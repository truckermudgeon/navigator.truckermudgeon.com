var vD=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var DQ=vD(Ur=>{function wE(e,t){for(var i=0;i<t.length;i++){const a=t[i];if(typeof a!="string"&&!Array.isArray(a)){for(const c in a)if(c!=="default"&&!(c in e)){const h=Object.getOwnPropertyDescriptor(a,c);h&&Object.defineProperty(e,c,h.get?h:{enumerable:!0,get:()=>a[c]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);new MutationObserver(c=>{for(const h of c)if(h.type==="childList")for(const f of h.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&a(f)}).observe(document,{childList:!0,subtree:!0});function i(c){const h={};return c.integrity&&(h.integrity=c.integrity),c.referrerPolicy&&(h.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?h.credentials="include":c.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function a(c){if(c.ep)return;c.ep=!0;const h=i(c);fetch(c.href,h)}})();function Lv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var db={exports:{}},zy={},fb={exports:{}},un={};var QC;function _D(){if(QC)return un;QC=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),h=Symbol.for("react.provider"),f=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),P=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),D=Symbol.iterator;function z(ye){return ye===null||typeof ye!="object"?null:(ye=D&&ye[D]||ye["@@iterator"],typeof ye=="function"?ye:null)}var F={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U=Object.assign,$={};function j(ye,ze,ft){this.props=ye,this.context=ze,this.refs=$,this.updater=ft||F}j.prototype.isReactComponent={},j.prototype.setState=function(ye,ze){if(typeof ye!="object"&&typeof ye!="function"&&ye!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ye,ze,"setState")},j.prototype.forceUpdate=function(ye){this.updater.enqueueForceUpdate(this,ye,"forceUpdate")};function ie(){}ie.prototype=j.prototype;function se(ye,ze,ft){this.props=ye,this.context=ze,this.refs=$,this.updater=ft||F}var Q=se.prototype=new ie;Q.constructor=se,U(Q,j.prototype),Q.isPureReactComponent=!0;var de=Array.isArray,oe=Object.prototype.hasOwnProperty,be={current:null},xe={key:!0,ref:!0,__self:!0,__source:!0};function Me(ye,ze,ft){var wt,xt={},_t=null,St=null;if(ze!=null)for(wt in ze.ref!==void 0&&(St=ze.ref),ze.key!==void 0&&(_t=""+ze.key),ze)oe.call(ze,wt)&&!xe.hasOwnProperty(wt)&&(xt[wt]=ze[wt]);var tt=arguments.length-2;if(tt===1)xt.children=ft;else if(1<tt){for(var At=Array(tt),It=0;It<tt;It++)At[It]=arguments[It+2];xt.children=At}if(ye&&ye.defaultProps)for(wt in tt=ye.defaultProps,tt)xt[wt]===void 0&&(xt[wt]=tt[wt]);return{$$typeof:e,type:ye,key:_t,ref:St,props:xt,_owner:be.current}}function Ee(ye,ze){return{$$typeof:e,type:ye.type,key:ze,ref:ye.ref,props:ye.props,_owner:ye._owner}}function re(ye){return typeof ye=="object"&&ye!==null&&ye.$$typeof===e}function ke(ye){var ze={"=":"=0",":":"=2"};return"$"+ye.replace(/[=:]/g,function(ft){return ze[ft]})}var Ge=/\/+/g;function Ke(ye,ze){return typeof ye=="object"&&ye!==null&&ye.key!=null?ke(""+ye.key):ze.toString(36)}function gt(ye,ze,ft,wt,xt){var _t=typeof ye;(_t==="undefined"||_t==="boolean")&&(ye=null);var St=!1;if(ye===null)St=!0;else switch(_t){case"string":case"number":St=!0;break;case"object":switch(ye.$$typeof){case e:case t:St=!0}}if(St)return St=ye,xt=xt(St),ye=wt===""?"."+Ke(St,0):wt,de(xt)?(ft="",ye!=null&&(ft=ye.replace(Ge,"$&/")+"/"),gt(xt,ze,ft,"",function(It){return It})):xt!=null&&(re(xt)&&(xt=Ee(xt,ft+(!xt.key||St&&St.key===xt.key?"":(""+xt.key).replace(Ge,"$&/")+"/")+ye)),ze.push(xt)),1;if(St=0,wt=wt===""?".":wt+":",de(ye))for(var tt=0;tt<ye.length;tt++){_t=ye[tt];var At=wt+Ke(_t,tt);St+=gt(_t,ze,ft,At,xt)}else if(At=z(ye),typeof At=="function")for(ye=At.call(ye),tt=0;!(_t=ye.next()).done;)_t=_t.value,At=wt+Ke(_t,tt++),St+=gt(_t,ze,ft,At,xt);else if(_t==="object")throw ze=String(ye),Error("Objects are not valid as a React child (found: "+(ze==="[object Object]"?"object with keys {"+Object.keys(ye).join(", ")+"}":ze)+"). If you meant to render a collection of children, use an array instead.");return St}function et(ye,ze,ft){if(ye==null)return ye;var wt=[],xt=0;return gt(ye,wt,"","",function(_t){return ze.call(ft,_t,xt++)}),wt}function qe(ye){if(ye._status===-1){var ze=ye._result;ze=ze(),ze.then(function(ft){(ye._status===0||ye._status===-1)&&(ye._status=1,ye._result=ft)},function(ft){(ye._status===0||ye._status===-1)&&(ye._status=2,ye._result=ft)}),ye._status===-1&&(ye._status=0,ye._result=ze)}if(ye._status===1)return ye._result.default;throw ye._result}var Qe={current:null},Ve={transition:null},je={ReactCurrentDispatcher:Qe,ReactCurrentBatchConfig:Ve,ReactCurrentOwner:be};function ct(){throw Error("act(...) is not supported in production builds of React.")}return un.Children={map:et,forEach:function(ye,ze,ft){et(ye,function(){ze.apply(this,arguments)},ft)},count:function(ye){var ze=0;return et(ye,function(){ze++}),ze},toArray:function(ye){return et(ye,function(ze){return ze})||[]},only:function(ye){if(!re(ye))throw Error("React.Children.only expected to receive a single React element child.");return ye}},un.Component=j,un.Fragment=i,un.Profiler=c,un.PureComponent=se,un.StrictMode=a,un.Suspense=b,un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=je,un.act=ct,un.cloneElement=function(ye,ze,ft){if(ye==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ye+".");var wt=U({},ye.props),xt=ye.key,_t=ye.ref,St=ye._owner;if(ze!=null){if(ze.ref!==void 0&&(_t=ze.ref,St=be.current),ze.key!==void 0&&(xt=""+ze.key),ye.type&&ye.type.defaultProps)var tt=ye.type.defaultProps;for(At in ze)oe.call(ze,At)&&!xe.hasOwnProperty(At)&&(wt[At]=ze[At]===void 0&&tt!==void 0?tt[At]:ze[At])}var At=arguments.length-2;if(At===1)wt.children=ft;else if(1<At){tt=Array(At);for(var It=0;It<At;It++)tt[It]=arguments[It+2];wt.children=tt}return{$$typeof:e,type:ye.type,key:xt,ref:_t,props:wt,_owner:St}},un.createContext=function(ye){return ye={$$typeof:f,_currentValue:ye,_currentValue2:ye,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ye.Provider={$$typeof:h,_context:ye},ye.Consumer=ye},un.createElement=Me,un.createFactory=function(ye){var ze=Me.bind(null,ye);return ze.type=ye,ze},un.createRef=function(){return{current:null}},un.forwardRef=function(ye){return{$$typeof:o,render:ye}},un.isValidElement=re,un.lazy=function(ye){return{$$typeof:I,_payload:{_status:-1,_result:ye},_init:qe}},un.memo=function(ye,ze){return{$$typeof:P,type:ye,compare:ze===void 0?null:ze}},un.startTransition=function(ye){var ze=Ve.transition;Ve.transition={};try{ye()}finally{Ve.transition=ze}},un.unstable_act=ct,un.useCallback=function(ye,ze){return Qe.current.useCallback(ye,ze)},un.useContext=function(ye){return Qe.current.useContext(ye)},un.useDebugValue=function(){},un.useDeferredValue=function(ye){return Qe.current.useDeferredValue(ye)},un.useEffect=function(ye,ze){return Qe.current.useEffect(ye,ze)},un.useId=function(){return Qe.current.useId()},un.useImperativeHandle=function(ye,ze,ft){return Qe.current.useImperativeHandle(ye,ze,ft)},un.useInsertionEffect=function(ye,ze){return Qe.current.useInsertionEffect(ye,ze)},un.useLayoutEffect=function(ye,ze){return Qe.current.useLayoutEffect(ye,ze)},un.useMemo=function(ye,ze){return Qe.current.useMemo(ye,ze)},un.useReducer=function(ye,ze,ft){return Qe.current.useReducer(ye,ze,ft)},un.useRef=function(ye){return Qe.current.useRef(ye)},un.useState=function(ye){return Qe.current.useState(ye)},un.useSyncExternalStore=function(ye,ze,ft){return Qe.current.useSyncExternalStore(ye,ze,ft)},un.useTransition=function(){return Qe.current.useTransition()},un.version="18.3.1",un}var eT;function Ex(){return eT||(eT=1,fb.exports=_D()),fb.exports}var tT;function xD(){if(tT)return zy;tT=1;var e=Ex(),t=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,c=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h={key:!0,ref:!0,__self:!0,__source:!0};function f(o,b,P){var I,D={},z=null,F=null;P!==void 0&&(z=""+P),b.key!==void 0&&(z=""+b.key),b.ref!==void 0&&(F=b.ref);for(I in b)a.call(b,I)&&!h.hasOwnProperty(I)&&(D[I]=b[I]);if(o&&o.defaultProps)for(I in b=o.defaultProps,b)D[I]===void 0&&(D[I]=b[I]);return{$$typeof:t,type:o,key:z,ref:F,props:D,_owner:c.current}}return zy.Fragment=i,zy.jsx=f,zy.jsxs=f,zy}var rT;function bD(){return rT||(rT=1,db.exports=xD()),db.exports}var G=bD();const Oy={grey:{50:"#FBFCFE",100:"#F0F4F8",200:"#DDE7EE",300:"#CDD7E1",400:"#9FA6AD",500:"#636B74",600:"#555E68",700:"#32383E",800:"#171A1C",900:"#0B0D0E"},blue:{50:"#EDF5FD",100:"#E3EFFB",200:"#C7DFF7",300:"#97C3F0",400:"#4393E4",500:"#0B6BCB",600:"#185EA5",700:"#12467B",800:"#0A2744",900:"#051423"},yellow:{50:"#FEFAF6",100:"#FDF0E1",200:"#FCE1C2",300:"#F3C896",400:"#EA9A3E",500:"#9A5B13",600:"#72430D",700:"#492B08",800:"#2E1B05",900:"#1D1002"},red:{50:"#FEF6F6",100:"#FCE4E4",200:"#F7C5C5",300:"#F09898",400:"#E47474",500:"#C41C1C",600:"#A51818",700:"#7D1212",800:"#430A0A",900:"#240505"},green:{50:"#F6FEF6",100:"#E3FBE3",200:"#C7F7C7",300:"#A1E8A1",400:"#51BC51",500:"#1F7A1F",600:"#136C13",700:"#0A470A",800:"#042F04",900:"#021D02"}},Fv="$$joy";function gv(e){let t="https://mui.com/production-error/?code="+e;for(let i=1;i<arguments.length;i+=1)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}function we(){return we=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)({}).hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},we.apply(null,arguments)}var K=Ex();const hn=Lv(K),yv=wE({__proto__:null,default:hn},[K]);function wD(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function SD(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var CD=function(){function e(i){var a=this;this._insertTag=function(c){var h;a.tags.length===0?a.insertionPoint?h=a.insertionPoint.nextSibling:a.prepend?h=a.container.firstChild:h=a.before:h=a.tags[a.tags.length-1].nextSibling,a.container.insertBefore(c,h),a.tags.push(c)},this.isSpeedy=i.speedy===void 0?!0:i.speedy,this.tags=[],this.ctr=0,this.nonce=i.nonce,this.key=i.key,this.container=i.container,this.prepend=i.prepend,this.insertionPoint=i.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(a){a.forEach(this._insertTag)},t.insert=function(a){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(SD(this));var c=this.tags[this.tags.length-1];if(this.isSpeedy){var h=wD(c);try{h.insertRule(a,h.cssRules.length)}catch{}}else c.appendChild(document.createTextNode(a));this.ctr++},t.flush=function(){this.tags.forEach(function(a){var c;return(c=a.parentNode)==null?void 0:c.removeChild(a)}),this.tags=[],this.ctr=0},e}(),ks="-ms-",G_="-moz-",$n="-webkit-",SE="comm",i2="rule",o2="decl",TD="@import",CE="@keyframes",MD="@layer",PD=Math.abs,Ix=String.fromCharCode,ED=Object.assign;function ID(e,t){return hs(e,0)^45?(((t<<2^hs(e,0))<<2^hs(e,1))<<2^hs(e,2))<<2^hs(e,3):0}function TE(e){return e.trim()}function kD(e,t){return(e=t.exec(e))?e[0]:e}function jn(e,t,i){return e.replace(t,i)}function vw(e,t){return e.indexOf(t)}function hs(e,t){return e.charCodeAt(t)|0}function vv(e,t,i){return e.slice(t,i)}function Gu(e){return e.length}function s2(e){return e.length}function i_(e,t){return t.push(e),e}function AD(e,t){return e.map(t).join("")}var kx=1,Ag=1,ME=0,Pa=0,Ro=0,Wg="";function Ax(e,t,i,a,c,h,f){return{value:e,root:t,parent:i,type:a,props:c,children:h,line:kx,column:Ag,length:f,return:""}}function Ly(e,t){return ED(Ax("",null,null,"",null,null,0),e,{length:-e.length},t)}function RD(){return Ro}function DD(){return Ro=Pa>0?hs(Wg,--Pa):0,Ag--,Ro===10&&(Ag=1,kx--),Ro}function cl(){return Ro=Pa<ME?hs(Wg,Pa++):0,Ag++,Ro===10&&(Ag=1,kx++),Ro}function Ju(){return hs(Wg,Pa)}function T_(){return Pa}function Bv(e,t){return vv(Wg,e,t)}function _v(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function PE(e){return kx=Ag=1,ME=Gu(Wg=e),Pa=0,[]}function EE(e){return Wg="",e}function M_(e){return TE(Bv(Pa-1,_w(e===91?e+2:e===40?e+1:e)))}function zD(e){for(;(Ro=Ju())&&Ro<33;)cl();return _v(e)>2||_v(Ro)>3?"":" "}function OD(e,t){for(;--t&&cl()&&!(Ro<48||Ro>102||Ro>57&&Ro<65||Ro>70&&Ro<97););return Bv(e,T_()+(t<6&&Ju()==32&&cl()==32))}function _w(e){for(;cl();)switch(Ro){case e:return Pa;case 34:case 39:e!==34&&e!==39&&_w(Ro);break;case 40:e===41&&_w(e);break;case 92:cl();break}return Pa}function LD(e,t){for(;cl()&&e+Ro!==57;)if(e+Ro===84&&Ju()===47)break;return"/*"+Bv(t,Pa-1)+"*"+Ix(e===47?e:cl())}function FD(e){for(;!_v(Ju());)cl();return Bv(e,Pa)}function BD(e){return EE(P_("",null,null,null,[""],e=PE(e),0,[0],e))}function P_(e,t,i,a,c,h,f,o,b){for(var P=0,I=0,D=f,z=0,F=0,U=0,$=1,j=1,ie=1,se=0,Q="",de=c,oe=h,be=a,xe=Q;j;)switch(U=se,se=cl()){case 40:if(U!=108&&hs(xe,D-1)==58){vw(xe+=jn(M_(se),"&","&\f"),"&\f")!=-1&&(ie=-1);break}case 34:case 39:case 91:xe+=M_(se);break;case 9:case 10:case 13:case 32:xe+=zD(U);break;case 92:xe+=OD(T_()-1,7);continue;case 47:switch(Ju()){case 42:case 47:i_($D(LD(cl(),T_()),t,i),b);break;default:xe+="/"}break;case 123*$:o[P++]=Gu(xe)*ie;case 125*$:case 59:case 0:switch(se){case 0:case 125:j=0;case 59+I:ie==-1&&(xe=jn(xe,/\f/g,"")),F>0&&Gu(xe)-D&&i_(F>32?iT(xe+";",a,i,D-1):iT(jn(xe," ","")+";",a,i,D-2),b);break;case 59:xe+=";";default:if(i_(be=nT(xe,t,i,P,I,c,o,Q,de=[],oe=[],D),h),se===123)if(I===0)P_(xe,t,be,be,de,h,D,o,oe);else switch(z===99&&hs(xe,3)===110?100:z){case 100:case 108:case 109:case 115:P_(e,be,be,a&&i_(nT(e,be,be,0,0,c,o,Q,c,de=[],D),oe),c,oe,D,o,a?de:oe);break;default:P_(xe,be,be,be,[""],oe,0,o,oe)}}P=I=F=0,$=ie=1,Q=xe="",D=f;break;case 58:D=1+Gu(xe),F=U;default:if($<1){if(se==123)--$;else if(se==125&&$++==0&&DD()==125)continue}switch(xe+=Ix(se),se*$){case 38:ie=I>0?1:(xe+="\f",-1);break;case 44:o[P++]=(Gu(xe)-1)*ie,ie=1;break;case 64:Ju()===45&&(xe+=M_(cl())),z=Ju(),I=D=Gu(Q=xe+=FD(T_())),se++;break;case 45:U===45&&Gu(xe)==2&&($=0)}}return h}function nT(e,t,i,a,c,h,f,o,b,P,I){for(var D=c-1,z=c===0?h:[""],F=s2(z),U=0,$=0,j=0;U<a;++U)for(var ie=0,se=vv(e,D+1,D=PD($=f[U])),Q=e;ie<F;++ie)(Q=TE($>0?z[ie]+" "+se:jn(se,/&\f/g,z[ie])))&&(b[j++]=Q);return Ax(e,t,i,c===0?i2:o,b,P,I)}function $D(e,t,i){return Ax(e,t,i,SE,Ix(RD()),vv(e,2,-2),0)}function iT(e,t,i,a){return Ax(e,t,i,o2,vv(e,0,a),vv(e,a+1,-1),a)}function bg(e,t){for(var i="",a=s2(e),c=0;c<a;c++)i+=t(e[c],c,e,t)||"";return i}function jD(e,t,i,a){switch(e.type){case MD:if(e.children.length)break;case TD:case o2:return e.return=e.return||e.value;case SE:return"";case CE:return e.return=e.value+"{"+bg(e.children,a)+"}";case i2:e.value=e.props.join(",")}return Gu(i=bg(e.children,a))?e.return=e.value+"{"+i+"}":""}function ND(e){var t=s2(e);return function(i,a,c,h){for(var f="",o=0;o<t;o++)f+=e[o](i,a,c,h)||"";return f}}function VD(e){return function(t){t.root||(t=t.return)&&e(t)}}function IE(e){var t=Object.create(null);return function(i){return t[i]===void 0&&(t[i]=e(i)),t[i]}}var UD=function(t,i,a){for(var c=0,h=0;c=h,h=Ju(),c===38&&h===12&&(i[a]=1),!_v(h);)cl();return Bv(t,Pa)},GD=function(t,i){var a=-1,c=44;do switch(_v(c)){case 0:c===38&&Ju()===12&&(i[a]=1),t[a]+=UD(Pa-1,i,a);break;case 2:t[a]+=M_(c);break;case 4:if(c===44){t[++a]=Ju()===58?"&\f":"",i[a]=t[a].length;break}default:t[a]+=Ix(c)}while(c=cl());return t},qD=function(t,i){return EE(GD(PE(t),i))},oT=new WeakMap,HD=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var i=t.value,a=t.parent,c=t.column===a.column&&t.line===a.line;a.type!=="rule";)if(a=a.parent,!a)return;if(!(t.props.length===1&&i.charCodeAt(0)!==58&&!oT.get(a))&&!c){oT.set(t,!0);for(var h=[],f=qD(i,h),o=a.props,b=0,P=0;b<f.length;b++)for(var I=0;I<o.length;I++,P++)t.props[P]=h[b]?f[b].replace(/&\f/g,o[I]):o[I]+" "+f[b]}}},WD=function(t){if(t.type==="decl"){var i=t.value;i.charCodeAt(0)===108&&i.charCodeAt(2)===98&&(t.return="",t.value="")}};function kE(e,t){switch(ID(e,t)){case 5103:return $n+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return $n+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return $n+e+G_+e+ks+e+e;case 6828:case 4268:return $n+e+ks+e+e;case 6165:return $n+e+ks+"flex-"+e+e;case 5187:return $n+e+jn(e,/(\w+).+(:[^]+)/,$n+"box-$1$2"+ks+"flex-$1$2")+e;case 5443:return $n+e+ks+"flex-item-"+jn(e,/flex-|-self/,"")+e;case 4675:return $n+e+ks+"flex-line-pack"+jn(e,/align-content|flex-|-self/,"")+e;case 5548:return $n+e+ks+jn(e,"shrink","negative")+e;case 5292:return $n+e+ks+jn(e,"basis","preferred-size")+e;case 6060:return $n+"box-"+jn(e,"-grow","")+$n+e+ks+jn(e,"grow","positive")+e;case 4554:return $n+jn(e,/([^-])(transform)/g,"$1"+$n+"$2")+e;case 6187:return jn(jn(jn(e,/(zoom-|grab)/,$n+"$1"),/(image-set)/,$n+"$1"),e,"")+e;case 5495:case 3959:return jn(e,/(image-set\([^]*)/,$n+"$1$`$1");case 4968:return jn(jn(e,/(.+:)(flex-)?(.*)/,$n+"box-pack:$3"+ks+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+$n+e+e;case 4095:case 3583:case 4068:case 2532:return jn(e,/(.+)-inline(.+)/,$n+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Gu(e)-1-t>6)switch(hs(e,t+1)){case 109:if(hs(e,t+4)!==45)break;case 102:return jn(e,/(.+:)(.+)-([^]+)/,"$1"+$n+"$2-$3$1"+G_+(hs(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~vw(e,"stretch")?kE(jn(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(hs(e,t+1)!==115)break;case 6444:switch(hs(e,Gu(e)-3-(~vw(e,"!important")&&10))){case 107:return jn(e,":",":"+$n)+e;case 101:return jn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+$n+(hs(e,14)===45?"inline-":"")+"box$3$1"+$n+"$2$3$1"+ks+"$2box$3")+e}break;case 5936:switch(hs(e,t+11)){case 114:return $n+e+ks+jn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return $n+e+ks+jn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return $n+e+ks+jn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return $n+e+ks+e+e}return e}var ZD=function(t,i,a,c){if(t.length>-1&&!t.return)switch(t.type){case o2:t.return=kE(t.value,t.length);break;case CE:return bg([Ly(t,{value:jn(t.value,"@","@"+$n)})],c);case i2:if(t.length)return AD(t.props,function(h){switch(kD(h,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return bg([Ly(t,{props:[jn(h,/:(read-\w+)/,":"+G_+"$1")]})],c);case"::placeholder":return bg([Ly(t,{props:[jn(h,/:(plac\w+)/,":"+$n+"input-$1")]}),Ly(t,{props:[jn(h,/:(plac\w+)/,":"+G_+"$1")]}),Ly(t,{props:[jn(h,/:(plac\w+)/,ks+"input-$1")]})],c)}return""})}},XD=[ZD],KD=function(t){var i=t.key;if(i==="css"){var a=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(a,function($){var j=$.getAttribute("data-emotion");j.indexOf(" ")!==-1&&(document.head.appendChild($),$.setAttribute("data-s",""))})}var c=t.stylisPlugins||XD,h={},f,o=[];f=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+i+' "]'),function($){for(var j=$.getAttribute("data-emotion").split(" "),ie=1;ie<j.length;ie++)h[j[ie]]=!0;o.push($)});var b,P=[HD,WD];{var I,D=[jD,VD(function($){I.insert($)})],z=ND(P.concat(c,D)),F=function(j){return bg(BD(j),z)};b=function(j,ie,se,Q){I=se,F(j?j+"{"+ie.styles+"}":ie.styles),Q&&(U.inserted[ie.name]=!0)}}var U={key:i,sheet:new CD({key:i,container:f,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:h,registered:{},insert:b};return U.sheet.hydrate(o),U},pb={exports:{}},Yn={};var sT;function YD(){if(sT)return Yn;sT=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,i=e?Symbol.for("react.portal"):60106,a=e?Symbol.for("react.fragment"):60107,c=e?Symbol.for("react.strict_mode"):60108,h=e?Symbol.for("react.profiler"):60114,f=e?Symbol.for("react.provider"):60109,o=e?Symbol.for("react.context"):60110,b=e?Symbol.for("react.async_mode"):60111,P=e?Symbol.for("react.concurrent_mode"):60111,I=e?Symbol.for("react.forward_ref"):60112,D=e?Symbol.for("react.suspense"):60113,z=e?Symbol.for("react.suspense_list"):60120,F=e?Symbol.for("react.memo"):60115,U=e?Symbol.for("react.lazy"):60116,$=e?Symbol.for("react.block"):60121,j=e?Symbol.for("react.fundamental"):60117,ie=e?Symbol.for("react.responder"):60118,se=e?Symbol.for("react.scope"):60119;function Q(oe){if(typeof oe=="object"&&oe!==null){var be=oe.$$typeof;switch(be){case t:switch(oe=oe.type,oe){case b:case P:case a:case h:case c:case D:return oe;default:switch(oe=oe&&oe.$$typeof,oe){case o:case I:case U:case F:case f:return oe;default:return be}}case i:return be}}}function de(oe){return Q(oe)===P}return Yn.AsyncMode=b,Yn.ConcurrentMode=P,Yn.ContextConsumer=o,Yn.ContextProvider=f,Yn.Element=t,Yn.ForwardRef=I,Yn.Fragment=a,Yn.Lazy=U,Yn.Memo=F,Yn.Portal=i,Yn.Profiler=h,Yn.StrictMode=c,Yn.Suspense=D,Yn.isAsyncMode=function(oe){return de(oe)||Q(oe)===b},Yn.isConcurrentMode=de,Yn.isContextConsumer=function(oe){return Q(oe)===o},Yn.isContextProvider=function(oe){return Q(oe)===f},Yn.isElement=function(oe){return typeof oe=="object"&&oe!==null&&oe.$$typeof===t},Yn.isForwardRef=function(oe){return Q(oe)===I},Yn.isFragment=function(oe){return Q(oe)===a},Yn.isLazy=function(oe){return Q(oe)===U},Yn.isMemo=function(oe){return Q(oe)===F},Yn.isPortal=function(oe){return Q(oe)===i},Yn.isProfiler=function(oe){return Q(oe)===h},Yn.isStrictMode=function(oe){return Q(oe)===c},Yn.isSuspense=function(oe){return Q(oe)===D},Yn.isValidElementType=function(oe){return typeof oe=="string"||typeof oe=="function"||oe===a||oe===P||oe===h||oe===c||oe===D||oe===z||typeof oe=="object"&&oe!==null&&(oe.$$typeof===U||oe.$$typeof===F||oe.$$typeof===f||oe.$$typeof===o||oe.$$typeof===I||oe.$$typeof===j||oe.$$typeof===ie||oe.$$typeof===se||oe.$$typeof===$)},Yn.typeOf=Q,Yn}var aT;function JD(){return aT||(aT=1,pb.exports=YD()),pb.exports}var mb,lT;function QD(){if(lT)return mb;lT=1;var e=JD(),t={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},c={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},h={};h[e.ForwardRef]=a,h[e.Memo]=c;function f(U){return e.isMemo(U)?c:h[U.$$typeof]||t}var o=Object.defineProperty,b=Object.getOwnPropertyNames,P=Object.getOwnPropertySymbols,I=Object.getOwnPropertyDescriptor,D=Object.getPrototypeOf,z=Object.prototype;function F(U,$,j){if(typeof $!="string"){if(z){var ie=D($);ie&&ie!==z&&F(U,ie,j)}var se=b($);P&&(se=se.concat(P($)));for(var Q=f(U),de=f($),oe=0;oe<se.length;++oe){var be=se[oe];if(!i[be]&&!(j&&j[be])&&!(de&&de[be])&&!(Q&&Q[be])){var xe=I($,be);try{o(U,be,xe)}catch{}}}}return U}return mb=F,mb}QD();var e3=!0;function AE(e,t,i){var a="";return i.split(" ").forEach(function(c){e[c]!==void 0?t.push(e[c]+";"):c&&(a+=c+" ")}),a}var a2=function(t,i,a){var c=t.key+"-"+i.name;(a===!1||e3===!1)&&t.registered[c]===void 0&&(t.registered[c]=i.styles)},l2=function(t,i,a){a2(t,i,a);var c=t.key+"-"+i.name;if(t.inserted[i.name]===void 0){var h=i;do t.insert(i===h?"."+c:"",h,t.sheet,!0),h=h.next;while(h!==void 0)}};function t3(e){for(var t=0,i,a=0,c=e.length;c>=4;++a,c-=4)i=e.charCodeAt(a)&255|(e.charCodeAt(++a)&255)<<8|(e.charCodeAt(++a)&255)<<16|(e.charCodeAt(++a)&255)<<24,i=(i&65535)*1540483477+((i>>>16)*59797<<16),i^=i>>>24,t=(i&65535)*1540483477+((i>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(c){case 3:t^=(e.charCodeAt(a+2)&255)<<16;case 2:t^=(e.charCodeAt(a+1)&255)<<8;case 1:t^=e.charCodeAt(a)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var r3={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},n3=/[A-Z]|^ms/g,i3=/_EMO_([^_]+?)_([^]*?)_EMO_/g,RE=function(t){return t.charCodeAt(1)===45},cT=function(t){return t!=null&&typeof t!="boolean"},gb=IE(function(e){return RE(e)?e:e.replace(n3,"-$&").toLowerCase()}),uT=function(t,i){switch(t){case"animation":case"animationName":if(typeof i=="string")return i.replace(i3,function(a,c,h){return qu={name:c,styles:h,next:qu},c})}return r3[t]!==1&&!RE(t)&&typeof i=="number"&&i!==0?i+"px":i};function xv(e,t,i){if(i==null)return"";var a=i;if(a.__emotion_styles!==void 0)return a;switch(typeof i){case"boolean":return"";case"object":{var c=i;if(c.anim===1)return qu={name:c.name,styles:c.styles,next:qu},c.name;var h=i;if(h.styles!==void 0){var f=h.next;if(f!==void 0)for(;f!==void 0;)qu={name:f.name,styles:f.styles,next:qu},f=f.next;var o=h.styles+";";return o}return o3(e,t,i)}case"function":{if(e!==void 0){var b=qu,P=i(e);return qu=b,xv(e,t,P)}break}}var I=i;if(t==null)return I;var D=t[I];return D!==void 0?D:I}function o3(e,t,i){var a="";if(Array.isArray(i))for(var c=0;c<i.length;c++)a+=xv(e,t,i[c])+";";else for(var h in i){var f=i[h];if(typeof f!="object"){var o=f;t!=null&&t[o]!==void 0?a+=h+"{"+t[o]+"}":cT(o)&&(a+=gb(h)+":"+uT(h,o)+";")}else if(Array.isArray(f)&&typeof f[0]=="string"&&(t==null||t[f[0]]===void 0))for(var b=0;b<f.length;b++)cT(f[b])&&(a+=gb(h)+":"+uT(h,f[b])+";");else{var P=xv(e,t,f);switch(h){case"animation":case"animationName":{a+=gb(h)+":"+P+";";break}default:a+=h+"{"+P+"}"}}}return a}var hT=/label:\s*([^\s;{]+)\s*(;|$)/g,qu;function $v(e,t,i){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var a=!0,c="";qu=void 0;var h=e[0];if(h==null||h.raw===void 0)a=!1,c+=xv(i,t,h);else{var f=h;c+=f[0]}for(var o=1;o<e.length;o++)if(c+=xv(i,t,e[o]),a){var b=h;c+=b[o]}hT.lastIndex=0;for(var P="",I;(I=hT.exec(c))!==null;)P+="-"+I[1];var D=t3(c)+P;return{name:D,styles:c,next:qu}}var s3=function(t){return t()},DE=yv.useInsertionEffect?yv.useInsertionEffect:!1,zE=DE||s3,dT=DE||K.useLayoutEffect,OE=K.createContext(typeof HTMLElement<"u"?KD({key:"css"}):null);OE.Provider;var c2=function(t){return K.forwardRef(function(i,a){var c=K.useContext(OE);return t(i,c,a)})},em=K.createContext({}),u2={}.hasOwnProperty,xw="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",a3=function(t,i){var a={};for(var c in i)u2.call(i,c)&&(a[c]=i[c]);return a[xw]=t,a},l3=function(t){var i=t.cache,a=t.serialized,c=t.isStringTag;return a2(i,a,c),zE(function(){return l2(i,a,c)}),null},c3=c2(function(e,t,i){var a=e.css;typeof a=="string"&&t.registered[a]!==void 0&&(a=t.registered[a]);var c=e[xw],h=[a],f="";typeof e.className=="string"?f=AE(t.registered,h,e.className):e.className!=null&&(f=e.className+" ");var o=$v(h,void 0,K.useContext(em));f+=t.key+"-"+o.name;var b={};for(var P in e)u2.call(e,P)&&P!=="css"&&P!==xw&&(b[P]=e[P]);return b.className=f,i&&(b.ref=i),K.createElement(K.Fragment,null,K.createElement(l3,{cache:t,serialized:o,isStringTag:typeof c=="string"}),K.createElement(c,b))}),u3=c3,fT=function(t,i){var a=arguments;if(i==null||!u2.call(i,"css"))return K.createElement.apply(void 0,a);var c=a.length,h=new Array(c);h[0]=u3,h[1]=a3(t,i);for(var f=2;f<c;f++)h[f]=a[f];return K.createElement.apply(null,h)};(function(e){var t;t||(t=e.JSX||(e.JSX={}))})(fT||(fT={}));var LE=c2(function(e,t){var i=e.styles,a=$v([i],void 0,K.useContext(em)),c=K.useRef();return dT(function(){var h=t.key+"-global",f=new t.sheet.constructor({key:h,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),o=!1,b=document.querySelector('style[data-emotion="'+h+" "+a.name+'"]');return t.sheet.tags.length&&(f.before=t.sheet.tags[0]),b!==null&&(o=!0,b.setAttribute("data-emotion",h),f.hydrate([b])),c.current=[f,o],function(){f.flush()}},[t]),dT(function(){var h=c.current,f=h[0],o=h[1];if(o){h[1]=!1;return}if(a.next!==void 0&&l2(t,a.next,!0),f.tags.length){var b=f.tags[f.tags.length-1].nextElementSibling;f.before=b,f.flush()}t.insert("",a,f,!1)},[t,a.name]),null});function FE(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return $v(t)}function h2(){var e=FE.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var h3=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,d3=IE(function(e){return h3.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),f3=d3,p3=function(t){return t!=="theme"},pT=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?f3:p3},mT=function(t,i,a){var c;if(i){var h=i.shouldForwardProp;c=t.__emotion_forwardProp&&h?function(f){return t.__emotion_forwardProp(f)&&h(f)}:h}return typeof c!="function"&&a&&(c=t.__emotion_forwardProp),c},m3=function(t){var i=t.cache,a=t.serialized,c=t.isStringTag;return a2(i,a,c),zE(function(){return l2(i,a,c)}),null},g3=function e(t,i){var a=t.__emotion_real===t,c=a&&t.__emotion_base||t,h,f;i!==void 0&&(h=i.label,f=i.target);var o=mT(t,i,a),b=o||pT(c),P=!b("as");return function(){var I=arguments,D=a&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(h!==void 0&&D.push("label:"+h+";"),I[0]==null||I[0].raw===void 0)D.push.apply(D,I);else{var z=I[0];D.push(z[0]);for(var F=I.length,U=1;U<F;U++)D.push(I[U],z[U])}var $=c2(function(j,ie,se){var Q=P&&j.as||c,de="",oe=[],be=j;if(j.theme==null){be={};for(var xe in j)be[xe]=j[xe];be.theme=K.useContext(em)}typeof j.className=="string"?de=AE(ie.registered,oe,j.className):j.className!=null&&(de=j.className+" ");var Me=$v(D.concat(oe),ie.registered,be);de+=ie.key+"-"+Me.name,f!==void 0&&(de+=" "+f);var Ee=P&&o===void 0?pT(Q):b,re={};for(var ke in j)P&&ke==="as"||Ee(ke)&&(re[ke]=j[ke]);return re.className=de,se&&(re.ref=se),K.createElement(K.Fragment,null,K.createElement(m3,{cache:ie,serialized:Me,isStringTag:typeof Q=="string"}),K.createElement(Q,re))});return $.displayName=h!==void 0?h:"Styled("+(typeof c=="string"?c:c.displayName||c.name||"Component")+")",$.defaultProps=t.defaultProps,$.__emotion_real=$,$.__emotion_base=c,$.__emotion_styles=D,$.__emotion_forwardProp=o,Object.defineProperty($,"toString",{value:function(){return"."+f}}),$.withComponent=function(j,ie){var se=e(j,we({},i,ie,{shouldForwardProp:mT($,ie,!0)}));return se.apply(void 0,D)},$}},y3=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],q_=g3.bind(null);y3.forEach(function(e){q_[e]=q_(e)});function v3(e){return e==null||Object.keys(e).length===0}function E_(e){const{styles:t,defaultTheme:i={}}=e,a=typeof t=="function"?c=>t(v3(c)?i:c):t;return G.jsx(LE,{styles:a})}function BE(e,t){return q_(e,t)}const _3=(e,t)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))};function Pr(e,t){if(e==null)return{};var i={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;i[a]=e[a]}return i}function mf(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function $E(e){if(K.isValidElement(e)||!mf(e))return e;const t={};return Object.keys(e).forEach(i=>{t[i]=$E(e[i])}),t}function ul(e,t,i={clone:!0}){const a=i.clone?we({},e):e;return mf(e)&&mf(t)&&Object.keys(t).forEach(c=>{K.isValidElement(t[c])?a[c]=t[c]:mf(t[c])&&Object.prototype.hasOwnProperty.call(e,c)&&mf(e[c])?a[c]=ul(e[c],t[c],i):i.clone?a[c]=mf(t[c])?$E(t[c]):t[c]:a[c]=t[c]}),a}const x3=["values","unit","step"],b3=e=>{const t=Object.keys(e).map(i=>({key:i,val:e[i]}))||[];return t.sort((i,a)=>i.val-a.val),t.reduce((i,a)=>we({},i,{[a.key]:a.val}),{})};function jE(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:i="px",step:a=5}=e,c=Pr(e,x3),h=b3(t),f=Object.keys(h);function o(z){return`@media (min-width:${typeof t[z]=="number"?t[z]:z}${i})`}function b(z){return`@media (max-width:${(typeof t[z]=="number"?t[z]:z)-a/100}${i})`}function P(z,F){const U=f.indexOf(F);return`@media (min-width:${typeof t[z]=="number"?t[z]:z}${i}) and (max-width:${(U!==-1&&typeof t[f[U]]=="number"?t[f[U]]:F)-a/100}${i})`}function I(z){return f.indexOf(z)+1<f.length?P(z,f[f.indexOf(z)+1]):o(z)}function D(z){const F=f.indexOf(z);return F===0?o(f[1]):F===f.length-1?b(f[F]):P(z,f[f.indexOf(z)+1]).replace("@media","@media not all and")}return we({keys:f,values:h,up:o,down:b,between:P,only:I,not:D,unit:i},c)}const w3={borderRadius:4};function Jy(e,t){return t?ul(e,t,{clone:!1}):e}const d2={xs:0,sm:600,md:900,lg:1200,xl:1536},gT={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${d2[e]}px)`};function eu(e,t,i){const a=e.theme||{};if(Array.isArray(t)){const h=a.breakpoints||gT;return t.reduce((f,o,b)=>(f[h.up(h.keys[b])]=i(t[b]),f),{})}if(typeof t=="object"){const h=a.breakpoints||gT;return Object.keys(t).reduce((f,o)=>{if(Object.keys(h.values||d2).indexOf(o)!==-1){const b=h.up(o);f[b]=i(t[o],o)}else{const b=o;f[b]=t[b]}return f},{})}return i(t)}function NE(e={}){var t;return((t=e.keys)==null?void 0:t.reduce((a,c)=>{const h=e.up(c);return a[h]={},a},{}))||{}}function VE(e,t){return e.reduce((i,a)=>{const c=i[a];return(!c||Object.keys(c).length===0)&&delete i[a],i},t)}function S3(e,...t){const i=NE(e),a=[i,...t].reduce((c,h)=>ul(c,h),{});return VE(Object.keys(i),a)}function C3(e,t){if(typeof e!="object")return{};const i={},a=Object.keys(t);return Array.isArray(e)?a.forEach((c,h)=>{h<e.length&&(i[c]=!0)}):a.forEach(c=>{e[c]!=null&&(i[c]=!0)}),i}function yb({values:e,breakpoints:t,base:i}){const a=i||C3(e,t),c=Object.keys(a);if(c.length===0)return e;let h;return c.reduce((f,o,b)=>(Array.isArray(e)?(f[o]=e[b]!=null?e[b]:e[h],h=b):typeof e=="object"?(f[o]=e[o]!=null?e[o]:e[h],h=o):f[o]=e,f),{})}function xr(e){if(typeof e!="string")throw new Error(gv(7));return e.charAt(0).toUpperCase()+e.slice(1)}function Rg(e,t,i=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&i){const a=`vars.${t}`.split(".").reduce((c,h)=>c&&c[h]?c[h]:null,e);if(a!=null)return a}return t.split(".").reduce((a,c)=>a&&a[c]!=null?a[c]:null,e)}function H_(e,t,i,a=i){let c;return typeof e=="function"?c=e(i):Array.isArray(e)?c=e[i]||a:c=Rg(e,i)||a,t&&(c=t(c,a,e)),c}function _o(e){const{prop:t,cssProperty:i=e.prop,themeKey:a,transform:c}=e,h=f=>{if(f[t]==null)return null;const o=f[t],b=f.theme,P=Rg(b,a)||{};return eu(f,o,D=>{let z=H_(P,c,D);return D===z&&typeof D=="string"&&(z=H_(P,c,`${t}${D==="default"?"":xr(D)}`,D)),i===!1?z:{[i]:z}})};return h.propTypes={},h.filterProps=[t],h}function T3(e){const t={};return i=>(t[i]===void 0&&(t[i]=e(i)),t[i])}const M3={m:"margin",p:"padding"},P3={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},yT={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},E3=T3(e=>{if(e.length>2)if(yT[e])e=yT[e];else return[e];const[t,i]=e.split(""),a=M3[t],c=P3[i]||"";return Array.isArray(c)?c.map(h=>a+h):[a+c]}),f2=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],p2=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...f2,...p2];function jv(e,t,i,a){var c;const h=(c=Rg(e,t,!1))!=null?c:i;return typeof h=="number"?f=>typeof f=="string"?f:h*f:Array.isArray(h)?f=>typeof f=="string"?f:h[f]:typeof h=="function"?h:()=>{}}function m2(e){return jv(e,"spacing",8)}function Gp(e,t){if(typeof t=="string"||t==null)return t;const i=Math.abs(t),a=e(i);return t>=0?a:typeof a=="number"?-a:`-${a}`}function I3(e,t){return i=>e.reduce((a,c)=>(a[c]=Gp(t,i),a),{})}function k3(e,t,i,a){if(t.indexOf(i)===-1)return null;const c=E3(i),h=I3(c,a),f=e[i];return eu(e,f,h)}function UE(e,t){const i=m2(e.theme);return Object.keys(e).map(a=>k3(e,t,a,i)).reduce(Jy,{})}function lo(e){return UE(e,f2)}lo.propTypes={};lo.filterProps=f2;function co(e){return UE(e,p2)}co.propTypes={};co.filterProps=p2;function GE(e=8){if(e.mui)return e;const t=m2({spacing:e}),i=(...a)=>(a.length===0?[1]:a).map(h=>{const f=t(h);return typeof f=="number"?`${f}px`:f}).join(" ");return i.mui=!0,i}function Rx(...e){const t=e.reduce((a,c)=>(c.filterProps.forEach(h=>{a[h]=c}),a),{}),i=a=>Object.keys(a).reduce((c,h)=>t[h]?Jy(c,t[h](a)):c,{});return i.propTypes={},i.filterProps=e.reduce((a,c)=>a.concat(c.filterProps),[]),i}function ql(e){return typeof e!="number"?e:`${e}px solid`}function tc(e,t){return _o({prop:e,themeKey:"borders",transform:t})}const A3=tc("border",ql),R3=tc("borderTop",ql),D3=tc("borderRight",ql),z3=tc("borderBottom",ql),O3=tc("borderLeft",ql),L3=tc("borderColor"),F3=tc("borderTopColor"),B3=tc("borderRightColor"),$3=tc("borderBottomColor"),j3=tc("borderLeftColor"),N3=tc("outline",ql),V3=tc("outlineColor"),Dx=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=jv(e.theme,"shape.borderRadius",4),i=a=>({borderRadius:Gp(t,a)});return eu(e,e.borderRadius,i)}return null};Dx.propTypes={};Dx.filterProps=["borderRadius"];Rx(A3,R3,D3,z3,O3,L3,F3,B3,$3,j3,Dx,N3,V3);const zx=e=>{if(e.gap!==void 0&&e.gap!==null){const t=jv(e.theme,"spacing",8),i=a=>({gap:Gp(t,a)});return eu(e,e.gap,i)}return null};zx.propTypes={};zx.filterProps=["gap"];const Ox=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=jv(e.theme,"spacing",8),i=a=>({columnGap:Gp(t,a)});return eu(e,e.columnGap,i)}return null};Ox.propTypes={};Ox.filterProps=["columnGap"];const Lx=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=jv(e.theme,"spacing",8),i=a=>({rowGap:Gp(t,a)});return eu(e,e.rowGap,i)}return null};Lx.propTypes={};Lx.filterProps=["rowGap"];const U3=_o({prop:"gridColumn"}),G3=_o({prop:"gridRow"}),q3=_o({prop:"gridAutoFlow"}),H3=_o({prop:"gridAutoColumns"}),W3=_o({prop:"gridAutoRows"}),Z3=_o({prop:"gridTemplateColumns"}),X3=_o({prop:"gridTemplateRows"}),K3=_o({prop:"gridTemplateAreas"}),Y3=_o({prop:"gridArea"});Rx(zx,Ox,Lx,U3,G3,q3,H3,W3,Z3,X3,K3,Y3);function wg(e,t){return t==="grey"?t:e}const J3=_o({prop:"color",themeKey:"palette",transform:wg}),Q3=_o({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:wg}),ez=_o({prop:"backgroundColor",themeKey:"palette",transform:wg});Rx(J3,Q3,ez);function nl(e){return e<=1&&e!==0?`${e*100}%`:e}const tz=_o({prop:"width",transform:nl}),g2=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=i=>{var a,c;const h=((a=e.theme)==null||(a=a.breakpoints)==null||(a=a.values)==null?void 0:a[i])||d2[i];return h?((c=e.theme)==null||(c=c.breakpoints)==null?void 0:c.unit)!=="px"?{maxWidth:`${h}${e.theme.breakpoints.unit}`}:{maxWidth:h}:{maxWidth:nl(i)}};return eu(e,e.maxWidth,t)}return null};g2.filterProps=["maxWidth"];const rz=_o({prop:"minWidth",transform:nl}),nz=_o({prop:"height",transform:nl}),iz=_o({prop:"maxHeight",transform:nl}),oz=_o({prop:"minHeight",transform:nl});_o({prop:"size",cssProperty:"width",transform:nl});_o({prop:"size",cssProperty:"height",transform:nl});const sz=_o({prop:"boxSizing"});Rx(tz,g2,rz,nz,iz,oz,sz);const Fx={border:{themeKey:"borders",transform:ql},borderTop:{themeKey:"borders",transform:ql},borderRight:{themeKey:"borders",transform:ql},borderBottom:{themeKey:"borders",transform:ql},borderLeft:{themeKey:"borders",transform:ql},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:ql},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Dx},color:{themeKey:"palette",transform:wg},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:wg},backgroundColor:{themeKey:"palette",transform:wg},p:{style:co},pt:{style:co},pr:{style:co},pb:{style:co},pl:{style:co},px:{style:co},py:{style:co},padding:{style:co},paddingTop:{style:co},paddingRight:{style:co},paddingBottom:{style:co},paddingLeft:{style:co},paddingX:{style:co},paddingY:{style:co},paddingInline:{style:co},paddingInlineStart:{style:co},paddingInlineEnd:{style:co},paddingBlock:{style:co},paddingBlockStart:{style:co},paddingBlockEnd:{style:co},m:{style:lo},mt:{style:lo},mr:{style:lo},mb:{style:lo},ml:{style:lo},mx:{style:lo},my:{style:lo},margin:{style:lo},marginTop:{style:lo},marginRight:{style:lo},marginBottom:{style:lo},marginLeft:{style:lo},marginX:{style:lo},marginY:{style:lo},marginInline:{style:lo},marginInlineStart:{style:lo},marginInlineEnd:{style:lo},marginBlock:{style:lo},marginBlockStart:{style:lo},marginBlockEnd:{style:lo},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:zx},rowGap:{style:Lx},columnGap:{style:Ox},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:nl},maxWidth:{style:g2},minWidth:{transform:nl},height:{transform:nl},maxHeight:{transform:nl},minHeight:{transform:nl},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function az(...e){const t=e.reduce((a,c)=>a.concat(Object.keys(c)),[]),i=new Set(t);return e.every(a=>i.size===Object.keys(a).length)}function lz(e,t){return typeof e=="function"?e(t):e}function cz(){function e(i,a,c,h){const f={[i]:a,theme:c},o=h[i];if(!o)return{[i]:a};const{cssProperty:b=i,themeKey:P,transform:I,style:D}=o;if(a==null)return null;if(P==="typography"&&a==="inherit")return{[i]:a};const z=Rg(c,P)||{};return D?D(f):eu(f,a,U=>{let $=H_(z,I,U);return U===$&&typeof U=="string"&&($=H_(z,I,`${i}${U==="default"?"":xr(U)}`,U)),b===!1?$:{[b]:$}})}function t(i){var a;const{sx:c,theme:h={}}=i||{};if(!c)return null;const f=(a=h.unstable_sxConfig)!=null?a:Fx;function o(b){let P=b;if(typeof b=="function")P=b(h);else if(typeof b!="object")return b;if(!P)return null;const I=NE(h.breakpoints),D=Object.keys(I);let z=I;return Object.keys(P).forEach(F=>{const U=lz(P[F],h);if(U!=null)if(typeof U=="object")if(f[F])z=Jy(z,e(F,U,h,f));else{const $=eu({theme:h},U,j=>({[F]:j}));az($,U)?z[F]=t({sx:U,theme:h}):z=Jy(z,$)}else z=Jy(z,e(F,U,h,f))}),VE(D,z)}return Array.isArray(c)?c.map(o):o(c)}return t}const Nv=cz();Nv.filterProps=["sx"];function qE(e,t){const i=this;return i.vars&&typeof i.getColorSchemeSelector=="function"?{[i.getColorSchemeSelector(e).replace(/(\[[^\]]+\])/,"*:where($1)")]:t}:i.palette.mode===e?t:{}}const uz=["breakpoints","palette","spacing","shape"];function y2(e={},...t){const{breakpoints:i={},palette:a={},spacing:c,shape:h={}}=e,f=Pr(e,uz),o=jE(i),b=GE(c);let P=ul({breakpoints:o,direction:"ltr",components:{},palette:we({mode:"light"},a),spacing:b,shape:we({},w3,h)},f);return P.applyStyles=qE,P=t.reduce((I,D)=>ul(I,D),P),P.unstable_sxConfig=we({},Fx,f?.unstable_sxConfig),P.unstable_sx=function(D){return Nv({sx:D,theme:this})},P}function hz(e){return Object.keys(e).length===0}function HE(e=null){const t=K.useContext(em);return!t||hz(t)?e:t}const dz=y2();function v2(e=dz){return HE(e)}function fz({styles:e,themeId:t,defaultTheme:i={}}){const a=v2(i),c=typeof e=="function"?e(t&&a[t]||a):e;return G.jsx(E_,{styles:c})}const pz=["sx"],mz=e=>{var t,i;const a={systemProps:{},otherProps:{}},c=(t=e==null||(i=e.theme)==null?void 0:i.unstable_sxConfig)!=null?t:Fx;return Object.keys(e).forEach(h=>{c[h]?a.systemProps[h]=e[h]:a.otherProps[h]=e[h]}),a};function Bx(e){const{sx:t}=e,i=Pr(e,pz),{systemProps:a,otherProps:c}=mz(i);let h;return Array.isArray(t)?h=[a,...t]:typeof t=="function"?h=(...f)=>{const o=t(...f);return mf(o)?we({},a,o):a}:h=we({},a,t),we({},c,{sx:h})}const vT=e=>e,gz=()=>{let e=vT;return{configure(t){e=t},generate(t){return e(t)},reset(){e=vT}}},WE=gz();function ZE(e){var t,i,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var c=e.length;for(t=0;t<c;t++)e[t]&&(i=ZE(e[t]))&&(a&&(a+=" "),a+=i)}else for(i in e)e[i]&&(a&&(a+=" "),a+=i);return a}function hi(){for(var e,t,i=0,a="",c=arguments.length;i<c;i++)(e=arguments[i])&&(t=ZE(e))&&(a&&(a+=" "),a+=t);return a}const yz=["className","component"];function vz(e={}){const{themeId:t,defaultTheme:i,defaultClassName:a="MuiBox-root",generateClassName:c}=e,h=BE("div",{shouldForwardProp:o=>o!=="theme"&&o!=="sx"&&o!=="as"})(Nv);return K.forwardRef(function(b,P){const I=v2(i),D=Bx(b),{className:z,component:F="div"}=D,U=Pr(D,yz);return G.jsx(h,we({as:F,ref:P,className:hi(z,c?c(a):a),theme:t&&I[t]||I},U))})}const XE={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function _2(e,t,i="Mui"){const a=XE[t];return a?`${i}-${a}`:`${WE.generate(e)}-${t}`}function KE(e,t,i="Mui"){const a={};return t.forEach(c=>{a[c]=_2(e,c,i)}),a}const _z=["ownerState"],xz=["variants"],bz=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function wz(e){return Object.keys(e).length===0}function Sz(e){return typeof e=="string"&&e.charCodeAt(0)>96}function vb(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const Cz=y2(),Tz=e=>e&&e.charAt(0).toLowerCase()+e.slice(1);function o_({defaultTheme:e,theme:t,themeId:i}){return wz(t)?e:t[i]||t}function Mz(e){return e?(t,i)=>i[e]:null}function I_(e,t){let{ownerState:i}=t,a=Pr(t,_z);const c=typeof e=="function"?e(we({ownerState:i},a)):e;if(Array.isArray(c))return c.flatMap(h=>I_(h,we({ownerState:i},a)));if(c&&typeof c=="object"&&Array.isArray(c.variants)){const{variants:h=[]}=c;let o=Pr(c,xz);return h.forEach(b=>{let P=!0;typeof b.props=="function"?P=b.props(we({ownerState:i},a,i)):Object.keys(b.props).forEach(I=>{i?.[I]!==b.props[I]&&a[I]!==b.props[I]&&(P=!1)}),P&&(Array.isArray(o)||(o=[o]),o.push(typeof b.style=="function"?b.style(we({ownerState:i},a,i)):b.style))}),o}return c}function YE(e={}){const{themeId:t,defaultTheme:i=Cz,rootShouldForwardProp:a=vb,slotShouldForwardProp:c=vb}=e,h=f=>Nv(we({},f,{theme:o_(we({},f,{defaultTheme:i,themeId:t}))}));return h.__mui_systemSx=!0,(f,o={})=>{_3(f,oe=>oe.filter(be=>!(be!=null&&be.__mui_systemSx)));const{name:b,slot:P,skipVariantsResolver:I,skipSx:D,overridesResolver:z=Mz(Tz(P))}=o,F=Pr(o,bz),U=I!==void 0?I:P&&P!=="Root"&&P!=="root"||!1,$=D||!1;let j,ie=vb;P==="Root"||P==="root"?ie=a:P?ie=c:Sz(f)&&(ie=void 0);const se=BE(f,we({shouldForwardProp:ie,label:j},F)),Q=oe=>typeof oe=="function"&&oe.__emotion_real!==oe||mf(oe)?be=>I_(oe,we({},be,{theme:o_({theme:be.theme,defaultTheme:i,themeId:t})})):oe,de=(oe,...be)=>{let xe=Q(oe);const Me=be?be.map(Q):[];b&&z&&Me.push(ke=>{const Ge=o_(we({},ke,{defaultTheme:i,themeId:t}));if(!Ge.components||!Ge.components[b]||!Ge.components[b].styleOverrides)return null;const Ke=Ge.components[b].styleOverrides,gt={};return Object.entries(Ke).forEach(([et,qe])=>{gt[et]=I_(qe,we({},ke,{theme:Ge}))}),z(ke,gt)}),b&&!U&&Me.push(ke=>{var Ge;const Ke=o_(we({},ke,{defaultTheme:i,themeId:t})),gt=Ke==null||(Ge=Ke.components)==null||(Ge=Ge[b])==null?void 0:Ge.variants;return I_({variants:gt},we({},ke,{theme:Ke}))}),$||Me.push(h);const Ee=Me.length-be.length;if(Array.isArray(oe)&&Ee>0){const ke=new Array(Ee).fill("");xe=[...oe,...ke],xe.raw=[...oe.raw,...ke]}const re=se(xe,...Me);return f.muiName&&(re.muiName=f.muiName),re};return se.withConfig&&(de.withConfig=se.withConfig),de}}const Pz=YE();function JE(e,t){const i=we({},t);return Object.keys(e).forEach(a=>{if(a.toString().match(/^(components|slots)$/))i[a]=we({},e[a],i[a]);else if(a.toString().match(/^(componentsProps|slotProps)$/)){const c=e[a]||{},h=t[a];i[a]={},!h||!Object.keys(h)?i[a]=c:!c||!Object.keys(c)?i[a]=h:(i[a]=we({},h),Object.keys(c).forEach(f=>{i[a][f]=JE(c[f],h[f])}))}else i[a]===void 0&&(i[a]=e[a])}),i}function Ez(e){const{theme:t,name:i,props:a}=e;return!t||!t.components||!t.components[i]||!t.components[i].defaultProps?a:JE(t.components[i].defaultProps,a)}function QE({props:e,name:t,defaultTheme:i,themeId:a}){let c=v2(i);return a&&(c=c[a]||c),Ez({theme:c,name:t,props:e})}const bv=typeof window<"u"?K.useLayoutEffect:K.useEffect;function Iz(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let i=e.match(t);return i&&i[0].length===1&&(i=i.map(a=>a+a)),i?`rgb${i.length===4?"a":""}(${i.map((a,c)=>c<3?parseInt(a,16):Math.round(parseInt(a,16)/255*1e3)/1e3).join(", ")})`:""}function eI(e){if(e.type)return e;if(e.charAt(0)==="#")return eI(Iz(e));const t=e.indexOf("("),i=e.substring(0,t);if(["rgb","rgba","hsl","hsla","color"].indexOf(i)===-1)throw new Error(gv(9,e));let a=e.substring(t+1,e.length-1),c;if(i==="color"){if(a=a.split(" "),c=a.shift(),a.length===4&&a[3].charAt(0)==="/"&&(a[3]=a[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(c)===-1)throw new Error(gv(10,c))}else a=a.split(",");return a=a.map(h=>parseFloat(h)),{type:i,values:a,colorSpace:c}}const Ip=e=>{const t=eI(e);return t.values.slice(0,3).map((i,a)=>t.type.indexOf("hsl")!==-1&&a!==0?`${i}%`:i).join(" ")};function Vv(e,t){var i,a;return K.isValidElement(e)&&t.indexOf((i=e.type.muiName)!=null?i:(a=e.type)==null||(a=a._payload)==null||(a=a.value)==null?void 0:a.muiName)!==-1}function Qy(e){return e&&e.ownerDocument||document}function W_(e,t){typeof e=="function"?e(t):e&&(e.current=t)}let _T=0;function kz(e){const[t,i]=K.useState(e),a=e||t;return K.useEffect(()=>{t==null&&(_T+=1,i(`mui-${_T}`))},[t]),a}const xT=yv.useId;function x2(e){if(xT!==void 0){const t=xT();return e??t}return kz(e)}function _b({controlled:e,default:t,name:i,state:a="value"}){const{current:c}=K.useRef(e!==void 0),[h,f]=K.useState(t),o=c?e:h,b=K.useCallback(P=>{c||f(P)},[]);return[o,b]}function Bp(e){const t=K.useRef(e);return bv(()=>{t.current=e}),K.useRef((...i)=>(0,t.current)(...i)).current}function Ea(...e){return K.useMemo(()=>e.every(t=>t==null)?null:t=>{e.forEach(i=>{W_(i,t)})},e)}const bT={};function Az(e,t){const i=K.useRef(bT);return i.current===bT&&(i.current=e(t)),i}const Rz=[];function Dz(e){K.useEffect(e,Rz)}let tI=class rI{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new rI}start(t,i){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,i()},t)}};function zz(){const e=Az(tI.create).current;return Dz(e.disposeEffect),e}let $x=!0,bw=!1;const Oz=new tI,Lz={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function Fz(e){const{type:t,tagName:i}=e;return!!(i==="INPUT"&&Lz[t]&&!e.readOnly||i==="TEXTAREA"&&!e.readOnly||e.isContentEditable)}function Bz(e){e.metaKey||e.altKey||e.ctrlKey||($x=!0)}function xb(){$x=!1}function $z(){this.visibilityState==="hidden"&&bw&&($x=!0)}function jz(e){e.addEventListener("keydown",Bz,!0),e.addEventListener("mousedown",xb,!0),e.addEventListener("pointerdown",xb,!0),e.addEventListener("touchstart",xb,!0),e.addEventListener("visibilitychange",$z,!0)}function Nz(e){const{target:t}=e;try{return t.matches(":focus-visible")}catch{}return $x||Fz(t)}function nI(){const e=K.useCallback(c=>{c!=null&&jz(c.ownerDocument)},[]),t=K.useRef(!1);function i(){return t.current?(bw=!0,Oz.start(100,()=>{bw=!1}),t.current=!1,!0):!1}function a(c){return Nz(c)?(t.current=!0,!0):!1}return{isFocusVisibleRef:t,onFocus:a,onBlur:i,ref:e}}const Vz=e=>{const t=K.useRef({});return K.useEffect(()=>{t.current=e}),t.current};function di(e,t,i=void 0){const a={};return Object.keys(e).forEach(c=>{a[c]=e[c].reduce((h,f)=>{if(f){const o=t(f);o!==""&&h.push(o),i&&i[f]&&h.push(i[f])}return h},[]).join(" ")}),a}function Uz(e){return typeof e=="string"}function iI(e,t,i){return e===void 0||Uz(e)?t:we({},t,{ownerState:we({},t.ownerState,i)})}function bf(e,t=[]){if(e===void 0)return{};const i={};return Object.keys(e).filter(a=>a.match(/^on[A-Z]/)&&typeof e[a]=="function"&&!t.includes(a)).forEach(a=>{i[a]=e[a]}),i}function wT(e){if(e===void 0)return{};const t={};return Object.keys(e).filter(i=>!(i.match(/^on[A-Z]/)&&typeof e[i]=="function")).forEach(i=>{t[i]=e[i]}),t}function oI(e){const{getSlotProps:t,additionalProps:i,externalSlotProps:a,externalForwardedProps:c,className:h}=e;if(!t){const F=hi(i?.className,h,c?.className,a?.className),U=we({},i?.style,c?.style,a?.style),$=we({},i,c,a);return F.length>0&&($.className=F),Object.keys(U).length>0&&($.style=U),{props:$,internalRef:void 0}}const f=bf(we({},c,a)),o=wT(a),b=wT(c),P=t(f),I=hi(P?.className,i?.className,h,c?.className,a?.className),D=we({},P?.style,i?.style,c?.style,a?.style),z=we({},P,i,b,o);return I.length>0&&(z.className=I),Object.keys(D).length>0&&(z.style=D),{props:z,internalRef:P.ref}}function sI(e,t,i){return typeof e=="function"?e(t,i):e}const Gz=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function qz(e){var t;const{elementType:i,externalSlotProps:a,ownerState:c,skipResolvingSlotProps:h=!1}=e,f=Pr(e,Gz),o=h?{}:sI(a,c),{props:b,internalRef:P}=oI(we({},f,{externalSlotProps:o})),I=Ea(P,o?.ref,(t=e.additionalProps)==null?void 0:t.ref);return iI(i,we({},b,{ref:I}),c)}function aI(e){if(parseInt(K.version,10)>=19){var t;return(e==null||(t=e.props)==null?void 0:t.ref)||null}return e?.ref||null}const lI=K.createContext(null);function b2(){return K.useContext(lI)}const Hz=typeof Symbol=="function"&&Symbol.for,Wz=Hz?Symbol.for("mui.nested"):"__THEME_NESTED__";function Zz(e,t){return typeof t=="function"?t(e):we({},e,t)}function Xz(e){const{children:t,theme:i}=e,a=b2(),c=K.useMemo(()=>{const h=a===null?i:Zz(a,i);return h!=null&&(h[Wz]=a!==null),h},[i,a]);return G.jsx(lI.Provider,{value:c,children:t})}const Kz=["value"],Yz=K.createContext();function Jz(e){let{value:t}=e,i=Pr(e,Kz);return G.jsx(Yz.Provider,we({value:t??!0},i))}const Qz=K.createContext(void 0);function eO({value:e,children:t}){return G.jsx(Qz.Provider,{value:e,children:t})}const ST={};function CT(e,t,i,a=!1){return K.useMemo(()=>{const c=e&&t[e]||t;if(typeof i=="function"){const h=i(c),f=e?we({},t,{[e]:h}):h;return a?()=>f:f}return e?we({},t,{[e]:i}):we({},t,i)},[e,t,i,a])}function tO(e){const{children:t,theme:i,themeId:a}=e,c=HE(ST),h=b2()||ST,f=CT(a,c,i),o=CT(a,h,i,!0),b=f.direction==="rtl";return G.jsx(Xz,{theme:o,children:G.jsx(em.Provider,{value:f,children:G.jsx(Jz,{value:b,children:G.jsx(eO,{value:f?.components,children:t})})})})}const w2="mode",S2="color-scheme",cI="data-color-scheme";function rO(e){const{defaultMode:t="light",defaultLightColorScheme:i="light",defaultDarkColorScheme:a="dark",modeStorageKey:c=w2,colorSchemeStorageKey:h=S2,attribute:f=cI,colorSchemeNode:o="document.documentElement",nonce:b}=e||{};return G.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?b:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  var mode = localStorage.getItem('${c}') || '${t}';
  var colorScheme = '';
  if (mode === 'system') {
    // handle system mode
    var mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = localStorage.getItem('${h}-dark') || '${a}';
    } else {
      colorScheme = localStorage.getItem('${h}-light') || '${i}';
    }
  }
  if (mode === 'light') {
    colorScheme = localStorage.getItem('${h}-light') || '${i}';
  }
  if (mode === 'dark') {
    colorScheme = localStorage.getItem('${h}-dark') || '${a}';
  }
  if (colorScheme) {
    ${o}.setAttribute('${f}', colorScheme);
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function TT(e){if(typeof window<"u"&&e==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function uI(e,t){if(e.mode==="light"||e.mode==="system"&&e.systemMode==="light")return t("light");if(e.mode==="dark"||e.mode==="system"&&e.systemMode==="dark")return t("dark")}function nO(e){return uI(e,t=>{if(t==="light")return e.lightColorScheme;if(t==="dark")return e.darkColorScheme})}function bb(e,t){if(typeof window>"u")return;let i;try{i=localStorage.getItem(e)||void 0,i||localStorage.setItem(e,t)}catch{}return i||t}function iO(e){const{defaultMode:t="light",defaultLightColorScheme:i,defaultDarkColorScheme:a,supportedColorSchemes:c=[],modeStorageKey:h=w2,colorSchemeStorageKey:f=S2,storageWindow:o=typeof window>"u"?void 0:window}=e,b=c.join(","),[P,I]=K.useState(()=>{const j=bb(h,t),ie=bb(`${f}-light`,i),se=bb(`${f}-dark`,a);return{mode:j,systemMode:TT(j),lightColorScheme:ie,darkColorScheme:se}}),D=nO(P),z=K.useCallback(j=>{I(ie=>{if(j===ie.mode)return ie;const se=j??t;try{localStorage.setItem(h,se)}catch{}return we({},ie,{mode:se,systemMode:TT(se)})})},[h,t]),F=K.useCallback(j=>{j?typeof j=="string"?j&&!b.includes(j)?console.error(`\`${j}\` does not exist in \`theme.colorSchemes\`.`):I(ie=>{const se=we({},ie);return uI(ie,Q=>{try{localStorage.setItem(`${f}-${Q}`,j)}catch{}Q==="light"&&(se.lightColorScheme=j),Q==="dark"&&(se.darkColorScheme=j)}),se}):I(ie=>{const se=we({},ie),Q=j.light===null?i:j.light,de=j.dark===null?a:j.dark;if(Q)if(!b.includes(Q))console.error(`\`${Q}\` does not exist in \`theme.colorSchemes\`.`);else{se.lightColorScheme=Q;try{localStorage.setItem(`${f}-light`,Q)}catch{}}if(de)if(!b.includes(de))console.error(`\`${de}\` does not exist in \`theme.colorSchemes\`.`);else{se.darkColorScheme=de;try{localStorage.setItem(`${f}-dark`,de)}catch{}}return se}):I(ie=>{try{localStorage.setItem(`${f}-light`,i),localStorage.setItem(`${f}-dark`,a)}catch{}return we({},ie,{lightColorScheme:i,darkColorScheme:a})})},[b,f,i,a]),U=K.useCallback(j=>{P.mode==="system"&&I(ie=>{const se=j!=null&&j.matches?"dark":"light";return ie.systemMode===se?ie:we({},ie,{systemMode:se})})},[P.mode]),$=K.useRef(U);return $.current=U,K.useEffect(()=>{const j=(...se)=>$.current(...se),ie=window.matchMedia("(prefers-color-scheme: dark)");return ie.addListener(j),j(ie),()=>{ie.removeListener(j)}},[]),K.useEffect(()=>{if(o){const j=ie=>{const se=ie.newValue;typeof ie.key=="string"&&ie.key.startsWith(f)&&(!se||b.match(se))&&(ie.key.endsWith("light")&&F({light:se}),ie.key.endsWith("dark")&&F({dark:se})),ie.key===h&&(!se||["light","dark","system"].includes(se))&&z(se||t)};return o.addEventListener("storage",j),()=>{o.removeEventListener("storage",j)}}},[F,z,h,f,b,t,o]),we({},P,{colorScheme:D,setMode:z,setColorScheme:F})}const oO=["colorSchemes","components","generateCssVars","cssVarPrefix"],sO="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function aO(e){const{themeId:t,theme:i={},attribute:a=cI,modeStorageKey:c=w2,colorSchemeStorageKey:h=S2,defaultMode:f="light",defaultColorScheme:o,disableTransitionOnChange:b=!1,resolveTheme:P,excludeVariablesFromRoot:I}=e;(!i.colorSchemes||typeof o=="string"&&!i.colorSchemes[o]||typeof o=="object"&&!i.colorSchemes[o?.light]||typeof o=="object"&&!i.colorSchemes[o?.dark])&&console.error(`MUI: \`${o}\` does not exist in \`theme.colorSchemes\`.`);const D=K.createContext(void 0),z=()=>{const ie=K.useContext(D);if(!ie)throw new Error(gv(19));return ie};function F(ie){const{children:se,theme:Q=i,modeStorageKey:de=c,colorSchemeStorageKey:oe=h,attribute:be=a,defaultMode:xe=f,defaultColorScheme:Me=o,disableTransitionOnChange:Ee=b,storageWindow:re=typeof window>"u"?void 0:window,documentNode:ke=typeof document>"u"?void 0:document,colorSchemeNode:Ge=typeof document>"u"?void 0:document.documentElement,colorSchemeSelector:Ke=":root",disableNestedContext:gt=!1,disableStyleSheetGeneration:et=!1}=ie,qe=K.useRef(!1),Qe=b2(),Ve=K.useContext(D),je=!!Ve&&!gt,ct=Q[t],ye=ct||Q,{colorSchemes:ze={},components:ft={},generateCssVars:wt=()=>({vars:{},css:{}}),cssVarPrefix:xt}=ye,_t=Pr(ye,oO),St=Object.keys(ze),tt=typeof Me=="string"?Me:Me.light,At=typeof Me=="string"?Me:Me.dark,{mode:It,setMode:mr,systemMode:ur,lightColorScheme:Hr,darkColorScheme:wr,colorScheme:sr,setColorScheme:Wt}=iO({supportedColorSchemes:St,defaultLightColorScheme:tt,defaultDarkColorScheme:At,modeStorageKey:de,colorSchemeStorageKey:oe,defaultMode:xe,storageWindow:re});let yr=It,Yt=sr;je&&(yr=Ve.mode,Yt=Ve.colorScheme);const Cr=yr||(xe==="system"?f:xe),Rr=Yt||(Cr==="dark"?At:tt),{css:Or,vars:Gr}=wt(),rn=we({},_t,{components:ft,colorSchemes:ze,cssVarPrefix:xt,vars:Gr,getColorSchemeSelector:ue=>`[${be}="${ue}"] &`}),Un={},wn={};Object.entries(ze).forEach(([ue,Pe])=>{const{css:Re,vars:Ye}=wt(ue);rn.vars=ul(rn.vars,Ye),ue===Rr&&(Object.keys(Pe).forEach($e=>{Pe[$e]&&typeof Pe[$e]=="object"?rn[$e]=we({},rn[$e],Pe[$e]):rn[$e]=Pe[$e]}),rn.palette&&(rn.palette.colorScheme=ue));const Xe=typeof Me=="string"?Me:xe==="dark"?Me.dark:Me.light;if(ue===Xe){if(I){const $e={};I(xt).forEach(Je=>{$e[Je]=Re[Je],delete Re[Je]}),Un[`[${be}="${ue}"]`]=$e}Un[`${Ke}, [${be}="${ue}"]`]=Re}else wn[`${Ke===":root"?"":Ke}[${be}="${ue}"]`]=Re}),rn.vars=ul(rn.vars,Gr),K.useEffect(()=>{Yt&&Ge&&Ge.setAttribute(be,Yt)},[Yt,be,Ge]),K.useEffect(()=>{let ue;if(Ee&&qe.current&&ke){const Pe=ke.createElement("style");Pe.appendChild(ke.createTextNode(sO)),ke.head.appendChild(Pe),window.getComputedStyle(ke.body),ue=setTimeout(()=>{ke.head.removeChild(Pe)},1)}return()=>{clearTimeout(ue)}},[Yt,Ee,ke]),K.useEffect(()=>(qe.current=!0,()=>{qe.current=!1}),[]);const He=K.useMemo(()=>({allColorSchemes:St,colorScheme:Yt,darkColorScheme:wr,lightColorScheme:Hr,mode:yr,setColorScheme:Wt,setMode:mr,systemMode:ur}),[St,Yt,wr,Hr,yr,Wt,mr,ur]);let ae=!0;(et||je&&Qe?.cssVarPrefix===xt)&&(ae=!1);const le=G.jsxs(K.Fragment,{children:[ae&&G.jsxs(K.Fragment,{children:[G.jsx(E_,{styles:{[Ke]:Or}}),G.jsx(E_,{styles:Un}),G.jsx(E_,{styles:wn})]}),G.jsx(tO,{themeId:ct?t:void 0,theme:P?P(rn):rn,children:se})]});return je?le:G.jsx(D.Provider,{value:He,children:le})}const U=typeof o=="string"?o:o.light,$=typeof o=="string"?o:o.dark;return{CssVarsProvider:F,useColorScheme:z,getInitColorSchemeScript:ie=>rO(we({attribute:a,colorSchemeStorageKey:h,defaultMode:f,defaultLightColorScheme:U,defaultDarkColorScheme:$,modeStorageKey:c},ie))}}function C2(e=""){function t(...a){if(!a.length)return"";const c=a[0];return typeof c=="string"&&!c.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${e?`${e}-`:""}${c}${t(...a.slice(1))})`:`, ${c}`}return(a,...c)=>`var(--${e?`${e}-`:""}${a}${t(...c)})`}const MT=(e,t,i,a=[])=>{let c=e;t.forEach((h,f)=>{f===t.length-1?Array.isArray(c)?c[Number(h)]=i:c&&typeof c=="object"&&(c[h]=i):c&&typeof c=="object"&&(c[h]||(c[h]=a.includes(h)?[]:{}),c=c[h])})},lO=(e,t,i)=>{function a(c,h=[],f=[]){Object.entries(c).forEach(([o,b])=>{(!i||i&&!i([...h,o]))&&b!=null&&(typeof b=="object"&&Object.keys(b).length>0?a(b,[...h,o],Array.isArray(b)?[...f,o]:f):t([...h,o],b,f))})}a(e)},cO=(e,t)=>typeof t=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(a=>e.includes(a))||e[e.length-1].toLowerCase().indexOf("opacity")>=0?t:`${t}px`:t;function wb(e,t){const{prefix:i,shouldSkipGeneratingVar:a}=t||{},c={},h={},f={};return lO(e,(o,b,P)=>{if((typeof b=="string"||typeof b=="number")&&(!a||!a(o,b))){const I=`--${i?`${i}-`:""}${o.join("-")}`;Object.assign(c,{[I]:cO(o,b)}),MT(h,o,`var(${I})`,P),MT(f,o,`var(${I}, ${b})`,P)}},o=>o[0]==="vars"),{css:c,vars:h,varsWithDefaults:f}}function wv(e){"@babel/helpers - typeof";return wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wv(e)}function uO(e,t){if(wv(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t);if(wv(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function hO(e){var t=uO(e,"string");return wv(t)=="symbol"?t:t+""}const dO=["colorSchemes","components","defaultColorScheme"];function fO(e,t){const{colorSchemes:i={},defaultColorScheme:a="light"}=e,c=Pr(e,dO),{vars:h,css:f,varsWithDefaults:o}=wb(c,t);let b=o;const P={},{[a]:I}=i,D=Pr(i,[a].map(hO));if(Object.entries(D||{}).forEach(([F,U])=>{const{vars:$,css:j,varsWithDefaults:ie}=wb(U,t);b=ul(b,ie),P[F]={css:j,vars:$}}),I){const{css:F,vars:U,varsWithDefaults:$}=wb(I,t);b=ul(b,$),P[a]={css:F,vars:U}}return{vars:b,generateCssVars:F=>{var U;if(!F){var $;const ie=we({},f);return{css:ie,vars:h,selector:(t==null||($=t.getSelector)==null?void 0:$.call(t,F,ie))||":root"}}const j=we({},P[F].css);return{css:j,vars:P[F].vars,selector:(t==null||(U=t.getSelector)==null?void 0:U.call(t,F,j))||":root"}}}}const pO=(e,t)=>e.filter(i=>t.includes(i)),mO=(e,t,i)=>{const a=e.keys[0];Array.isArray(t)?t.forEach((c,h)=>{i((f,o)=>{h<=e.keys.length-1&&(h===0?Object.assign(f,o):f[e.up(e.keys[h])]=o)},c)}):t&&typeof t=="object"?(Object.keys(t).length>e.keys.length?e.keys:pO(e.keys,Object.keys(t))).forEach(h=>{if(e.keys.indexOf(h)!==-1){const f=t[h];f!==void 0&&i((o,b)=>{a===h?Object.assign(o,b):o[e.up(h)]=b},f)}}):(typeof t=="number"||typeof t=="string")&&i((c,h)=>{Object.assign(c,h)},t)},gO=["component","direction","spacing","divider","children","className","useFlexGap"],yO=y2(),vO=Pz("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>t.root});function _O(e){return QE({props:e,name:"MuiStack",defaultTheme:yO})}function xO(e,t){const i=K.Children.toArray(e).filter(Boolean);return i.reduce((a,c,h)=>(a.push(c),h<i.length-1&&a.push(K.cloneElement(t,{key:`separator-${h}`})),a),[])}const bO=e=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[e],wO=({ownerState:e,theme:t})=>{let i=we({display:"flex",flexDirection:"column"},eu({theme:t},yb({values:e.direction,breakpoints:t.breakpoints.values}),a=>({flexDirection:a})));if(e.spacing){const a=m2(t),c=Object.keys(t.breakpoints.values).reduce((b,P)=>((typeof e.spacing=="object"&&e.spacing[P]!=null||typeof e.direction=="object"&&e.direction[P]!=null)&&(b[P]=!0),b),{}),h=yb({values:e.direction,base:c}),f=yb({values:e.spacing,base:c});typeof h=="object"&&Object.keys(h).forEach((b,P,I)=>{if(!h[b]){const z=P>0?h[I[P-1]]:"column";h[b]=z}}),i=ul(i,eu({theme:t},f,(b,P)=>e.useFlexGap?{gap:Gp(a,b)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${bO(P?h[P]:e.direction)}`]:Gp(a,b)}}))}return i=S3(t.breakpoints,i),i};function SO(e={}){const{createStyledComponent:t=vO,useThemeProps:i=_O,componentName:a="MuiStack"}=e,c=()=>di({root:["root"]},b=>_2(a,b),{}),h=t(wO);return K.forwardRef(function(b,P){const I=i(b),D=Bx(I),{component:z="div",direction:F="column",spacing:U=0,divider:$,children:j,className:ie,useFlexGap:se=!1}=D,Q=Pr(D,gO),de={direction:F,spacing:U,useFlexGap:se},oe=c();return G.jsx(h,we({as:z,ownerState:de,ref:P,className:hi(oe.root,ie)},Q,{children:$?xO(j,$):j}))})}const CO=we({},Fx,{borderRadius:{themeKey:"radius"},boxShadow:{themeKey:"shadow"},fontFamily:{themeKey:"fontFamily"},fontSize:{themeKey:"fontSize"},fontWeight:{themeKey:"fontWeight"},letterSpacing:{themeKey:"letterSpacing"},lineHeight:{themeKey:"lineHeight"}});function TO(e){var t;return!!e[0].match(/^(typography|variants|breakpoints)$/)||!!e[0].match(/sxConfig$/)||e[0]==="palette"&&!!((t=e[1])!=null&&t.match(/^(mode)$/))||e[0]==="focus"&&e[1]!=="thickness"}const wi=(e,t)=>_2(e,t,"Mui"),Si=(e,t)=>KE(e,t,"Mui"),MO=e=>e&&typeof e=="object"&&Object.keys(e).some(t=>{var i;return(i=t.match)==null?void 0:i.call(t,/^(plain(Hover|Active|Disabled)?(Color|Bg)|outlined(Hover|Active|Disabled)?(Color|Border|Bg)|soft(Hover|Active|Disabled)?(Color|Bg)|solid(Hover|Active|Disabled)?(Color|Bg))$/)}),PT=(e,t,i)=>{t.includes("Color")&&(e.color=i),t.includes("Bg")&&(e.backgroundColor=i),t.includes("Border")&&(e.borderColor=i)},ET=(e,t,i)=>{const a={};return Object.entries(t||{}).forEach(([c,h])=>{if(c.match(new RegExp(`${e}(color|bg|border)`,"i"))&&h){const f=i?i(c):h;c.includes("Disabled")&&(a.pointerEvents="none",a.cursor="default",a["--Icon-color"]="currentColor"),c.match(/(Hover|Active|Disabled)/)||(a["--variant-borderWidth"]||(a["--variant-borderWidth"]="0px"),c.includes("Border")&&(a["--variant-borderWidth"]="1px",a.border="var(--variant-borderWidth) solid")),PT(a,c,f)}}),a},Is=(e,t)=>{let i={};if(t){const{getCssVar:a,palette:c}=t;Object.entries(c).forEach(h=>{const[f,o]=h;MO(o)&&typeof o=="object"&&(i=we({},i,{[f]:ET(e,o,b=>`var(--variant-${b}, ${a(`palette-${f}-${b}`,c[f][b])})`)}))})}return i.context=ET(e,{plainColor:"var(--variant-plainColor)",plainHoverColor:"var(--variant-plainHoverColor)",plainHoverBg:"var(--variant-plainHoverBg)",plainActiveBg:"var(--variant-plainActiveBg)",plainDisabledColor:"var(--variant-plainDisabledColor)",outlinedColor:"var(--variant-outlinedColor)",outlinedBorder:"var(--variant-outlinedBorder)",outlinedHoverColor:"var(--variant-outlinedHoverColor)",outlinedHoverBorder:"var(--variant-outlinedHoverBorder)",outlinedHoverBg:"var(--variant-outlinedHoverBg)",outlinedActiveBg:"var(--variant-outlinedActiveBg)",outlinedDisabledColor:"var(--variant-outlinedDisabledColor)",outlinedDisabledBorder:"var(--variant-outlinedDisabledBorder)",softColor:"var(--variant-softColor)",softBg:"var(--variant-softBg)",softHoverColor:"var(--variant-softHoverColor)",softHoverBg:"var(--variant-softHoverBg)",softActiveBg:"var(--variant-softActiveBg)",softDisabledColor:"var(--variant-softDisabledColor)",softDisabledBg:"var(--variant-softDisabledBg)",solidColor:"var(--variant-solidColor)",solidBg:"var(--variant-solidBg)",solidHoverBg:"var(--variant-solidHoverBg)",solidActiveBg:"var(--variant-solidActiveBg)",solidDisabledColor:"var(--variant-solidDisabledColor)",solidDisabledBg:"var(--variant-solidDisabledBg)"}),i},PO=["cssVarPrefix","breakpoints","spacing","components","variants","shouldSkipGeneratingVar"],EO=["colorSchemes"],IO=(e="joy")=>C2(e);function kO(e){var t,i,a,c,h,f,o,b,P,I;const D={},{cssVarPrefix:z="joy",breakpoints:F,spacing:U,components:$,variants:j,shouldSkipGeneratingVar:ie=TO}=D,se=Pr(D,PO),Q=IO(z),de={primary:Oy.blue,neutral:Oy.grey,danger:Oy.red,success:Oy.green,warning:Oy.yellow,common:{white:"#FFF",black:"#000"}},oe=tt=>{var At;const It=tt.split("-"),mr=It[1],ur=It[2];return Q(tt,(At=de[mr])==null?void 0:At[ur])},be=tt=>({plainColor:oe(`palette-${tt}-500`),plainHoverBg:oe(`palette-${tt}-100`),plainActiveBg:oe(`palette-${tt}-200`),plainDisabledColor:oe("palette-neutral-400"),outlinedColor:oe(`palette-${tt}-500`),outlinedBorder:oe(`palette-${tt}-300`),outlinedHoverBg:oe(`palette-${tt}-100`),outlinedActiveBg:oe(`palette-${tt}-200`),outlinedDisabledColor:oe("palette-neutral-400"),outlinedDisabledBorder:oe("palette-neutral-200"),softColor:oe(`palette-${tt}-700`),softBg:oe(`palette-${tt}-100`),softHoverBg:oe(`palette-${tt}-200`),softActiveColor:oe(`palette-${tt}-800`),softActiveBg:oe(`palette-${tt}-300`),softDisabledColor:oe("palette-neutral-400"),softDisabledBg:oe("palette-neutral-50"),solidColor:oe("palette-common-white"),solidBg:oe(`palette-${tt}-500`),solidHoverBg:oe(`palette-${tt}-600`),solidActiveBg:oe(`palette-${tt}-700`),solidDisabledColor:oe("palette-neutral-400"),solidDisabledBg:oe("palette-neutral-100")}),xe=tt=>({plainColor:oe(`palette-${tt}-300`),plainHoverBg:oe(`palette-${tt}-800`),plainActiveBg:oe(`palette-${tt}-700`),plainDisabledColor:oe("palette-neutral-500"),outlinedColor:oe(`palette-${tt}-200`),outlinedBorder:oe(`palette-${tt}-700`),outlinedHoverBg:oe(`palette-${tt}-800`),outlinedActiveBg:oe(`palette-${tt}-700`),outlinedDisabledColor:oe("palette-neutral-500"),outlinedDisabledBorder:oe("palette-neutral-800"),softColor:oe(`palette-${tt}-200`),softBg:oe(`palette-${tt}-800`),softHoverBg:oe(`palette-${tt}-700`),softActiveColor:oe(`palette-${tt}-100`),softActiveBg:oe(`palette-${tt}-600`),softDisabledColor:oe("palette-neutral-500"),softDisabledBg:oe("palette-neutral-800"),solidColor:oe("palette-common-white"),solidBg:oe(`palette-${tt}-500`),solidHoverBg:oe(`palette-${tt}-600`),solidActiveBg:oe(`palette-${tt}-700`),solidDisabledColor:oe("palette-neutral-500"),solidDisabledBg:oe("palette-neutral-800")}),Me={palette:{mode:"light",primary:we({},de.primary,be("primary")),neutral:we({},de.neutral,be("neutral"),{plainColor:oe("palette-neutral-700"),plainHoverColor:oe("palette-neutral-900"),outlinedColor:oe("palette-neutral-700")}),danger:we({},de.danger,be("danger")),success:we({},de.success,be("success")),warning:we({},de.warning,be("warning")),common:{white:"#FFF",black:"#000"},text:{primary:oe("palette-neutral-800"),secondary:oe("palette-neutral-700"),tertiary:oe("palette-neutral-600"),icon:oe("palette-neutral-500")},background:{body:oe("palette-common-white"),surface:oe("palette-neutral-50"),popup:oe("palette-common-white"),level1:oe("palette-neutral-100"),level2:oe("palette-neutral-200"),level3:oe("palette-neutral-300"),tooltip:oe("palette-neutral-500"),backdrop:`rgba(${Q("palette-neutral-darkChannel",Ip(de.neutral[900]))} / 0.25)`},divider:`rgba(${Q("palette-neutral-mainChannel",Ip(de.neutral[500]))} / 0.2)`,focusVisible:oe("palette-primary-500")},shadowRing:"0 0 #000",shadowChannel:"21 21 21",shadowOpacity:"0.08"},Ee={palette:{mode:"dark",primary:we({},de.primary,xe("primary")),neutral:we({},de.neutral,xe("neutral"),{plainColor:oe("palette-neutral-300"),plainHoverColor:oe("palette-neutral-300")}),danger:we({},de.danger,xe("danger")),success:we({},de.success,xe("success")),warning:we({},de.warning,xe("warning")),common:{white:"#FFF",black:"#000"},text:{primary:oe("palette-neutral-100"),secondary:oe("palette-neutral-300"),tertiary:oe("palette-neutral-400"),icon:oe("palette-neutral-400")},background:{body:oe("palette-common-black"),surface:oe("palette-neutral-900"),popup:oe("palette-common-black"),level1:oe("palette-neutral-800"),level2:oe("palette-neutral-700"),level3:oe("palette-neutral-600"),tooltip:oe("palette-neutral-600"),backdrop:`rgba(${Q("palette-neutral-darkChannel",Ip(de.neutral[50]))} / 0.25)`},divider:`rgba(${Q("palette-neutral-mainChannel",Ip(de.neutral[500]))} / 0.16)`,focusVisible:oe("palette-primary-500")},shadowRing:"0 0 #000",shadowChannel:"0 0 0",shadowOpacity:"0.6"},re='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',ke=we({body:`"Inter", ${Q(`fontFamily-fallback, ${re}`)}`,display:`"Inter", ${Q(`fontFamily-fallback, ${re}`)}`,code:"Source Code Pro,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace",fallback:re},se.fontFamily),Ge=we({sm:300,md:500,lg:600,xl:700},se.fontWeight),Ke=we({xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem",xl2:"1.5rem",xl3:"1.875rem",xl4:"2.25rem"},se.fontSize),gt=we({xs:"1.33334",sm:"1.42858",md:"1.5",lg:"1.55556",xl:"1.66667"},se.lineHeight),et=(t=(i=se.colorSchemes)==null||(i=i.light)==null?void 0:i.shadowRing)!=null?t:Me.shadowRing,qe=(a=(c=se.colorSchemes)==null||(c=c.light)==null?void 0:c.shadowChannel)!=null?a:Me.shadowChannel,Qe=(h=(f=se.colorSchemes)==null||(f=f.light)==null?void 0:f.shadowOpacity)!=null?h:Me.shadowOpacity,Ve={colorSchemes:{light:Me,dark:Ee},fontSize:Ke,fontFamily:ke,fontWeight:Ge,focus:{thickness:"2px",selector:`&.${wi("","focusVisible")}, &:focus-visible`,default:{outlineOffset:`var(--focus-outline-offset, ${Q("focus-thickness",(o=(b=se.focus)==null?void 0:b.thickness)!=null?o:"2px")})`,outline:`${Q("focus-thickness",(P=(I=se.focus)==null?void 0:I.thickness)!=null?P:"2px")} solid ${Q("palette-focusVisible",de.primary[500])}`}},lineHeight:gt,radius:{xs:"2px",sm:"6px",md:"8px",lg:"12px",xl:"16px"},shadow:{xs:`${Q("shadowRing",et)}, 0px 1px 2px 0px rgba(${Q("shadowChannel",qe)} / ${Q("shadowOpacity",Qe)})`,sm:`${Q("shadowRing",et)}, 0px 1px 2px 0px rgba(${Q("shadowChannel",qe)} / ${Q("shadowOpacity",Qe)}), 0px 2px 4px 0px rgba(${Q("shadowChannel",qe)} / ${Q("shadowOpacity",Qe)})`,md:`${Q("shadowRing",et)}, 0px 2px 8px -2px rgba(${Q("shadowChannel",qe)} / ${Q("shadowOpacity",Qe)}), 0px 6px 12px -2px rgba(${Q("shadowChannel",qe)} / ${Q("shadowOpacity",Qe)})`,lg:`${Q("shadowRing",et)}, 0px 2px 8px -2px rgba(${Q("shadowChannel",qe)} / ${Q("shadowOpacity",Qe)}), 0px 12px 16px -4px rgba(${Q("shadowChannel",qe)} / ${Q("shadowOpacity",Qe)})`,xl:`${Q("shadowRing",et)}, 0px 2px 8px -2px rgba(${Q("shadowChannel",qe)} / ${Q("shadowOpacity",Qe)}), 0px 20px 24px -4px rgba(${Q("shadowChannel",qe)} / ${Q("shadowOpacity",Qe)})`},zIndex:{badge:1,table:10,popup:1e3,modal:1300,snackbar:1400,tooltip:1500},typography:{h1:{fontFamily:Q(`fontFamily-display, ${ke.display}`),fontWeight:Q(`fontWeight-xl, ${Ge.xl}`),fontSize:Q(`fontSize-xl4, ${Ke.xl4}`),lineHeight:Q(`lineHeight-xs, ${gt.xs}`),letterSpacing:"-0.025em",color:Q(`palette-text-primary, ${Me.palette.text.primary}`)},h2:{fontFamily:Q(`fontFamily-display, ${ke.display}`),fontWeight:Q(`fontWeight-xl, ${Ge.xl}`),fontSize:Q(`fontSize-xl3, ${Ke.xl3}`),lineHeight:Q(`lineHeight-xs, ${gt.xs}`),letterSpacing:"-0.025em",color:Q(`palette-text-primary, ${Me.palette.text.primary}`)},h3:{fontFamily:Q(`fontFamily-display, ${ke.display}`),fontWeight:Q(`fontWeight-lg, ${Ge.lg}`),fontSize:Q(`fontSize-xl2, ${Ke.xl2}`),lineHeight:Q(`lineHeight-xs, ${gt.xs}`),letterSpacing:"-0.025em",color:Q(`palette-text-primary, ${Me.palette.text.primary}`)},h4:{fontFamily:Q(`fontFamily-display, ${ke.display}`),fontWeight:Q(`fontWeight-lg, ${Ge.lg}`),fontSize:Q(`fontSize-xl, ${Ke.xl}`),lineHeight:Q(`lineHeight-md, ${gt.md}`),letterSpacing:"-0.025em",color:Q(`palette-text-primary, ${Me.palette.text.primary}`)},"title-lg":{fontFamily:Q(`fontFamily-body, ${ke.body}`),fontWeight:Q(`fontWeight-lg, ${Ge.lg}`),fontSize:Q(`fontSize-lg, ${Ke.lg}`),lineHeight:Q(`lineHeight-xs, ${gt.xs}`),color:Q(`palette-text-primary, ${Me.palette.text.primary}`)},"title-md":{fontFamily:Q(`fontFamily-body, ${ke.body}`),fontWeight:Q(`fontWeight-md, ${Ge.md}`),fontSize:Q(`fontSize-md, ${Ke.md}`),lineHeight:Q(`lineHeight-md, ${gt.md}`),color:Q(`palette-text-primary, ${Me.palette.text.primary}`)},"title-sm":{fontFamily:Q(`fontFamily-body, ${ke.body}`),fontWeight:Q(`fontWeight-md, ${Ge.md}`),fontSize:Q(`fontSize-sm, ${Ke.sm}`),lineHeight:Q(`lineHeight-sm, ${gt.sm}`),color:Q(`palette-text-primary, ${Me.palette.text.primary}`)},"body-lg":{fontFamily:Q(`fontFamily-body, ${ke.body}`),fontSize:Q(`fontSize-lg, ${Ke.lg}`),lineHeight:Q(`lineHeight-md, ${gt.md}`),color:Q(`palette-text-secondary, ${Me.palette.text.secondary}`)},"body-md":{fontFamily:Q(`fontFamily-body, ${ke.body}`),fontSize:Q(`fontSize-md, ${Ke.md}`),lineHeight:Q(`lineHeight-md, ${gt.md}`),color:Q(`palette-text-secondary, ${Me.palette.text.secondary}`)},"body-sm":{fontFamily:Q(`fontFamily-body, ${ke.body}`),fontSize:Q(`fontSize-sm, ${Ke.sm}`),lineHeight:Q(`lineHeight-md, ${gt.md}`),color:Q(`palette-text-tertiary, ${Me.palette.text.tertiary}`)},"body-xs":{fontFamily:Q(`fontFamily-body, ${ke.body}`),fontWeight:Q(`fontWeight-md, ${Ge.md}`),fontSize:Q(`fontSize-xs, ${Ke.xs}`),lineHeight:Q(`lineHeight-md, ${gt.md}`),color:Q(`palette-text-tertiary, ${Me.palette.text.tertiary}`)}}},je=se?ul(Ve,se):Ve,{colorSchemes:ct}=je,ye=Pr(je,EO),ze=we({colorSchemes:ct},ye,{breakpoints:jE(F??{}),components:ul({MuiSvgIcon:{defaultProps:{fontSize:"xl2"},styleOverrides:{root:({ownerState:tt,theme:At})=>{var It;const mr=tt.instanceFontSize;return we({margin:"var(--Icon-margin)"},tt.fontSize&&tt.fontSize!=="inherit"&&{fontSize:`var(--Icon-fontSize, ${At.vars.fontSize[tt.fontSize]})`},!tt.htmlColor&&we({color:`var(--Icon-color, ${ze.vars.palette.text.icon})`},tt.color&&tt.color!=="inherit"&&At.vars.palette[tt.color]&&{color:`rgba(${(It=At.vars.palette[tt.color])==null?void 0:It.mainChannel} / 1)`}),mr&&mr!=="inherit"&&{"--Icon-fontSize":At.vars.fontSize[mr]})}}}},$),cssVarPrefix:z,getCssVar:Q,spacing:GE(U)});function ft(tt,At){Object.keys(At).forEach(It=>{const mr={main:"500",light:"200",dark:"700"};tt==="dark"&&(mr.main=400),!At[It].mainChannel&&At[It][mr.main]&&(At[It].mainChannel=Ip(At[It][mr.main])),!At[It].lightChannel&&At[It][mr.light]&&(At[It].lightChannel=Ip(At[It][mr.light])),!At[It].darkChannel&&At[It][mr.dark]&&(At[It].darkChannel=Ip(At[It][mr.dark]))})}Object.entries(ze.colorSchemes).forEach(([tt,At])=>{ft(tt,At.palette)});const wt={prefix:z,shouldSkipGeneratingVar:ie},{vars:xt,generateCssVars:_t}=fO(we({colorSchemes:ct},ye),wt);ze.vars=xt,ze.generateCssVars=_t,ze.unstable_sxConfig=we({},CO,void 0),ze.unstable_sx=function(At){return Nv({sx:At,theme:this})},ze.getColorSchemeSelector=tt=>tt==="light"?"&":`&[data-joy-color-scheme="${tt}"], [data-joy-color-scheme="${tt}"] &`;const St={getCssVar:Q,palette:ze.colorSchemes.light.palette};return ze.variants=ul({plain:Is("plain",St),plainHover:Is("plainHover",St),plainActive:Is("plainActive",St),plainDisabled:Is("plainDisabled",St),outlined:Is("outlined",St),outlinedHover:Is("outlinedHover",St),outlinedActive:Is("outlinedActive",St),outlinedDisabled:Is("outlinedDisabled",St),soft:Is("soft",St),softHover:Is("softHover",St),softActive:Is("softActive",St),softDisabled:Is("softDisabled",St),solid:Is("solid",St),solidHover:Is("solidHover",St),solidActive:Is("solidActive",St),solidDisabled:Is("solidDisabled",St)},j),ze.palette=we({},ze.colorSchemes.light.palette,{colorScheme:"light"}),ze.shouldSkipGeneratingVar=ie,ze.applyStyles=qE,ze}const Zg=kO(),Fy={attribute:"data-joy-color-scheme",colorSchemeStorageKey:"joy-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"joy-mode"},{CssVarsProvider:AO,useColorScheme:RO}=aO({themeId:Fv,theme:Zg,attribute:Fy.attribute,modeStorageKey:Fy.modeStorageKey,colorSchemeStorageKey:Fy.colorSchemeStorageKey,defaultColorScheme:{light:Fy.defaultLightColorScheme,dark:Fy.defaultDarkColorScheme}}),rr=YE({defaultTheme:Zg,themeId:Fv});function Ci({props:e,name:t}){return QE({props:e,name:t,defaultTheme:we({},Zg,{components:{}}),themeId:Fv})}function DO(e){return G.jsx(fz,we({},e,{defaultTheme:Zg,themeId:Fv}))}const zO={disableDefaultClasses:!1},OO=K.createContext(zO);function LO(e){const{disableDefaultClasses:t}=K.useContext(OO);return i=>t?"":e(i)}function FO(e){const{rootElementName:t=""}=e,[i,a]=K.useState(t.toUpperCase()),c=K.useCallback(h=>{var f;a((f=h?.tagName)!=null?f:"")},[]);return[i,c]}const hI="base";function BO(e){return`${hI}--${e}`}function $O(e,t){return`${hI}-${e}-${t}`}function jO(e,t){const i=XE[t];return i?BO(i):$O(e,t)}function Uv(e={}){const{disabled:t=!1,focusableWhenDisabled:i,href:a,rootRef:c,tabIndex:h,to:f,type:o,rootElementName:b}=e,P=K.useRef(null),[I,D]=K.useState(!1),{isFocusVisibleRef:z,onFocus:F,onBlur:U,ref:$}=nI(),[j,ie]=K.useState(!1);t&&!i&&j&&ie(!1),K.useEffect(()=>{z.current=j},[j,z]);const[se,Q]=FO({rootElementName:b??(a||f?"a":void 0)}),de=et=>qe=>{var Qe;j&&qe.preventDefault(),(Qe=et.onMouseLeave)==null||Qe.call(et,qe)},oe=et=>qe=>{var Qe;U(qe),z.current===!1&&ie(!1),(Qe=et.onBlur)==null||Qe.call(et,qe)},be=et=>qe=>{var Qe;if(P.current||(P.current=qe.currentTarget),F(qe),z.current===!0){var Ve;ie(!0),(Ve=et.onFocusVisible)==null||Ve.call(et,qe)}(Qe=et.onFocus)==null||Qe.call(et,qe)},xe=()=>{const et=P.current;return se==="BUTTON"||se==="INPUT"&&["button","submit","reset"].includes(et?.type)||se==="A"&&et?.href},Me=et=>qe=>{if(!t){var Qe;(Qe=et.onClick)==null||Qe.call(et,qe)}},Ee=et=>qe=>{var Qe;t||(D(!0),document.addEventListener("mouseup",()=>{D(!1)},{once:!0})),(Qe=et.onMouseDown)==null||Qe.call(et,qe)},re=et=>qe=>{var Qe;if((Qe=et.onKeyDown)==null||Qe.call(et,qe),!qe.defaultMuiPrevented&&(qe.target===qe.currentTarget&&!xe()&&qe.key===" "&&qe.preventDefault(),qe.target===qe.currentTarget&&qe.key===" "&&!t&&D(!0),qe.target===qe.currentTarget&&!xe()&&qe.key==="Enter"&&!t)){var Ve;(Ve=et.onClick)==null||Ve.call(et,qe),qe.preventDefault()}},ke=et=>qe=>{var Qe;if(qe.target===qe.currentTarget&&D(!1),(Qe=et.onKeyUp)==null||Qe.call(et,qe),qe.target===qe.currentTarget&&!xe()&&!t&&qe.key===" "&&!qe.defaultMuiPrevented){var Ve;(Ve=et.onClick)==null||Ve.call(et,qe)}},Ge=Ea(Q,c,$,P),Ke={};return h!==void 0&&(Ke.tabIndex=h),se==="BUTTON"?(Ke.type=o??"button",i?Ke["aria-disabled"]=t:Ke.disabled=t):se==="INPUT"?o&&["button","submit","reset"].includes(o)&&(i?Ke["aria-disabled"]=t:Ke.disabled=t):se!==""&&(!a&&!f&&(Ke.role="button",Ke.tabIndex=h??0),t&&(Ke["aria-disabled"]=t,Ke.tabIndex=i?h??0:-1)),{getRootProps:(et={})=>{const qe=we({},bf(e),bf(et)),Qe=we({type:o},qe,Ke,et,{onBlur:oe(qe),onClick:Me(qe),onFocus:be(qe),onKeyDown:re(qe),onKeyUp:ke(qe),onMouseDown:Ee(qe),onMouseLeave:de(qe),ref:Ge});return delete Qe.onFocusVisible,Qe},focusVisible:j,setFocusVisible:ie,active:I,rootRef:Ge}}function IT(e){return e.substring(2).toLowerCase()}function NO(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}function VO(e){const{children:t,disableReactTree:i=!1,mouseEvent:a="onClick",onClickAway:c,touchEvent:h="onTouchEnd"}=e,f=K.useRef(!1),o=K.useRef(null),b=K.useRef(!1),P=K.useRef(!1);K.useEffect(()=>(setTimeout(()=>{b.current=!0},0),()=>{b.current=!1}),[]);const I=Ea(aI(t),o),D=Bp(U=>{const $=P.current;P.current=!1;const j=Qy(o.current);if(!b.current||!o.current||"clientX"in U&&NO(U,j))return;if(f.current){f.current=!1;return}let ie;U.composedPath?ie=U.composedPath().indexOf(o.current)>-1:ie=!j.documentElement.contains(U.target)||o.current.contains(U.target),!ie&&(i||!$)&&c(U)}),z=U=>$=>{P.current=!0;const j=t.props[U];j&&j($)},F={ref:I};return h!==!1&&(F[h]=z(h)),K.useEffect(()=>{if(h!==!1){const U=IT(h),$=Qy(o.current),j=()=>{f.current=!0};return $.addEventListener(U,D),$.addEventListener("touchmove",j),()=>{$.removeEventListener(U,D),$.removeEventListener("touchmove",j)}}},[D,h]),a!==!1&&(F[a]=z(a)),K.useEffect(()=>{if(a!==!1){const U=IT(a),$=Qy(o.current);return $.addEventListener(U,D),()=>{$.removeEventListener(U,D)}}},[D,a]),G.jsx(K.Fragment,{children:K.cloneElement(t,F)})}const UO=K.createContext(void 0);function GO(){return K.useContext(UO)}function qO(e={}){const{defaultValue:t,disabled:i=!1,error:a=!1,onBlur:c,onChange:h,onFocus:f,required:o=!1,value:b,inputRef:P}=e,I=GO();let D,z,F,U,$;if(I){var j,ie,se;D=void 0,z=(j=I.disabled)!=null?j:!1,F=(ie=I.error)!=null?ie:!1,U=(se=I.required)!=null?se:!1,$=I.value}else D=t,z=i,F=a,U=o,$=b;const{current:Q}=K.useRef($!=null),de=K.useCallback(et=>{},[]),oe=K.useRef(null),be=Ea(oe,P,de),[xe,Me]=K.useState(!1);K.useEffect(()=>{!I&&z&&xe&&(Me(!1),c?.())},[I,z,xe,c]);const Ee=et=>qe=>{var Qe;if(I!=null&&I.disabled){qe.stopPropagation();return}if((Qe=et.onFocus)==null||Qe.call(et,qe),I&&I.onFocus){var Ve;I==null||(Ve=I.onFocus)==null||Ve.call(I)}else Me(!0)},re=et=>qe=>{var Qe;(Qe=et.onBlur)==null||Qe.call(et,qe),I&&I.onBlur?I.onBlur():Me(!1)},ke=et=>(qe,...Qe)=>{var Ve,je;if(!Q&&(qe.target||oe.current)==null)throw new Error(gv(17));I==null||(Ve=I.onChange)==null||Ve.call(I,qe),(je=et.onChange)==null||je.call(et,qe,...Qe)},Ge=et=>qe=>{var Qe;oe.current&&qe.currentTarget===qe.target&&oe.current.focus(),(Qe=et.onClick)==null||Qe.call(et,qe)};return{disabled:z,error:F,focused:xe,formControlContext:I,getInputProps:(et={})=>{const Qe=we({},{onBlur:c,onChange:h,onFocus:f},bf(et)),Ve=we({},Qe,{onBlur:re(Qe),onChange:ke(Qe),onFocus:Ee(Qe)});return we({},Ve,{"aria-invalid":F||void 0,defaultValue:D,value:$,required:U,disabled:z},et,{ref:be},Ve)},getRootProps:(et={})=>{const qe=bf(e,["onBlur","onChange","onFocus"]),Qe=we({},qe,bf(et));return we({},et,Qe,{onClick:Ge(Qe)})},inputRef:be,required:U,value:$}}var Sb={exports:{}},_a={},Cb={exports:{}},Tb={};var kT;function HO(){return kT||(kT=1,function(e){function t(Ve,je){var ct=Ve.length;Ve.push(je);e:for(;0<ct;){var ye=ct-1>>>1,ze=Ve[ye];if(0<c(ze,je))Ve[ye]=je,Ve[ct]=ze,ct=ye;else break e}}function i(Ve){return Ve.length===0?null:Ve[0]}function a(Ve){if(Ve.length===0)return null;var je=Ve[0],ct=Ve.pop();if(ct!==je){Ve[0]=ct;e:for(var ye=0,ze=Ve.length,ft=ze>>>1;ye<ft;){var wt=2*(ye+1)-1,xt=Ve[wt],_t=wt+1,St=Ve[_t];if(0>c(xt,ct))_t<ze&&0>c(St,xt)?(Ve[ye]=St,Ve[_t]=ct,ye=_t):(Ve[ye]=xt,Ve[wt]=ct,ye=wt);else if(_t<ze&&0>c(St,ct))Ve[ye]=St,Ve[_t]=ct,ye=_t;else break e}}return je}function c(Ve,je){var ct=Ve.sortIndex-je.sortIndex;return ct!==0?ct:Ve.id-je.id}if(typeof performance=="object"&&typeof performance.now=="function"){var h=performance;e.unstable_now=function(){return h.now()}}else{var f=Date,o=f.now();e.unstable_now=function(){return f.now()-o}}var b=[],P=[],I=1,D=null,z=3,F=!1,U=!1,$=!1,j=typeof setTimeout=="function"?setTimeout:null,ie=typeof clearTimeout=="function"?clearTimeout:null,se=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Q(Ve){for(var je=i(P);je!==null;){if(je.callback===null)a(P);else if(je.startTime<=Ve)a(P),je.sortIndex=je.expirationTime,t(b,je);else break;je=i(P)}}function de(Ve){if($=!1,Q(Ve),!U)if(i(b)!==null)U=!0,qe(oe);else{var je=i(P);je!==null&&Qe(de,je.startTime-Ve)}}function oe(Ve,je){U=!1,$&&($=!1,ie(Me),Me=-1),F=!0;var ct=z;try{for(Q(je),D=i(b);D!==null&&(!(D.expirationTime>je)||Ve&&!ke());){var ye=D.callback;if(typeof ye=="function"){D.callback=null,z=D.priorityLevel;var ze=ye(D.expirationTime<=je);je=e.unstable_now(),typeof ze=="function"?D.callback=ze:D===i(b)&&a(b),Q(je)}else a(b);D=i(b)}if(D!==null)var ft=!0;else{var wt=i(P);wt!==null&&Qe(de,wt.startTime-je),ft=!1}return ft}finally{D=null,z=ct,F=!1}}var be=!1,xe=null,Me=-1,Ee=5,re=-1;function ke(){return!(e.unstable_now()-re<Ee)}function Ge(){if(xe!==null){var Ve=e.unstable_now();re=Ve;var je=!0;try{je=xe(!0,Ve)}finally{je?Ke():(be=!1,xe=null)}}else be=!1}var Ke;if(typeof se=="function")Ke=function(){se(Ge)};else if(typeof MessageChannel<"u"){var gt=new MessageChannel,et=gt.port2;gt.port1.onmessage=Ge,Ke=function(){et.postMessage(null)}}else Ke=function(){j(Ge,0)};function qe(Ve){xe=Ve,be||(be=!0,Ke())}function Qe(Ve,je){Me=j(function(){Ve(e.unstable_now())},je)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ve){Ve.callback=null},e.unstable_continueExecution=function(){U||F||(U=!0,qe(oe))},e.unstable_forceFrameRate=function(Ve){0>Ve||125<Ve?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ee=0<Ve?Math.floor(1e3/Ve):5},e.unstable_getCurrentPriorityLevel=function(){return z},e.unstable_getFirstCallbackNode=function(){return i(b)},e.unstable_next=function(Ve){switch(z){case 1:case 2:case 3:var je=3;break;default:je=z}var ct=z;z=je;try{return Ve()}finally{z=ct}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Ve,je){switch(Ve){case 1:case 2:case 3:case 4:case 5:break;default:Ve=3}var ct=z;z=Ve;try{return je()}finally{z=ct}},e.unstable_scheduleCallback=function(Ve,je,ct){var ye=e.unstable_now();switch(typeof ct=="object"&&ct!==null?(ct=ct.delay,ct=typeof ct=="number"&&0<ct?ye+ct:ye):ct=ye,Ve){case 1:var ze=-1;break;case 2:ze=250;break;case 5:ze=1073741823;break;case 4:ze=1e4;break;default:ze=5e3}return ze=ct+ze,Ve={id:I++,callback:je,priorityLevel:Ve,startTime:ct,expirationTime:ze,sortIndex:-1},ct>ye?(Ve.sortIndex=ct,t(P,Ve),i(b)===null&&Ve===i(P)&&($?(ie(Me),Me=-1):$=!0,Qe(de,ct-ye))):(Ve.sortIndex=ze,t(b,Ve),U||F||(U=!0,qe(oe))),Ve},e.unstable_shouldYield=ke,e.unstable_wrapCallback=function(Ve){var je=z;return function(){var ct=z;z=je;try{return Ve.apply(this,arguments)}finally{z=ct}}}}(Tb)),Tb}var AT;function WO(){return AT||(AT=1,Cb.exports=HO()),Cb.exports}var RT;function ZO(){if(RT)return _a;RT=1;var e=Ex(),t=WO();function i(p){for(var y="https://reactjs.org/docs/error-decoder.html?invariant="+p,T=1;T<arguments.length;T++)y+="&args[]="+encodeURIComponent(arguments[T]);return"Minified React error #"+p+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,c={};function h(p,y){f(p,y),f(p+"Capture",y)}function f(p,y){for(c[p]=y,p=0;p<y.length;p++)a.add(y[p])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),b=Object.prototype.hasOwnProperty,P=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,I={},D={};function z(p){return b.call(D,p)?!0:b.call(I,p)?!1:P.test(p)?D[p]=!0:(I[p]=!0,!1)}function F(p,y,T,A){if(T!==null&&T.type===0)return!1;switch(typeof y){case"function":case"symbol":return!0;case"boolean":return A?!1:T!==null?!T.acceptsBooleans:(p=p.toLowerCase().slice(0,5),p!=="data-"&&p!=="aria-");default:return!1}}function U(p,y,T,A){if(y===null||typeof y>"u"||F(p,y,T,A))return!0;if(A)return!1;if(T!==null)switch(T.type){case 3:return!y;case 4:return y===!1;case 5:return isNaN(y);case 6:return isNaN(y)||1>y}return!1}function $(p,y,T,A,N,W,he){this.acceptsBooleans=y===2||y===3||y===4,this.attributeName=A,this.attributeNamespace=N,this.mustUseProperty=T,this.propertyName=p,this.type=y,this.sanitizeURL=W,this.removeEmptyString=he}var j={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(p){j[p]=new $(p,0,!1,p,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(p){var y=p[0];j[y]=new $(y,1,!1,p[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(p){j[p]=new $(p,2,!1,p.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(p){j[p]=new $(p,2,!1,p,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(p){j[p]=new $(p,3,!1,p.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(p){j[p]=new $(p,3,!0,p,null,!1,!1)}),["capture","download"].forEach(function(p){j[p]=new $(p,4,!1,p,null,!1,!1)}),["cols","rows","size","span"].forEach(function(p){j[p]=new $(p,6,!1,p,null,!1,!1)}),["rowSpan","start"].forEach(function(p){j[p]=new $(p,5,!1,p.toLowerCase(),null,!1,!1)});var ie=/[\-:]([a-z])/g;function se(p){return p[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(p){var y=p.replace(ie,se);j[y]=new $(y,1,!1,p,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(p){var y=p.replace(ie,se);j[y]=new $(y,1,!1,p,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(p){var y=p.replace(ie,se);j[y]=new $(y,1,!1,p,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(p){j[p]=new $(p,1,!1,p.toLowerCase(),null,!1,!1)}),j.xlinkHref=new $("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(p){j[p]=new $(p,1,!1,p.toLowerCase(),null,!0,!0)});function Q(p,y,T,A){var N=j.hasOwnProperty(y)?j[y]:null;(N!==null?N.type!==0:A||!(2<y.length)||y[0]!=="o"&&y[0]!=="O"||y[1]!=="n"&&y[1]!=="N")&&(U(y,T,N,A)&&(T=null),A||N===null?z(y)&&(T===null?p.removeAttribute(y):p.setAttribute(y,""+T)):N.mustUseProperty?p[N.propertyName]=T===null?N.type===3?!1:"":T:(y=N.attributeName,A=N.attributeNamespace,T===null?p.removeAttribute(y):(N=N.type,T=N===3||N===4&&T===!0?"":""+T,A?p.setAttributeNS(A,y,T):p.setAttribute(y,T))))}var de=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,oe=Symbol.for("react.element"),be=Symbol.for("react.portal"),xe=Symbol.for("react.fragment"),Me=Symbol.for("react.strict_mode"),Ee=Symbol.for("react.profiler"),re=Symbol.for("react.provider"),ke=Symbol.for("react.context"),Ge=Symbol.for("react.forward_ref"),Ke=Symbol.for("react.suspense"),gt=Symbol.for("react.suspense_list"),et=Symbol.for("react.memo"),qe=Symbol.for("react.lazy"),Qe=Symbol.for("react.offscreen"),Ve=Symbol.iterator;function je(p){return p===null||typeof p!="object"?null:(p=Ve&&p[Ve]||p["@@iterator"],typeof p=="function"?p:null)}var ct=Object.assign,ye;function ze(p){if(ye===void 0)try{throw Error()}catch(T){var y=T.stack.trim().match(/\n( *(at )?)/);ye=y&&y[1]||""}return`
`+ye+p}var ft=!1;function wt(p,y){if(!p||ft)return"";ft=!0;var T=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(y)if(y=function(){throw Error()},Object.defineProperty(y.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(y,[])}catch(pt){var A=pt}Reflect.construct(p,[],y)}else{try{y.call()}catch(pt){A=pt}p.call(y.prototype)}else{try{throw Error()}catch(pt){A=pt}p()}}catch(pt){if(pt&&A&&typeof pt.stack=="string"){for(var N=pt.stack.split(`
`),W=A.stack.split(`
`),he=N.length-1,Le=W.length-1;1<=he&&0<=Le&&N[he]!==W[Le];)Le--;for(;1<=he&&0<=Le;he--,Le--)if(N[he]!==W[Le]){if(he!==1||Le!==1)do if(he--,Le--,0>Le||N[he]!==W[Le]){var Ne=`
`+N[he].replace(" at new "," at ");return p.displayName&&Ne.includes("<anonymous>")&&(Ne=Ne.replace("<anonymous>",p.displayName)),Ne}while(1<=he&&0<=Le);break}}}finally{ft=!1,Error.prepareStackTrace=T}return(p=p?p.displayName||p.name:"")?ze(p):""}function xt(p){switch(p.tag){case 5:return ze(p.type);case 16:return ze("Lazy");case 13:return ze("Suspense");case 19:return ze("SuspenseList");case 0:case 2:case 15:return p=wt(p.type,!1),p;case 11:return p=wt(p.type.render,!1),p;case 1:return p=wt(p.type,!0),p;default:return""}}function _t(p){if(p==null)return null;if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case xe:return"Fragment";case be:return"Portal";case Ee:return"Profiler";case Me:return"StrictMode";case Ke:return"Suspense";case gt:return"SuspenseList"}if(typeof p=="object")switch(p.$$typeof){case ke:return(p.displayName||"Context")+".Consumer";case re:return(p._context.displayName||"Context")+".Provider";case Ge:var y=p.render;return p=p.displayName,p||(p=y.displayName||y.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case et:return y=p.displayName||null,y!==null?y:_t(p.type)||"Memo";case qe:y=p._payload,p=p._init;try{return _t(p(y))}catch{}}return null}function St(p){var y=p.type;switch(p.tag){case 24:return"Cache";case 9:return(y.displayName||"Context")+".Consumer";case 10:return(y._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return p=y.render,p=p.displayName||p.name||"",y.displayName||(p!==""?"ForwardRef("+p+")":"ForwardRef");case 7:return"Fragment";case 5:return y;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _t(y);case 8:return y===Me?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof y=="function")return y.displayName||y.name||null;if(typeof y=="string")return y}return null}function tt(p){switch(typeof p){case"boolean":case"number":case"string":case"undefined":return p;case"object":return p;default:return""}}function At(p){var y=p.type;return(p=p.nodeName)&&p.toLowerCase()==="input"&&(y==="checkbox"||y==="radio")}function It(p){var y=At(p)?"checked":"value",T=Object.getOwnPropertyDescriptor(p.constructor.prototype,y),A=""+p[y];if(!p.hasOwnProperty(y)&&typeof T<"u"&&typeof T.get=="function"&&typeof T.set=="function"){var N=T.get,W=T.set;return Object.defineProperty(p,y,{configurable:!0,get:function(){return N.call(this)},set:function(he){A=""+he,W.call(this,he)}}),Object.defineProperty(p,y,{enumerable:T.enumerable}),{getValue:function(){return A},setValue:function(he){A=""+he},stopTracking:function(){p._valueTracker=null,delete p[y]}}}}function mr(p){p._valueTracker||(p._valueTracker=It(p))}function ur(p){if(!p)return!1;var y=p._valueTracker;if(!y)return!0;var T=y.getValue(),A="";return p&&(A=At(p)?p.checked?"true":"false":p.value),p=A,p!==T?(y.setValue(p),!0):!1}function Hr(p){if(p=p||(typeof document<"u"?document:void 0),typeof p>"u")return null;try{return p.activeElement||p.body}catch{return p.body}}function wr(p,y){var T=y.checked;return ct({},y,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:T??p._wrapperState.initialChecked})}function sr(p,y){var T=y.defaultValue==null?"":y.defaultValue,A=y.checked!=null?y.checked:y.defaultChecked;T=tt(y.value!=null?y.value:T),p._wrapperState={initialChecked:A,initialValue:T,controlled:y.type==="checkbox"||y.type==="radio"?y.checked!=null:y.value!=null}}function Wt(p,y){y=y.checked,y!=null&&Q(p,"checked",y,!1)}function yr(p,y){Wt(p,y);var T=tt(y.value),A=y.type;if(T!=null)A==="number"?(T===0&&p.value===""||p.value!=T)&&(p.value=""+T):p.value!==""+T&&(p.value=""+T);else if(A==="submit"||A==="reset"){p.removeAttribute("value");return}y.hasOwnProperty("value")?Cr(p,y.type,T):y.hasOwnProperty("defaultValue")&&Cr(p,y.type,tt(y.defaultValue)),y.checked==null&&y.defaultChecked!=null&&(p.defaultChecked=!!y.defaultChecked)}function Yt(p,y,T){if(y.hasOwnProperty("value")||y.hasOwnProperty("defaultValue")){var A=y.type;if(!(A!=="submit"&&A!=="reset"||y.value!==void 0&&y.value!==null))return;y=""+p._wrapperState.initialValue,T||y===p.value||(p.value=y),p.defaultValue=y}T=p.name,T!==""&&(p.name=""),p.defaultChecked=!!p._wrapperState.initialChecked,T!==""&&(p.name=T)}function Cr(p,y,T){(y!=="number"||Hr(p.ownerDocument)!==p)&&(T==null?p.defaultValue=""+p._wrapperState.initialValue:p.defaultValue!==""+T&&(p.defaultValue=""+T))}var Rr=Array.isArray;function Or(p,y,T,A){if(p=p.options,y){y={};for(var N=0;N<T.length;N++)y["$"+T[N]]=!0;for(T=0;T<p.length;T++)N=y.hasOwnProperty("$"+p[T].value),p[T].selected!==N&&(p[T].selected=N),N&&A&&(p[T].defaultSelected=!0)}else{for(T=""+tt(T),y=null,N=0;N<p.length;N++){if(p[N].value===T){p[N].selected=!0,A&&(p[N].defaultSelected=!0);return}y!==null||p[N].disabled||(y=p[N])}y!==null&&(y.selected=!0)}}function Gr(p,y){if(y.dangerouslySetInnerHTML!=null)throw Error(i(91));return ct({},y,{value:void 0,defaultValue:void 0,children:""+p._wrapperState.initialValue})}function rn(p,y){var T=y.value;if(T==null){if(T=y.children,y=y.defaultValue,T!=null){if(y!=null)throw Error(i(92));if(Rr(T)){if(1<T.length)throw Error(i(93));T=T[0]}y=T}y==null&&(y=""),T=y}p._wrapperState={initialValue:tt(T)}}function Un(p,y){var T=tt(y.value),A=tt(y.defaultValue);T!=null&&(T=""+T,T!==p.value&&(p.value=T),y.defaultValue==null&&p.defaultValue!==T&&(p.defaultValue=T)),A!=null&&(p.defaultValue=""+A)}function wn(p){var y=p.textContent;y===p._wrapperState.initialValue&&y!==""&&y!==null&&(p.value=y)}function He(p){switch(p){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ae(p,y){return p==null||p==="http://www.w3.org/1999/xhtml"?He(y):p==="http://www.w3.org/2000/svg"&&y==="foreignObject"?"http://www.w3.org/1999/xhtml":p}var le,ue=function(p){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(y,T,A,N){MSApp.execUnsafeLocalFunction(function(){return p(y,T,A,N)})}:p}(function(p,y){if(p.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in p)p.innerHTML=y;else{for(le=le||document.createElement("div"),le.innerHTML="<svg>"+y.valueOf().toString()+"</svg>",y=le.firstChild;p.firstChild;)p.removeChild(p.firstChild);for(;y.firstChild;)p.appendChild(y.firstChild)}});function Pe(p,y){if(y){var T=p.firstChild;if(T&&T===p.lastChild&&T.nodeType===3){T.nodeValue=y;return}}p.textContent=y}var Re={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ye=["Webkit","ms","Moz","O"];Object.keys(Re).forEach(function(p){Ye.forEach(function(y){y=y+p.charAt(0).toUpperCase()+p.substring(1),Re[y]=Re[p]})});function Xe(p,y,T){return y==null||typeof y=="boolean"||y===""?"":T||typeof y!="number"||y===0||Re.hasOwnProperty(p)&&Re[p]?(""+y).trim():y+"px"}function $e(p,y){p=p.style;for(var T in y)if(y.hasOwnProperty(T)){var A=T.indexOf("--")===0,N=Xe(T,y[T],A);T==="float"&&(T="cssFloat"),A?p.setProperty(T,N):p[T]=N}}var Je=ct({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ct(p,y){if(y){if(Je[p]&&(y.children!=null||y.dangerouslySetInnerHTML!=null))throw Error(i(137,p));if(y.dangerouslySetInnerHTML!=null){if(y.children!=null)throw Error(i(60));if(typeof y.dangerouslySetInnerHTML!="object"||!("__html"in y.dangerouslySetInnerHTML))throw Error(i(61))}if(y.style!=null&&typeof y.style!="object")throw Error(i(62))}}function yt(p,y){if(p.indexOf("-")===-1)return typeof y.is=="string";switch(p){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $t=null;function qt(p){return p=p.target||p.srcElement||window,p.correspondingUseElement&&(p=p.correspondingUseElement),p.nodeType===3?p.parentNode:p}var Qt=null,br=null,tr=null;function Ze(p){if(p=js(p)){if(typeof Qt!="function")throw Error(i(280));var y=p.stateNode;y&&(y=Ah(y),Qt(p.stateNode,p.type,y))}}function Lr(p){br?tr?tr.push(p):tr=[p]:br=p}function mn(){if(br){var p=br,y=tr;if(tr=br=null,Ze(p),y)for(p=0;p<y.length;p++)Ze(y[p])}}function ar(p,y){return p(y)}function Dr(){}var ln=!1;function Xr(p,y,T){if(ln)return p(y,T);ln=!0;try{return ar(p,y,T)}finally{ln=!1,(br!==null||tr!==null)&&(Dr(),mn())}}function zr(p,y){var T=p.stateNode;if(T===null)return null;var A=Ah(T);if(A===null)return null;T=A[y];e:switch(y){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(A=!A.disabled)||(p=p.type,A=!(p==="button"||p==="input"||p==="select"||p==="textarea")),p=!A;break e;default:p=!1}if(p)return null;if(T&&typeof T!="function")throw Error(i(231,y,typeof T));return T}var Vr=!1;if(o)try{var Kr={};Object.defineProperty(Kr,"passive",{get:function(){Vr=!0}}),window.addEventListener("test",Kr,Kr),window.removeEventListener("test",Kr,Kr)}catch{Vr=!1}function Vi(p,y,T,A,N,W,he,Le,Ne){var pt=Array.prototype.slice.call(arguments,3);try{y.apply(T,pt)}catch(Ot){this.onError(Ot)}}var Ui=!1,Et=null,vn=!1,zn=null,fs={onError:function(p){Ui=!0,Et=p}};function Ki(p,y,T,A,N,W,he,Le,Ne){Ui=!1,Et=null,Vi.apply(fs,arguments)}function jt(p,y,T,A,N,W,he,Le,Ne){if(Ki.apply(this,arguments),Ui){if(Ui){var pt=Et;Ui=!1,Et=null}else throw Error(i(198));vn||(vn=!0,zn=pt)}}function ot(p){var y=p,T=p;if(p.alternate)for(;y.return;)y=y.return;else{p=y;do y=p,(y.flags&4098)!==0&&(T=y.return),p=y.return;while(p)}return y.tag===3?T:null}function rt(p){if(p.tag===13){var y=p.memoizedState;if(y===null&&(p=p.alternate,p!==null&&(y=p.memoizedState)),y!==null)return y.dehydrated}return null}function Zt(p){if(ot(p)!==p)throw Error(i(188))}function Tr(p){var y=p.alternate;if(!y){if(y=ot(p),y===null)throw Error(i(188));return y!==p?null:p}for(var T=p,A=y;;){var N=T.return;if(N===null)break;var W=N.alternate;if(W===null){if(A=N.return,A!==null){T=A;continue}break}if(N.child===W.child){for(W=N.child;W;){if(W===T)return Zt(N),p;if(W===A)return Zt(N),y;W=W.sibling}throw Error(i(188))}if(T.return!==A.return)T=N,A=W;else{for(var he=!1,Le=N.child;Le;){if(Le===T){he=!0,T=N,A=W;break}if(Le===A){he=!0,A=N,T=W;break}Le=Le.sibling}if(!he){for(Le=W.child;Le;){if(Le===T){he=!0,T=W,A=N;break}if(Le===A){he=!0,A=W,T=N;break}Le=Le.sibling}if(!he)throw Error(i(189))}}if(T.alternate!==A)throw Error(i(190))}if(T.tag!==3)throw Error(i(188));return T.stateNode.current===T?p:y}function Nr(p){return p=Tr(p),p!==null?ir(p):null}function ir(p){if(p.tag===5||p.tag===6)return p;for(p=p.child;p!==null;){var y=ir(p);if(y!==null)return y;p=p.sibling}return null}var An=t.unstable_scheduleCallback,Gi=t.unstable_cancelCallback,Ra=t.unstable_shouldYield,pl=t.unstable_requestPaint,Gn=t.unstable_now,ml=t.unstable_getCurrentPriorityLevel,Qs=t.unstable_ImmediatePriority,Yi=t.unstable_UserBlockingPriority,nn=t.unstable_NormalPriority,nc=t.unstable_LowPriority,Mr=t.unstable_IdlePriority,Ei=null,on=null;function fi(p){if(on&&typeof on.onCommitFiberRoot=="function")try{on.onCommitFiberRoot(Ei,p,void 0,(p.current.flags&128)===128)}catch{}}var Ii=Math.clz32?Math.clz32:gn,Rs=Math.log,os=Math.LN2;function gn(p){return p>>>=0,p===0?32:31-(Rs(p)/os|0)|0}var lh=64,ch=4194304;function Da(p){switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return p&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return p}}function uh(p,y){var T=p.pendingLanes;if(T===0)return 0;var A=0,N=p.suspendedLanes,W=p.pingedLanes,he=T&268435455;if(he!==0){var Le=he&~N;Le!==0?A=Da(Le):(W&=he,W!==0&&(A=Da(W)))}else he=T&~N,he!==0?A=Da(he):W!==0&&(A=Da(W));if(A===0)return 0;if(y!==0&&y!==A&&(y&N)===0&&(N=A&-A,W=y&-y,N>=W||N===16&&(W&4194240)!==0))return y;if((A&4)!==0&&(A|=T&16),y=p.entangledLanes,y!==0)for(p=p.entanglements,y&=A;0<y;)T=31-Ii(y),N=1<<T,A|=p[T],y&=~N;return A}function hm(p,y){switch(p){case 1:case 2:case 4:return y+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dm(p,y){for(var T=p.suspendedLanes,A=p.pingedLanes,N=p.expirationTimes,W=p.pendingLanes;0<W;){var he=31-Ii(W),Le=1<<he,Ne=N[he];Ne===-1?((Le&T)===0||(Le&A)!==0)&&(N[he]=hm(Le,y)):Ne<=y&&(p.expiredLanes|=Le),W&=~Le}}function lu(p){return p=p.pendingLanes&-1073741825,p!==0?p:p&1073741824?1073741824:0}function hd(){var p=lh;return lh<<=1,(lh&4194240)===0&&(lh=64),p}function hh(p){for(var y=[],T=0;31>T;T++)y.push(p);return y}function ic(p,y,T){p.pendingLanes|=y,y!==536870912&&(p.suspendedLanes=0,p.pingedLanes=0),p=p.eventTimes,y=31-Ii(y),p[y]=T}function Lf(p,y){var T=p.pendingLanes&~y;p.pendingLanes=y,p.suspendedLanes=0,p.pingedLanes=0,p.expiredLanes&=y,p.mutableReadLanes&=y,p.entangledLanes&=y,y=p.entanglements;var A=p.eventTimes;for(p=p.expirationTimes;0<T;){var N=31-Ii(T),W=1<<N;y[N]=0,A[N]=-1,p[N]=-1,T&=~W}}function Ff(p,y){var T=p.entangledLanes|=y;for(p=p.entanglements;T;){var A=31-Ii(T),N=1<<A;N&y|p[A]&y&&(p[A]|=y),T&=~N}}var fn=0;function dh(p){return p&=-p,1<p?4<p?(p&268435455)!==0?16:536870912:4:1}var Bf,gl,dd,cu,za,yl=!1,Fr=[],ea=null,vl=null,ta=null,Ji=new Map,Oi=new Map,_n=[],Sr="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mn(p,y){switch(p){case"focusin":case"focusout":ea=null;break;case"dragenter":case"dragleave":vl=null;break;case"mouseover":case"mouseout":ta=null;break;case"pointerover":case"pointerout":Ji.delete(y.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oi.delete(y.pointerId)}}function ps(p,y,T,A,N,W){return p===null||p.nativeEvent!==W?(p={blockedOn:y,domEventName:T,eventSystemFlags:A,nativeEvent:W,targetContainers:[N]},y!==null&&(y=js(y),y!==null&&gl(y)),p):(p.eventSystemFlags|=A,y=p.targetContainers,N!==null&&y.indexOf(N)===-1&&y.push(N),p)}function Do(p,y,T,A,N){switch(y){case"focusin":return ea=ps(ea,p,y,T,A,N),!0;case"dragenter":return vl=ps(vl,p,y,T,A,N),!0;case"mouseover":return ta=ps(ta,p,y,T,A,N),!0;case"pointerover":var W=N.pointerId;return Ji.set(W,ps(Ji.get(W)||null,p,y,T,A,N)),!0;case"gotpointercapture":return W=N.pointerId,Oi.set(W,ps(Oi.get(W)||null,p,y,T,A,N)),!0}return!1}function Go(p){var y=$s(p.target);if(y!==null){var T=ot(y);if(T!==null){if(y=T.tag,y===13){if(y=rt(T),y!==null){p.blockedOn=y,za(p.priority,function(){dd(T)});return}}else if(y===3&&T.stateNode.current.memoizedState.isDehydrated){p.blockedOn=T.tag===3?T.stateNode.containerInfo:null;return}}}p.blockedOn=null}function Qi(p){if(p.blockedOn!==null)return!1;for(var y=p.targetContainers;0<y.length;){var T=ph(p.domEventName,p.eventSystemFlags,y[0],p.nativeEvent);if(T===null){T=p.nativeEvent;var A=new T.constructor(T.type,T);$t=A,T.target.dispatchEvent(A),$t=null}else return y=js(T),y!==null&&gl(y),p.blockedOn=T,!1;y.shift()}return!0}function oc(p,y,T){Qi(p)&&T.delete(y)}function _l(){yl=!1,ea!==null&&Qi(ea)&&(ea=null),vl!==null&&Qi(vl)&&(vl=null),ta!==null&&Qi(ta)&&(ta=null),Ji.forEach(oc),Oi.forEach(oc)}function qn(p,y){p.blockedOn===y&&(p.blockedOn=null,yl||(yl=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,_l)))}function Ds(p){function y(N){return qn(N,p)}if(0<Fr.length){qn(Fr[0],p);for(var T=1;T<Fr.length;T++){var A=Fr[T];A.blockedOn===p&&(A.blockedOn=null)}}for(ea!==null&&qn(ea,p),vl!==null&&qn(vl,p),ta!==null&&qn(ta,p),Ji.forEach(y),Oi.forEach(y),T=0;T<_n.length;T++)A=_n[T],A.blockedOn===p&&(A.blockedOn=null);for(;0<_n.length&&(T=_n[0],T.blockedOn===null);)Go(T),T.blockedOn===null&&_n.shift()}var zo=de.ReactCurrentBatchConfig,sc=!0;function qo(p,y,T,A){var N=fn,W=zo.transition;zo.transition=null;try{fn=1,zs(p,y,T,A)}finally{fn=N,zo.transition=W}}function ac(p,y,T,A){var N=fn,W=zo.transition;zo.transition=null;try{fn=4,zs(p,y,T,A)}finally{fn=N,zo.transition=W}}function zs(p,y,T,A){if(sc){var N=ph(p,y,T,A);if(N===null)xc(p,y,A,fh,T),Mn(p,A);else if(Do(N,p,y,T,A))A.stopPropagation();else if(Mn(p,A),y&4&&-1<Sr.indexOf(p)){for(;N!==null;){var W=js(N);if(W!==null&&Bf(W),W=ph(p,y,T,A),W===null&&xc(p,y,A,fh,T),W===N)break;N=W}N!==null&&A.stopPropagation()}else xc(p,y,A,null,T)}}var fh=null;function ph(p,y,T,A){if(fh=null,p=qt(A),p=$s(p),p!==null)if(y=ot(p),y===null)p=null;else if(T=y.tag,T===13){if(p=rt(y),p!==null)return p;p=null}else if(T===3){if(y.stateNode.current.memoizedState.isDehydrated)return y.tag===3?y.stateNode.containerInfo:null;p=null}else y!==p&&(p=null);return fh=p,null}function xl(p){switch(p){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ml()){case Qs:return 1;case Yi:return 4;case nn:case nc:return 16;case Mr:return 536870912;default:return 16}default:return 16}}var sn=null,bl=null,Zr=null;function Br(){if(Zr)return Zr;var p,y=bl,T=y.length,A,N="value"in sn?sn.value:sn.textContent,W=N.length;for(p=0;p<T&&y[p]===N[p];p++);var he=T-p;for(A=1;A<=he&&y[T-A]===N[W-A];A++);return Zr=N.slice(p,1<A?1-A:void 0)}function Oa(p){var y=p.keyCode;return"charCode"in p?(p=p.charCode,p===0&&y===13&&(p=13)):p=y,p===10&&(p=13),32<=p||p===13?p:0}function Yr(){return!0}function uu(){return!1}function li(p){function y(T,A,N,W,he){this._reactName=T,this._targetInst=N,this.type=A,this.nativeEvent=W,this.target=he,this.currentTarget=null;for(var Le in p)p.hasOwnProperty(Le)&&(T=p[Le],this[Le]=T?T(W):W[Le]);return this.isDefaultPrevented=(W.defaultPrevented!=null?W.defaultPrevented:W.returnValue===!1)?Yr:uu,this.isPropagationStopped=uu,this}return ct(y.prototype,{preventDefault:function(){this.defaultPrevented=!0;var T=this.nativeEvent;T&&(T.preventDefault?T.preventDefault():typeof T.returnValue!="unknown"&&(T.returnValue=!1),this.isDefaultPrevented=Yr)},stopPropagation:function(){var T=this.nativeEvent;T&&(T.stopPropagation?T.stopPropagation():typeof T.cancelBubble!="unknown"&&(T.cancelBubble=!0),this.isPropagationStopped=Yr)},persist:function(){},isPersistent:Yr}),y}var Os={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(p){return p.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ra=li(Os),hu=ct({},Os,{view:0,detail:0}),mh=li(hu),gh,$f,du,eo=ct({},hu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wl,button:0,buttons:0,relatedTarget:function(p){return p.relatedTarget===void 0?p.fromElement===p.srcElement?p.toElement:p.fromElement:p.relatedTarget},movementX:function(p){return"movementX"in p?p.movementX:(p!==du&&(du&&p.type==="mousemove"?(gh=p.screenX-du.screenX,$f=p.screenY-du.screenY):$f=gh=0,du=p),gh)},movementY:function(p){return"movementY"in p?p.movementY:$f}}),Ls=li(eo),ti=ct({},eo,{dataTransfer:0}),lc=li(ti),jf=ct({},hu,{relatedTarget:0}),cc=li(jf),pi=ct({},Os,{animationName:0,elapsedTime:0,pseudoElement:0}),fm=li(pi),Nf=ct({},Os,{clipboardData:function(p){return"clipboardData"in p?p.clipboardData:window.clipboardData}}),pm=li(Nf),ny=ct({},Os,{data:0}),uc=li(ny),fd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Vf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yh(p){var y=this.nativeEvent;return y.getModifierState?y.getModifierState(p):(p=Vf[p])?!!y[p]:!1}function wl(){return yh}var pu=ct({},hu,{key:function(p){if(p.key){var y=fd[p.key]||p.key;if(y!=="Unidentified")return y}return p.type==="keypress"?(p=Oa(p),p===13?"Enter":String.fromCharCode(p)):p.type==="keydown"||p.type==="keyup"?fu[p.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wl,charCode:function(p){return p.type==="keypress"?Oa(p):0},keyCode:function(p){return p.type==="keydown"||p.type==="keyup"?p.keyCode:0},which:function(p){return p.type==="keypress"?Oa(p):p.type==="keydown"||p.type==="keyup"?p.keyCode:0}}),Li=li(pu),mm=ct({},eo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hc=li(mm),vh=ct({},hu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wl}),dc=li(vh),iy=ct({},Os,{propertyName:0,elapsedTime:0,pseudoElement:0}),pd=li(iy),oy=ct({},eo,{deltaX:function(p){return"deltaX"in p?p.deltaX:"wheelDeltaX"in p?-p.wheelDeltaX:0},deltaY:function(p){return"deltaY"in p?p.deltaY:"wheelDeltaY"in p?-p.wheelDeltaY:"wheelDelta"in p?-p.wheelDelta:0},deltaZ:0,deltaMode:0}),mu=li(oy),md=[9,13,27,32],gd=o&&"CompositionEvent"in window,gu=null;o&&"documentMode"in document&&(gu=document.documentMode);var Uf=o&&"TextEvent"in window&&!gu,yd=o&&(!gd||gu&&8<gu&&11>=gu),vd=" ",Gf=!1;function qf(p,y){switch(p){case"keyup":return md.indexOf(y.keyCode)!==-1;case"keydown":return y.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hf(p){return p=p.detail,typeof p=="object"&&"data"in p?p.data:null}var ms=!1;function gm(p,y){switch(p){case"compositionend":return Hf(y);case"keypress":return y.which!==32?null:(Gf=!0,vd);case"textInput":return p=y.data,p===vd&&Gf?null:p;default:return null}}function Wf(p,y){if(ms)return p==="compositionend"||!gd&&qf(p,y)?(p=Br(),Zr=bl=sn=null,ms=!1,p):null;switch(p){case"paste":return null;case"keypress":if(!(y.ctrlKey||y.altKey||y.metaKey)||y.ctrlKey&&y.altKey){if(y.char&&1<y.char.length)return y.char;if(y.which)return String.fromCharCode(y.which)}return null;case"compositionend":return yd&&y.locale!=="ko"?null:y.data;default:return null}}var yu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zf(p){var y=p&&p.nodeName&&p.nodeName.toLowerCase();return y==="input"?!!yu[p.type]:y==="textarea"}function _h(p,y,T,A){Lr(A),y=wu(y,"onChange"),0<y.length&&(T=new ra("onChange","change",null,T,A),p.push({event:T,listeners:y}))}var xh=null,bh=null;function ym(p){Sm(p,0)}function Sl(p){var y=Ns(p);if(ur(y))return p}function vm(p,y){if(p==="change")return y}var _d=!1;if(o){var xd;if(o){var vu="oninput"in document;if(!vu){var gs=document.createElement("div");gs.setAttribute("oninput","return;"),vu=typeof gs.oninput=="function"}xd=vu}else xd=!1;_d=xd&&(!document.documentMode||9<document.documentMode)}function wh(){xh&&(xh.detachEvent("onpropertychange",bd),bh=xh=null)}function bd(p){if(p.propertyName==="value"&&Sl(bh)){var y=[];_h(y,bh,p,qt(p)),Xr(ym,y)}}function Xf(p,y,T){p==="focusin"?(wh(),xh=y,bh=T,xh.attachEvent("onpropertychange",bd)):p==="focusout"&&wh()}function Kf(p){if(p==="selectionchange"||p==="keyup"||p==="keydown")return Sl(bh)}function wd(p,y){if(p==="click")return Sl(y)}function fc(p,y){if(p==="input"||p==="change")return Sl(y)}function Yf(p,y){return p===y&&(p!==0||1/p===1/y)||p!==p&&y!==y}var Fs=typeof Object.is=="function"?Object.is:Yf;function _u(p,y){if(Fs(p,y))return!0;if(typeof p!="object"||p===null||typeof y!="object"||y===null)return!1;var T=Object.keys(p),A=Object.keys(y);if(T.length!==A.length)return!1;for(A=0;A<T.length;A++){var N=T[A];if(!b.call(y,N)||!Fs(p[N],y[N]))return!1}return!0}function _m(p){for(;p&&p.firstChild;)p=p.firstChild;return p}function xm(p,y){var T=_m(p);p=0;for(var A;T;){if(T.nodeType===3){if(A=p+T.textContent.length,p<=y&&A>=y)return{node:T,offset:y-p};p=A}e:{for(;T;){if(T.nextSibling){T=T.nextSibling;break e}T=T.parentNode}T=void 0}T=_m(T)}}function Jf(p,y){return p&&y?p===y?!0:p&&p.nodeType===3?!1:y&&y.nodeType===3?Jf(p,y.parentNode):"contains"in p?p.contains(y):p.compareDocumentPosition?!!(p.compareDocumentPosition(y)&16):!1:!1}function bm(){for(var p=window,y=Hr();y instanceof p.HTMLIFrameElement;){try{var T=typeof y.contentWindow.location.href=="string"}catch{T=!1}if(T)p=y.contentWindow;else break;y=Hr(p.document)}return y}function an(p){var y=p&&p.nodeName&&p.nodeName.toLowerCase();return y&&(y==="input"&&(p.type==="text"||p.type==="search"||p.type==="tel"||p.type==="url"||p.type==="password")||y==="textarea"||p.contentEditable==="true")}function Sd(p){var y=bm(),T=p.focusedElem,A=p.selectionRange;if(y!==T&&T&&T.ownerDocument&&Jf(T.ownerDocument.documentElement,T)){if(A!==null&&an(T)){if(y=A.start,p=A.end,p===void 0&&(p=y),"selectionStart"in T)T.selectionStart=y,T.selectionEnd=Math.min(p,T.value.length);else if(p=(y=T.ownerDocument||document)&&y.defaultView||window,p.getSelection){p=p.getSelection();var N=T.textContent.length,W=Math.min(A.start,N);A=A.end===void 0?W:Math.min(A.end,N),!p.extend&&W>A&&(N=A,A=W,W=N),N=xm(T,W);var he=xm(T,A);N&&he&&(p.rangeCount!==1||p.anchorNode!==N.node||p.anchorOffset!==N.offset||p.focusNode!==he.node||p.focusOffset!==he.offset)&&(y=y.createRange(),y.setStart(N.node,N.offset),p.removeAllRanges(),W>A?(p.addRange(y),p.extend(he.node,he.offset)):(y.setEnd(he.node,he.offset),p.addRange(y)))}}for(y=[],p=T;p=p.parentNode;)p.nodeType===1&&y.push({element:p,left:p.scrollLeft,top:p.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<y.length;T++)p=y[T],p.element.scrollLeft=p.left,p.element.scrollTop=p.top}}var Cd=o&&"documentMode"in document&&11>=document.documentMode,La=null,Sh=null,Bs=null,pc=!1;function mc(p,y,T){var A=T.window===T?T.document:T.nodeType===9?T:T.ownerDocument;pc||La==null||La!==Hr(A)||(A=La,"selectionStart"in A&&an(A)?A={start:A.selectionStart,end:A.selectionEnd}:(A=(A.ownerDocument&&A.ownerDocument.defaultView||window).getSelection(),A={anchorNode:A.anchorNode,anchorOffset:A.anchorOffset,focusNode:A.focusNode,focusOffset:A.focusOffset}),Bs&&_u(Bs,A)||(Bs=A,A=wu(Sh,"onSelect"),0<A.length&&(y=new ra("onSelect","select",null,y,T),p.push({event:y,listeners:A}),y.target=La)))}function Oo(p,y){var T={};return T[p.toLowerCase()]=y.toLowerCase(),T["Webkit"+p]="webkit"+y,T["Moz"+p]="moz"+y,T}var gc={animationend:Oo("Animation","AnimationEnd"),animationiteration:Oo("Animation","AnimationIteration"),animationstart:Oo("Animation","AnimationStart"),transitionend:Oo("Transition","TransitionEnd")},Td={},Md={};o&&(Md=document.createElement("div").style,"AnimationEvent"in window||(delete gc.animationend.animation,delete gc.animationiteration.animation,delete gc.animationstart.animation),"TransitionEvent"in window||delete gc.transitionend.transition);function na(p){if(Td[p])return Td[p];if(!gc[p])return p;var y=gc[p],T;for(T in y)if(y.hasOwnProperty(T)&&T in Md)return Td[p]=y[T];return p}var Ch=na("animationend"),Th=na("animationiteration"),xu=na("animationstart"),Mh=na("transitionend"),Qf=new Map,yc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ss(p,y){Qf.set(p,y),h(y,[p])}for(var Pd=0;Pd<yc.length;Pd++){var Ph=yc[Pd],qr=Ph.toLowerCase(),Ed=Ph[0].toUpperCase()+Ph.slice(1);ss(qr,"on"+Ed)}ss(Ch,"onAnimationEnd"),ss(Th,"onAnimationIteration"),ss(xu,"onAnimationStart"),ss("dblclick","onDoubleClick"),ss("focusin","onFocus"),ss("focusout","onBlur"),ss(Mh,"onTransitionEnd"),f("onMouseEnter",["mouseout","mouseover"]),f("onMouseLeave",["mouseout","mouseover"]),f("onPointerEnter",["pointerout","pointerover"]),f("onPointerLeave",["pointerout","pointerover"]),h("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),h("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),h("onBeforeInput",["compositionend","keypress","textInput","paste"]),h("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),h("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),h("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Eh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wm=new Set("cancel close invalid load scroll toggle".split(" ").concat(Eh));function bu(p,y,T){var A=p.type||"unknown-event";p.currentTarget=T,jt(A,y,void 0,p),p.currentTarget=null}function Sm(p,y){y=(y&4)!==0;for(var T=0;T<p.length;T++){var A=p[T],N=A.event;A=A.listeners;e:{var W=void 0;if(y)for(var he=A.length-1;0<=he;he--){var Le=A[he],Ne=Le.instance,pt=Le.currentTarget;if(Le=Le.listener,Ne!==W&&N.isPropagationStopped())break e;bu(N,Le,pt),W=Ne}else for(he=0;he<A.length;he++){if(Le=A[he],Ne=Le.instance,pt=Le.currentTarget,Le=Le.listener,Ne!==W&&N.isPropagationStopped())break e;bu(N,Le,pt),W=Ne}}}if(vn)throw p=zn,vn=!1,zn=null,p}function ri(p,y){var T=y[Sc];T===void 0&&(T=y[Sc]=new Set);var A=p+"__bubble";T.has(A)||(_c(y,p,2,!1),T.add(A))}function Id(p,y,T){var A=0;y&&(A|=4),_c(T,p,A,y)}var kd="_reactListening"+Math.random().toString(36).slice(2);function vc(p){if(!p[kd]){p[kd]=!0,a.forEach(function(T){T!=="selectionchange"&&(wm.has(T)||Id(T,!1,p),Id(T,!0,p))});var y=p.nodeType===9?p:p.ownerDocument;y===null||y[kd]||(y[kd]=!0,Id("selectionchange",!1,y))}}function _c(p,y,T,A){switch(xl(y)){case 1:var N=qo;break;case 4:N=ac;break;default:N=zs}T=N.bind(null,y,T,p),N=void 0,!Vr||y!=="touchstart"&&y!=="touchmove"&&y!=="wheel"||(N=!0),A?N!==void 0?p.addEventListener(y,T,{capture:!0,passive:N}):p.addEventListener(y,T,!0):N!==void 0?p.addEventListener(y,T,{passive:N}):p.addEventListener(y,T,!1)}function xc(p,y,T,A,N){var W=A;if((y&1)===0&&(y&2)===0&&A!==null)e:for(;;){if(A===null)return;var he=A.tag;if(he===3||he===4){var Le=A.stateNode.containerInfo;if(Le===N||Le.nodeType===8&&Le.parentNode===N)break;if(he===4)for(he=A.return;he!==null;){var Ne=he.tag;if((Ne===3||Ne===4)&&(Ne=he.stateNode.containerInfo,Ne===N||Ne.nodeType===8&&Ne.parentNode===N))return;he=he.return}for(;Le!==null;){if(he=$s(Le),he===null)return;if(Ne=he.tag,Ne===5||Ne===6){A=W=he;continue e}Le=Le.parentNode}}A=A.return}Xr(function(){var pt=W,Ot=qt(T),Lt=[];e:{var zt=Qf.get(p);if(zt!==void 0){var lr=ra,pr=p;switch(p){case"keypress":if(Oa(T)===0)break e;case"keydown":case"keyup":lr=Li;break;case"focusin":pr="focus",lr=cc;break;case"focusout":pr="blur",lr=cc;break;case"beforeblur":case"afterblur":lr=cc;break;case"click":if(T.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":lr=Ls;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":lr=lc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":lr=dc;break;case Ch:case Th:case xu:lr=fm;break;case Mh:lr=pd;break;case"scroll":lr=mh;break;case"wheel":lr=mu;break;case"copy":case"cut":case"paste":lr=pm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":lr=hc}var gr=(y&4)!==0,Ri=!gr&&p==="scroll",lt=gr?zt!==null?zt+"Capture":null:zt;gr=[];for(var We=pt,dt;We!==null;){dt=We;var Vt=dt.stateNode;if(dt.tag===5&&Vt!==null&&(dt=Vt,lt!==null&&(Vt=zr(We,lt),Vt!=null&&gr.push(Cl(We,Vt,dt)))),Ri)break;We=We.return}0<gr.length&&(zt=new lr(zt,pr,null,T,Ot),Lt.push({event:zt,listeners:gr}))}}if((y&7)===0){e:{if(zt=p==="mouseover"||p==="pointerover",lr=p==="mouseout"||p==="pointerout",zt&&T!==$t&&(pr=T.relatedTarget||T.fromElement)&&($s(pr)||pr[ys]))break e;if((lr||zt)&&(zt=Ot.window===Ot?Ot:(zt=Ot.ownerDocument)?zt.defaultView||zt.parentWindow:window,lr?(pr=T.relatedTarget||T.toElement,lr=pt,pr=pr?$s(pr):null,pr!==null&&(Ri=ot(pr),pr!==Ri||pr.tag!==5&&pr.tag!==6)&&(pr=null)):(lr=null,pr=pt),lr!==pr)){if(gr=Ls,Vt="onMouseLeave",lt="onMouseEnter",We="mouse",(p==="pointerout"||p==="pointerover")&&(gr=hc,Vt="onPointerLeave",lt="onPointerEnter",We="pointer"),Ri=lr==null?zt:Ns(lr),dt=pr==null?zt:Ns(pr),zt=new gr(Vt,We+"leave",lr,T,Ot),zt.target=Ri,zt.relatedTarget=dt,Vt=null,$s(Ot)===pt&&(gr=new gr(lt,We+"enter",pr,T,Ot),gr.target=dt,gr.relatedTarget=Ri,Vt=gr),Ri=Vt,lr&&pr)t:{for(gr=lr,lt=pr,We=0,dt=gr;dt;dt=Tl(dt))We++;for(dt=0,Vt=lt;Vt;Vt=Tl(Vt))dt++;for(;0<We-dt;)gr=Tl(gr),We--;for(;0<dt-We;)lt=Tl(lt),dt--;for(;We--;){if(gr===lt||lt!==null&&gr===lt.alternate)break t;gr=Tl(gr),lt=Tl(lt)}gr=null}else gr=null;lr!==null&&Ih(Lt,zt,lr,gr,!1),pr!==null&&Ri!==null&&Ih(Lt,Ri,pr,gr,!0)}}e:{if(zt=pt?Ns(pt):window,lr=zt.nodeName&&zt.nodeName.toLowerCase(),lr==="select"||lr==="input"&&zt.type==="file")var vr=vm;else if(Zf(zt))if(_d)vr=fc;else{vr=Kf;var Er=Xf}else(lr=zt.nodeName)&&lr.toLowerCase()==="input"&&(zt.type==="checkbox"||zt.type==="radio")&&(vr=wd);if(vr&&(vr=vr(p,pt))){_h(Lt,vr,T,Ot);break e}Er&&Er(p,zt,pt),p==="focusout"&&(Er=zt._wrapperState)&&Er.controlled&&zt.type==="number"&&Cr(zt,"number",zt.value)}switch(Er=pt?Ns(pt):window,p){case"focusin":(Zf(Er)||Er.contentEditable==="true")&&(La=Er,Sh=pt,Bs=null);break;case"focusout":Bs=Sh=La=null;break;case"mousedown":pc=!0;break;case"contextmenu":case"mouseup":case"dragend":pc=!1,mc(Lt,T,Ot);break;case"selectionchange":if(Cd)break;case"keydown":case"keyup":mc(Lt,T,Ot)}var Ar;if(gd)e:{switch(p){case"compositionstart":var $r="onCompositionStart";break e;case"compositionend":$r="onCompositionEnd";break e;case"compositionupdate":$r="onCompositionUpdate";break e}$r=void 0}else ms?qf(p,T)&&($r="onCompositionEnd"):p==="keydown"&&T.keyCode===229&&($r="onCompositionStart");$r&&(yd&&T.locale!=="ko"&&(ms||$r!=="onCompositionStart"?$r==="onCompositionEnd"&&ms&&(Ar=Br()):(sn=Ot,bl="value"in sn?sn.value:sn.textContent,ms=!0)),Er=wu(pt,$r),0<Er.length&&($r=new uc($r,p,null,T,Ot),Lt.push({event:$r,listeners:Er}),Ar?$r.data=Ar:(Ar=Hf(T),Ar!==null&&($r.data=Ar)))),(Ar=Uf?gm(p,T):Wf(p,T))&&(pt=wu(pt,"onBeforeInput"),0<pt.length&&(Ot=new uc("onBeforeInput","beforeinput",null,T,Ot),Lt.push({event:Ot,listeners:pt}),Ot.data=Ar))}Sm(Lt,y)})}function Cl(p,y,T){return{instance:p,listener:y,currentTarget:T}}function wu(p,y){for(var T=y+"Capture",A=[];p!==null;){var N=p,W=N.stateNode;N.tag===5&&W!==null&&(N=W,W=zr(p,T),W!=null&&A.unshift(Cl(p,W,N)),W=zr(p,y),W!=null&&A.push(Cl(p,W,N))),p=p.return}return A}function Tl(p){if(p===null)return null;do p=p.return;while(p&&p.tag!==5);return p||null}function Ih(p,y,T,A,N){for(var W=y._reactName,he=[];T!==null&&T!==A;){var Le=T,Ne=Le.alternate,pt=Le.stateNode;if(Ne!==null&&Ne===A)break;Le.tag===5&&pt!==null&&(Le=pt,N?(Ne=zr(T,W),Ne!=null&&he.unshift(Cl(T,Ne,Le))):N||(Ne=zr(T,W),Ne!=null&&he.push(Cl(T,Ne,Le)))),T=T.return}he.length!==0&&p.push({event:y,listeners:he})}var Ad=/\r\n?/g,Ml=/\u0000|\uFFFD/g;function Pl(p){return(typeof p=="string"?p:""+p).replace(Ad,`
`).replace(Ml,"")}function Su(p,y,T){if(y=Pl(y),Pl(p)!==y&&T)throw Error(i(425))}function Rd(){}var bc=null,ep=null;function Dd(p,y){return p==="textarea"||p==="noscript"||typeof y.children=="string"||typeof y.children=="number"||typeof y.dangerouslySetInnerHTML=="object"&&y.dangerouslySetInnerHTML!==null&&y.dangerouslySetInnerHTML.__html!=null}var wc=typeof setTimeout=="function"?setTimeout:void 0,zd=typeof clearTimeout=="function"?clearTimeout:void 0,tp=typeof Promise=="function"?Promise:void 0,Cm=typeof queueMicrotask=="function"?queueMicrotask:typeof tp<"u"?function(p){return tp.resolve(null).then(p).catch(kh)}:wc;function kh(p){setTimeout(function(){throw p})}function Cu(p,y){var T=y,A=0;do{var N=T.nextSibling;if(p.removeChild(T),N&&N.nodeType===8)if(T=N.data,T==="/$"){if(A===0){p.removeChild(N),Ds(y);return}A--}else T!=="$"&&T!=="$?"&&T!=="$!"||A++;T=N}while(T);Ds(y)}function Fa(p){for(;p!=null;p=p.nextSibling){var y=p.nodeType;if(y===1||y===3)break;if(y===8){if(y=p.data,y==="$"||y==="$!"||y==="$?")break;if(y==="/$")return null}}return p}function rp(p){p=p.previousSibling;for(var y=0;p;){if(p.nodeType===8){var T=p.data;if(T==="$"||T==="$!"||T==="$?"){if(y===0)return p;y--}else T==="/$"&&y++}p=p.previousSibling}return null}var On=Math.random().toString(36).slice(2),wo="__reactFiber$"+On,po="__reactProps$"+On,ys="__reactContainer$"+On,Sc="__reactEvents$"+On,Od="__reactListeners$"+On,El="__reactHandles$"+On;function $s(p){var y=p[wo];if(y)return y;for(var T=p.parentNode;T;){if(y=T[ys]||T[wo]){if(T=y.alternate,y.child!==null||T!==null&&T.child!==null)for(p=rp(p);p!==null;){if(T=p[wo])return T;p=rp(p)}return y}p=T,T=p.parentNode}return null}function js(p){return p=p[wo]||p[ys],!p||p.tag!==5&&p.tag!==6&&p.tag!==13&&p.tag!==3?null:p}function Ns(p){if(p.tag===5||p.tag===6)return p.stateNode;throw Error(i(33))}function Ah(p){return p[po]||null}var Ld=[],Cc=-1;function Ba(p){return{current:p}}function Hn(p){0>Cc||(p.current=Ld[Cc],Ld[Cc]=null,Cc--)}function pn(p,y){Cc++,Ld[Cc]=p.current,p.current=y}var ia={},to=Ba(ia),ro=Ba(!1),Il=ia;function kl(p,y){var T=p.type.contextTypes;if(!T)return ia;var A=p.stateNode;if(A&&A.__reactInternalMemoizedUnmaskedChildContext===y)return A.__reactInternalMemoizedMaskedChildContext;var N={},W;for(W in T)N[W]=y[W];return A&&(p=p.stateNode,p.__reactInternalMemoizedUnmaskedChildContext=y,p.__reactInternalMemoizedMaskedChildContext=N),N}function So(p){return p=p.childContextTypes,p!=null}function Rh(){Hn(ro),Hn(to)}function Fd(p,y,T){if(to.current!==ia)throw Error(i(168));pn(to,y),pn(ro,T)}function Bd(p,y,T){var A=p.stateNode;if(y=y.childContextTypes,typeof A.getChildContext!="function")return T;A=A.getChildContext();for(var N in A)if(!(N in y))throw Error(i(108,St(p)||"Unknown",N));return ct({},T,A)}function Vs(p){return p=(p=p.stateNode)&&p.__reactInternalMemoizedMergedChildContext||ia,Il=to.current,pn(to,p),pn(ro,ro.current),!0}function np(p,y,T){var A=p.stateNode;if(!A)throw Error(i(169));T?(p=Bd(p,y,Il),A.__reactInternalMemoizedMergedChildContext=p,Hn(ro),Hn(to),pn(to,p)):Hn(ro),pn(ro,T)}var Fi=null,Ho=!1,$d=!1;function vs(p){Fi===null?Fi=[p]:Fi.push(p)}function sy(p){Ho=!0,vs(p)}function _s(){if(!$d&&Fi!==null){$d=!0;var p=0,y=fn;try{var T=Fi;for(fn=1;p<T.length;p++){var A=T[p];do A=A(!0);while(A!==null)}Fi=null,Ho=!1}catch(N){throw Fi!==null&&(Fi=Fi.slice(p+1)),An(Qs,_s),N}finally{fn=y,$d=!1}}return null}var oa=[],mi=0,Al=null,Dh=0,xs=[],bs=0,ws=null,Wo=1,qi="";function Ut(p,y){oa[mi++]=Dh,oa[mi++]=Al,Al=p,Dh=y}function zh(p,y,T){xs[bs++]=Wo,xs[bs++]=qi,xs[bs++]=ws,ws=p;var A=Wo;p=qi;var N=32-Ii(A)-1;A&=~(1<<N),T+=1;var W=32-Ii(y)+N;if(30<W){var he=N-N%5;W=(A&(1<<he)-1).toString(32),A>>=he,N-=he,Wo=1<<32-Ii(y)+N|T<<N|A,qi=W+p}else Wo=1<<W|T<<N|A,qi=p}function Oh(p){p.return!==null&&(Ut(p,1),zh(p,1,0))}function Rl(p){for(;p===Al;)Al=oa[--mi],oa[mi]=null,Dh=oa[--mi],oa[mi]=null;for(;p===ws;)ws=xs[--bs],xs[bs]=null,qi=xs[--bs],xs[bs]=null,Wo=xs[--bs],xs[bs]=null}var mo=null,go=null,Wn=!1,Lo=null;function jd(p,y){var T=ya(5,null,null,0);T.elementType="DELETED",T.stateNode=y,T.return=p,y=p.deletions,y===null?(p.deletions=[T],p.flags|=16):y.push(T)}function ip(p,y){switch(p.tag){case 5:var T=p.type;return y=y.nodeType!==1||T.toLowerCase()!==y.nodeName.toLowerCase()?null:y,y!==null?(p.stateNode=y,mo=p,go=Fa(y.firstChild),!0):!1;case 6:return y=p.pendingProps===""||y.nodeType!==3?null:y,y!==null?(p.stateNode=y,mo=p,go=null,!0):!1;case 13:return y=y.nodeType!==8?null:y,y!==null?(T=ws!==null?{id:Wo,overflow:qi}:null,p.memoizedState={dehydrated:y,treeContext:T,retryLane:1073741824},T=ya(18,null,null,0),T.stateNode=y,T.return=p,p.child=T,mo=p,go=null,!0):!1;default:return!1}}function Dl(p){return(p.mode&1)!==0&&(p.flags&128)===0}function op(p){if(Wn){var y=go;if(y){var T=y;if(!ip(p,y)){if(Dl(p))throw Error(i(418));y=Fa(T.nextSibling);var A=mo;y&&ip(p,y)?jd(A,T):(p.flags=p.flags&-4097|2,Wn=!1,mo=p)}}else{if(Dl(p))throw Error(i(418));p.flags=p.flags&-4097|2,Wn=!1,mo=p}}}function Lh(p){for(p=p.return;p!==null&&p.tag!==5&&p.tag!==3&&p.tag!==13;)p=p.return;mo=p}function Tc(p){if(p!==mo)return!1;if(!Wn)return Lh(p),Wn=!0,!1;var y;if((y=p.tag!==3)&&!(y=p.tag!==5)&&(y=p.type,y=y!=="head"&&y!=="body"&&!Dd(p.type,p.memoizedProps)),y&&(y=go)){if(Dl(p))throw sp(),Error(i(418));for(;y;)jd(p,y),y=Fa(y.nextSibling)}if(Lh(p),p.tag===13){if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));e:{for(p=p.nextSibling,y=0;p;){if(p.nodeType===8){var T=p.data;if(T==="/$"){if(y===0){go=Fa(p.nextSibling);break e}y--}else T!=="$"&&T!=="$!"&&T!=="$?"||y++}p=p.nextSibling}go=null}}else go=mo?Fa(p.stateNode.nextSibling):null;return!0}function sp(){for(var p=go;p;)p=Fa(p.nextSibling)}function zl(){go=mo=null,Wn=!1}function Nd(p){Lo===null?Lo=[p]:Lo.push(p)}var ap=de.ReactCurrentBatchConfig;function Mc(p,y,T){if(p=T.ref,p!==null&&typeof p!="function"&&typeof p!="object"){if(T._owner){if(T=T._owner,T){if(T.tag!==1)throw Error(i(309));var A=T.stateNode}if(!A)throw Error(i(147,p));var N=A,W=""+p;return y!==null&&y.ref!==null&&typeof y.ref=="function"&&y.ref._stringRef===W?y.ref:(y=function(he){var Le=N.refs;he===null?delete Le[W]:Le[W]=he},y._stringRef=W,y)}if(typeof p!="string")throw Error(i(284));if(!T._owner)throw Error(i(290,p))}return p}function Fh(p,y){throw p=Object.prototype.toString.call(y),Error(i(31,p==="[object Object]"?"object with keys {"+Object.keys(y).join(", ")+"}":p))}function $a(p){var y=p._init;return y(p._payload)}function Sn(p){function y(lt,We){if(p){var dt=lt.deletions;dt===null?(lt.deletions=[We],lt.flags|=16):dt.push(We)}}function T(lt,We){if(!p)return null;for(;We!==null;)y(lt,We),We=We.sibling;return null}function A(lt,We){for(lt=new Map;We!==null;)We.key!==null?lt.set(We.key,We):lt.set(We.index,We),We=We.sibling;return lt}function N(lt,We){return lt=jc(lt,We),lt.index=0,lt.sibling=null,lt}function W(lt,We,dt){return lt.index=dt,p?(dt=lt.alternate,dt!==null?(dt=dt.index,dt<We?(lt.flags|=2,We):dt):(lt.flags|=2,We)):(lt.flags|=1048576,We)}function he(lt){return p&&lt.alternate===null&&(lt.flags|=2),lt}function Le(lt,We,dt,Vt){return We===null||We.tag!==6?(We=Lm(dt,lt.mode,Vt),We.return=lt,We):(We=N(We,dt),We.return=lt,We)}function Ne(lt,We,dt,Vt){var vr=dt.type;return vr===xe?Ot(lt,We,dt.props.children,Vt,dt.key):We!==null&&(We.elementType===vr||typeof vr=="object"&&vr!==null&&vr.$$typeof===qe&&$a(vr)===We.type)?(Vt=N(We,dt.props),Vt.ref=Mc(lt,We,dt),Vt.return=lt,Vt):(Vt=sf(dt.type,dt.key,dt.props,null,lt.mode,Vt),Vt.ref=Mc(lt,We,dt),Vt.return=lt,Vt)}function pt(lt,We,dt,Vt){return We===null||We.tag!==4||We.stateNode.containerInfo!==dt.containerInfo||We.stateNode.implementation!==dt.implementation?(We=Sy(dt,lt.mode,Vt),We.return=lt,We):(We=N(We,dt.children||[]),We.return=lt,We)}function Ot(lt,We,dt,Vt,vr){return We===null||We.tag!==7?(We=$u(dt,lt.mode,Vt,vr),We.return=lt,We):(We=N(We,dt),We.return=lt,We)}function Lt(lt,We,dt){if(typeof We=="string"&&We!==""||typeof We=="number")return We=Lm(""+We,lt.mode,dt),We.return=lt,We;if(typeof We=="object"&&We!==null){switch(We.$$typeof){case oe:return dt=sf(We.type,We.key,We.props,null,lt.mode,dt),dt.ref=Mc(lt,null,We),dt.return=lt,dt;case be:return We=Sy(We,lt.mode,dt),We.return=lt,We;case qe:var Vt=We._init;return Lt(lt,Vt(We._payload),dt)}if(Rr(We)||je(We))return We=$u(We,lt.mode,dt,null),We.return=lt,We;Fh(lt,We)}return null}function zt(lt,We,dt,Vt){var vr=We!==null?We.key:null;if(typeof dt=="string"&&dt!==""||typeof dt=="number")return vr!==null?null:Le(lt,We,""+dt,Vt);if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case oe:return dt.key===vr?Ne(lt,We,dt,Vt):null;case be:return dt.key===vr?pt(lt,We,dt,Vt):null;case qe:return vr=dt._init,zt(lt,We,vr(dt._payload),Vt)}if(Rr(dt)||je(dt))return vr!==null?null:Ot(lt,We,dt,Vt,null);Fh(lt,dt)}return null}function lr(lt,We,dt,Vt,vr){if(typeof Vt=="string"&&Vt!==""||typeof Vt=="number")return lt=lt.get(dt)||null,Le(We,lt,""+Vt,vr);if(typeof Vt=="object"&&Vt!==null){switch(Vt.$$typeof){case oe:return lt=lt.get(Vt.key===null?dt:Vt.key)||null,Ne(We,lt,Vt,vr);case be:return lt=lt.get(Vt.key===null?dt:Vt.key)||null,pt(We,lt,Vt,vr);case qe:var Er=Vt._init;return lr(lt,We,dt,Er(Vt._payload),vr)}if(Rr(Vt)||je(Vt))return lt=lt.get(dt)||null,Ot(We,lt,Vt,vr,null);Fh(We,Vt)}return null}function pr(lt,We,dt,Vt){for(var vr=null,Er=null,Ar=We,$r=We=0,Po=null;Ar!==null&&$r<dt.length;$r++){Ar.index>$r?(Po=Ar,Ar=null):Po=Ar.sibling;var Cn=zt(lt,Ar,dt[$r],Vt);if(Cn===null){Ar===null&&(Ar=Po);break}p&&Ar&&Cn.alternate===null&&y(lt,Ar),We=W(Cn,We,$r),Er===null?vr=Cn:Er.sibling=Cn,Er=Cn,Ar=Po}if($r===dt.length)return T(lt,Ar),Wn&&Ut(lt,$r),vr;if(Ar===null){for(;$r<dt.length;$r++)Ar=Lt(lt,dt[$r],Vt),Ar!==null&&(We=W(Ar,We,$r),Er===null?vr=Ar:Er.sibling=Ar,Er=Ar);return Wn&&Ut(lt,$r),vr}for(Ar=A(lt,Ar);$r<dt.length;$r++)Po=lr(Ar,lt,$r,dt[$r],Vt),Po!==null&&(p&&Po.alternate!==null&&Ar.delete(Po.key===null?$r:Po.key),We=W(Po,We,$r),Er===null?vr=Po:Er.sibling=Po,Er=Po);return p&&Ar.forEach(function(ju){return y(lt,ju)}),Wn&&Ut(lt,$r),vr}function gr(lt,We,dt,Vt){var vr=je(dt);if(typeof vr!="function")throw Error(i(150));if(dt=vr.call(dt),dt==null)throw Error(i(151));for(var Er=vr=null,Ar=We,$r=We=0,Po=null,Cn=dt.next();Ar!==null&&!Cn.done;$r++,Cn=dt.next()){Ar.index>$r?(Po=Ar,Ar=null):Po=Ar.sibling;var ju=zt(lt,Ar,Cn.value,Vt);if(ju===null){Ar===null&&(Ar=Po);break}p&&Ar&&ju.alternate===null&&y(lt,Ar),We=W(ju,We,$r),Er===null?vr=ju:Er.sibling=ju,Er=ju,Ar=Po}if(Cn.done)return T(lt,Ar),Wn&&Ut(lt,$r),vr;if(Ar===null){for(;!Cn.done;$r++,Cn=dt.next())Cn=Lt(lt,Cn.value,Vt),Cn!==null&&(We=W(Cn,We,$r),Er===null?vr=Cn:Er.sibling=Cn,Er=Cn);return Wn&&Ut(lt,$r),vr}for(Ar=A(lt,Ar);!Cn.done;$r++,Cn=dt.next())Cn=lr(Ar,lt,$r,Cn.value,Vt),Cn!==null&&(p&&Cn.alternate!==null&&Ar.delete(Cn.key===null?$r:Cn.key),We=W(Cn,We,$r),Er===null?vr=Cn:Er.sibling=Cn,Er=Cn);return p&&Ar.forEach(function(N0){return y(lt,N0)}),Wn&&Ut(lt,$r),vr}function Ri(lt,We,dt,Vt){if(typeof dt=="object"&&dt!==null&&dt.type===xe&&dt.key===null&&(dt=dt.props.children),typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case oe:e:{for(var vr=dt.key,Er=We;Er!==null;){if(Er.key===vr){if(vr=dt.type,vr===xe){if(Er.tag===7){T(lt,Er.sibling),We=N(Er,dt.props.children),We.return=lt,lt=We;break e}}else if(Er.elementType===vr||typeof vr=="object"&&vr!==null&&vr.$$typeof===qe&&$a(vr)===Er.type){T(lt,Er.sibling),We=N(Er,dt.props),We.ref=Mc(lt,Er,dt),We.return=lt,lt=We;break e}T(lt,Er);break}else y(lt,Er);Er=Er.sibling}dt.type===xe?(We=$u(dt.props.children,lt.mode,Vt,dt.key),We.return=lt,lt=We):(Vt=sf(dt.type,dt.key,dt.props,null,lt.mode,Vt),Vt.ref=Mc(lt,We,dt),Vt.return=lt,lt=Vt)}return he(lt);case be:e:{for(Er=dt.key;We!==null;){if(We.key===Er)if(We.tag===4&&We.stateNode.containerInfo===dt.containerInfo&&We.stateNode.implementation===dt.implementation){T(lt,We.sibling),We=N(We,dt.children||[]),We.return=lt,lt=We;break e}else{T(lt,We);break}else y(lt,We);We=We.sibling}We=Sy(dt,lt.mode,Vt),We.return=lt,lt=We}return he(lt);case qe:return Er=dt._init,Ri(lt,We,Er(dt._payload),Vt)}if(Rr(dt))return pr(lt,We,dt,Vt);if(je(dt))return gr(lt,We,dt,Vt);Fh(lt,dt)}return typeof dt=="string"&&dt!==""||typeof dt=="number"?(dt=""+dt,We!==null&&We.tag===6?(T(lt,We.sibling),We=N(We,dt),We.return=lt,lt=We):(T(lt,We),We=Lm(dt,lt.mode,Vt),We.return=lt,lt=We),he(lt)):T(lt,We)}return Ri}var Tu=Sn(!0),Mu=Sn(!1),Pc=Ba(null),Ec=null,Ol=null,Vd=null;function Ud(){Vd=Ol=Ec=null}function Gd(p){var y=Pc.current;Hn(Pc),p._currentValue=y}function as(p,y,T){for(;p!==null;){var A=p.alternate;if((p.childLanes&y)!==y?(p.childLanes|=y,A!==null&&(A.childLanes|=y)):A!==null&&(A.childLanes&y)!==y&&(A.childLanes|=y),p===T)break;p=p.return}}function sa(p,y){Ec=p,Vd=Ol=null,p=p.dependencies,p!==null&&p.firstContext!==null&&((p.lanes&y)!==0&&(Bo=!0),p.firstContext=null)}function Xt(p){var y=p._currentValue;if(Vd!==p)if(p={context:p,memoizedValue:y,next:null},Ol===null){if(Ec===null)throw Error(i(308));Ol=p,Ec.dependencies={lanes:0,firstContext:p}}else Ol=Ol.next=p;return y}var cr=null;function Ic(p){cr===null?cr=[p]:cr.push(p)}function Bh(p,y,T,A){var N=y.interleaved;return N===null?(T.next=T,Ic(y)):(T.next=N.next,N.next=T),y.interleaved=T,Ss(p,A)}function Ss(p,y){p.lanes|=y;var T=p.alternate;for(T!==null&&(T.lanes|=y),T=p,p=p.return;p!==null;)p.childLanes|=y,T=p.alternate,T!==null&&(T.childLanes|=y),T=p,p=p.return;return T.tag===3?T.stateNode:null}var Ti=!1;function Zo(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qd(p,y){p=p.updateQueue,y.updateQueue===p&&(y.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,effects:p.effects})}function aa(p,y){return{eventTime:p,lane:y,tag:0,payload:null,callback:null,next:null}}function Ll(p,y,T){var A=p.updateQueue;if(A===null)return null;if(A=A.shared,(bn&2)!==0){var N=A.pending;return N===null?y.next=y:(y.next=N.next,N.next=y),A.pending=y,Ss(p,T)}return N=A.interleaved,N===null?(y.next=y,Ic(A)):(y.next=N.next,N.next=y),A.interleaved=y,Ss(p,T)}function Hd(p,y,T){if(y=y.updateQueue,y!==null&&(y=y.shared,(T&4194240)!==0)){var A=y.lanes;A&=p.pendingLanes,T|=A,y.lanes=T,Ff(p,T)}}function Pu(p,y){var T=p.updateQueue,A=p.alternate;if(A!==null&&(A=A.updateQueue,T===A)){var N=null,W=null;if(T=T.firstBaseUpdate,T!==null){do{var he={eventTime:T.eventTime,lane:T.lane,tag:T.tag,payload:T.payload,callback:T.callback,next:null};W===null?N=W=he:W=W.next=he,T=T.next}while(T!==null);W===null?N=W=y:W=W.next=y}else N=W=y;T={baseState:A.baseState,firstBaseUpdate:N,lastBaseUpdate:W,shared:A.shared,effects:A.effects},p.updateQueue=T;return}p=T.lastBaseUpdate,p===null?T.firstBaseUpdate=y:p.next=y,T.lastBaseUpdate=y}function Ln(p,y,T,A){var N=p.updateQueue;Ti=!1;var W=N.firstBaseUpdate,he=N.lastBaseUpdate,Le=N.shared.pending;if(Le!==null){N.shared.pending=null;var Ne=Le,pt=Ne.next;Ne.next=null,he===null?W=pt:he.next=pt,he=Ne;var Ot=p.alternate;Ot!==null&&(Ot=Ot.updateQueue,Le=Ot.lastBaseUpdate,Le!==he&&(Le===null?Ot.firstBaseUpdate=pt:Le.next=pt,Ot.lastBaseUpdate=Ne))}if(W!==null){var Lt=N.baseState;he=0,Ot=pt=Ne=null,Le=W;do{var zt=Le.lane,lr=Le.eventTime;if((A&zt)===zt){Ot!==null&&(Ot=Ot.next={eventTime:lr,lane:0,tag:Le.tag,payload:Le.payload,callback:Le.callback,next:null});e:{var pr=p,gr=Le;switch(zt=y,lr=T,gr.tag){case 1:if(pr=gr.payload,typeof pr=="function"){Lt=pr.call(lr,Lt,zt);break e}Lt=pr;break e;case 3:pr.flags=pr.flags&-65537|128;case 0:if(pr=gr.payload,zt=typeof pr=="function"?pr.call(lr,Lt,zt):pr,zt==null)break e;Lt=ct({},Lt,zt);break e;case 2:Ti=!0}}Le.callback!==null&&Le.lane!==0&&(p.flags|=64,zt=N.effects,zt===null?N.effects=[Le]:zt.push(Le))}else lr={eventTime:lr,lane:zt,tag:Le.tag,payload:Le.payload,callback:Le.callback,next:null},Ot===null?(pt=Ot=lr,Ne=Lt):Ot=Ot.next=lr,he|=zt;if(Le=Le.next,Le===null){if(Le=N.shared.pending,Le===null)break;zt=Le,Le=zt.next,zt.next=null,N.lastBaseUpdate=zt,N.shared.pending=null}}while(!0);if(Ot===null&&(Ne=Lt),N.baseState=Ne,N.firstBaseUpdate=pt,N.lastBaseUpdate=Ot,y=N.shared.interleaved,y!==null){N=y;do he|=N.lane,N=N.next;while(N!==y)}else W===null&&(N.shared.lanes=0);Au|=he,p.lanes=he,p.memoizedState=Lt}}function gi(p,y,T){if(p=y.effects,y.effects=null,p!==null)for(y=0;y<p.length;y++){var A=p[y],N=A.callback;if(N!==null){if(A.callback=null,A=T,typeof N!="function")throw Error(i(191,N));N.call(A)}}}var Us={},Xo=Ba(Us),Fl=Ba(Us),kc=Ba(Us);function la(p){if(p===Us)throw Error(i(174));return p}function $h(p,y){switch(pn(kc,y),pn(Fl,p),pn(Xo,Us),p=y.nodeType,p){case 9:case 11:y=(y=y.documentElement)?y.namespaceURI:ae(null,"");break;default:p=p===8?y.parentNode:y,y=p.namespaceURI||null,p=p.tagName,y=ae(y,p)}Hn(Xo),pn(Xo,y)}function ca(){Hn(Xo),Hn(Fl),Hn(kc)}function ua(p){la(kc.current);var y=la(Xo.current),T=ae(y,p.type);y!==T&&(pn(Fl,p),pn(Xo,T))}function Eu(p){Fl.current===p&&(Hn(Xo),Hn(Fl))}var Fn=Ba(0);function Ac(p){for(var y=p;y!==null;){if(y.tag===13){var T=y.memoizedState;if(T!==null&&(T=T.dehydrated,T===null||T.data==="$?"||T.data==="$!"))return y}else if(y.tag===19&&y.memoizedProps.revealOrder!==void 0){if((y.flags&128)!==0)return y}else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===p)break;for(;y.sibling===null;){if(y.return===null||y.return===p)return null;y=y.return}y.sibling.return=y.return,y=y.sibling}return null}var Rc=[];function jh(){for(var p=0;p<Rc.length;p++)Rc[p]._workInProgressVersionPrimary=null;Rc.length=0}var ja=de.ReactCurrentDispatcher,Na=de.ReactCurrentBatchConfig,Va=0,Bn=null,ni=null,Bi=null,Dc=!1,Bl=!1,zc=0,w=0;function n(){throw Error(i(321))}function u(p,y){if(y===null)return!1;for(var T=0;T<y.length&&T<p.length;T++)if(!Fs(p[T],y[T]))return!1;return!0}function m(p,y,T,A,N,W){if(Va=W,Bn=y,y.memoizedState=null,y.updateQueue=null,y.lanes=0,ja.current=p===null||p.memoizedState===null?ii:no,p=T(A,N),Bl){W=0;do{if(Bl=!1,zc=0,25<=W)throw Error(i(301));W+=1,Bi=ni=null,y.updateQueue=null,ja.current=ki,p=T(A,N)}while(Bl)}if(ja.current=Kn,y=ni!==null&&ni.next!==null,Va=0,Bi=ni=Bn=null,Dc=!1,y)throw Error(i(300));return p}function v(){var p=zc!==0;return zc=0,p}function S(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bi===null?Bn.memoizedState=Bi=p:Bi=Bi.next=p,Bi}function M(){if(ni===null){var p=Bn.alternate;p=p!==null?p.memoizedState:null}else p=ni.next;var y=Bi===null?Bn.memoizedState:Bi.next;if(y!==null)Bi=y,ni=p;else{if(p===null)throw Error(i(310));ni=p,p={memoizedState:ni.memoizedState,baseState:ni.baseState,baseQueue:ni.baseQueue,queue:ni.queue,next:null},Bi===null?Bn.memoizedState=Bi=p:Bi=Bi.next=p}return Bi}function k(p,y){return typeof y=="function"?y(p):y}function O(p){var y=M(),T=y.queue;if(T===null)throw Error(i(311));T.lastRenderedReducer=p;var A=ni,N=A.baseQueue,W=T.pending;if(W!==null){if(N!==null){var he=N.next;N.next=W.next,W.next=he}A.baseQueue=N=W,T.pending=null}if(N!==null){W=N.next,A=A.baseState;var Le=he=null,Ne=null,pt=W;do{var Ot=pt.lane;if((Va&Ot)===Ot)Ne!==null&&(Ne=Ne.next={lane:0,action:pt.action,hasEagerState:pt.hasEagerState,eagerState:pt.eagerState,next:null}),A=pt.hasEagerState?pt.eagerState:p(A,pt.action);else{var Lt={lane:Ot,action:pt.action,hasEagerState:pt.hasEagerState,eagerState:pt.eagerState,next:null};Ne===null?(Le=Ne=Lt,he=A):Ne=Ne.next=Lt,Bn.lanes|=Ot,Au|=Ot}pt=pt.next}while(pt!==null&&pt!==W);Ne===null?he=A:Ne.next=Le,Fs(A,y.memoizedState)||(Bo=!0),y.memoizedState=A,y.baseState=he,y.baseQueue=Ne,T.lastRenderedState=A}if(p=T.interleaved,p!==null){N=p;do W=N.lane,Bn.lanes|=W,Au|=W,N=N.next;while(N!==p)}else N===null&&(T.lanes=0);return[y.memoizedState,T.dispatch]}function B(p){var y=M(),T=y.queue;if(T===null)throw Error(i(311));T.lastRenderedReducer=p;var A=T.dispatch,N=T.pending,W=y.memoizedState;if(N!==null){T.pending=null;var he=N=N.next;do W=p(W,he.action),he=he.next;while(he!==N);Fs(W,y.memoizedState)||(Bo=!0),y.memoizedState=W,y.baseQueue===null&&(y.baseState=W),T.lastRenderedState=W}return[W,A]}function q(){}function Y(p,y){var T=Bn,A=M(),N=y(),W=!Fs(A.memoizedState,N);if(W&&(A.memoizedState=N,Bo=!0),A=A.queue,Ae(ce.bind(null,T,A,p),[p]),A.getSnapshot!==y||W||Bi!==null&&Bi.memoizedState.tag&1){if(T.flags|=2048,Se(9,te.bind(null,T,A,N,y),void 0,null),Mo===null)throw Error(i(349));(Va&30)!==0||X(T,y,N)}return N}function X(p,y,T){p.flags|=16384,p={getSnapshot:y,value:T},y=Bn.updateQueue,y===null?(y={lastEffect:null,stores:null},Bn.updateQueue=y,y.stores=[p]):(T=y.stores,T===null?y.stores=[p]:T.push(p))}function te(p,y,T,A){y.value=T,y.getSnapshot=A,ge(y)&&_e(p)}function ce(p,y,T){return T(function(){ge(y)&&_e(p)})}function ge(p){var y=p.getSnapshot;p=p.value;try{var T=y();return!Fs(p,T)}catch{return!0}}function _e(p){var y=Ss(p,1);y!==null&&Xa(y,p,1,-1)}function ve(p){var y=S();return typeof p=="function"&&(p=p()),y.memoizedState=y.baseState=p,p={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:k,lastRenderedState:p},y.queue=p,p=p.dispatch=Zn.bind(null,Bn,p),[y.memoizedState,p]}function Se(p,y,T,A){return p={tag:p,create:y,destroy:T,deps:A,next:null},y=Bn.updateQueue,y===null?(y={lastEffect:null,stores:null},Bn.updateQueue=y,y.lastEffect=p.next=p):(T=y.lastEffect,T===null?y.lastEffect=p.next=p:(A=T.next,T.next=p,p.next=A,y.lastEffect=p)),p}function Oe(){return M().memoizedState}function Ce(p,y,T,A){var N=S();Bn.flags|=p,N.memoizedState=Se(1|y,T,void 0,A===void 0?null:A)}function De(p,y,T,A){var N=M();A=A===void 0?null:A;var W=void 0;if(ni!==null){var he=ni.memoizedState;if(W=he.destroy,A!==null&&u(A,he.deps)){N.memoizedState=Se(y,T,W,A);return}}Bn.flags|=p,N.memoizedState=Se(1|y,T,W,A)}function Be(p,y){return Ce(8390656,8,p,y)}function Ae(p,y){return De(2048,8,p,y)}function Ue(p,y){return De(4,2,p,y)}function ut(p,y){return De(4,4,p,y)}function it(p,y){if(typeof y=="function")return p=p(),y(p),function(){y(null)};if(y!=null)return p=p(),y.current=p,function(){y.current=null}}function st(p,y,T){return T=T!=null?T.concat([p]):null,De(4,4,it.bind(null,y,p),T)}function at(){}function Rt(p,y){var T=M();y=y===void 0?null:y;var A=T.memoizedState;return A!==null&&y!==null&&u(y,A[1])?A[0]:(T.memoizedState=[p,y],p)}function Dt(p,y){var T=M();y=y===void 0?null:y;var A=T.memoizedState;return A!==null&&y!==null&&u(y,A[1])?A[0]:(p=p(),T.memoizedState=[p,y],p)}function Tt(p,y,T){return(Va&21)===0?(p.baseState&&(p.baseState=!1,Bo=!0),p.memoizedState=T):(Fs(T,y)||(T=hd(),Bn.lanes|=T,Au|=T,p.baseState=!0),y)}function Nt(p,y){var T=fn;fn=T!==0&&4>T?T:4,p(!0);var A=Na.transition;Na.transition={};try{p(!1),y()}finally{fn=T,Na.transition=A}}function kr(){return M().memoizedState}function xn(p,y,T){var A=Ms(p);if(T={lane:A,action:T,hasEagerState:!1,eagerState:null,next:null},Pn(p))Xn(y,T);else if(T=Bh(p,y,T,A),T!==null){var N=Qo();Xa(T,p,A,N),En(T,y,A)}}function Zn(p,y,T){var A=Ms(p),N={lane:A,action:T,hasEagerState:!1,eagerState:null,next:null};if(Pn(p))Xn(y,N);else{var W=p.alternate;if(p.lanes===0&&(W===null||W.lanes===0)&&(W=y.lastRenderedReducer,W!==null))try{var he=y.lastRenderedState,Le=W(he,T);if(N.hasEagerState=!0,N.eagerState=Le,Fs(Le,he)){var Ne=y.interleaved;Ne===null?(N.next=N,Ic(y)):(N.next=Ne.next,Ne.next=N),y.interleaved=N;return}}catch{}finally{}T=Bh(p,y,N,A),T!==null&&(N=Qo(),Xa(T,p,A,N),En(T,y,A))}}function Pn(p){var y=p.alternate;return p===Bn||y!==null&&y===Bn}function Xn(p,y){Bl=Dc=!0;var T=p.pending;T===null?y.next=y:(y.next=T.next,T.next=y),p.pending=y}function En(p,y,T){if((T&4194240)!==0){var A=y.lanes;A&=p.pendingLanes,T|=A,y.lanes=T,Ff(p,T)}}var Kn={readContext:Xt,useCallback:n,useContext:n,useEffect:n,useImperativeHandle:n,useInsertionEffect:n,useLayoutEffect:n,useMemo:n,useReducer:n,useRef:n,useState:n,useDebugValue:n,useDeferredValue:n,useTransition:n,useMutableSource:n,useSyncExternalStore:n,useId:n,unstable_isNewReconciler:!1},ii={readContext:Xt,useCallback:function(p,y){return S().memoizedState=[p,y===void 0?null:y],p},useContext:Xt,useEffect:Be,useImperativeHandle:function(p,y,T){return T=T!=null?T.concat([p]):null,Ce(4194308,4,it.bind(null,y,p),T)},useLayoutEffect:function(p,y){return Ce(4194308,4,p,y)},useInsertionEffect:function(p,y){return Ce(4,2,p,y)},useMemo:function(p,y){var T=S();return y=y===void 0?null:y,p=p(),T.memoizedState=[p,y],p},useReducer:function(p,y,T){var A=S();return y=T!==void 0?T(y):y,A.memoizedState=A.baseState=y,p={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:y},A.queue=p,p=p.dispatch=xn.bind(null,Bn,p),[A.memoizedState,p]},useRef:function(p){var y=S();return p={current:p},y.memoizedState=p},useState:ve,useDebugValue:at,useDeferredValue:function(p){return S().memoizedState=p},useTransition:function(){var p=ve(!1),y=p[0];return p=Nt.bind(null,p[1]),S().memoizedState=p,[y,p]},useMutableSource:function(){},useSyncExternalStore:function(p,y,T){var A=Bn,N=S();if(Wn){if(T===void 0)throw Error(i(407));T=T()}else{if(T=y(),Mo===null)throw Error(i(349));(Va&30)!==0||X(A,y,T)}N.memoizedState=T;var W={value:T,getSnapshot:y};return N.queue=W,Be(ce.bind(null,A,W,p),[p]),A.flags|=2048,Se(9,te.bind(null,A,W,T,y),void 0,null),T},useId:function(){var p=S(),y=Mo.identifierPrefix;if(Wn){var T=qi,A=Wo;T=(A&~(1<<32-Ii(A)-1)).toString(32)+T,y=":"+y+"R"+T,T=zc++,0<T&&(y+="H"+T.toString(32)),y+=":"}else T=w++,y=":"+y+"r"+T.toString(32)+":";return p.memoizedState=y},unstable_isNewReconciler:!1},no={readContext:Xt,useCallback:Rt,useContext:Xt,useEffect:Ae,useImperativeHandle:st,useInsertionEffect:Ue,useLayoutEffect:ut,useMemo:Dt,useReducer:O,useRef:Oe,useState:function(){return O(k)},useDebugValue:at,useDeferredValue:function(p){var y=M();return Tt(y,ni.memoizedState,p)},useTransition:function(){var p=O(k)[0],y=M().memoizedState;return[p,y]},useMutableSource:q,useSyncExternalStore:Y,useId:kr,unstable_isNewReconciler:!1},ki={readContext:Xt,useCallback:Rt,useContext:Xt,useEffect:Ae,useImperativeHandle:st,useInsertionEffect:Ue,useLayoutEffect:ut,useMemo:Dt,useReducer:B,useRef:Oe,useState:function(){return B(k)},useDebugValue:at,useDeferredValue:function(p){var y=M();return ni===null?y.memoizedState=p:Tt(y,ni.memoizedState,p)},useTransition:function(){var p=B(k)[0],y=M().memoizedState;return[p,y]},useMutableSource:q,useSyncExternalStore:Y,useId:kr,unstable_isNewReconciler:!1};function yn(p,y){if(p&&p.defaultProps){y=ct({},y),p=p.defaultProps;for(var T in p)y[T]===void 0&&(y[T]=p[T]);return y}return y}function Hi(p,y,T,A){y=p.memoizedState,T=T(A,y),T=T==null?y:ct({},y,T),p.memoizedState=T,p.lanes===0&&(p.updateQueue.baseState=T)}var Gs={isMounted:function(p){return(p=p._reactInternals)?ot(p)===p:!1},enqueueSetState:function(p,y,T){p=p._reactInternals;var A=Qo(),N=Ms(p),W=aa(A,N);W.payload=y,T!=null&&(W.callback=T),y=Ll(p,W,N),y!==null&&(Xa(y,p,N,A),Hd(y,p,N))},enqueueReplaceState:function(p,y,T){p=p._reactInternals;var A=Qo(),N=Ms(p),W=aa(A,N);W.tag=1,W.payload=y,T!=null&&(W.callback=T),y=Ll(p,W,N),y!==null&&(Xa(y,p,N,A),Hd(y,p,N))},enqueueForceUpdate:function(p,y){p=p._reactInternals;var T=Qo(),A=Ms(p),N=aa(T,A);N.tag=2,y!=null&&(N.callback=y),y=Ll(p,N,A),y!==null&&(Xa(y,p,A,T),Hd(y,p,A))}};function ha(p,y,T,A,N,W,he){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(A,W,he):y.prototype&&y.prototype.isPureReactComponent?!_u(T,A)||!_u(N,W):!0}function qs(p,y,T){var A=!1,N=ia,W=y.contextType;return typeof W=="object"&&W!==null?W=Xt(W):(N=So(y)?Il:to.current,A=y.contextTypes,W=(A=A!=null)?kl(p,N):ia),y=new y(T,W),p.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Gs,p.stateNode=y,y._reactInternals=p,A&&(p=p.stateNode,p.__reactInternalMemoizedUnmaskedChildContext=N,p.__reactInternalMemoizedMaskedChildContext=W),y}function Fo(p,y,T,A){p=y.state,typeof y.componentWillReceiveProps=="function"&&y.componentWillReceiveProps(T,A),typeof y.UNSAFE_componentWillReceiveProps=="function"&&y.UNSAFE_componentWillReceiveProps(T,A),y.state!==p&&Gs.enqueueReplaceState(y,y.state,null)}function Ua(p,y,T,A){var N=p.stateNode;N.props=T,N.state=p.memoizedState,N.refs={},Zo(p);var W=y.contextType;typeof W=="object"&&W!==null?N.context=Xt(W):(W=So(y)?Il:to.current,N.context=kl(p,W)),N.state=p.memoizedState,W=y.getDerivedStateFromProps,typeof W=="function"&&(Hi(p,y,W,T),N.state=p.memoizedState),typeof y.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(y=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),y!==N.state&&Gs.enqueueReplaceState(N,N.state,null),Ln(p,T,N,A),N.state=p.memoizedState),typeof N.componentDidMount=="function"&&(p.flags|=4194308)}function da(p,y){try{var T="",A=y;do T+=xt(A),A=A.return;while(A);var N=T}catch(W){N=`
Error generating stack: `+W.message+`
`+W.stack}return{value:p,source:y,stack:N,digest:null}}function Ga(p,y,T){return{value:p,source:null,stack:T??null,digest:y??null}}function Ko(p,y){try{console.error(y.value)}catch(T){setTimeout(function(){throw T})}}var fa=typeof WeakMap=="function"?WeakMap:Map;function Cs(p,y,T){T=aa(-1,T),T.tag=3,T.payload={element:null};var A=y.value;return T.callback=function(){Du||(Du=!0,Am=A),Ko(p,y)},T}function Ts(p,y,T){T=aa(-1,T),T.tag=3;var A=p.type.getDerivedStateFromError;if(typeof A=="function"){var N=y.value;T.payload=function(){return A(N)},T.callback=function(){Ko(p,y)}}var W=p.stateNode;return W!==null&&typeof W.componentDidCatch=="function"&&(T.callback=function(){Ko(p,y),typeof A!="function"&&(Bc===null?Bc=new Set([this]):Bc.add(this));var he=y.stack;this.componentDidCatch(y.value,{componentStack:he!==null?he:""})}),T}function Rn(p,y,T){var A=p.pingCache;if(A===null){A=p.pingCache=new fa;var N=new Set;A.set(y,N)}else N=A.get(y),N===void 0&&(N=new Set,A.set(y,N));N.has(T)||(N.add(T),p=A0.bind(null,p,y,T),y.then(p,p))}function In(p){do{var y;if((y=p.tag===13)&&(y=p.memoizedState,y=y!==null?y.dehydrated!==null:!0),y)return p;p=p.return}while(p!==null);return null}function $i(p,y,T,A,N){return(p.mode&1)===0?(p===y?p.flags|=65536:(p.flags|=128,T.flags|=131072,T.flags&=-52805,T.tag===1&&(T.alternate===null?T.tag=17:(y=aa(-1,1),y.tag=2,Ll(T,y,1))),T.lanes|=1),p):(p.flags|=65536,p.lanes=N,p)}var Wi=de.ReactCurrentOwner,Bo=!1;function Co(p,y,T,A){y.child=p===null?Mu(y,null,T,A):Tu(y,p.child,T,A)}function $l(p,y,T,A,N){T=T.render;var W=y.ref;return sa(y,N),A=m(p,y,T,A,W,N),T=v(),p!==null&&!Bo?(y.updateQueue=p.updateQueue,y.flags&=-2053,p.lanes&=~N,Lc(p,y,N)):(Wn&&T&&Oh(y),y.flags|=1,Co(p,y,A,N),y.child)}function Tm(p,y,T,A,N){if(p===null){var W=T.type;return typeof W=="function"&&!wy(W)&&W.defaultProps===void 0&&T.compare===null&&T.defaultProps===void 0?(y.tag=15,y.type=W,lp(p,y,W,A,N)):(p=sf(T.type,null,A,y,y.mode,N),p.ref=y.ref,p.return=y,y.child=p)}if(W=p.child,(p.lanes&N)===0){var he=W.memoizedProps;if(T=T.compare,T=T!==null?T:_u,T(he,A)&&p.ref===y.ref)return Lc(p,y,N)}return y.flags|=1,p=jc(W,A),p.ref=y.ref,p.return=y,y.child=p}function lp(p,y,T,A,N){if(p!==null){var W=p.memoizedProps;if(_u(W,A)&&p.ref===y.ref)if(Bo=!1,y.pendingProps=A=W,(p.lanes&N)!==0)(p.flags&131072)!==0&&(Bo=!0);else return y.lanes=p.lanes,Lc(p,y,N)}return pa(p,y,T,A,N)}function Wd(p,y,T){var A=y.pendingProps,N=A.children,W=p!==null?p.memoizedState:null;if(A.mode==="hidden")if((y.mode&1)===0)y.memoizedState={baseLanes:0,cachePool:null,transitions:null},pn(rf,Ws),Ws|=T;else{if((T&1073741824)===0)return p=W!==null?W.baseLanes|T:T,y.lanes=y.childLanes=1073741824,y.memoizedState={baseLanes:p,cachePool:null,transitions:null},y.updateQueue=null,pn(rf,Ws),Ws|=p,null;y.memoizedState={baseLanes:0,cachePool:null,transitions:null},A=W!==null?W.baseLanes:T,pn(rf,Ws),Ws|=A}else W!==null?(A=W.baseLanes|T,y.memoizedState=null):A=T,pn(rf,Ws),Ws|=A;return Co(p,y,N,T),y.child}function qa(p,y){var T=y.ref;(p===null&&T!==null||p!==null&&p.ref!==T)&&(y.flags|=512,y.flags|=2097152)}function pa(p,y,T,A,N){var W=So(T)?Il:to.current;return W=kl(y,W),sa(y,N),T=m(p,y,T,A,W,N),A=v(),p!==null&&!Bo?(y.updateQueue=p.updateQueue,y.flags&=-2053,p.lanes&=~N,Lc(p,y,N)):(Wn&&A&&Oh(y),y.flags|=1,Co(p,y,T,N),y.child)}function Ha(p,y,T,A,N){if(So(T)){var W=!0;Vs(y)}else W=!1;if(sa(y,N),y.stateNode===null)Oc(p,y),qs(y,T,A),Ua(y,T,A,N),A=!0;else if(p===null){var he=y.stateNode,Le=y.memoizedProps;he.props=Le;var Ne=he.context,pt=T.contextType;typeof pt=="object"&&pt!==null?pt=Xt(pt):(pt=So(T)?Il:to.current,pt=kl(y,pt));var Ot=T.getDerivedStateFromProps,Lt=typeof Ot=="function"||typeof he.getSnapshotBeforeUpdate=="function";Lt||typeof he.UNSAFE_componentWillReceiveProps!="function"&&typeof he.componentWillReceiveProps!="function"||(Le!==A||Ne!==pt)&&Fo(y,he,A,pt),Ti=!1;var zt=y.memoizedState;he.state=zt,Ln(y,A,he,N),Ne=y.memoizedState,Le!==A||zt!==Ne||ro.current||Ti?(typeof Ot=="function"&&(Hi(y,T,Ot,A),Ne=y.memoizedState),(Le=Ti||ha(y,T,Le,A,zt,Ne,pt))?(Lt||typeof he.UNSAFE_componentWillMount!="function"&&typeof he.componentWillMount!="function"||(typeof he.componentWillMount=="function"&&he.componentWillMount(),typeof he.UNSAFE_componentWillMount=="function"&&he.UNSAFE_componentWillMount()),typeof he.componentDidMount=="function"&&(y.flags|=4194308)):(typeof he.componentDidMount=="function"&&(y.flags|=4194308),y.memoizedProps=A,y.memoizedState=Ne),he.props=A,he.state=Ne,he.context=pt,A=Le):(typeof he.componentDidMount=="function"&&(y.flags|=4194308),A=!1)}else{he=y.stateNode,qd(p,y),Le=y.memoizedProps,pt=y.type===y.elementType?Le:yn(y.type,Le),he.props=pt,Lt=y.pendingProps,zt=he.context,Ne=T.contextType,typeof Ne=="object"&&Ne!==null?Ne=Xt(Ne):(Ne=So(T)?Il:to.current,Ne=kl(y,Ne));var lr=T.getDerivedStateFromProps;(Ot=typeof lr=="function"||typeof he.getSnapshotBeforeUpdate=="function")||typeof he.UNSAFE_componentWillReceiveProps!="function"&&typeof he.componentWillReceiveProps!="function"||(Le!==Lt||zt!==Ne)&&Fo(y,he,A,Ne),Ti=!1,zt=y.memoizedState,he.state=zt,Ln(y,A,he,N);var pr=y.memoizedState;Le!==Lt||zt!==pr||ro.current||Ti?(typeof lr=="function"&&(Hi(y,T,lr,A),pr=y.memoizedState),(pt=Ti||ha(y,T,pt,A,zt,pr,Ne)||!1)?(Ot||typeof he.UNSAFE_componentWillUpdate!="function"&&typeof he.componentWillUpdate!="function"||(typeof he.componentWillUpdate=="function"&&he.componentWillUpdate(A,pr,Ne),typeof he.UNSAFE_componentWillUpdate=="function"&&he.UNSAFE_componentWillUpdate(A,pr,Ne)),typeof he.componentDidUpdate=="function"&&(y.flags|=4),typeof he.getSnapshotBeforeUpdate=="function"&&(y.flags|=1024)):(typeof he.componentDidUpdate!="function"||Le===p.memoizedProps&&zt===p.memoizedState||(y.flags|=4),typeof he.getSnapshotBeforeUpdate!="function"||Le===p.memoizedProps&&zt===p.memoizedState||(y.flags|=1024),y.memoizedProps=A,y.memoizedState=pr),he.props=A,he.state=pr,he.context=Ne,A=pt):(typeof he.componentDidUpdate!="function"||Le===p.memoizedProps&&zt===p.memoizedState||(y.flags|=4),typeof he.getSnapshotBeforeUpdate!="function"||Le===p.memoizedProps&&zt===p.memoizedState||(y.flags|=1024),A=!1)}return Nh(p,y,T,A,W,N)}function Nh(p,y,T,A,N,W){qa(p,y);var he=(y.flags&128)!==0;if(!A&&!he)return N&&np(y,T,!1),Lc(p,y,W);A=y.stateNode,Wi.current=y;var Le=he&&typeof T.getDerivedStateFromError!="function"?null:A.render();return y.flags|=1,p!==null&&he?(y.child=Tu(y,p.child,null,W),y.child=Tu(y,null,Le,W)):Co(p,y,Le,W),y.memoizedState=A.state,N&&np(y,T,!0),y.child}function Zd(p){var y=p.stateNode;y.pendingContext?Fd(p,y.pendingContext,y.pendingContext!==y.context):y.context&&Fd(p,y.context,!1),$h(p,y.containerInfo)}function Vh(p,y,T,A,N){return zl(),Nd(N),y.flags|=256,Co(p,y,T,A),y.child}var Iu={dehydrated:null,treeContext:null,retryLane:0};function Xd(p){return{baseLanes:p,cachePool:null,transitions:null}}function ay(p,y,T){var A=y.pendingProps,N=Fn.current,W=!1,he=(y.flags&128)!==0,Le;if((Le=he)||(Le=p!==null&&p.memoizedState===null?!1:(N&2)!==0),Le?(W=!0,y.flags&=-129):(p===null||p.memoizedState!==null)&&(N|=1),pn(Fn,N&1),p===null)return op(y),p=y.memoizedState,p!==null&&(p=p.dehydrated,p!==null)?((y.mode&1)===0?y.lanes=1:p.data==="$!"?y.lanes=8:y.lanes=1073741824,null):(he=A.children,p=A.fallback,W?(A=y.mode,W=y.child,he={mode:"hidden",children:he},(A&1)===0&&W!==null?(W.childLanes=0,W.pendingProps=he):W=vp(he,A,0,null),p=$u(p,A,T,null),W.return=y,p.return=y,W.sibling=p,y.child=W,y.child.memoizedState=Xd(T),y.memoizedState=Iu,p):ly(y,he));if(N=p.memoizedState,N!==null&&(Le=N.dehydrated,Le!==null))return S1(p,y,he,A,Le,N,T);if(W){W=A.fallback,he=y.mode,N=p.child,Le=N.sibling;var Ne={mode:"hidden",children:A.children};return(he&1)===0&&y.child!==N?(A=y.child,A.childLanes=0,A.pendingProps=Ne,y.deletions=null):(A=jc(N,Ne),A.subtreeFlags=N.subtreeFlags&14680064),Le!==null?W=jc(Le,W):(W=$u(W,he,T,null),W.flags|=2),W.return=y,A.return=y,A.sibling=W,y.child=A,A=W,W=y.child,he=p.child.memoizedState,he=he===null?Xd(T):{baseLanes:he.baseLanes|T,cachePool:null,transitions:he.transitions},W.memoizedState=he,W.childLanes=p.childLanes&~T,y.memoizedState=Iu,A}return W=p.child,p=W.sibling,A=jc(W,{mode:"visible",children:A.children}),(y.mode&1)===0&&(A.lanes=T),A.return=y,A.sibling=null,p!==null&&(T=y.deletions,T===null?(y.deletions=[p],y.flags|=16):T.push(p)),y.child=A,y.memoizedState=null,A}function ly(p,y){return y=vp({mode:"visible",children:y},p.mode,0,null),y.return=p,p.child=y}function Kd(p,y,T,A){return A!==null&&Nd(A),Tu(y,p.child,null,T),p=ly(y,y.pendingProps.children),p.flags|=2,y.memoizedState=null,p}function S1(p,y,T,A,N,W,he){if(T)return y.flags&256?(y.flags&=-257,A=Ga(Error(i(422))),Kd(p,y,he,A)):y.memoizedState!==null?(y.child=p.child,y.flags|=128,null):(W=A.fallback,N=y.mode,A=vp({mode:"visible",children:A.children},N,0,null),W=$u(W,N,he,null),W.flags|=2,A.return=y,W.return=y,A.sibling=W,y.child=A,(y.mode&1)!==0&&Tu(y,p.child,null,he),y.child.memoizedState=Xd(he),y.memoizedState=Iu,W);if((y.mode&1)===0)return Kd(p,y,he,null);if(N.data==="$!"){if(A=N.nextSibling&&N.nextSibling.dataset,A)var Le=A.dgst;return A=Le,W=Error(i(419)),A=Ga(W,A,void 0),Kd(p,y,he,A)}if(Le=(he&p.childLanes)!==0,Bo||Le){if(A=Mo,A!==null){switch(he&-he){case 4:N=2;break;case 16:N=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:N=32;break;case 536870912:N=268435456;break;default:N=0}N=(N&(A.suspendedLanes|he))!==0?0:N,N!==0&&N!==W.retryLane&&(W.retryLane=N,Ss(p,N),Xa(A,p,N,-1))}return _y(),A=Ga(Error(i(421))),Kd(p,y,he,A)}return N.data==="$?"?(y.flags|=128,y.child=p.child,y=E1.bind(null,p),N._reactRetry=y,null):(p=W.treeContext,go=Fa(N.nextSibling),mo=y,Wn=!0,Lo=null,p!==null&&(xs[bs++]=Wo,xs[bs++]=qi,xs[bs++]=ws,Wo=p.id,qi=p.overflow,ws=y),y=ly(y,A.children),y.flags|=4096,y)}function Mm(p,y,T){p.lanes|=y;var A=p.alternate;A!==null&&(A.lanes|=y),as(p.return,y,T)}function Pm(p,y,T,A,N){var W=p.memoizedState;W===null?p.memoizedState={isBackwards:y,rendering:null,renderingStartTime:0,last:A,tail:T,tailMode:N}:(W.isBackwards=y,W.rendering=null,W.renderingStartTime=0,W.last=A,W.tail=T,W.tailMode=N)}function cy(p,y,T){var A=y.pendingProps,N=A.revealOrder,W=A.tail;if(Co(p,y,A.children,T),A=Fn.current,(A&2)!==0)A=A&1|2,y.flags|=128;else{if(p!==null&&(p.flags&128)!==0)e:for(p=y.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&Mm(p,T,y);else if(p.tag===19)Mm(p,T,y);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===y)break e;for(;p.sibling===null;){if(p.return===null||p.return===y)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}A&=1}if(pn(Fn,A),(y.mode&1)===0)y.memoizedState=null;else switch(N){case"forwards":for(T=y.child,N=null;T!==null;)p=T.alternate,p!==null&&Ac(p)===null&&(N=T),T=T.sibling;T=N,T===null?(N=y.child,y.child=null):(N=T.sibling,T.sibling=null),Pm(y,!1,N,T,W);break;case"backwards":for(T=null,N=y.child,y.child=null;N!==null;){if(p=N.alternate,p!==null&&Ac(p)===null){y.child=N;break}p=N.sibling,N.sibling=T,T=N,N=p}Pm(y,!0,T,null,W);break;case"together":Pm(y,!1,null,null,void 0);break;default:y.memoizedState=null}return y.child}function Oc(p,y){(y.mode&1)===0&&p!==null&&(p.alternate=null,y.alternate=null,y.flags|=2)}function Lc(p,y,T){if(p!==null&&(y.dependencies=p.dependencies),Au|=y.lanes,(T&y.childLanes)===0)return null;if(p!==null&&y.child!==p.child)throw Error(i(153));if(y.child!==null){for(p=y.child,T=jc(p,p.pendingProps),y.child=T,T.return=y;p.sibling!==null;)p=p.sibling,T=T.sibling=jc(p,p.pendingProps),T.return=y;T.sibling=null}return y.child}function Yd(p,y,T){switch(y.tag){case 3:Zd(y),zl();break;case 5:ua(y);break;case 1:So(y.type)&&Vs(y);break;case 4:$h(y,y.stateNode.containerInfo);break;case 10:var A=y.type._context,N=y.memoizedProps.value;pn(Pc,A._currentValue),A._currentValue=N;break;case 13:if(A=y.memoizedState,A!==null)return A.dehydrated!==null?(pn(Fn,Fn.current&1),y.flags|=128,null):(T&y.child.childLanes)!==0?ay(p,y,T):(pn(Fn,Fn.current&1),p=Lc(p,y,T),p!==null?p.sibling:null);pn(Fn,Fn.current&1);break;case 19:if(A=(T&y.childLanes)!==0,(p.flags&128)!==0){if(A)return cy(p,y,T);y.flags|=128}if(N=y.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),pn(Fn,Fn.current),A)break;return null;case 22:case 23:return y.lanes=0,Wd(p,y,T)}return Lc(p,y,T)}var cp,Jd,y0,v0;cp=function(p,y){for(var T=y.child;T!==null;){if(T.tag===5||T.tag===6)p.appendChild(T.stateNode);else if(T.tag!==4&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===y)break;for(;T.sibling===null;){if(T.return===null||T.return===y)return;T=T.return}T.sibling.return=T.return,T=T.sibling}},Jd=function(){},y0=function(p,y,T,A){var N=p.memoizedProps;if(N!==A){p=y.stateNode,la(Xo.current);var W=null;switch(T){case"input":N=wr(p,N),A=wr(p,A),W=[];break;case"select":N=ct({},N,{value:void 0}),A=ct({},A,{value:void 0}),W=[];break;case"textarea":N=Gr(p,N),A=Gr(p,A),W=[];break;default:typeof N.onClick!="function"&&typeof A.onClick=="function"&&(p.onclick=Rd)}Ct(T,A);var he;T=null;for(pt in N)if(!A.hasOwnProperty(pt)&&N.hasOwnProperty(pt)&&N[pt]!=null)if(pt==="style"){var Le=N[pt];for(he in Le)Le.hasOwnProperty(he)&&(T||(T={}),T[he]="")}else pt!=="dangerouslySetInnerHTML"&&pt!=="children"&&pt!=="suppressContentEditableWarning"&&pt!=="suppressHydrationWarning"&&pt!=="autoFocus"&&(c.hasOwnProperty(pt)?W||(W=[]):(W=W||[]).push(pt,null));for(pt in A){var Ne=A[pt];if(Le=N?.[pt],A.hasOwnProperty(pt)&&Ne!==Le&&(Ne!=null||Le!=null))if(pt==="style")if(Le){for(he in Le)!Le.hasOwnProperty(he)||Ne&&Ne.hasOwnProperty(he)||(T||(T={}),T[he]="");for(he in Ne)Ne.hasOwnProperty(he)&&Le[he]!==Ne[he]&&(T||(T={}),T[he]=Ne[he])}else T||(W||(W=[]),W.push(pt,T)),T=Ne;else pt==="dangerouslySetInnerHTML"?(Ne=Ne?Ne.__html:void 0,Le=Le?Le.__html:void 0,Ne!=null&&Le!==Ne&&(W=W||[]).push(pt,Ne)):pt==="children"?typeof Ne!="string"&&typeof Ne!="number"||(W=W||[]).push(pt,""+Ne):pt!=="suppressContentEditableWarning"&&pt!=="suppressHydrationWarning"&&(c.hasOwnProperty(pt)?(Ne!=null&&pt==="onScroll"&&ri("scroll",p),W||Le===Ne||(W=[])):(W=W||[]).push(pt,Ne))}T&&(W=W||[]).push("style",T);var pt=W;(y.updateQueue=pt)&&(y.flags|=4)}},v0=function(p,y,T,A){T!==A&&(y.flags|=4)};function up(p,y){if(!Wn)switch(p.tailMode){case"hidden":y=p.tail;for(var T=null;y!==null;)y.alternate!==null&&(T=y),y=y.sibling;T===null?p.tail=null:T.sibling=null;break;case"collapsed":T=p.tail;for(var A=null;T!==null;)T.alternate!==null&&(A=T),T=T.sibling;A===null?y||p.tail===null?p.tail=null:p.tail.sibling=null:A.sibling=null}}function Yo(p){var y=p.alternate!==null&&p.alternate.child===p.child,T=0,A=0;if(y)for(var N=p.child;N!==null;)T|=N.lanes|N.childLanes,A|=N.subtreeFlags&14680064,A|=N.flags&14680064,N.return=p,N=N.sibling;else for(N=p.child;N!==null;)T|=N.lanes|N.childLanes,A|=N.subtreeFlags,A|=N.flags,N.return=p,N=N.sibling;return p.subtreeFlags|=A,p.childLanes=T,y}function C1(p,y,T){var A=y.pendingProps;switch(Rl(y),y.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yo(y),null;case 1:return So(y.type)&&Rh(),Yo(y),null;case 3:return A=y.stateNode,ca(),Hn(ro),Hn(to),jh(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(p===null||p.child===null)&&(Tc(y)?y.flags|=4:p===null||p.memoizedState.isDehydrated&&(y.flags&256)===0||(y.flags|=1024,Lo!==null&&(Dm(Lo),Lo=null))),Jd(p,y),Yo(y),null;case 5:Eu(y);var N=la(kc.current);if(T=y.type,p!==null&&y.stateNode!=null)y0(p,y,T,A,N),p.ref!==y.ref&&(y.flags|=512,y.flags|=2097152);else{if(!A){if(y.stateNode===null)throw Error(i(166));return Yo(y),null}if(p=la(Xo.current),Tc(y)){A=y.stateNode,T=y.type;var W=y.memoizedProps;switch(A[wo]=y,A[po]=W,p=(y.mode&1)!==0,T){case"dialog":ri("cancel",A),ri("close",A);break;case"iframe":case"object":case"embed":ri("load",A);break;case"video":case"audio":for(N=0;N<Eh.length;N++)ri(Eh[N],A);break;case"source":ri("error",A);break;case"img":case"image":case"link":ri("error",A),ri("load",A);break;case"details":ri("toggle",A);break;case"input":sr(A,W),ri("invalid",A);break;case"select":A._wrapperState={wasMultiple:!!W.multiple},ri("invalid",A);break;case"textarea":rn(A,W),ri("invalid",A)}Ct(T,W),N=null;for(var he in W)if(W.hasOwnProperty(he)){var Le=W[he];he==="children"?typeof Le=="string"?A.textContent!==Le&&(W.suppressHydrationWarning!==!0&&Su(A.textContent,Le,p),N=["children",Le]):typeof Le=="number"&&A.textContent!==""+Le&&(W.suppressHydrationWarning!==!0&&Su(A.textContent,Le,p),N=["children",""+Le]):c.hasOwnProperty(he)&&Le!=null&&he==="onScroll"&&ri("scroll",A)}switch(T){case"input":mr(A),Yt(A,W,!0);break;case"textarea":mr(A),wn(A);break;case"select":case"option":break;default:typeof W.onClick=="function"&&(A.onclick=Rd)}A=N,y.updateQueue=A,A!==null&&(y.flags|=4)}else{he=N.nodeType===9?N:N.ownerDocument,p==="http://www.w3.org/1999/xhtml"&&(p=He(T)),p==="http://www.w3.org/1999/xhtml"?T==="script"?(p=he.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild)):typeof A.is=="string"?p=he.createElement(T,{is:A.is}):(p=he.createElement(T),T==="select"&&(he=p,A.multiple?he.multiple=!0:A.size&&(he.size=A.size))):p=he.createElementNS(p,T),p[wo]=y,p[po]=A,cp(p,y,!1,!1),y.stateNode=p;e:{switch(he=yt(T,A),T){case"dialog":ri("cancel",p),ri("close",p),N=A;break;case"iframe":case"object":case"embed":ri("load",p),N=A;break;case"video":case"audio":for(N=0;N<Eh.length;N++)ri(Eh[N],p);N=A;break;case"source":ri("error",p),N=A;break;case"img":case"image":case"link":ri("error",p),ri("load",p),N=A;break;case"details":ri("toggle",p),N=A;break;case"input":sr(p,A),N=wr(p,A),ri("invalid",p);break;case"option":N=A;break;case"select":p._wrapperState={wasMultiple:!!A.multiple},N=ct({},A,{value:void 0}),ri("invalid",p);break;case"textarea":rn(p,A),N=Gr(p,A),ri("invalid",p);break;default:N=A}Ct(T,N),Le=N;for(W in Le)if(Le.hasOwnProperty(W)){var Ne=Le[W];W==="style"?$e(p,Ne):W==="dangerouslySetInnerHTML"?(Ne=Ne?Ne.__html:void 0,Ne!=null&&ue(p,Ne)):W==="children"?typeof Ne=="string"?(T!=="textarea"||Ne!=="")&&Pe(p,Ne):typeof Ne=="number"&&Pe(p,""+Ne):W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&W!=="autoFocus"&&(c.hasOwnProperty(W)?Ne!=null&&W==="onScroll"&&ri("scroll",p):Ne!=null&&Q(p,W,Ne,he))}switch(T){case"input":mr(p),Yt(p,A,!1);break;case"textarea":mr(p),wn(p);break;case"option":A.value!=null&&p.setAttribute("value",""+tt(A.value));break;case"select":p.multiple=!!A.multiple,W=A.value,W!=null?Or(p,!!A.multiple,W,!1):A.defaultValue!=null&&Or(p,!!A.multiple,A.defaultValue,!0);break;default:typeof N.onClick=="function"&&(p.onclick=Rd)}switch(T){case"button":case"input":case"select":case"textarea":A=!!A.autoFocus;break e;case"img":A=!0;break e;default:A=!1}}A&&(y.flags|=4)}y.ref!==null&&(y.flags|=512,y.flags|=2097152)}return Yo(y),null;case 6:if(p&&y.stateNode!=null)v0(p,y,p.memoizedProps,A);else{if(typeof A!="string"&&y.stateNode===null)throw Error(i(166));if(T=la(kc.current),la(Xo.current),Tc(y)){if(A=y.stateNode,T=y.memoizedProps,A[wo]=y,(W=A.nodeValue!==T)&&(p=mo,p!==null))switch(p.tag){case 3:Su(A.nodeValue,T,(p.mode&1)!==0);break;case 5:p.memoizedProps.suppressHydrationWarning!==!0&&Su(A.nodeValue,T,(p.mode&1)!==0)}W&&(y.flags|=4)}else A=(T.nodeType===9?T:T.ownerDocument).createTextNode(A),A[wo]=y,y.stateNode=A}return Yo(y),null;case 13:if(Hn(Fn),A=y.memoizedState,p===null||p.memoizedState!==null&&p.memoizedState.dehydrated!==null){if(Wn&&go!==null&&(y.mode&1)!==0&&(y.flags&128)===0)sp(),zl(),y.flags|=98560,W=!1;else if(W=Tc(y),A!==null&&A.dehydrated!==null){if(p===null){if(!W)throw Error(i(318));if(W=y.memoizedState,W=W!==null?W.dehydrated:null,!W)throw Error(i(317));W[wo]=y}else zl(),(y.flags&128)===0&&(y.memoizedState=null),y.flags|=4;Yo(y),W=!1}else Lo!==null&&(Dm(Lo),Lo=null),W=!0;if(!W)return y.flags&65536?y:null}return(y.flags&128)!==0?(y.lanes=T,y):(A=A!==null,A!==(p!==null&&p.memoizedState!==null)&&A&&(y.child.flags|=8192,(y.mode&1)!==0&&(p===null||(Fn.current&1)!==0?Zi===0&&(Zi=3):_y())),y.updateQueue!==null&&(y.flags|=4),Yo(y),null);case 4:return ca(),Jd(p,y),p===null&&vc(y.stateNode.containerInfo),Yo(y),null;case 10:return Gd(y.type._context),Yo(y),null;case 17:return So(y.type)&&Rh(),Yo(y),null;case 19:if(Hn(Fn),W=y.memoizedState,W===null)return Yo(y),null;if(A=(y.flags&128)!==0,he=W.rendering,he===null)if(A)up(W,!1);else{if(Zi!==0||p!==null&&(p.flags&128)!==0)for(p=y.child;p!==null;){if(he=Ac(p),he!==null){for(y.flags|=128,up(W,!1),A=he.updateQueue,A!==null&&(y.updateQueue=A,y.flags|=4),y.subtreeFlags=0,A=T,T=y.child;T!==null;)W=T,p=A,W.flags&=14680066,he=W.alternate,he===null?(W.childLanes=0,W.lanes=p,W.child=null,W.subtreeFlags=0,W.memoizedProps=null,W.memoizedState=null,W.updateQueue=null,W.dependencies=null,W.stateNode=null):(W.childLanes=he.childLanes,W.lanes=he.lanes,W.child=he.child,W.subtreeFlags=0,W.deletions=null,W.memoizedProps=he.memoizedProps,W.memoizedState=he.memoizedState,W.updateQueue=he.updateQueue,W.type=he.type,p=he.dependencies,W.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext}),T=T.sibling;return pn(Fn,Fn.current&1|2),y.child}p=p.sibling}W.tail!==null&&Gn()>Fc&&(y.flags|=128,A=!0,up(W,!1),y.lanes=4194304)}else{if(!A)if(p=Ac(he),p!==null){if(y.flags|=128,A=!0,T=p.updateQueue,T!==null&&(y.updateQueue=T,y.flags|=4),up(W,!0),W.tail===null&&W.tailMode==="hidden"&&!he.alternate&&!Wn)return Yo(y),null}else 2*Gn()-W.renderingStartTime>Fc&&T!==1073741824&&(y.flags|=128,A=!0,up(W,!1),y.lanes=4194304);W.isBackwards?(he.sibling=y.child,y.child=he):(T=W.last,T!==null?T.sibling=he:y.child=he,W.last=he)}return W.tail!==null?(y=W.tail,W.rendering=y,W.tail=y.sibling,W.renderingStartTime=Gn(),y.sibling=null,T=Fn.current,pn(Fn,A?T&1|2:T&1),y):(Yo(y),null);case 22:case 23:return yy(),A=y.memoizedState!==null,p!==null&&p.memoizedState!==null!==A&&(y.flags|=8192),A&&(y.mode&1)!==0?(Ws&1073741824)!==0&&(Yo(y),y.subtreeFlags&6&&(y.flags|=8192)):Yo(y),null;case 24:return null;case 25:return null}throw Error(i(156,y.tag))}function _0(p,y){switch(Rl(y),y.tag){case 1:return So(y.type)&&Rh(),p=y.flags,p&65536?(y.flags=p&-65537|128,y):null;case 3:return ca(),Hn(ro),Hn(to),jh(),p=y.flags,(p&65536)!==0&&(p&128)===0?(y.flags=p&-65537|128,y):null;case 5:return Eu(y),null;case 13:if(Hn(Fn),p=y.memoizedState,p!==null&&p.dehydrated!==null){if(y.alternate===null)throw Error(i(340));zl()}return p=y.flags,p&65536?(y.flags=p&-65537|128,y):null;case 19:return Hn(Fn),null;case 4:return ca(),null;case 10:return Gd(y.type._context),null;case 22:case 23:return yy(),null;case 24:return null;default:return null}}var Qd=!1,$o=!1,x0=typeof WeakSet=="function"?WeakSet:Set,hr=null;function ef(p,y){var T=p.ref;if(T!==null)if(typeof T=="function")try{T(null)}catch(A){Ai(p,y,A)}else T.current=null}function Em(p,y,T){try{T()}catch(A){Ai(p,y,A)}}var uy=!1;function T1(p,y){if(bc=sc,p=bm(),an(p)){if("selectionStart"in p)var T={start:p.selectionStart,end:p.selectionEnd};else e:{T=(T=p.ownerDocument)&&T.defaultView||window;var A=T.getSelection&&T.getSelection();if(A&&A.rangeCount!==0){T=A.anchorNode;var N=A.anchorOffset,W=A.focusNode;A=A.focusOffset;try{T.nodeType,W.nodeType}catch{T=null;break e}var he=0,Le=-1,Ne=-1,pt=0,Ot=0,Lt=p,zt=null;t:for(;;){for(var lr;Lt!==T||N!==0&&Lt.nodeType!==3||(Le=he+N),Lt!==W||A!==0&&Lt.nodeType!==3||(Ne=he+A),Lt.nodeType===3&&(he+=Lt.nodeValue.length),(lr=Lt.firstChild)!==null;)zt=Lt,Lt=lr;for(;;){if(Lt===p)break t;if(zt===T&&++pt===N&&(Le=he),zt===W&&++Ot===A&&(Ne=he),(lr=Lt.nextSibling)!==null)break;Lt=zt,zt=Lt.parentNode}Lt=lr}T=Le===-1||Ne===-1?null:{start:Le,end:Ne}}else T=null}T=T||{start:0,end:0}}else T=null;for(ep={focusedElem:p,selectionRange:T},sc=!1,hr=y;hr!==null;)if(y=hr,p=y.child,(y.subtreeFlags&1028)!==0&&p!==null)p.return=y,hr=p;else for(;hr!==null;){y=hr;try{var pr=y.alternate;if((y.flags&1024)!==0)switch(y.tag){case 0:case 11:case 15:break;case 1:if(pr!==null){var gr=pr.memoizedProps,Ri=pr.memoizedState,lt=y.stateNode,We=lt.getSnapshotBeforeUpdate(y.elementType===y.type?gr:yn(y.type,gr),Ri);lt.__reactInternalSnapshotBeforeUpdate=We}break;case 3:var dt=y.stateNode.containerInfo;dt.nodeType===1?dt.textContent="":dt.nodeType===9&&dt.documentElement&&dt.removeChild(dt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(Vt){Ai(y,y.return,Vt)}if(p=y.sibling,p!==null){p.return=y.return,hr=p;break}hr=y.return}return pr=uy,uy=!1,pr}function Uh(p,y,T){var A=y.updateQueue;if(A=A!==null?A.lastEffect:null,A!==null){var N=A=A.next;do{if((N.tag&p)===p){var W=N.destroy;N.destroy=void 0,W!==void 0&&Em(y,T,W)}N=N.next}while(N!==A)}}function hp(p,y){if(y=y.updateQueue,y=y!==null?y.lastEffect:null,y!==null){var T=y=y.next;do{if((T.tag&p)===p){var A=T.create;T.destroy=A()}T=T.next}while(T!==y)}}function dp(p){var y=p.ref;if(y!==null){var T=p.stateNode;switch(p.tag){case 5:p=T;break;default:p=T}typeof y=="function"?y(p):y.current=p}}function tf(p){var y=p.alternate;y!==null&&(p.alternate=null,tf(y)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(y=p.stateNode,y!==null&&(delete y[wo],delete y[po],delete y[Sc],delete y[Od],delete y[El])),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}function Jo(p){return p.tag===5||p.tag===3||p.tag===4}function hy(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||Jo(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function fp(p,y,T){var A=p.tag;if(A===5||A===6)p=p.stateNode,y?T.nodeType===8?T.parentNode.insertBefore(p,y):T.insertBefore(p,y):(T.nodeType===8?(y=T.parentNode,y.insertBefore(p,T)):(y=T,y.appendChild(p)),T=T._reactRootContainer,T!=null||y.onclick!==null||(y.onclick=Rd));else if(A!==4&&(p=p.child,p!==null))for(fp(p,y,T),p=p.sibling;p!==null;)fp(p,y,T),p=p.sibling}function dy(p,y,T){var A=p.tag;if(A===5||A===6)p=p.stateNode,y?T.insertBefore(p,y):T.appendChild(p);else if(A!==4&&(p=p.child,p!==null))for(dy(p,y,T),p=p.sibling;p!==null;)dy(p,y,T),p=p.sibling}var To=null,Wa=!1;function ku(p,y,T){for(T=T.child;T!==null;)fy(p,y,T),T=T.sibling}function fy(p,y,T){if(on&&typeof on.onCommitFiberUnmount=="function")try{on.onCommitFiberUnmount(Ei,T)}catch{}switch(T.tag){case 5:$o||ef(T,y);case 6:var A=To,N=Wa;To=null,ku(p,y,T),To=A,Wa=N,To!==null&&(Wa?(p=To,T=T.stateNode,p.nodeType===8?p.parentNode.removeChild(T):p.removeChild(T)):To.removeChild(T.stateNode));break;case 18:To!==null&&(Wa?(p=To,T=T.stateNode,p.nodeType===8?Cu(p.parentNode,T):p.nodeType===1&&Cu(p,T),Ds(p)):Cu(To,T.stateNode));break;case 4:A=To,N=Wa,To=T.stateNode.containerInfo,Wa=!0,ku(p,y,T),To=A,Wa=N;break;case 0:case 11:case 14:case 15:if(!$o&&(A=T.updateQueue,A!==null&&(A=A.lastEffect,A!==null))){N=A=A.next;do{var W=N,he=W.destroy;W=W.tag,he!==void 0&&((W&2)!==0||(W&4)!==0)&&Em(T,y,he),N=N.next}while(N!==A)}ku(p,y,T);break;case 1:if(!$o&&(ef(T,y),A=T.stateNode,typeof A.componentWillUnmount=="function"))try{A.props=T.memoizedProps,A.state=T.memoizedState,A.componentWillUnmount()}catch(Le){Ai(T,y,Le)}ku(p,y,T);break;case 21:ku(p,y,T);break;case 22:T.mode&1?($o=(A=$o)||T.memoizedState!==null,ku(p,y,T),$o=A):ku(p,y,T);break;default:ku(p,y,T)}}function b0(p){var y=p.updateQueue;if(y!==null){p.updateQueue=null;var T=p.stateNode;T===null&&(T=p.stateNode=new x0),y.forEach(function(A){var N=yp.bind(null,p,A);T.has(A)||(T.add(A),A.then(N,N))})}}function Hs(p,y){var T=y.deletions;if(T!==null)for(var A=0;A<T.length;A++){var N=T[A];try{var W=p,he=y,Le=he;e:for(;Le!==null;){switch(Le.tag){case 5:To=Le.stateNode,Wa=!1;break e;case 3:To=Le.stateNode.containerInfo,Wa=!0;break e;case 4:To=Le.stateNode.containerInfo,Wa=!0;break e}Le=Le.return}if(To===null)throw Error(i(160));fy(W,he,N),To=null,Wa=!1;var Ne=N.alternate;Ne!==null&&(Ne.return=null),N.return=null}catch(pt){Ai(N,y,pt)}}if(y.subtreeFlags&12854)for(y=y.child;y!==null;)py(y,p),y=y.sibling}function py(p,y){var T=p.alternate,A=p.flags;switch(p.tag){case 0:case 11:case 14:case 15:if(Hs(y,p),Za(p),A&4){try{Uh(3,p,p.return),hp(3,p)}catch(gr){Ai(p,p.return,gr)}try{Uh(5,p,p.return)}catch(gr){Ai(p,p.return,gr)}}break;case 1:Hs(y,p),Za(p),A&512&&T!==null&&ef(T,T.return);break;case 5:if(Hs(y,p),Za(p),A&512&&T!==null&&ef(T,T.return),p.flags&32){var N=p.stateNode;try{Pe(N,"")}catch(gr){Ai(p,p.return,gr)}}if(A&4&&(N=p.stateNode,N!=null)){var W=p.memoizedProps,he=T!==null?T.memoizedProps:W,Le=p.type,Ne=p.updateQueue;if(p.updateQueue=null,Ne!==null)try{Le==="input"&&W.type==="radio"&&W.name!=null&&Wt(N,W),yt(Le,he);var pt=yt(Le,W);for(he=0;he<Ne.length;he+=2){var Ot=Ne[he],Lt=Ne[he+1];Ot==="style"?$e(N,Lt):Ot==="dangerouslySetInnerHTML"?ue(N,Lt):Ot==="children"?Pe(N,Lt):Q(N,Ot,Lt,pt)}switch(Le){case"input":yr(N,W);break;case"textarea":Un(N,W);break;case"select":var zt=N._wrapperState.wasMultiple;N._wrapperState.wasMultiple=!!W.multiple;var lr=W.value;lr!=null?Or(N,!!W.multiple,lr,!1):zt!==!!W.multiple&&(W.defaultValue!=null?Or(N,!!W.multiple,W.defaultValue,!0):Or(N,!!W.multiple,W.multiple?[]:"",!1))}N[po]=W}catch(gr){Ai(p,p.return,gr)}}break;case 6:if(Hs(y,p),Za(p),A&4){if(p.stateNode===null)throw Error(i(162));N=p.stateNode,W=p.memoizedProps;try{N.nodeValue=W}catch(gr){Ai(p,p.return,gr)}}break;case 3:if(Hs(y,p),Za(p),A&4&&T!==null&&T.memoizedState.isDehydrated)try{Ds(y.containerInfo)}catch(gr){Ai(p,p.return,gr)}break;case 4:Hs(y,p),Za(p);break;case 13:Hs(y,p),Za(p),N=p.child,N.flags&8192&&(W=N.memoizedState!==null,N.stateNode.isHidden=W,!W||N.alternate!==null&&N.alternate.memoizedState!==null||(km=Gn())),A&4&&b0(p);break;case 22:if(Ot=T!==null&&T.memoizedState!==null,p.mode&1?($o=(pt=$o)||Ot,Hs(y,p),$o=pt):Hs(y,p),Za(p),A&8192){if(pt=p.memoizedState!==null,(p.stateNode.isHidden=pt)&&!Ot&&(p.mode&1)!==0)for(hr=p,Ot=p.child;Ot!==null;){for(Lt=hr=Ot;hr!==null;){switch(zt=hr,lr=zt.child,zt.tag){case 0:case 11:case 14:case 15:Uh(4,zt,zt.return);break;case 1:ef(zt,zt.return);var pr=zt.stateNode;if(typeof pr.componentWillUnmount=="function"){A=zt,T=zt.return;try{y=A,pr.props=y.memoizedProps,pr.state=y.memoizedState,pr.componentWillUnmount()}catch(gr){Ai(A,T,gr)}}break;case 5:ef(zt,zt.return);break;case 22:if(zt.memoizedState!==null){pp(Lt);continue}}lr!==null?(lr.return=zt,hr=lr):pp(Lt)}Ot=Ot.sibling}e:for(Ot=null,Lt=p;;){if(Lt.tag===5){if(Ot===null){Ot=Lt;try{N=Lt.stateNode,pt?(W=N.style,typeof W.setProperty=="function"?W.setProperty("display","none","important"):W.display="none"):(Le=Lt.stateNode,Ne=Lt.memoizedProps.style,he=Ne!=null&&Ne.hasOwnProperty("display")?Ne.display:null,Le.style.display=Xe("display",he))}catch(gr){Ai(p,p.return,gr)}}}else if(Lt.tag===6){if(Ot===null)try{Lt.stateNode.nodeValue=pt?"":Lt.memoizedProps}catch(gr){Ai(p,p.return,gr)}}else if((Lt.tag!==22&&Lt.tag!==23||Lt.memoizedState===null||Lt===p)&&Lt.child!==null){Lt.child.return=Lt,Lt=Lt.child;continue}if(Lt===p)break e;for(;Lt.sibling===null;){if(Lt.return===null||Lt.return===p)break e;Ot===Lt&&(Ot=null),Lt=Lt.return}Ot===Lt&&(Ot=null),Lt.sibling.return=Lt.return,Lt=Lt.sibling}}break;case 19:Hs(y,p),Za(p),A&4&&b0(p);break;case 21:break;default:Hs(y,p),Za(p)}}function Za(p){var y=p.flags;if(y&2){try{e:{for(var T=p.return;T!==null;){if(Jo(T)){var A=T;break e}T=T.return}throw Error(i(160))}switch(A.tag){case 5:var N=A.stateNode;A.flags&32&&(Pe(N,""),A.flags&=-33);var W=hy(p);dy(p,W,N);break;case 3:case 4:var he=A.stateNode.containerInfo,Le=hy(p);fp(p,Le,he);break;default:throw Error(i(161))}}catch(Ne){Ai(p,p.return,Ne)}p.flags&=-3}y&4096&&(p.flags&=-4097)}function M1(p,y,T){hr=p,w0(p)}function w0(p,y,T){for(var A=(p.mode&1)!==0;hr!==null;){var N=hr,W=N.child;if(N.tag===22&&A){var he=N.memoizedState!==null||Qd;if(!he){var Le=N.alternate,Ne=Le!==null&&Le.memoizedState!==null||$o;Le=Qd;var pt=$o;if(Qd=he,($o=Ne)&&!pt)for(hr=N;hr!==null;)he=hr,Ne=he.child,he.tag===22&&he.memoizedState!==null?Im(N):Ne!==null?(Ne.return=he,hr=Ne):Im(N);for(;W!==null;)hr=W,w0(W),W=W.sibling;hr=N,Qd=Le,$o=pt}S0(p)}else(N.subtreeFlags&8772)!==0&&W!==null?(W.return=N,hr=W):S0(p)}}function S0(p){for(;hr!==null;){var y=hr;if((y.flags&8772)!==0){var T=y.alternate;try{if((y.flags&8772)!==0)switch(y.tag){case 0:case 11:case 15:$o||hp(5,y);break;case 1:var A=y.stateNode;if(y.flags&4&&!$o)if(T===null)A.componentDidMount();else{var N=y.elementType===y.type?T.memoizedProps:yn(y.type,T.memoizedProps);A.componentDidUpdate(N,T.memoizedState,A.__reactInternalSnapshotBeforeUpdate)}var W=y.updateQueue;W!==null&&gi(y,W,A);break;case 3:var he=y.updateQueue;if(he!==null){if(T=null,y.child!==null)switch(y.child.tag){case 5:T=y.child.stateNode;break;case 1:T=y.child.stateNode}gi(y,he,T)}break;case 5:var Le=y.stateNode;if(T===null&&y.flags&4){T=Le;var Ne=y.memoizedProps;switch(y.type){case"button":case"input":case"select":case"textarea":Ne.autoFocus&&T.focus();break;case"img":Ne.src&&(T.src=Ne.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(y.memoizedState===null){var pt=y.alternate;if(pt!==null){var Ot=pt.memoizedState;if(Ot!==null){var Lt=Ot.dehydrated;Lt!==null&&Ds(Lt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}$o||y.flags&512&&dp(y)}catch(zt){Ai(y,y.return,zt)}}if(y===p){hr=null;break}if(T=y.sibling,T!==null){T.return=y.return,hr=T;break}hr=y.return}}function pp(p){for(;hr!==null;){var y=hr;if(y===p){hr=null;break}var T=y.sibling;if(T!==null){T.return=y.return,hr=T;break}hr=y.return}}function Im(p){for(;hr!==null;){var y=hr;try{switch(y.tag){case 0:case 11:case 15:var T=y.return;try{hp(4,y)}catch(Ne){Ai(y,T,Ne)}break;case 1:var A=y.stateNode;if(typeof A.componentDidMount=="function"){var N=y.return;try{A.componentDidMount()}catch(Ne){Ai(y,N,Ne)}}var W=y.return;try{dp(y)}catch(Ne){Ai(y,W,Ne)}break;case 5:var he=y.return;try{dp(y)}catch(Ne){Ai(y,he,Ne)}}}catch(Ne){Ai(y,y.return,Ne)}if(y===p){hr=null;break}var Le=y.sibling;if(Le!==null){Le.return=y.return,hr=Le;break}hr=y.return}}var C0=Math.ceil,jl=de.ReactCurrentDispatcher,Gh=de.ReactCurrentOwner,ma=de.ReactCurrentBatchConfig,bn=0,Mo=null,io=null,jo=0,Ws=0,rf=Ba(0),Zi=0,mp=null,Au=0,Ru=0,my=0,oi=null,yo=null,km=0,Fc=1/0,ga=null,Du=!1,Am=null,Bc=null,zu=!1,Nl=null,$c=0,Ou=0,Lu=null,Fu=-1,Rm=0;function Qo(){return(bn&6)!==0?Gn():Fu!==-1?Fu:Fu=Gn()}function Ms(p){return(p.mode&1)===0?1:(bn&2)!==0&&jo!==0?jo&-jo:ap.transition!==null?(Rm===0&&(Rm=hd()),Rm):(p=fn,p!==0||(p=window.event,p=p===void 0?16:xl(p.type)),p)}function Xa(p,y,T,A){if(50<Ou)throw Ou=0,Lu=null,Error(i(185));ic(p,T,A),((bn&2)===0||p!==Mo)&&(p===Mo&&((bn&2)===0&&(Ru|=T),Zi===4&&Bu(p,jo)),ls(p,A),T===1&&bn===0&&(y.mode&1)===0&&(Fc=Gn()+500,Ho&&_s()))}function ls(p,y){var T=p.callbackNode;dm(p,y);var A=uh(p,p===Mo?jo:0);if(A===0)T!==null&&Gi(T),p.callbackNode=null,p.callbackPriority=0;else if(y=A&-A,p.callbackPriority!==y){if(T!=null&&Gi(T),y===1)p.tag===0?sy(M0.bind(null,p)):vs(M0.bind(null,p)),Cm(function(){(bn&6)===0&&_s()}),T=null;else{switch(dh(A)){case 1:T=Qs;break;case 4:T=Yi;break;case 16:T=nn;break;case 536870912:T=Mr;break;default:T=nn}T=D0(T,nf.bind(null,p))}p.callbackPriority=y,p.callbackNode=T}}function nf(p,y){if(Fu=-1,Rm=0,(bn&6)!==0)throw Error(i(327));var T=p.callbackNode;if(of()&&p.callbackNode!==T)return null;var A=uh(p,p===Mo?jo:0);if(A===0)return null;if((A&30)!==0||(A&p.expiredLanes)!==0||y)y=zm(p,A);else{y=A;var N=bn;bn|=2;var W=vy();(Mo!==p||jo!==y)&&(ga=null,Fc=Gn()+500,Ka(p,y));do try{E0();break}catch(Le){P0(p,Le)}while(!0);Ud(),jl.current=W,bn=N,io!==null?y=0:(Mo=null,jo=0,y=Zi)}if(y!==0){if(y===2&&(N=lu(p),N!==0&&(A=N,y=gp(p,N))),y===1)throw T=mp,Ka(p,0),Bu(p,A),ls(p,Gn()),T;if(y===6)Bu(p,A);else{if(N=p.current.alternate,(A&30)===0&&!T0(N)&&(y=zm(p,A),y===2&&(W=lu(p),W!==0&&(A=W,y=gp(p,W))),y===1))throw T=mp,Ka(p,0),Bu(p,A),ls(p,Gn()),T;switch(p.finishedWork=N,p.finishedLanes=A,y){case 0:case 1:throw Error(i(345));case 2:Ya(p,yo,ga);break;case 3:if(Bu(p,A),(A&130023424)===A&&(y=km+500-Gn(),10<y)){if(uh(p,0)!==0)break;if(N=p.suspendedLanes,(N&A)!==A){Qo(),p.pingedLanes|=p.suspendedLanes&N;break}p.timeoutHandle=wc(Ya.bind(null,p,yo,ga),y);break}Ya(p,yo,ga);break;case 4:if(Bu(p,A),(A&4194240)===A)break;for(y=p.eventTimes,N=-1;0<A;){var he=31-Ii(A);W=1<<he,he=y[he],he>N&&(N=he),A&=~W}if(A=N,A=Gn()-A,A=(120>A?120:480>A?480:1080>A?1080:1920>A?1920:3e3>A?3e3:4320>A?4320:1960*C0(A/1960))-A,10<A){p.timeoutHandle=wc(Ya.bind(null,p,yo,ga),A);break}Ya(p,yo,ga);break;case 5:Ya(p,yo,ga);break;default:throw Error(i(329))}}}return ls(p,Gn()),p.callbackNode===T?nf.bind(null,p):null}function gp(p,y){var T=oi;return p.current.memoizedState.isDehydrated&&(Ka(p,y).flags|=256),p=zm(p,y),p!==2&&(y=yo,yo=T,y!==null&&Dm(y)),p}function Dm(p){yo===null?yo=p:yo.push.apply(yo,p)}function T0(p){for(var y=p;;){if(y.flags&16384){var T=y.updateQueue;if(T!==null&&(T=T.stores,T!==null))for(var A=0;A<T.length;A++){var N=T[A],W=N.getSnapshot;N=N.value;try{if(!Fs(W(),N))return!1}catch{return!1}}}if(T=y.child,y.subtreeFlags&16384&&T!==null)T.return=y,y=T;else{if(y===p)break;for(;y.sibling===null;){if(y.return===null||y.return===p)return!0;y=y.return}y.sibling.return=y.return,y=y.sibling}}return!0}function Bu(p,y){for(y&=~my,y&=~Ru,p.suspendedLanes|=y,p.pingedLanes&=~y,p=p.expirationTimes;0<y;){var T=31-Ii(y),A=1<<T;p[T]=-1,y&=~A}}function M0(p){if((bn&6)!==0)throw Error(i(327));of();var y=uh(p,0);if((y&1)===0)return ls(p,Gn()),null;var T=zm(p,y);if(p.tag!==0&&T===2){var A=lu(p);A!==0&&(y=A,T=gp(p,A))}if(T===1)throw T=mp,Ka(p,0),Bu(p,y),ls(p,Gn()),T;if(T===6)throw Error(i(345));return p.finishedWork=p.current.alternate,p.finishedLanes=y,Ya(p,yo,ga),ls(p,Gn()),null}function gy(p,y){var T=bn;bn|=1;try{return p(y)}finally{bn=T,bn===0&&(Fc=Gn()+500,Ho&&_s())}}function qh(p){Nl!==null&&Nl.tag===0&&(bn&6)===0&&of();var y=bn;bn|=1;var T=ma.transition,A=fn;try{if(ma.transition=null,fn=1,p)return p()}finally{fn=A,ma.transition=T,bn=y,(bn&6)===0&&_s()}}function yy(){Ws=rf.current,Hn(rf)}function Ka(p,y){p.finishedWork=null,p.finishedLanes=0;var T=p.timeoutHandle;if(T!==-1&&(p.timeoutHandle=-1,zd(T)),io!==null)for(T=io.return;T!==null;){var A=T;switch(Rl(A),A.tag){case 1:A=A.type.childContextTypes,A!=null&&Rh();break;case 3:ca(),Hn(ro),Hn(to),jh();break;case 5:Eu(A);break;case 4:ca();break;case 13:Hn(Fn);break;case 19:Hn(Fn);break;case 10:Gd(A.type._context);break;case 22:case 23:yy()}T=T.return}if(Mo=p,io=p=jc(p.current,null),jo=Ws=y,Zi=0,mp=null,my=Ru=Au=0,yo=oi=null,cr!==null){for(y=0;y<cr.length;y++)if(T=cr[y],A=T.interleaved,A!==null){T.interleaved=null;var N=A.next,W=T.pending;if(W!==null){var he=W.next;W.next=N,A.next=he}T.pending=A}cr=null}return p}function P0(p,y){do{var T=io;try{if(Ud(),ja.current=Kn,Dc){for(var A=Bn.memoizedState;A!==null;){var N=A.queue;N!==null&&(N.pending=null),A=A.next}Dc=!1}if(Va=0,Bi=ni=Bn=null,Bl=!1,zc=0,Gh.current=null,T===null||T.return===null){Zi=1,mp=y,io=null;break}e:{var W=p,he=T.return,Le=T,Ne=y;if(y=jo,Le.flags|=32768,Ne!==null&&typeof Ne=="object"&&typeof Ne.then=="function"){var pt=Ne,Ot=Le,Lt=Ot.tag;if((Ot.mode&1)===0&&(Lt===0||Lt===11||Lt===15)){var zt=Ot.alternate;zt?(Ot.updateQueue=zt.updateQueue,Ot.memoizedState=zt.memoizedState,Ot.lanes=zt.lanes):(Ot.updateQueue=null,Ot.memoizedState=null)}var lr=In(he);if(lr!==null){lr.flags&=-257,$i(lr,he,Le,W,y),lr.mode&1&&Rn(W,pt,y),y=lr,Ne=pt;var pr=y.updateQueue;if(pr===null){var gr=new Set;gr.add(Ne),y.updateQueue=gr}else pr.add(Ne);break e}else{if((y&1)===0){Rn(W,pt,y),_y();break e}Ne=Error(i(426))}}else if(Wn&&Le.mode&1){var Ri=In(he);if(Ri!==null){(Ri.flags&65536)===0&&(Ri.flags|=256),$i(Ri,he,Le,W,y),Nd(da(Ne,Le));break e}}W=Ne=da(Ne,Le),Zi!==4&&(Zi=2),oi===null?oi=[W]:oi.push(W),W=he;do{switch(W.tag){case 3:W.flags|=65536,y&=-y,W.lanes|=y;var lt=Cs(W,Ne,y);Pu(W,lt);break e;case 1:Le=Ne;var We=W.type,dt=W.stateNode;if((W.flags&128)===0&&(typeof We.getDerivedStateFromError=="function"||dt!==null&&typeof dt.componentDidCatch=="function"&&(Bc===null||!Bc.has(dt)))){W.flags|=65536,y&=-y,W.lanes|=y;var Vt=Ts(W,Le,y);Pu(W,Vt);break e}}W=W.return}while(W!==null)}Om(T)}catch(vr){y=vr,io===T&&T!==null&&(io=T=T.return);continue}break}while(!0)}function vy(){var p=jl.current;return jl.current=Kn,p===null?Kn:p}function _y(){(Zi===0||Zi===3||Zi===2)&&(Zi=4),Mo===null||(Au&268435455)===0&&(Ru&268435455)===0||Bu(Mo,jo)}function zm(p,y){var T=bn;bn|=2;var A=vy();(Mo!==p||jo!==y)&&(ga=null,Ka(p,y));do try{P1();break}catch(N){P0(p,N)}while(!0);if(Ud(),bn=T,jl.current=A,io!==null)throw Error(i(261));return Mo=null,jo=0,Zi}function P1(){for(;io!==null;)I0(io)}function E0(){for(;io!==null&&!Ra();)I0(io)}function I0(p){var y=by(p.alternate,p,Ws);p.memoizedProps=p.pendingProps,y===null?Om(p):io=y,Gh.current=null}function Om(p){var y=p;do{var T=y.alternate;if(p=y.return,(y.flags&32768)===0){if(T=C1(T,y,Ws),T!==null){io=T;return}}else{if(T=_0(T,y),T!==null){T.flags&=32767,io=T;return}if(p!==null)p.flags|=32768,p.subtreeFlags=0,p.deletions=null;else{Zi=6,io=null;return}}if(y=y.sibling,y!==null){io=y;return}io=y=p}while(y!==null);Zi===0&&(Zi=5)}function Ya(p,y,T){var A=fn,N=ma.transition;try{ma.transition=null,fn=1,xy(p,y,T,A)}finally{ma.transition=N,fn=A}return null}function xy(p,y,T,A){do of();while(Nl!==null);if((bn&6)!==0)throw Error(i(327));T=p.finishedWork;var N=p.finishedLanes;if(T===null)return null;if(p.finishedWork=null,p.finishedLanes=0,T===p.current)throw Error(i(177));p.callbackNode=null,p.callbackPriority=0;var W=T.lanes|T.childLanes;if(Lf(p,W),p===Mo&&(io=Mo=null,jo=0),(T.subtreeFlags&2064)===0&&(T.flags&2064)===0||zu||(zu=!0,D0(nn,function(){return of(),null})),W=(T.flags&15990)!==0,(T.subtreeFlags&15990)!==0||W){W=ma.transition,ma.transition=null;var he=fn;fn=1;var Le=bn;bn|=4,Gh.current=null,T1(p,T),py(T,p),Sd(ep),sc=!!bc,ep=bc=null,p.current=T,M1(T),pl(),bn=Le,fn=he,ma.transition=W}else p.current=T;if(zu&&(zu=!1,Nl=p,$c=N),W=p.pendingLanes,W===0&&(Bc=null),fi(T.stateNode),ls(p,Gn()),y!==null)for(A=p.onRecoverableError,T=0;T<y.length;T++)N=y[T],A(N.value,{componentStack:N.stack,digest:N.digest});if(Du)throw Du=!1,p=Am,Am=null,p;return($c&1)!==0&&p.tag!==0&&of(),W=p.pendingLanes,(W&1)!==0?p===Lu?Ou++:(Ou=0,Lu=p):Ou=0,_s(),null}function of(){if(Nl!==null){var p=dh($c),y=ma.transition,T=fn;try{if(ma.transition=null,fn=16>p?16:p,Nl===null)var A=!1;else{if(p=Nl,Nl=null,$c=0,(bn&6)!==0)throw Error(i(331));var N=bn;for(bn|=4,hr=p.current;hr!==null;){var W=hr,he=W.child;if((hr.flags&16)!==0){var Le=W.deletions;if(Le!==null){for(var Ne=0;Ne<Le.length;Ne++){var pt=Le[Ne];for(hr=pt;hr!==null;){var Ot=hr;switch(Ot.tag){case 0:case 11:case 15:Uh(8,Ot,W)}var Lt=Ot.child;if(Lt!==null)Lt.return=Ot,hr=Lt;else for(;hr!==null;){Ot=hr;var zt=Ot.sibling,lr=Ot.return;if(tf(Ot),Ot===pt){hr=null;break}if(zt!==null){zt.return=lr,hr=zt;break}hr=lr}}}var pr=W.alternate;if(pr!==null){var gr=pr.child;if(gr!==null){pr.child=null;do{var Ri=gr.sibling;gr.sibling=null,gr=Ri}while(gr!==null)}}hr=W}}if((W.subtreeFlags&2064)!==0&&he!==null)he.return=W,hr=he;else e:for(;hr!==null;){if(W=hr,(W.flags&2048)!==0)switch(W.tag){case 0:case 11:case 15:Uh(9,W,W.return)}var lt=W.sibling;if(lt!==null){lt.return=W.return,hr=lt;break e}hr=W.return}}var We=p.current;for(hr=We;hr!==null;){he=hr;var dt=he.child;if((he.subtreeFlags&2064)!==0&&dt!==null)dt.return=he,hr=dt;else e:for(he=We;hr!==null;){if(Le=hr,(Le.flags&2048)!==0)try{switch(Le.tag){case 0:case 11:case 15:hp(9,Le)}}catch(vr){Ai(Le,Le.return,vr)}if(Le===he){hr=null;break e}var Vt=Le.sibling;if(Vt!==null){Vt.return=Le.return,hr=Vt;break e}hr=Le.return}}if(bn=N,_s(),on&&typeof on.onPostCommitFiberRoot=="function")try{on.onPostCommitFiberRoot(Ei,p)}catch{}A=!0}return A}finally{fn=T,ma.transition=y}}return!1}function k0(p,y,T){y=da(T,y),y=Cs(p,y,1),p=Ll(p,y,1),y=Qo(),p!==null&&(ic(p,1,y),ls(p,y))}function Ai(p,y,T){if(p.tag===3)k0(p,p,T);else for(;y!==null;){if(y.tag===3){k0(y,p,T);break}else if(y.tag===1){var A=y.stateNode;if(typeof y.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(Bc===null||!Bc.has(A))){p=da(T,p),p=Ts(y,p,1),y=Ll(y,p,1),p=Qo(),y!==null&&(ic(y,1,p),ls(y,p));break}}y=y.return}}function A0(p,y,T){var A=p.pingCache;A!==null&&A.delete(y),y=Qo(),p.pingedLanes|=p.suspendedLanes&T,Mo===p&&(jo&T)===T&&(Zi===4||Zi===3&&(jo&130023424)===jo&&500>Gn()-km?Ka(p,0):my|=T),ls(p,y)}function R0(p,y){y===0&&((p.mode&1)===0?y=1:(y=ch,ch<<=1,(ch&130023424)===0&&(ch=4194304)));var T=Qo();p=Ss(p,y),p!==null&&(ic(p,y,T),ls(p,T))}function E1(p){var y=p.memoizedState,T=0;y!==null&&(T=y.retryLane),R0(p,T)}function yp(p,y){var T=0;switch(p.tag){case 13:var A=p.stateNode,N=p.memoizedState;N!==null&&(T=N.retryLane);break;case 19:A=p.stateNode;break;default:throw Error(i(314))}A!==null&&A.delete(y),R0(p,T)}var by;by=function(p,y,T){if(p!==null)if(p.memoizedProps!==y.pendingProps||ro.current)Bo=!0;else{if((p.lanes&T)===0&&(y.flags&128)===0)return Bo=!1,Yd(p,y,T);Bo=(p.flags&131072)!==0}else Bo=!1,Wn&&(y.flags&1048576)!==0&&zh(y,Dh,y.index);switch(y.lanes=0,y.tag){case 2:var A=y.type;Oc(p,y),p=y.pendingProps;var N=kl(y,to.current);sa(y,T),N=m(null,y,A,p,N,T);var W=v();return y.flags|=1,typeof N=="object"&&N!==null&&typeof N.render=="function"&&N.$$typeof===void 0?(y.tag=1,y.memoizedState=null,y.updateQueue=null,So(A)?(W=!0,Vs(y)):W=!1,y.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,Zo(y),N.updater=Gs,y.stateNode=N,N._reactInternals=y,Ua(y,A,p,T),y=Nh(null,y,A,!0,W,T)):(y.tag=0,Wn&&W&&Oh(y),Co(null,y,N,T),y=y.child),y;case 16:A=y.elementType;e:{switch(Oc(p,y),p=y.pendingProps,N=A._init,A=N(A._payload),y.type=A,N=y.tag=k1(A),p=yn(A,p),N){case 0:y=pa(null,y,A,p,T);break e;case 1:y=Ha(null,y,A,p,T);break e;case 11:y=$l(null,y,A,p,T);break e;case 14:y=Tm(null,y,A,yn(A.type,p),T);break e}throw Error(i(306,A,""))}return y;case 0:return A=y.type,N=y.pendingProps,N=y.elementType===A?N:yn(A,N),pa(p,y,A,N,T);case 1:return A=y.type,N=y.pendingProps,N=y.elementType===A?N:yn(A,N),Ha(p,y,A,N,T);case 3:e:{if(Zd(y),p===null)throw Error(i(387));A=y.pendingProps,W=y.memoizedState,N=W.element,qd(p,y),Ln(y,A,null,T);var he=y.memoizedState;if(A=he.element,W.isDehydrated)if(W={element:A,isDehydrated:!1,cache:he.cache,pendingSuspenseBoundaries:he.pendingSuspenseBoundaries,transitions:he.transitions},y.updateQueue.baseState=W,y.memoizedState=W,y.flags&256){N=da(Error(i(423)),y),y=Vh(p,y,A,T,N);break e}else if(A!==N){N=da(Error(i(424)),y),y=Vh(p,y,A,T,N);break e}else for(go=Fa(y.stateNode.containerInfo.firstChild),mo=y,Wn=!0,Lo=null,T=Mu(y,null,A,T),y.child=T;T;)T.flags=T.flags&-3|4096,T=T.sibling;else{if(zl(),A===N){y=Lc(p,y,T);break e}Co(p,y,A,T)}y=y.child}return y;case 5:return ua(y),p===null&&op(y),A=y.type,N=y.pendingProps,W=p!==null?p.memoizedProps:null,he=N.children,Dd(A,N)?he=null:W!==null&&Dd(A,W)&&(y.flags|=32),qa(p,y),Co(p,y,he,T),y.child;case 6:return p===null&&op(y),null;case 13:return ay(p,y,T);case 4:return $h(y,y.stateNode.containerInfo),A=y.pendingProps,p===null?y.child=Tu(y,null,A,T):Co(p,y,A,T),y.child;case 11:return A=y.type,N=y.pendingProps,N=y.elementType===A?N:yn(A,N),$l(p,y,A,N,T);case 7:return Co(p,y,y.pendingProps,T),y.child;case 8:return Co(p,y,y.pendingProps.children,T),y.child;case 12:return Co(p,y,y.pendingProps.children,T),y.child;case 10:e:{if(A=y.type._context,N=y.pendingProps,W=y.memoizedProps,he=N.value,pn(Pc,A._currentValue),A._currentValue=he,W!==null)if(Fs(W.value,he)){if(W.children===N.children&&!ro.current){y=Lc(p,y,T);break e}}else for(W=y.child,W!==null&&(W.return=y);W!==null;){var Le=W.dependencies;if(Le!==null){he=W.child;for(var Ne=Le.firstContext;Ne!==null;){if(Ne.context===A){if(W.tag===1){Ne=aa(-1,T&-T),Ne.tag=2;var pt=W.updateQueue;if(pt!==null){pt=pt.shared;var Ot=pt.pending;Ot===null?Ne.next=Ne:(Ne.next=Ot.next,Ot.next=Ne),pt.pending=Ne}}W.lanes|=T,Ne=W.alternate,Ne!==null&&(Ne.lanes|=T),as(W.return,T,y),Le.lanes|=T;break}Ne=Ne.next}}else if(W.tag===10)he=W.type===y.type?null:W.child;else if(W.tag===18){if(he=W.return,he===null)throw Error(i(341));he.lanes|=T,Le=he.alternate,Le!==null&&(Le.lanes|=T),as(he,T,y),he=W.sibling}else he=W.child;if(he!==null)he.return=W;else for(he=W;he!==null;){if(he===y){he=null;break}if(W=he.sibling,W!==null){W.return=he.return,he=W;break}he=he.return}W=he}Co(p,y,N.children,T),y=y.child}return y;case 9:return N=y.type,A=y.pendingProps.children,sa(y,T),N=Xt(N),A=A(N),y.flags|=1,Co(p,y,A,T),y.child;case 14:return A=y.type,N=yn(A,y.pendingProps),N=yn(A.type,N),Tm(p,y,A,N,T);case 15:return lp(p,y,y.type,y.pendingProps,T);case 17:return A=y.type,N=y.pendingProps,N=y.elementType===A?N:yn(A,N),Oc(p,y),y.tag=1,So(A)?(p=!0,Vs(y)):p=!1,sa(y,T),qs(y,A,N),Ua(y,A,N,T),Nh(null,y,A,!0,p,T);case 19:return cy(p,y,T);case 22:return Wd(p,y,T)}throw Error(i(156,y.tag))};function D0(p,y){return An(p,y)}function I1(p,y,T,A){this.tag=p,this.key=T,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=y,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ya(p,y,T,A){return new I1(p,y,T,A)}function wy(p){return p=p.prototype,!(!p||!p.isReactComponent)}function k1(p){if(typeof p=="function")return wy(p)?1:0;if(p!=null){if(p=p.$$typeof,p===Ge)return 11;if(p===et)return 14}return 2}function jc(p,y){var T=p.alternate;return T===null?(T=ya(p.tag,y,p.key,p.mode),T.elementType=p.elementType,T.type=p.type,T.stateNode=p.stateNode,T.alternate=p,p.alternate=T):(T.pendingProps=y,T.type=p.type,T.flags=0,T.subtreeFlags=0,T.deletions=null),T.flags=p.flags&14680064,T.childLanes=p.childLanes,T.lanes=p.lanes,T.child=p.child,T.memoizedProps=p.memoizedProps,T.memoizedState=p.memoizedState,T.updateQueue=p.updateQueue,y=p.dependencies,T.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext},T.sibling=p.sibling,T.index=p.index,T.ref=p.ref,T}function sf(p,y,T,A,N,W){var he=2;if(A=p,typeof p=="function")wy(p)&&(he=1);else if(typeof p=="string")he=5;else e:switch(p){case xe:return $u(T.children,N,W,y);case Me:he=8,N|=8;break;case Ee:return p=ya(12,T,y,N|2),p.elementType=Ee,p.lanes=W,p;case Ke:return p=ya(13,T,y,N),p.elementType=Ke,p.lanes=W,p;case gt:return p=ya(19,T,y,N),p.elementType=gt,p.lanes=W,p;case Qe:return vp(T,N,W,y);default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case re:he=10;break e;case ke:he=9;break e;case Ge:he=11;break e;case et:he=14;break e;case qe:he=16,A=null;break e}throw Error(i(130,p==null?p:typeof p,""))}return y=ya(he,T,y,N),y.elementType=p,y.type=A,y.lanes=W,y}function $u(p,y,T,A){return p=ya(7,p,A,y),p.lanes=T,p}function vp(p,y,T,A){return p=ya(22,p,A,y),p.elementType=Qe,p.lanes=T,p.stateNode={isHidden:!1},p}function Lm(p,y,T){return p=ya(6,p,null,y),p.lanes=T,p}function Sy(p,y,T){return y=ya(4,p.children!==null?p.children:[],p.key,y),y.lanes=T,y.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},y}function Fm(p,y,T,A,N){this.tag=y,this.containerInfo=p,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hh(0),this.expirationTimes=hh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hh(0),this.identifierPrefix=A,this.onRecoverableError=N,this.mutableSourceEagerHydrationData=null}function Cy(p,y,T,A,N,W,he,Le,Ne){return p=new Fm(p,y,T,Le,Ne),y===1?(y=1,W===!0&&(y|=8)):y=0,W=ya(3,null,null,y),p.current=W,W.stateNode=p,W.memoizedState={element:A,isDehydrated:T,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zo(W),p}function z0(p,y,T){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:be,key:A==null?null:""+A,children:p,containerInfo:y,implementation:T}}function O0(p){if(!p)return ia;p=p._reactInternals;e:{if(ot(p)!==p||p.tag!==1)throw Error(i(170));var y=p;do{switch(y.tag){case 3:y=y.stateNode.context;break e;case 1:if(So(y.type)){y=y.stateNode.__reactInternalMemoizedMergedChildContext;break e}}y=y.return}while(y!==null);throw Error(i(171))}if(p.tag===1){var T=p.type;if(So(T))return Bd(p,T,y)}return y}function L0(p,y,T,A,N,W,he,Le,Ne){return p=Cy(T,A,!0,p,N,W,he,Le,Ne),p.context=O0(null),T=p.current,A=Qo(),N=Ms(T),W=aa(A,N),W.callback=y??null,Ll(T,W,N),p.current.lanes=N,ic(p,N,A),ls(p,A),p}function Bm(p,y,T,A){var N=y.current,W=Qo(),he=Ms(N);return T=O0(T),y.context===null?y.context=T:y.pendingContext=T,y=aa(W,he),y.payload={element:p},A=A===void 0?null:A,A!==null&&(y.callback=A),p=Ll(N,y,he),p!==null&&(Xa(p,N,he,W),Hd(p,N,he)),he}function _p(p){if(p=p.current,!p.child)return null;switch(p.child.tag){case 5:return p.child.stateNode;default:return p.child.stateNode}}function F0(p,y){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var T=p.retryLane;p.retryLane=T!==0&&T<y?T:y}}function Ty(p,y){F0(p,y),(p=p.alternate)&&F0(p,y)}function oo(){return null}var af=typeof reportError=="function"?reportError:function(p){console.error(p)};function My(p){this._internalRoot=p}$m.prototype.render=My.prototype.render=function(p){var y=this._internalRoot;if(y===null)throw Error(i(409));Bm(p,y,null,null)},$m.prototype.unmount=My.prototype.unmount=function(){var p=this._internalRoot;if(p!==null){this._internalRoot=null;var y=p.containerInfo;qh(function(){Bm(null,p,null,null)}),y[ys]=null}};function $m(p){this._internalRoot=p}$m.prototype.unstable_scheduleHydration=function(p){if(p){var y=cu();p={blockedOn:null,target:p,priority:y};for(var T=0;T<_n.length&&y!==0&&y<_n[T].priority;T++);_n.splice(T,0,p),T===0&&Go(p)}};function jm(p){return!(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)}function xp(p){return!(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11&&(p.nodeType!==8||p.nodeValue!==" react-mount-point-unstable "))}function B0(){}function $0(p,y,T,A,N){if(N){if(typeof A=="function"){var W=A;A=function(){var pt=_p(he);W.call(pt)}}var he=L0(y,A,p,0,null,!1,!1,"",B0);return p._reactRootContainer=he,p[ys]=he.current,vc(p.nodeType===8?p.parentNode:p),qh(),he}for(;N=p.lastChild;)p.removeChild(N);if(typeof A=="function"){var Le=A;A=function(){var pt=_p(Ne);Le.call(pt)}}var Ne=Cy(p,0,!1,null,null,!1,!1,"",B0);return p._reactRootContainer=Ne,p[ys]=Ne.current,vc(p.nodeType===8?p.parentNode:p),qh(function(){Bm(y,Ne,T,A)}),Ne}function bp(p,y,T,A,N){var W=T._reactRootContainer;if(W){var he=W;if(typeof N=="function"){var Le=N;N=function(){var Ne=_p(he);Le.call(Ne)}}Bm(y,he,p,N)}else he=$0(T,y,p,N,A);return _p(he)}Bf=function(p){switch(p.tag){case 3:var y=p.stateNode;if(y.current.memoizedState.isDehydrated){var T=Da(y.pendingLanes);T!==0&&(Ff(y,T|1),ls(y,Gn()),(bn&6)===0&&(Fc=Gn()+500,_s()))}break;case 13:qh(function(){var A=Ss(p,1);if(A!==null){var N=Qo();Xa(A,p,1,N)}}),Ty(p,1)}},gl=function(p){if(p.tag===13){var y=Ss(p,134217728);if(y!==null){var T=Qo();Xa(y,p,134217728,T)}Ty(p,134217728)}},dd=function(p){if(p.tag===13){var y=Ms(p),T=Ss(p,y);if(T!==null){var A=Qo();Xa(T,p,y,A)}Ty(p,y)}},cu=function(){return fn},za=function(p,y){var T=fn;try{return fn=p,y()}finally{fn=T}},Qt=function(p,y,T){switch(y){case"input":if(yr(p,T),y=T.name,T.type==="radio"&&y!=null){for(T=p;T.parentNode;)T=T.parentNode;for(T=T.querySelectorAll("input[name="+JSON.stringify(""+y)+'][type="radio"]'),y=0;y<T.length;y++){var A=T[y];if(A!==p&&A.form===p.form){var N=Ah(A);if(!N)throw Error(i(90));ur(A),yr(A,N)}}}break;case"textarea":Un(p,T);break;case"select":y=T.value,y!=null&&Or(p,!!T.multiple,y,!1)}},ar=gy,Dr=qh;var lf={usingClientEntryPoint:!1,Events:[js,Ns,Ah,Lr,mn,gy]},Hh={findFiberByHostInstance:$s,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},j0={bundleType:Hh.bundleType,version:Hh.version,rendererPackageName:Hh.rendererPackageName,rendererConfig:Hh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:de.ReactCurrentDispatcher,findHostInstanceByFiber:function(p){return p=Nr(p),p===null?null:p.stateNode},findFiberByHostInstance:Hh.findFiberByHostInstance||oo,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wp.isDisabled&&wp.supportsFiber)try{Ei=wp.inject(j0),on=wp}catch{}}return _a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lf,_a.createPortal=function(p,y){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jm(y))throw Error(i(200));return z0(p,y,null,T)},_a.createRoot=function(p,y){if(!jm(p))throw Error(i(299));var T=!1,A="",N=af;return y!=null&&(y.unstable_strictMode===!0&&(T=!0),y.identifierPrefix!==void 0&&(A=y.identifierPrefix),y.onRecoverableError!==void 0&&(N=y.onRecoverableError)),y=Cy(p,1,!1,null,null,T,!1,A,N),p[ys]=y.current,vc(p.nodeType===8?p.parentNode:p),new My(y)},_a.findDOMNode=function(p){if(p==null)return null;if(p.nodeType===1)return p;var y=p._reactInternals;if(y===void 0)throw typeof p.render=="function"?Error(i(188)):(p=Object.keys(p).join(","),Error(i(268,p)));return p=Nr(y),p=p===null?null:p.stateNode,p},_a.flushSync=function(p){return qh(p)},_a.hydrate=function(p,y,T){if(!xp(y))throw Error(i(200));return bp(null,p,y,!0,T)},_a.hydrateRoot=function(p,y,T){if(!jm(p))throw Error(i(405));var A=T!=null&&T.hydratedSources||null,N=!1,W="",he=af;if(T!=null&&(T.unstable_strictMode===!0&&(N=!0),T.identifierPrefix!==void 0&&(W=T.identifierPrefix),T.onRecoverableError!==void 0&&(he=T.onRecoverableError)),y=L0(y,null,p,1,T??null,N,!1,W,he),p[ys]=y.current,vc(p),A)for(p=0;p<A.length;p++)T=A[p],N=T._getVersion,N=N(T._source),y.mutableSourceEagerHydrationData==null?y.mutableSourceEagerHydrationData=[T,N]:y.mutableSourceEagerHydrationData.push(T,N);return new $m(y)},_a.render=function(p,y,T){if(!xp(y))throw Error(i(200));return bp(null,p,y,!1,T)},_a.unmountComponentAtNode=function(p){if(!xp(p))throw Error(i(40));return p._reactRootContainer?(qh(function(){bp(null,null,p,!1,function(){p._reactRootContainer=null,p[ys]=null})}),!0):!1},_a.unstable_batchedUpdates=gy,_a.unstable_renderSubtreeIntoContainer=function(p,y,T,A){if(!xp(T))throw Error(i(200));if(p==null||p._reactInternals===void 0)throw Error(i(38));return bp(p,y,T,!1,A)},_a.version="18.3.1-next-f1338f8080-20240426",_a}var DT;function dI(){if(DT)return Sb.exports;DT=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Sb.exports=ZO(),Sb.exports}var Zu=dI();const s_=Lv(Zu);function XO(e){return typeof e=="function"?e():e}const KO=K.forwardRef(function(t,i){const{children:a,container:c,disablePortal:h=!1}=t,[f,o]=K.useState(null),b=Ea(K.isValidElement(a)?aI(a):null,i);if(bv(()=>{h||o(XO(c)||document.body)},[c,h]),bv(()=>{if(f&&!h)return W_(i,f),()=>{W_(i,null)}},[i,f,h]),h){if(K.isValidElement(a)){const P={ref:b};return K.cloneElement(a,P)}return G.jsx(K.Fragment,{children:a})}return G.jsx(K.Fragment,{children:f&&Zu.createPortal(a,f)})});var Ta="top",Ql="bottom",ec="right",Ma="left",T2="auto",Gv=[Ta,Ql,ec,Ma],Dg="start",Sv="end",YO="clippingParents",fI="viewport",By="popper",JO="reference",zT=Gv.reduce(function(e,t){return e.concat([t+"-"+Dg,t+"-"+Sv])},[]),pI=[].concat(Gv,[T2]).reduce(function(e,t){return e.concat([t,t+"-"+Dg,t+"-"+Sv])},[]),QO="beforeRead",eL="read",tL="afterRead",rL="beforeMain",nL="main",iL="afterMain",oL="beforeWrite",sL="write",aL="afterWrite",lL=[QO,eL,tL,rL,nL,iL,oL,sL,aL];function ih(e){return e?(e.nodeName||"").toLowerCase():null}function dl(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function qp(e){var t=dl(e).Element;return e instanceof t||e instanceof Element}function Jl(e){var t=dl(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function M2(e){if(typeof ShadowRoot>"u")return!1;var t=dl(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function cL(e){var t=e.state;Object.keys(t.elements).forEach(function(i){var a=t.styles[i]||{},c=t.attributes[i]||{},h=t.elements[i];!Jl(h)||!ih(h)||(Object.assign(h.style,a),Object.keys(c).forEach(function(f){var o=c[f];o===!1?h.removeAttribute(f):h.setAttribute(f,o===!0?"":o)}))})}function uL(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach(function(a){var c=t.elements[a],h=t.attributes[a]||{},f=Object.keys(t.styles.hasOwnProperty(a)?t.styles[a]:i[a]),o=f.reduce(function(b,P){return b[P]="",b},{});!Jl(c)||!ih(c)||(Object.assign(c.style,o),Object.keys(h).forEach(function(b){c.removeAttribute(b)}))})}}const hL={name:"applyStyles",enabled:!0,phase:"write",fn:cL,effect:uL,requires:["computeStyles"]};function Qu(e){return e.split("-")[0]}var Vp=Math.max,Z_=Math.min,zg=Math.round;function ww(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function mI(){return!/^((?!chrome|android).)*safari/i.test(ww())}function Og(e,t,i){t===void 0&&(t=!1),i===void 0&&(i=!1);var a=e.getBoundingClientRect(),c=1,h=1;t&&Jl(e)&&(c=e.offsetWidth>0&&zg(a.width)/e.offsetWidth||1,h=e.offsetHeight>0&&zg(a.height)/e.offsetHeight||1);var f=qp(e)?dl(e):window,o=f.visualViewport,b=!mI()&&i,P=(a.left+(b&&o?o.offsetLeft:0))/c,I=(a.top+(b&&o?o.offsetTop:0))/h,D=a.width/c,z=a.height/h;return{width:D,height:z,top:I,right:P+D,bottom:I+z,left:P,x:P,y:I}}function P2(e){var t=Og(e),i=e.offsetWidth,a=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-a)<=1&&(a=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:a}}function gI(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&M2(i)){var a=t;do{if(a&&e.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function od(e){return dl(e).getComputedStyle(e)}function dL(e){return["table","td","th"].indexOf(ih(e))>=0}function Rf(e){return((qp(e)?e.ownerDocument:e.document)||window.document).documentElement}function jx(e){return ih(e)==="html"?e:e.assignedSlot||e.parentNode||(M2(e)?e.host:null)||Rf(e)}function OT(e){return!Jl(e)||od(e).position==="fixed"?null:e.offsetParent}function fL(e){var t=/firefox/i.test(ww()),i=/Trident/i.test(ww());if(i&&Jl(e)){var a=od(e);if(a.position==="fixed")return null}var c=jx(e);for(M2(c)&&(c=c.host);Jl(c)&&["html","body"].indexOf(ih(c))<0;){var h=od(c);if(h.transform!=="none"||h.perspective!=="none"||h.contain==="paint"||["transform","perspective"].indexOf(h.willChange)!==-1||t&&h.willChange==="filter"||t&&h.filter&&h.filter!=="none")return c;c=c.parentNode}return null}function qv(e){for(var t=dl(e),i=OT(e);i&&dL(i)&&od(i).position==="static";)i=OT(i);return i&&(ih(i)==="html"||ih(i)==="body"&&od(i).position==="static")?t:i||fL(e)||t}function E2(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function ev(e,t,i){return Vp(e,Z_(t,i))}function pL(e,t,i){var a=ev(e,t,i);return a>i?i:a}function yI(){return{top:0,right:0,bottom:0,left:0}}function vI(e){return Object.assign({},yI(),e)}function _I(e,t){return t.reduce(function(i,a){return i[a]=e,i},{})}var mL=function(t,i){return t=typeof t=="function"?t(Object.assign({},i.rects,{placement:i.placement})):t,vI(typeof t!="number"?t:_I(t,Gv))};function gL(e){var t,i=e.state,a=e.name,c=e.options,h=i.elements.arrow,f=i.modifiersData.popperOffsets,o=Qu(i.placement),b=E2(o),P=[Ma,ec].indexOf(o)>=0,I=P?"height":"width";if(!(!h||!f)){var D=mL(c.padding,i),z=P2(h),F=b==="y"?Ta:Ma,U=b==="y"?Ql:ec,$=i.rects.reference[I]+i.rects.reference[b]-f[b]-i.rects.popper[I],j=f[b]-i.rects.reference[b],ie=qv(h),se=ie?b==="y"?ie.clientHeight||0:ie.clientWidth||0:0,Q=$/2-j/2,de=D[F],oe=se-z[I]-D[U],be=se/2-z[I]/2+Q,xe=ev(de,be,oe),Me=b;i.modifiersData[a]=(t={},t[Me]=xe,t.centerOffset=xe-be,t)}}function yL(e){var t=e.state,i=e.options,a=i.element,c=a===void 0?"[data-popper-arrow]":a;c!=null&&(typeof c=="string"&&(c=t.elements.popper.querySelector(c),!c)||gI(t.elements.popper,c)&&(t.elements.arrow=c))}const vL={name:"arrow",enabled:!0,phase:"main",fn:gL,effect:yL,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Lg(e){return e.split("-")[1]}var _L={top:"auto",right:"auto",bottom:"auto",left:"auto"};function xL(e,t){var i=e.x,a=e.y,c=t.devicePixelRatio||1;return{x:zg(i*c)/c||0,y:zg(a*c)/c||0}}function LT(e){var t,i=e.popper,a=e.popperRect,c=e.placement,h=e.variation,f=e.offsets,o=e.position,b=e.gpuAcceleration,P=e.adaptive,I=e.roundOffsets,D=e.isFixed,z=f.x,F=z===void 0?0:z,U=f.y,$=U===void 0?0:U,j=typeof I=="function"?I({x:F,y:$}):{x:F,y:$};F=j.x,$=j.y;var ie=f.hasOwnProperty("x"),se=f.hasOwnProperty("y"),Q=Ma,de=Ta,oe=window;if(P){var be=qv(i),xe="clientHeight",Me="clientWidth";if(be===dl(i)&&(be=Rf(i),od(be).position!=="static"&&o==="absolute"&&(xe="scrollHeight",Me="scrollWidth")),be=be,c===Ta||(c===Ma||c===ec)&&h===Sv){de=Ql;var Ee=D&&be===oe&&oe.visualViewport?oe.visualViewport.height:be[xe];$-=Ee-a.height,$*=b?1:-1}if(c===Ma||(c===Ta||c===Ql)&&h===Sv){Q=ec;var re=D&&be===oe&&oe.visualViewport?oe.visualViewport.width:be[Me];F-=re-a.width,F*=b?1:-1}}var ke=Object.assign({position:o},P&&_L),Ge=I===!0?xL({x:F,y:$},dl(i)):{x:F,y:$};if(F=Ge.x,$=Ge.y,b){var Ke;return Object.assign({},ke,(Ke={},Ke[de]=se?"0":"",Ke[Q]=ie?"0":"",Ke.transform=(oe.devicePixelRatio||1)<=1?"translate("+F+"px, "+$+"px)":"translate3d("+F+"px, "+$+"px, 0)",Ke))}return Object.assign({},ke,(t={},t[de]=se?$+"px":"",t[Q]=ie?F+"px":"",t.transform="",t))}function bL(e){var t=e.state,i=e.options,a=i.gpuAcceleration,c=a===void 0?!0:a,h=i.adaptive,f=h===void 0?!0:h,o=i.roundOffsets,b=o===void 0?!0:o,P={placement:Qu(t.placement),variation:Lg(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:c,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,LT(Object.assign({},P,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:f,roundOffsets:b})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,LT(Object.assign({},P,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:b})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const wL={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:bL,data:{}};var a_={passive:!0};function SL(e){var t=e.state,i=e.instance,a=e.options,c=a.scroll,h=c===void 0?!0:c,f=a.resize,o=f===void 0?!0:f,b=dl(t.elements.popper),P=[].concat(t.scrollParents.reference,t.scrollParents.popper);return h&&P.forEach(function(I){I.addEventListener("scroll",i.update,a_)}),o&&b.addEventListener("resize",i.update,a_),function(){h&&P.forEach(function(I){I.removeEventListener("scroll",i.update,a_)}),o&&b.removeEventListener("resize",i.update,a_)}}const CL={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:SL,data:{}};var TL={left:"right",right:"left",bottom:"top",top:"bottom"};function k_(e){return e.replace(/left|right|bottom|top/g,function(t){return TL[t]})}var ML={start:"end",end:"start"};function FT(e){return e.replace(/start|end/g,function(t){return ML[t]})}function I2(e){var t=dl(e),i=t.pageXOffset,a=t.pageYOffset;return{scrollLeft:i,scrollTop:a}}function k2(e){return Og(Rf(e)).left+I2(e).scrollLeft}function PL(e,t){var i=dl(e),a=Rf(e),c=i.visualViewport,h=a.clientWidth,f=a.clientHeight,o=0,b=0;if(c){h=c.width,f=c.height;var P=mI();(P||!P&&t==="fixed")&&(o=c.offsetLeft,b=c.offsetTop)}return{width:h,height:f,x:o+k2(e),y:b}}function EL(e){var t,i=Rf(e),a=I2(e),c=(t=e.ownerDocument)==null?void 0:t.body,h=Vp(i.scrollWidth,i.clientWidth,c?c.scrollWidth:0,c?c.clientWidth:0),f=Vp(i.scrollHeight,i.clientHeight,c?c.scrollHeight:0,c?c.clientHeight:0),o=-a.scrollLeft+k2(e),b=-a.scrollTop;return od(c||i).direction==="rtl"&&(o+=Vp(i.clientWidth,c?c.clientWidth:0)-h),{width:h,height:f,x:o,y:b}}function A2(e){var t=od(e),i=t.overflow,a=t.overflowX,c=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+c+a)}function xI(e){return["html","body","#document"].indexOf(ih(e))>=0?e.ownerDocument.body:Jl(e)&&A2(e)?e:xI(jx(e))}function tv(e,t){var i;t===void 0&&(t=[]);var a=xI(e),c=a===((i=e.ownerDocument)==null?void 0:i.body),h=dl(a),f=c?[h].concat(h.visualViewport||[],A2(a)?a:[]):a,o=t.concat(f);return c?o:o.concat(tv(jx(f)))}function Sw(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function IL(e,t){var i=Og(e,!1,t==="fixed");return i.top=i.top+e.clientTop,i.left=i.left+e.clientLeft,i.bottom=i.top+e.clientHeight,i.right=i.left+e.clientWidth,i.width=e.clientWidth,i.height=e.clientHeight,i.x=i.left,i.y=i.top,i}function BT(e,t,i){return t===fI?Sw(PL(e,i)):qp(t)?IL(t,i):Sw(EL(Rf(e)))}function kL(e){var t=tv(jx(e)),i=["absolute","fixed"].indexOf(od(e).position)>=0,a=i&&Jl(e)?qv(e):e;return qp(a)?t.filter(function(c){return qp(c)&&gI(c,a)&&ih(c)!=="body"}):[]}function AL(e,t,i,a){var c=t==="clippingParents"?kL(e):[].concat(t),h=[].concat(c,[i]),f=h[0],o=h.reduce(function(b,P){var I=BT(e,P,a);return b.top=Vp(I.top,b.top),b.right=Z_(I.right,b.right),b.bottom=Z_(I.bottom,b.bottom),b.left=Vp(I.left,b.left),b},BT(e,f,a));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function bI(e){var t=e.reference,i=e.element,a=e.placement,c=a?Qu(a):null,h=a?Lg(a):null,f=t.x+t.width/2-i.width/2,o=t.y+t.height/2-i.height/2,b;switch(c){case Ta:b={x:f,y:t.y-i.height};break;case Ql:b={x:f,y:t.y+t.height};break;case ec:b={x:t.x+t.width,y:o};break;case Ma:b={x:t.x-i.width,y:o};break;default:b={x:t.x,y:t.y}}var P=c?E2(c):null;if(P!=null){var I=P==="y"?"height":"width";switch(h){case Dg:b[P]=b[P]-(t[I]/2-i[I]/2);break;case Sv:b[P]=b[P]+(t[I]/2-i[I]/2);break}}return b}function Cv(e,t){t===void 0&&(t={});var i=t,a=i.placement,c=a===void 0?e.placement:a,h=i.strategy,f=h===void 0?e.strategy:h,o=i.boundary,b=o===void 0?YO:o,P=i.rootBoundary,I=P===void 0?fI:P,D=i.elementContext,z=D===void 0?By:D,F=i.altBoundary,U=F===void 0?!1:F,$=i.padding,j=$===void 0?0:$,ie=vI(typeof j!="number"?j:_I(j,Gv)),se=z===By?JO:By,Q=e.rects.popper,de=e.elements[U?se:z],oe=AL(qp(de)?de:de.contextElement||Rf(e.elements.popper),b,I,f),be=Og(e.elements.reference),xe=bI({reference:be,element:Q,placement:c}),Me=Sw(Object.assign({},Q,xe)),Ee=z===By?Me:be,re={top:oe.top-Ee.top+ie.top,bottom:Ee.bottom-oe.bottom+ie.bottom,left:oe.left-Ee.left+ie.left,right:Ee.right-oe.right+ie.right},ke=e.modifiersData.offset;if(z===By&&ke){var Ge=ke[c];Object.keys(re).forEach(function(Ke){var gt=[ec,Ql].indexOf(Ke)>=0?1:-1,et=[Ta,Ql].indexOf(Ke)>=0?"y":"x";re[Ke]+=Ge[et]*gt})}return re}function RL(e,t){t===void 0&&(t={});var i=t,a=i.placement,c=i.boundary,h=i.rootBoundary,f=i.padding,o=i.flipVariations,b=i.allowedAutoPlacements,P=b===void 0?pI:b,I=Lg(a),D=I?o?zT:zT.filter(function(U){return Lg(U)===I}):Gv,z=D.filter(function(U){return P.indexOf(U)>=0});z.length===0&&(z=D);var F=z.reduce(function(U,$){return U[$]=Cv(e,{placement:$,boundary:c,rootBoundary:h,padding:f})[Qu($)],U},{});return Object.keys(F).sort(function(U,$){return F[U]-F[$]})}function DL(e){if(Qu(e)===T2)return[];var t=k_(e);return[FT(e),t,FT(t)]}function zL(e){var t=e.state,i=e.options,a=e.name;if(!t.modifiersData[a]._skip){for(var c=i.mainAxis,h=c===void 0?!0:c,f=i.altAxis,o=f===void 0?!0:f,b=i.fallbackPlacements,P=i.padding,I=i.boundary,D=i.rootBoundary,z=i.altBoundary,F=i.flipVariations,U=F===void 0?!0:F,$=i.allowedAutoPlacements,j=t.options.placement,ie=Qu(j),se=ie===j,Q=b||(se||!U?[k_(j)]:DL(j)),de=[j].concat(Q).reduce(function(wt,xt){return wt.concat(Qu(xt)===T2?RL(t,{placement:xt,boundary:I,rootBoundary:D,padding:P,flipVariations:U,allowedAutoPlacements:$}):xt)},[]),oe=t.rects.reference,be=t.rects.popper,xe=new Map,Me=!0,Ee=de[0],re=0;re<de.length;re++){var ke=de[re],Ge=Qu(ke),Ke=Lg(ke)===Dg,gt=[Ta,Ql].indexOf(Ge)>=0,et=gt?"width":"height",qe=Cv(t,{placement:ke,boundary:I,rootBoundary:D,altBoundary:z,padding:P}),Qe=gt?Ke?ec:Ma:Ke?Ql:Ta;oe[et]>be[et]&&(Qe=k_(Qe));var Ve=k_(Qe),je=[];if(h&&je.push(qe[Ge]<=0),o&&je.push(qe[Qe]<=0,qe[Ve]<=0),je.every(function(wt){return wt})){Ee=ke,Me=!1;break}xe.set(ke,je)}if(Me)for(var ct=U?3:1,ye=function(xt){var _t=de.find(function(St){var tt=xe.get(St);if(tt)return tt.slice(0,xt).every(function(At){return At})});if(_t)return Ee=_t,"break"},ze=ct;ze>0;ze--){var ft=ye(ze);if(ft==="break")break}t.placement!==Ee&&(t.modifiersData[a]._skip=!0,t.placement=Ee,t.reset=!0)}}const OL={name:"flip",enabled:!0,phase:"main",fn:zL,requiresIfExists:["offset"],data:{_skip:!1}};function $T(e,t,i){return i===void 0&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function jT(e){return[Ta,ec,Ql,Ma].some(function(t){return e[t]>=0})}function LL(e){var t=e.state,i=e.name,a=t.rects.reference,c=t.rects.popper,h=t.modifiersData.preventOverflow,f=Cv(t,{elementContext:"reference"}),o=Cv(t,{altBoundary:!0}),b=$T(f,a),P=$T(o,c,h),I=jT(b),D=jT(P);t.modifiersData[i]={referenceClippingOffsets:b,popperEscapeOffsets:P,isReferenceHidden:I,hasPopperEscaped:D},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":I,"data-popper-escaped":D})}const FL={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:LL};function BL(e,t,i){var a=Qu(e),c=[Ma,Ta].indexOf(a)>=0?-1:1,h=typeof i=="function"?i(Object.assign({},t,{placement:e})):i,f=h[0],o=h[1];return f=f||0,o=(o||0)*c,[Ma,ec].indexOf(a)>=0?{x:o,y:f}:{x:f,y:o}}function $L(e){var t=e.state,i=e.options,a=e.name,c=i.offset,h=c===void 0?[0,0]:c,f=pI.reduce(function(I,D){return I[D]=BL(D,t.rects,h),I},{}),o=f[t.placement],b=o.x,P=o.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=b,t.modifiersData.popperOffsets.y+=P),t.modifiersData[a]=f}const jL={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:$L};function NL(e){var t=e.state,i=e.name;t.modifiersData[i]=bI({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const VL={name:"popperOffsets",enabled:!0,phase:"read",fn:NL,data:{}};function UL(e){return e==="x"?"y":"x"}function GL(e){var t=e.state,i=e.options,a=e.name,c=i.mainAxis,h=c===void 0?!0:c,f=i.altAxis,o=f===void 0?!1:f,b=i.boundary,P=i.rootBoundary,I=i.altBoundary,D=i.padding,z=i.tether,F=z===void 0?!0:z,U=i.tetherOffset,$=U===void 0?0:U,j=Cv(t,{boundary:b,rootBoundary:P,padding:D,altBoundary:I}),ie=Qu(t.placement),se=Lg(t.placement),Q=!se,de=E2(ie),oe=UL(de),be=t.modifiersData.popperOffsets,xe=t.rects.reference,Me=t.rects.popper,Ee=typeof $=="function"?$(Object.assign({},t.rects,{placement:t.placement})):$,re=typeof Ee=="number"?{mainAxis:Ee,altAxis:Ee}:Object.assign({mainAxis:0,altAxis:0},Ee),ke=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,Ge={x:0,y:0};if(be){if(h){var Ke,gt=de==="y"?Ta:Ma,et=de==="y"?Ql:ec,qe=de==="y"?"height":"width",Qe=be[de],Ve=Qe+j[gt],je=Qe-j[et],ct=F?-Me[qe]/2:0,ye=se===Dg?xe[qe]:Me[qe],ze=se===Dg?-Me[qe]:-xe[qe],ft=t.elements.arrow,wt=F&&ft?P2(ft):{width:0,height:0},xt=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:yI(),_t=xt[gt],St=xt[et],tt=ev(0,xe[qe],wt[qe]),At=Q?xe[qe]/2-ct-tt-_t-re.mainAxis:ye-tt-_t-re.mainAxis,It=Q?-xe[qe]/2+ct+tt+St+re.mainAxis:ze+tt+St+re.mainAxis,mr=t.elements.arrow&&qv(t.elements.arrow),ur=mr?de==="y"?mr.clientTop||0:mr.clientLeft||0:0,Hr=(Ke=ke?.[de])!=null?Ke:0,wr=Qe+At-Hr-ur,sr=Qe+It-Hr,Wt=ev(F?Z_(Ve,wr):Ve,Qe,F?Vp(je,sr):je);be[de]=Wt,Ge[de]=Wt-Qe}if(o){var yr,Yt=de==="x"?Ta:Ma,Cr=de==="x"?Ql:ec,Rr=be[oe],Or=oe==="y"?"height":"width",Gr=Rr+j[Yt],rn=Rr-j[Cr],Un=[Ta,Ma].indexOf(ie)!==-1,wn=(yr=ke?.[oe])!=null?yr:0,He=Un?Gr:Rr-xe[Or]-Me[Or]-wn+re.altAxis,ae=Un?Rr+xe[Or]+Me[Or]-wn-re.altAxis:rn,le=F&&Un?pL(He,Rr,ae):ev(F?He:Gr,Rr,F?ae:rn);be[oe]=le,Ge[oe]=le-Rr}t.modifiersData[a]=Ge}}const qL={name:"preventOverflow",enabled:!0,phase:"main",fn:GL,requiresIfExists:["offset"]};function HL(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function WL(e){return e===dl(e)||!Jl(e)?I2(e):HL(e)}function ZL(e){var t=e.getBoundingClientRect(),i=zg(t.width)/e.offsetWidth||1,a=zg(t.height)/e.offsetHeight||1;return i!==1||a!==1}function XL(e,t,i){i===void 0&&(i=!1);var a=Jl(t),c=Jl(t)&&ZL(t),h=Rf(t),f=Og(e,c,i),o={scrollLeft:0,scrollTop:0},b={x:0,y:0};return(a||!a&&!i)&&((ih(t)!=="body"||A2(h))&&(o=WL(t)),Jl(t)?(b=Og(t,!0),b.x+=t.clientLeft,b.y+=t.clientTop):h&&(b.x=k2(h))),{x:f.left+o.scrollLeft-b.x,y:f.top+o.scrollTop-b.y,width:f.width,height:f.height}}function KL(e){var t=new Map,i=new Set,a=[];e.forEach(function(h){t.set(h.name,h)});function c(h){i.add(h.name);var f=[].concat(h.requires||[],h.requiresIfExists||[]);f.forEach(function(o){if(!i.has(o)){var b=t.get(o);b&&c(b)}}),a.push(h)}return e.forEach(function(h){i.has(h.name)||c(h)}),a}function YL(e){var t=KL(e);return lL.reduce(function(i,a){return i.concat(t.filter(function(c){return c.phase===a}))},[])}function JL(e){var t;return function(){return t||(t=new Promise(function(i){Promise.resolve().then(function(){t=void 0,i(e())})})),t}}function QL(e){var t=e.reduce(function(i,a){var c=i[a.name];return i[a.name]=c?Object.assign({},c,a,{options:Object.assign({},c.options,a.options),data:Object.assign({},c.data,a.data)}):a,i},{});return Object.keys(t).map(function(i){return t[i]})}var NT={placement:"bottom",modifiers:[],strategy:"absolute"};function VT(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function e4(e){e===void 0&&(e={});var t=e,i=t.defaultModifiers,a=i===void 0?[]:i,c=t.defaultOptions,h=c===void 0?NT:c;return function(o,b,P){P===void 0&&(P=h);var I={placement:"bottom",orderedModifiers:[],options:Object.assign({},NT,h),modifiersData:{},elements:{reference:o,popper:b},attributes:{},styles:{}},D=[],z=!1,F={state:I,setOptions:function(ie){var se=typeof ie=="function"?ie(I.options):ie;$(),I.options=Object.assign({},h,I.options,se),I.scrollParents={reference:qp(o)?tv(o):o.contextElement?tv(o.contextElement):[],popper:tv(b)};var Q=YL(QL([].concat(a,I.options.modifiers)));return I.orderedModifiers=Q.filter(function(de){return de.enabled}),U(),F.update()},forceUpdate:function(){if(!z){var ie=I.elements,se=ie.reference,Q=ie.popper;if(VT(se,Q)){I.rects={reference:XL(se,qv(Q),I.options.strategy==="fixed"),popper:P2(Q)},I.reset=!1,I.placement=I.options.placement,I.orderedModifiers.forEach(function(re){return I.modifiersData[re.name]=Object.assign({},re.data)});for(var de=0;de<I.orderedModifiers.length;de++){if(I.reset===!0){I.reset=!1,de=-1;continue}var oe=I.orderedModifiers[de],be=oe.fn,xe=oe.options,Me=xe===void 0?{}:xe,Ee=oe.name;typeof be=="function"&&(I=be({state:I,options:Me,name:Ee,instance:F})||I)}}}},update:JL(function(){return new Promise(function(j){F.forceUpdate(),j(I)})}),destroy:function(){$(),z=!0}};if(!VT(o,b))return F;F.setOptions(P).then(function(j){!z&&P.onFirstUpdate&&P.onFirstUpdate(j)});function U(){I.orderedModifiers.forEach(function(j){var ie=j.name,se=j.options,Q=se===void 0?{}:se,de=j.effect;if(typeof de=="function"){var oe=de({state:I,name:ie,instance:F,options:Q}),be=function(){};D.push(oe||be)}})}function $(){D.forEach(function(j){return j()}),D=[]}return F}}var t4=[CL,VL,wL,hL,jL,OL,qL,vL,FL],r4=e4({defaultModifiers:t4});const n4="Popper";function i4(e){return jO(n4,e)}const o4=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],s4=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function a4(e,t){if(t==="ltr")return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}function Cw(e){return typeof e=="function"?e():e}function l4(e){return e.nodeType!==void 0}const c4=()=>di({root:["root"]},LO(i4)),u4={},h4=K.forwardRef(function(t,i){var a;const{anchorEl:c,children:h,direction:f,disablePortal:o,modifiers:b,open:P,placement:I,popperOptions:D,popperRef:z,slotProps:F={},slots:U={},TransitionProps:$}=t,j=Pr(t,o4),ie=K.useRef(null),se=Ea(ie,i),Q=K.useRef(null),de=Ea(Q,z),oe=K.useRef(de);bv(()=>{oe.current=de},[de]),K.useImperativeHandle(z,()=>Q.current,[]);const be=a4(I,f),[xe,Me]=K.useState(be),[Ee,re]=K.useState(Cw(c));K.useEffect(()=>{Q.current&&Q.current.forceUpdate()}),K.useEffect(()=>{c&&re(Cw(c))},[c]),bv(()=>{if(!Ee||!P)return;const et=Ve=>{Me(Ve.placement)};let qe=[{name:"preventOverflow",options:{altBoundary:o}},{name:"flip",options:{altBoundary:o}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:Ve})=>{et(Ve)}}];b!=null&&(qe=qe.concat(b)),D&&D.modifiers!=null&&(qe=qe.concat(D.modifiers));const Qe=r4(Ee,ie.current,we({placement:be},D,{modifiers:qe}));return oe.current(Qe),()=>{Qe.destroy(),oe.current(null)}},[Ee,o,b,P,D,be]);const ke={placement:xe};$!==null&&(ke.TransitionProps=$);const Ge=c4(),Ke=(a=U.root)!=null?a:"div",gt=qz({elementType:Ke,externalSlotProps:F.root,externalForwardedProps:j,additionalProps:{role:"tooltip",ref:se},ownerState:t,className:Ge.root});return G.jsx(Ke,we({},gt,{children:typeof h=="function"?h(ke):h}))}),d4=K.forwardRef(function(t,i){const{anchorEl:a,children:c,container:h,direction:f="ltr",disablePortal:o=!1,keepMounted:b=!1,modifiers:P,open:I,placement:D="bottom",popperOptions:z=u4,popperRef:F,style:U,transition:$=!1,slotProps:j={},slots:ie={}}=t,se=Pr(t,s4),[Q,de]=K.useState(!0),oe=()=>{de(!1)},be=()=>{de(!0)};if(!b&&!I&&(!$||Q))return null;let xe;if(h)xe=h;else if(a){const re=Cw(a);xe=re&&l4(re)?Qy(re).body:Qy(null).body}const Me=!I&&b&&(!$||Q)?"none":void 0,Ee=$?{in:I,onEnter:oe,onExited:be}:void 0;return G.jsx(KO,{disablePortal:o,container:xe,children:G.jsx(h4,we({anchorEl:a,direction:f,disablePortal:o,modifiers:P,ref:i,open:$?!Q:I,placement:D,popperOptions:z,popperRef:F,slotProps:j,slots:ie},se,{style:we({position:"fixed",top:0,left:0,display:Me},U),TransitionProps:Ee,children:c}))})});function f4(e={}){const{autoHideDuration:t=null,disableWindowBlurListener:i=!1,onClose:a,open:c,resumeHideDuration:h}=e,f=zz();K.useEffect(()=>{if(!c)return;function ie(se){se.defaultPrevented||(se.key==="Escape"||se.key==="Esc")&&a?.(se,"escapeKeyDown")}return document.addEventListener("keydown",ie),()=>{document.removeEventListener("keydown",ie)}},[c,a]);const o=Bp((ie,se)=>{a?.(ie,se)}),b=Bp(ie=>{!a||ie==null||f.start(ie,()=>{o(null,"timeout")})});K.useEffect(()=>(c&&b(t),f.clear),[c,t,b,f]);const P=ie=>{a?.(ie,"clickaway")},I=f.clear,D=K.useCallback(()=>{t!=null&&b(h??t*.5)},[t,h,b]),z=ie=>se=>{const Q=ie.onBlur;Q?.(se),D()},F=ie=>se=>{const Q=ie.onFocus;Q?.(se),I()},U=ie=>se=>{const Q=ie.onMouseEnter;Q?.(se),I()},$=ie=>se=>{const Q=ie.onMouseLeave;Q?.(se),D()};return K.useEffect(()=>{if(!i&&c)return window.addEventListener("focus",D),window.addEventListener("blur",I),()=>{window.removeEventListener("focus",D),window.removeEventListener("blur",I)}},[i,c,D,I]),{getRootProps:(ie={})=>{const se=we({},bf(e),bf(ie));return we({role:"presentation"},ie,se,{onBlur:z(se),onFocus:F(se),onMouseEnter:U(se),onMouseLeave:$(se)})},onClickAway:P}}function UT(e){return typeof e.normalize<"u"?e.normalize("NFD").replace(/[\u0300-\u036f]/g,""):e}function p4(e={}){const{ignoreAccents:t=!0,ignoreCase:i=!0,limit:a,matchFrom:c="any",stringify:h,trim:f=!1}=e;return(o,{inputValue:b,getOptionLabel:P})=>{let I=f?b.trim():b;i&&(I=I.toLowerCase()),t&&(I=UT(I));const D=I?o.filter(z=>{let F=(h||P)(z);return i&&(F=F.toLowerCase()),t&&(F=UT(F)),c==="start"?F.indexOf(I)===0:F.indexOf(I)>-1}):o;return typeof a=="number"?D.slice(0,a):D}}function l_(e,t){for(let i=0;i<e.length;i+=1)if(t(e[i]))return i;return-1}const m4=p4(),GT=5,g4=e=>{var t;return e.current!==null&&((t=e.current.parentElement)==null?void 0:t.contains(document.activeElement))},y4=[];function v4(e){const{unstable_isActiveElementInListbox:t=g4,unstable_classNamePrefix:i="Mui",autoComplete:a=!1,autoHighlight:c=!1,autoSelect:h=!1,blurOnSelect:f=!1,clearOnBlur:o=!e.freeSolo,clearOnEscape:b=!1,componentName:P="useAutocomplete",defaultValue:I=e.multiple?y4:null,disableClearable:D=!1,disableCloseOnSelect:z=!1,disabled:F,disabledItemsFocusable:U=!1,disableListWrap:$=!1,filterOptions:j=m4,filterSelectedOptions:ie=!1,freeSolo:se=!1,getOptionDisabled:Q,getOptionKey:de,getOptionLabel:oe=ot=>{var rt;return(rt=ot.label)!=null?rt:ot},groupBy:be,handleHomeEndKeys:xe=!e.freeSolo,id:Me,includeInputInList:Ee=!1,inputValue:re,isOptionEqualToValue:ke=(ot,rt)=>ot===rt,multiple:Ge=!1,onChange:Ke,onClose:gt,onHighlightChange:et,onInputChange:qe,onOpen:Qe,open:Ve,openOnFocus:je=!1,options:ct,readOnly:ye=!1,selectOnFocus:ze=!e.freeSolo,value:ft}=e,wt=x2(Me);let xt=oe;xt=ot=>{const rt=oe(ot);return typeof rt!="string"?String(rt):rt};const _t=K.useRef(!1),St=K.useRef(!0),tt=K.useRef(null),At=K.useRef(null),[It,mr]=K.useState(null),[ur,Hr]=K.useState(-1),wr=c?0:-1,sr=K.useRef(wr),[Wt,yr]=_b({controlled:ft,default:I,name:P}),[Yt,Cr]=_b({controlled:re,default:"",name:P,state:"inputValue"}),[Rr,Or]=K.useState(!1),Gr=K.useCallback((ot,rt)=>{if(!(Ge?Wt.length<rt.length:rt!==null)&&!o)return;let Tr;if(Ge)Tr="";else if(rt==null)Tr="";else{const Nr=xt(rt);Tr=typeof Nr=="string"?Nr:""}Yt!==Tr&&(Cr(Tr),qe&&qe(ot,Tr,"reset"))},[xt,Yt,Ge,qe,Cr,o,Wt]),[rn,Un]=_b({controlled:Ve,default:!1,name:P,state:"open"}),[wn,He]=K.useState(!0),ae=!Ge&&Wt!=null&&Yt===xt(Wt),le=rn&&!ye,ue=le?j(ct.filter(ot=>!(ie&&(Ge?Wt:[Wt]).some(rt=>rt!==null&&ke(ot,rt)))),{inputValue:ae&&wn?"":Yt,getOptionLabel:xt}):[],Pe=Vz({filteredOptions:ue,value:Wt,inputValue:Yt});K.useEffect(()=>{const ot=Wt!==Pe.value;Rr&&!ot||se&&!ot||Gr(null,Wt)},[Wt,Gr,Rr,Pe.value,se]);const Re=rn&&ue.length>0&&!ye,Ye=Bp(ot=>{ot===-1?tt.current.focus():It.querySelector(`[data-tag-index="${ot}"]`).focus()});K.useEffect(()=>{Ge&&ur>Wt.length-1&&(Hr(-1),Ye(-1))},[Wt,Ge,ur,Ye]);function Xe(ot,rt){if(!At.current||ot<0||ot>=ue.length)return-1;let Zt=ot;for(;;){const Tr=At.current.querySelector(`[data-option-index="${Zt}"]`),Nr=U?!1:!Tr||Tr.disabled||Tr.getAttribute("aria-disabled")==="true";if(Tr&&Tr.hasAttribute("tabindex")&&!Nr)return Zt;if(rt==="next"?Zt=(Zt+1)%ue.length:Zt=(Zt-1+ue.length)%ue.length,Zt===ot)return-1}}const $e=Bp(({event:ot,index:rt,reason:Zt="auto"})=>{if(sr.current=rt,rt===-1?tt.current.removeAttribute("aria-activedescendant"):tt.current.setAttribute("aria-activedescendant",`${wt}-option-${rt}`),et&&et(ot,rt===-1?null:ue[rt],Zt),!At.current)return;const Tr=At.current.querySelector(`[role="option"].${i}-focused`);Tr&&(Tr.classList.remove(`${i}-focused`),Tr.classList.remove(`${i}-focusVisible`));let Nr=At.current;if(At.current.getAttribute("role")!=="listbox"&&(Nr=At.current.parentElement.querySelector('[role="listbox"]')),!Nr)return;if(rt===-1){Nr.scrollTop=0;return}const ir=At.current.querySelector(`[data-option-index="${rt}"]`);if(ir&&(ir.classList.add(`${i}-focused`),Zt==="keyboard"&&ir.classList.add(`${i}-focusVisible`),Nr.scrollHeight>Nr.clientHeight&&Zt!=="mouse"&&Zt!=="touch")){const An=ir,Gi=Nr.clientHeight+Nr.scrollTop,Ra=An.offsetTop+An.offsetHeight;Ra>Gi?Nr.scrollTop=Ra-Nr.clientHeight:An.offsetTop-An.offsetHeight*(be?1.3:0)<Nr.scrollTop&&(Nr.scrollTop=An.offsetTop-An.offsetHeight*(be?1.3:0))}}),Je=Bp(({event:ot,diff:rt,direction:Zt="next",reason:Tr="auto"})=>{if(!le)return;const ir=Xe((()=>{const An=ue.length-1;if(rt==="reset")return wr;if(rt==="start")return 0;if(rt==="end")return An;const Gi=sr.current+rt;return Gi<0?Gi===-1&&Ee?-1:$&&sr.current!==-1||Math.abs(rt)>1?0:An:Gi>An?Gi===An+1&&Ee?-1:$||Math.abs(rt)>1?An:0:Gi})(),Zt);if($e({index:ir,reason:Tr,event:ot}),a&&rt!=="reset")if(ir===-1)tt.current.value=Yt;else{const An=xt(ue[ir]);tt.current.value=An,An.toLowerCase().indexOf(Yt.toLowerCase())===0&&Yt.length>0&&tt.current.setSelectionRange(Yt.length,An.length)}}),Ct=()=>{const ot=(rt,Zt)=>{const Tr=rt?xt(rt):"",Nr=Zt?xt(Zt):"";return Tr===Nr};if(sr.current!==-1&&Pe.filteredOptions&&Pe.filteredOptions.length!==ue.length&&Pe.inputValue===Yt&&(Ge?Wt.length===Pe.value.length&&Pe.value.every((rt,Zt)=>xt(Wt[Zt])===xt(rt)):ot(Pe.value,Wt))){const rt=Pe.filteredOptions[sr.current];if(rt)return l_(ue,Zt=>xt(Zt)===xt(rt))}return-1},yt=K.useCallback(()=>{if(!le)return;const ot=Ct();if(ot!==-1){sr.current=ot;return}const rt=Ge?Wt[0]:Wt;if(ue.length===0||rt==null){Je({diff:"reset"});return}if(At.current){if(rt!=null){const Zt=ue[sr.current];if(Ge&&Zt&&l_(Wt,Nr=>ke(Zt,Nr))!==-1)return;const Tr=l_(ue,Nr=>ke(Nr,rt));Tr===-1?Je({diff:"reset"}):$e({index:Tr});return}if(sr.current>=ue.length-1){$e({index:ue.length-1});return}$e({index:sr.current})}},[ue.length,Ge?!1:Wt,ie,Je,$e,le,Yt,Ge]),$t=Bp(ot=>{W_(At,ot),ot&&yt()});K.useEffect(()=>{yt()},[yt]);const qt=ot=>{rn||(Un(!0),He(!0),Qe&&Qe(ot))},Qt=(ot,rt)=>{rn&&(Un(!1),gt&&gt(ot,rt))},br=(ot,rt,Zt,Tr)=>{if(Ge){if(Wt.length===rt.length&&Wt.every((Nr,ir)=>Nr===rt[ir]))return}else if(Wt===rt)return;Ke&&Ke(ot,rt,Zt,Tr),yr(rt)},tr=K.useRef(!1),Ze=(ot,rt,Zt="selectOption",Tr="options")=>{let Nr=Zt,ir=rt;if(Ge){ir=Array.isArray(Wt)?Wt.slice():[];const An=l_(ir,Gi=>ke(rt,Gi));An===-1?ir.push(rt):Tr!=="freeSolo"&&(ir.splice(An,1),Nr="removeOption")}Gr(ot,ir),br(ot,ir,Nr,{option:rt}),!z&&(!ot||!ot.ctrlKey&&!ot.metaKey)&&Qt(ot,Nr),(f===!0||f==="touch"&&tr.current||f==="mouse"&&!tr.current)&&tt.current.blur()};function Lr(ot,rt){if(ot===-1)return-1;let Zt=ot;for(;;){if(rt==="next"&&Zt===Wt.length||rt==="previous"&&Zt===-1)return-1;const Tr=It.querySelector(`[data-tag-index="${Zt}"]`);if(!Tr||!Tr.hasAttribute("tabindex")||Tr.disabled||Tr.getAttribute("aria-disabled")==="true")Zt+=rt==="next"?1:-1;else return Zt}}const mn=(ot,rt)=>{if(!Ge)return;Yt===""&&Qt(ot,"toggleInput");let Zt=ur;ur===-1?Yt===""&&rt==="previous"&&(Zt=Wt.length-1):(Zt+=rt==="next"?1:-1,Zt<0&&(Zt=0),Zt===Wt.length&&(Zt=-1)),Zt=Lr(Zt,rt),Hr(Zt),Ye(Zt)},ar=ot=>{_t.current=!0,Cr(""),qe&&qe(ot,"","clear"),br(ot,Ge?[]:null,"clear")},Dr=ot=>rt=>{if(ot.onKeyDown&&ot.onKeyDown(rt),!rt.defaultMuiPrevented&&(ur!==-1&&["ArrowLeft","ArrowRight"].indexOf(rt.key)===-1&&(Hr(-1),Ye(-1)),rt.which!==229))switch(rt.key){case"Home":le&&xe&&(rt.preventDefault(),Je({diff:"start",direction:"next",reason:"keyboard",event:rt}));break;case"End":le&&xe&&(rt.preventDefault(),Je({diff:"end",direction:"previous",reason:"keyboard",event:rt}));break;case"PageUp":rt.preventDefault(),Je({diff:-GT,direction:"previous",reason:"keyboard",event:rt}),qt(rt);break;case"PageDown":rt.preventDefault(),Je({diff:GT,direction:"next",reason:"keyboard",event:rt}),qt(rt);break;case"ArrowDown":rt.preventDefault(),Je({diff:1,direction:"next",reason:"keyboard",event:rt}),qt(rt);break;case"ArrowUp":rt.preventDefault(),Je({diff:-1,direction:"previous",reason:"keyboard",event:rt}),qt(rt);break;case"ArrowLeft":mn(rt,"previous");break;case"ArrowRight":mn(rt,"next");break;case"Enter":if(sr.current!==-1&&le){const Zt=ue[sr.current],Tr=Q?Q(Zt):!1;if(rt.preventDefault(),Tr)return;Ze(rt,Zt,"selectOption"),a&&tt.current.setSelectionRange(tt.current.value.length,tt.current.value.length)}else se&&Yt!==""&&ae===!1&&(Ge&&rt.preventDefault(),Ze(rt,Yt,"createOption","freeSolo"));break;case"Escape":le?(rt.preventDefault(),rt.stopPropagation(),Qt(rt,"escape")):b&&(Yt!==""||Ge&&Wt.length>0)&&(rt.preventDefault(),rt.stopPropagation(),ar(rt));break;case"Backspace":if(Ge&&!ye&&Yt===""&&Wt.length>0){const Zt=ur===-1?Wt.length-1:ur,Tr=Wt.slice();Tr.splice(Zt,1),br(rt,Tr,"removeOption",{option:Wt[Zt]})}break;case"Delete":if(Ge&&!ye&&Yt===""&&Wt.length>0&&ur!==-1){const Zt=ur,Tr=Wt.slice();Tr.splice(Zt,1),br(rt,Tr,"removeOption",{option:Wt[Zt]})}break}},ln=ot=>{Or(!0),je&&!_t.current&&qt(ot)},Xr=ot=>{if(t(At)){tt.current.focus();return}Or(!1),St.current=!0,_t.current=!1,h&&sr.current!==-1&&le?Ze(ot,ue[sr.current],"blur"):h&&se&&Yt!==""?Ze(ot,Yt,"blur","freeSolo"):o&&Gr(ot,Wt),Qt(ot,"blur")},zr=ot=>{const rt=ot.target.value;Yt!==rt&&(Cr(rt),He(!1),qe&&qe(ot,rt,"input")),rt===""?!D&&!Ge&&br(ot,null,"clear"):qt(ot)},Vr=ot=>{const rt=Number(ot.currentTarget.getAttribute("data-option-index"));sr.current!==rt&&$e({event:ot,index:rt,reason:"mouse"})},Kr=ot=>{$e({event:ot,index:Number(ot.currentTarget.getAttribute("data-option-index")),reason:"touch"}),tr.current=!0},Vi=ot=>{const rt=Number(ot.currentTarget.getAttribute("data-option-index"));Ze(ot,ue[rt],"selectOption"),tr.current=!1},Ui=ot=>rt=>{const Zt=Wt.slice();Zt.splice(ot,1),br(rt,Zt,"removeOption",{option:Wt[ot]})},Et=ot=>{rn?Qt(ot,"toggleInput"):qt(ot)},vn=ot=>{ot.currentTarget.contains(ot.target)&&ot.target.getAttribute("id")!==wt&&ot.preventDefault()},zn=ot=>{ot.currentTarget.contains(ot.target)&&(tt.current.focus(),ze&&St.current&&tt.current.selectionEnd-tt.current.selectionStart===0&&tt.current.select(),St.current=!1)},fs=ot=>{!F&&(Yt===""||!rn)&&Et(ot)};let Ki=se&&Yt.length>0;Ki=Ki||(Ge?Wt.length>0:Wt!==null);let jt=ue;return be&&(jt=ue.reduce((ot,rt,Zt)=>{const Tr=be(rt);return ot.length>0&&ot[ot.length-1].group===Tr?ot[ot.length-1].options.push(rt):ot.push({key:Zt,index:Zt,group:Tr,options:[rt]}),ot},[])),F&&Rr&&Xr(),{getRootProps:(ot={})=>we({"aria-owns":Re?`${wt}-listbox`:null},ot,{onKeyDown:Dr(ot),onMouseDown:vn,onClick:zn}),getInputLabelProps:()=>({id:`${wt}-label`,htmlFor:wt}),getInputProps:()=>({id:wt,value:Yt,onBlur:Xr,onFocus:ln,onChange:zr,onMouseDown:fs,"aria-activedescendant":le?"":null,"aria-autocomplete":a?"both":"list","aria-controls":Re?`${wt}-listbox`:void 0,"aria-expanded":Re,autoComplete:"off",ref:tt,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:F}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:ar}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:Et}),getTagProps:({index:ot})=>we({key:ot,"data-tag-index":ot,tabIndex:-1},!ye&&{onDelete:Ui(ot)}),getListboxProps:()=>({role:"listbox",id:`${wt}-listbox`,"aria-labelledby":`${wt}-label`,ref:$t,onMouseDown:ot=>{ot.preventDefault()}}),getOptionProps:({index:ot,option:rt})=>{var Zt;const Tr=(Ge?Wt:[Wt]).some(ir=>ir!=null&&ke(rt,ir)),Nr=Q?Q(rt):!1;return{key:(Zt=de?.(rt))!=null?Zt:xt(rt),tabIndex:-1,role:"option",id:`${wt}-option-${ot}`,onMouseMove:Vr,onClick:Vi,onTouchStart:Kr,"data-option-index":ot,"aria-disabled":Nr,"aria-selected":Tr}},id:wt,inputValue:Yt,value:Wt,dirty:Ki,expanded:le&&It,popupOpen:le,focused:Rr||ur!==-1,anchorEl:It,setAnchorEl:mr,focusedTag:ur,groupedOptions:jt}}const _4=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],x4=["component","slots","slotProps"],b4=["component"];function _r(e,t){const{className:i,elementType:a,ownerState:c,externalForwardedProps:h,getSlotOwnerState:f,internalForwardedProps:o}=t,b=Pr(t,_4),{component:P,slots:I={[e]:void 0},slotProps:D={[e]:void 0}}=h,z=Pr(h,x4),F=I[e]||a,U=sI(D[e],c),$=oI(we({className:i},b,{externalForwardedProps:e==="root"?z:void 0,externalSlotProps:U})),{props:{component:j},internalRef:ie}=$,se=Pr($.props,b4),Q=Ea(ie,U?.ref,t.ref),de=f?f(se):{},oe=we({},c,de),be=e==="root"?j||P:j,xe=iI(F,we({},e==="root"&&!P&&!I[e]&&o,e!=="root"&&!I[e]&&o,se,be&&{as:be},{ref:Q}),oe);return Object.keys(de).forEach(Me=>{delete xe[Me]}),[F,xe]}function w4(e){return wi("MuiListItem",e)}const X_=Si("MuiListItem",["root","startAction","endAction","nested","nesting","sticky","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]),K_=K.createContext(!1),Nx=K.createContext(!1),wI=K.createContext(!1),R2=K.createContext(void 0),SI=K.createContext(void 0),CI=K.createContext(void 0),S4=["component","className","children","nested","sticky","variant","color","startAction","endAction","role","slots","slotProps"],C4=e=>{const{sticky:t,nested:i,nesting:a,variant:c,color:h}=e,f={root:["root",i&&"nested",a&&"nesting",t&&"sticky",h&&`color${xr(h)}`,c&&`variant${xr(c)}`],startAction:["startAction"],endAction:["endAction"]};return di(f,w4,{})},T4=rr("li")(({theme:e,ownerState:t})=>{var i;return[!t.nested&&{"--ListItemButton-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))","--ListItemButton-marginBlock":"calc(-1 * var(--ListItem-paddingY))",alignItems:"center",gap:"var(--ListItem-gap)",marginInline:"var(--ListItem-marginInline)"},t.nested&&{"--NestedList-marginRight":"calc(-1 * var(--ListItem-paddingRight))","--NestedList-marginLeft":"calc(-1 * var(--ListItem-paddingLeft))","--NestedListItem-paddingLeft":"calc(var(--ListItem-paddingLeft) + var(--List-nestedInsetStart))","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))","--ListItem-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))",flexDirection:"column"},we({"--unstable_actionRadius":"calc(var(--ListItem-radius) - var(--variant-borderWidth, 0px))"},t.startAction&&{"--unstable_startActionWidth":"2rem"},t.endAction&&{"--unstable_endActionWidth":"2.5rem"},{boxSizing:"border-box",borderRadius:"var(--ListItem-radius)",display:"var(--_ListItem-display)","&:not([hidden])":{"--_ListItem-display":"var(--_List-markerDisplay, flex)"},flex:"none",listStyleType:"var(--_List-markerType, disc)",position:"relative",paddingBlockStart:t.nested?0:"var(--ListItem-paddingY)",paddingBlockEnd:t.nested?0:"var(--ListItem-paddingY)",paddingInlineStart:"var(--ListItem-paddingLeft)",paddingInlineEnd:"var(--ListItem-paddingRight)"},t["data-first-child"]===void 0&&we({},t.row?{marginInlineStart:"var(--List-gap)"}:{marginBlockStart:"var(--List-gap)"}),t.row&&t.wrap&&{marginInlineStart:"var(--List-gap)",marginBlockStart:"var(--List-gap)"},{minBlockSize:"var(--ListItem-minHeight)"},t.sticky&&{position:"sticky",top:"var(--ListItem-stickyTop, 0px)",zIndex:1,background:`var(--ListItem-stickyBackground, ${e.vars.palette.background.body})`},{[`.${X_.nested} > &`]:{"--_ListItem-display":"flex"}}),(i=e.variants[t.variant])==null?void 0:i[t.color]]}),M4=rr(T4,{name:"JoyListItem",slot:"Root",overridesResolver:(e,t)=>t.root})({}),P4=rr("div",{name:"JoyListItem",slot:"StartAction",overridesResolver:(e,t)=>t.startAction})(({ownerState:e})=>({display:"inherit",position:"absolute",top:e.nested?"calc(var(--ListItem-minHeight) / 2)":"50%",left:0,transform:"translate(var(--ListItem-startActionTranslateX), -50%)",zIndex:1})),E4=rr("div",{name:"JoyListItem",slot:"StartAction",overridesResolver:(e,t)=>t.startAction})(({ownerState:e})=>({display:"inherit",position:"absolute",top:e.nested?"calc(var(--ListItem-minHeight) / 2)":"50%",right:0,transform:"translate(var(--ListItem-endActionTranslateX), -50%)"})),ll=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoyListItem"}),c=K.useContext(CI),h=K.useContext(R2),f=K.useContext(Nx),o=K.useContext(wI),b=K.useContext(K_),{component:P,className:I,children:D,nested:z=!1,sticky:F=!1,variant:U="plain",color:$="neutral",startAction:j,endAction:ie,role:se,slots:Q={},slotProps:de={}}=a,oe=Pr(a,S4),[be,xe]=K.useState(""),[Me,Ee]=h?.split(":")||["",""],re=P||(Me&&!Me.match(/^(ul|ol|menu)$/)?"div":void 0);let ke=c==="menu"?"none":void 0;h&&(ke={menu:"none",menubar:"none",group:"presentation"}[Ee]),se&&(ke=se);const Ge=we({},a,{sticky:F,startAction:j,endAction:ie,row:f,wrap:o,variant:U,color:$,nesting:b,nested:z,component:re,role:ke}),Ke=C4(Ge),gt=we({},oe,{component:re,slots:Q,slotProps:de}),[et,qe]=_r("root",{additionalProps:{role:ke},ref:i,className:hi(Ke.root,I),elementType:M4,externalForwardedProps:gt,ownerState:Ge}),[Qe,Ve]=_r("startAction",{className:Ke.startAction,elementType:P4,externalForwardedProps:gt,ownerState:Ge}),[je,ct]=_r("endAction",{className:Ke.endAction,elementType:E4,externalForwardedProps:gt,ownerState:Ge});return G.jsx(SI.Provider,{value:xe,children:G.jsx(K_.Provider,{value:z?be||!0:!1,children:G.jsxs(et,we({},qe,{children:[j&&G.jsx(Qe,we({},Ve,{children:j})),K.Children.map(D,(ye,ze)=>{var ft;return K.isValidElement(ye)?K.cloneElement(ye,we({},ze===0&&{"data-first-child":""},Vv(ye,["ListItem"])&&{component:((ft=ye.props)==null?void 0:ft.component)||"div"})):ye}),ie&&G.jsx(je,we({},ct,{children:ie}))]}))})})});ll.muiName="ListItem";const I4={"--NestedList-marginRight":"0px","--NestedList-marginLeft":"0px","--NestedListItem-paddingLeft":"var(--ListItem-paddingX)","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"0px","--ListItem-marginBlock":"0px","--ListItem-marginInline":"0px"};function TI(e){const{children:t,nested:i,row:a=!1,wrap:c=!1}=e,h=G.jsx(Nx.Provider,{value:a,children:G.jsx(wI.Provider,{value:c,children:K.Children.map(t,(f,o)=>K.isValidElement(f)?K.cloneElement(f,we({},o===0&&{"data-first-child":""},o===K.Children.count(t)-1&&{"data-last-child":""})):f)})});return i===void 0?h:G.jsx(K_.Provider,{value:i,children:h})}const tm=({theme:e,ownerState:t},i)=>{let a={};function c(h){if(typeof h=="function"){const f=h(e);c(f)}else Array.isArray(h)?h.forEach(f=>{typeof f!="boolean"&&c(f)}):typeof h=="object"&&(a=we({},a,h))}return t.sx&&(c(t.sx),i.forEach(h=>{const f=a[h];if(typeof f=="string"||typeof f=="number")if(h==="borderRadius")if(typeof f=="number")a[h]=`${f}px`;else{var o;a[h]=((o=e.vars)==null?void 0:o.radius[f])||f}else["p","padding","m","margin"].indexOf(h)!==-1&&typeof f=="number"?a[h]=e.spacing(f):a[h]=f;else typeof f=="function"?a[h]=f(e):a[h]=void 0})),a};function k4(e){return wi("MuiList",e)}const A4=Si("MuiList",["root","nesting","scoped","sizeSm","sizeMd","sizeLg","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","horizontal","vertical"]),R4=K.createContext(void 0),D4=["component","className","children","size","orientation","wrap","variant","color","role","slots","slotProps"],z4=e=>{const{variant:t,color:i,size:a,nesting:c,orientation:h,instanceSize:f}=e,o={root:["root",h,t&&`variant${xr(t)}`,i&&`color${xr(i)}`,!f&&!c&&a&&`size${xr(a)}`,f&&`size${xr(f)}`,c&&"nesting"]};return di(o,k4,{})},MI=rr("ul")(({theme:e,ownerState:t})=>{var i;const{p:a,padding:c,borderRadius:h}=tm({theme:e,ownerState:t},["p","padding","borderRadius"]);function f(o){return o==="sm"?{"--ListDivider-gap":"0.25rem","--ListItem-minHeight":"2rem","--ListItem-paddingY":"3px","--ListItem-paddingX":t.marker?"3px":"0.5rem","--ListItem-gap":"0.5rem","--ListItemDecorator-size":t.orientation==="horizontal"?"1.5rem":"2rem","--Icon-fontSize":e.vars.fontSize.lg}:o==="md"?{"--ListDivider-gap":"0.375rem","--ListItem-minHeight":"2.25rem","--ListItem-paddingY":"0.25rem","--ListItem-paddingX":t.marker?"0.25rem":"0.75rem","--ListItem-gap":"0.625rem","--ListItemDecorator-size":t.orientation==="horizontal"?"1.75rem":"2.5rem","--Icon-fontSize":e.vars.fontSize.xl}:o==="lg"?{"--ListDivider-gap":"0.5rem","--ListItem-minHeight":"2.75rem","--ListItem-paddingY":"0.375rem","--ListItem-paddingX":t.marker?"0.5rem":"1rem","--ListItem-gap":"0.75rem","--ListItemDecorator-size":t.orientation==="horizontal"?"2.25rem":"3rem","--Icon-fontSize":e.vars.fontSize.xl2}:{}}return[t.nesting&&we({},f(t.instanceSize),{"--ListItem-paddingRight":"var(--ListItem-paddingX)","--ListItem-paddingLeft":"var(--NestedListItem-paddingLeft)","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"0px","--ListItem-marginBlock":"0px","--ListItem-marginInline":"0px",padding:0},t.marker&&{paddingInlineStart:"calc(3ch - var(--_List-markerDeduct, 0px))"},{marginInlineStart:"var(--NestedList-marginLeft)",marginInlineEnd:"var(--NestedList-marginRight)",marginBlockStart:"var(--List-gap)",marginBlockEnd:"initial"}),!t.nesting&&we({},f(t.size),{"--List-gap":"0px","--List-nestedInsetStart":"0px","--ListItem-paddingLeft":"var(--ListItem-paddingX)","--ListItem-paddingRight":"var(--ListItem-paddingX)"},t.marker&&{"--_List-markerDeduct":"1ch"},{"--unstable_List-childRadius":"calc(max(var(--List-radius) - var(--List-padding), min(var(--List-padding) / 2, var(--List-radius) / 2)) - var(--variant-borderWidth, 0px))","--ListItem-radius":"var(--unstable_List-childRadius)","--ListItem-startActionTranslateX":"calc(0.5 * var(--ListItem-paddingLeft))","--ListItem-endActionTranslateX":"calc(-0.5 * var(--ListItem-paddingRight))",margin:"initial"},e.typography[`body-${t.size}`],t.orientation==="horizontal"?we({},t.wrap?{padding:"var(--List-padding)",marginInlineStart:"calc(-1 * var(--List-gap))",marginBlockStart:"calc(-1 * var(--List-gap))"}:{paddingInline:"var(--List-padding, var(--ListDivider-gap))",paddingBlock:"var(--List-padding)"}):{paddingBlock:"var(--List-padding, var(--ListDivider-gap))",paddingInline:"var(--List-padding)"},t.marker&&{paddingInlineStart:"3ch"}),we({boxSizing:"border-box",borderRadius:"var(--List-radius)",listStyle:"none",display:"flex",flexDirection:t.orientation==="horizontal"?"row":"column"},t.wrap&&{flexWrap:"wrap"},t.marker&&{"--_List-markerDisplay":"list-item","--_List-markerType":t.marker,lineHeight:"calc(var(--ListItem-minHeight) - 2 * var(--ListItem-paddingY))"},{flexGrow:1,position:"relative"},(i=e.variants[t.variant])==null?void 0:i[t.color],{"--unstable_List-borderWidth":"var(--variant-borderWidth, 0px)"},h!==void 0&&{"--List-radius":h},a!==void 0&&{"--List-padding":a},c!==void 0&&{"--List-padding":c})]}),O4=rr(MI,{name:"JoyList",slot:"Root",overridesResolver:(e,t)=>t.root})({}),rm=K.forwardRef(function(t,i){var a;const c=K.useContext(K_),h=K.useContext(CI),f=K.useContext(R4),o=Ci({props:t,name:"JoyList"}),{component:b,className:P,children:I,size:D,orientation:z="vertical",wrap:F=!1,variant:U="plain",color:$="neutral",role:j,slots:ie={},slotProps:se={}}=o,Q=Pr(o,D4),de=D||((a=t.size)!=null?a:"md");let oe;h&&(oe="group"),f&&(oe="presentation"),j&&(oe=j);const be=we({},o,{instanceSize:t.size,size:de,nesting:c,orientation:z,wrap:F,variant:U,color:$,role:oe}),xe=z4(be),Me=we({},Q,{component:b,slots:ie,slotProps:se}),[Ee,re]=_r("root",{ref:i,className:hi(xe.root,P),elementType:O4,externalForwardedProps:Me,ownerState:be,additionalProps:{as:b,role:oe,"aria-labelledby":typeof c=="string"?c:void 0}});return G.jsx(Ee,we({},re,{children:G.jsx(R2.Provider,{value:`${typeof b=="string"?b:""}:${oe||""}`,children:G.jsx(TI,{row:z==="horizontal",wrap:F,children:I})})}))});function L4(e){return wi("MuiListItemButton",e)}const A_=Si("MuiListItemButton",["root","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","focusVisible","disabled","selected","variantPlain","variantSoft","variantOutlined","variantSolid"]),PI=K.createContext("horizontal"),F4=["children","className","action","component","orientation","role","selected","color","variant","slots","slotProps"],B4=e=>{const{color:t,disabled:i,focusVisible:a,focusVisibleClassName:c,selected:h,variant:f}=e,o={root:["root",i&&"disabled",a&&"focusVisible",t&&`color${xr(t)}`,h&&"selected",f&&`variant${xr(f)}`]},b=di(o,L4,{});return a&&c&&(b.root+=` ${c}`),b},EI=rr("div")(({theme:e,ownerState:t})=>{var i,a,c,h,f,o;return we({"--Icon-margin":"initial","--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,WebkitTapHighlightColor:"transparent",boxSizing:"border-box",position:"relative",font:"inherit",display:"flex",flexDirection:"row",alignItems:"center",alignSelf:"stretch",gap:"var(--ListItem-gap)"},t.orientation==="vertical"&&{flexDirection:"column",justifyContent:"center"},{textAlign:"initial",textDecoration:"initial",backgroundColor:"initial",cursor:"pointer",marginInline:"var(--ListItemButton-marginInline)",marginBlock:"var(--ListItemButton-marginBlock)"},t["data-first-child"]===void 0&&{marginInlineStart:t.row?"var(--List-gap)":void 0,marginBlockStart:t.row?void 0:"var(--List-gap)"},{paddingBlock:"calc(var(--ListItem-paddingY) - var(--variant-borderWidth, 0px))",paddingInlineStart:"calc(var(--ListItem-paddingLeft) + var(--ListItem-startActionWidth, var(--unstable_startActionWidth, 0px)))",paddingInlineEnd:"calc(var(--ListItem-paddingRight) + var(--ListItem-endActionWidth, var(--unstable_endActionWidth, 0px)))",minBlockSize:"var(--ListItem-minHeight)",border:"1px solid transparent",borderRadius:"var(--ListItem-radius)",flex:"var(--unstable_ListItem-flex, none)",fontSize:"inherit",lineHeight:"inherit",minInlineSize:0,[e.focus.selector]:we({},e.focus.default,{zIndex:1})},(i=e.variants[t.variant])==null?void 0:i[t.color],{"&:active":(a=e.variants[`${t.variant}Active`])==null?void 0:a[t.color],[`.${X_.root} > &`]:{"--unstable_ListItem-flex":"1 0 0%"},[`&.${A_.selected}`]:we({},(c=e.variants[`${t.variant}Active`])==null?void 0:c[t.color],{"--Icon-color":"currentColor"}),[`&:not(.${A_.selected}, [aria-selected="true"])`]:{"&:hover":(h=e.variants[`${t.variant}Hover`])==null?void 0:h[t.color],"&:active":(f=e.variants[`${t.variant}Active`])==null?void 0:f[t.color]},[`&.${A_.disabled}`]:we({},(o=e.variants[`${t.variant}Disabled`])==null?void 0:o[t.color])})}),$4=rr(EI,{name:"JoyListItemButton",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e,theme:t})=>we({},!e.row&&{[`&.${A_.selected}`]:{fontWeight:t.vars.fontWeight.md}})),$p=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoyListItemButton"}),c=K.useContext(Nx),{children:h,className:f,action:o,component:b="div",orientation:P="horizontal",role:I,selected:D=!1,color:z="neutral",variant:F="plain",slots:U={},slotProps:$={}}=a,j=Pr(a,F4),ie=K.useRef(null),se=Ea(ie,i),{focusVisible:Q,setFocusVisible:de,getRootProps:oe}=Uv(we({},a,{rootRef:se}));K.useImperativeHandle(o,()=>({focusVisible:()=>{var ke;de(!0),(ke=ie.current)==null||ke.focus()}}),[de]);const be=we({},a,{component:b,color:z,focusVisible:Q,orientation:P,row:c,selected:D,variant:F}),xe=B4(be),Me=we({},j,{component:b,slots:U,slotProps:$}),[Ee,re]=_r("root",{ref:i,className:hi(xe.root,f),elementType:$4,externalForwardedProps:Me,ownerState:be,getSlotProps:oe});return G.jsx(PI.Provider,{value:P,children:G.jsx(Ee,we({},re,{role:I??re.role,children:h}))})});function j4(e){return wi("MuiSvgIcon",e)}Si("MuiSvgIcon",["root","colorInherit","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","fontSizeInherit","fontSizeXs","fontSizeSm","fontSizeMd","fontSizeLg","fontSizeXl","fontSizeXl2","fontSizeXl3","fontSizeXl4","sizeSm","sizeMd","sizeLg"]);const N4=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox","size","slots","slotProps"],V4=e=>{const{color:t,size:i,fontSize:a}=e,c={root:["root",t&&t!=="inherit"&&`color${xr(t)}`,i&&`size${xr(i)}`,a&&`fontSize${xr(a)}`]};return di(c,j4,{})},qT={sm:"xl",md:"xl2",lg:"xl3"},U4=rr("svg",{name:"JoySvgIcon",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var i;return we({},t.instanceSize&&{"--Icon-fontSize":e.vars.fontSize[qT[t.instanceSize]]},t.instanceFontSize&&t.instanceFontSize!=="inherit"&&{"--Icon-fontSize":e.vars.fontSize[t.instanceFontSize]},{userSelect:"none",margin:"var(--Icon-margin)",width:"1em",height:"1em",display:"inline-block",fill:t.hasSvgAsChild?void 0:"currentColor",flexShrink:0,fontSize:`var(--Icon-fontSize, ${e.vars.fontSize[qT[t.size]]||"unset"})`},t.fontSize&&t.fontSize!=="inherit"&&{fontSize:`var(--Icon-fontSize, ${e.fontSize[t.fontSize]})`},!t.htmlColor&&we({color:`var(--Icon-color, ${e.vars.palette.text.icon})`},t.color==="inherit"&&{color:"inherit"},t.color!=="inherit"&&e.vars.palette[t.color]&&{color:`rgba(${(i=e.vars.palette[t.color])==null?void 0:i.mainChannel} / 1)`}))}),HT=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoySvgIcon"}),{children:c,className:h,color:f,component:o="svg",fontSize:b,htmlColor:P,inheritViewBox:I=!1,titleAccess:D,viewBox:z="0 0 24 24",size:F="md",slots:U={},slotProps:$={}}=a,j=Pr(a,N4),ie=K.isValidElement(c)&&c.type==="svg",se=we({},a,{color:f,component:o,size:F,instanceSize:t.size,fontSize:b,instanceFontSize:t.fontSize,inheritViewBox:I,viewBox:z,hasSvgAsChild:ie}),Q=V4(se),de=we({},j,{component:o,slots:U,slotProps:$}),[oe,be]=_r("root",{ref:i,className:hi(Q.root,h),elementType:U4,externalForwardedProps:de,ownerState:se,additionalProps:we({color:P,focusable:!1},D&&{role:"img"},!D&&{"aria-hidden":!0},!I&&{viewBox:z},ie&&c.props)});return G.jsxs(oe,we({},be,{children:[ie?c.props.children:c,D?G.jsx("title",{children:D}):null]}))});function D2(e,t){function i(a,c){return G.jsx(HT,we({"data-testid":`${t}Icon`,ref:c},a,{children:e}))}return i.muiName=HT.muiName,K.memo(K.forwardRef(i))}const z2=e=>t=>`--${e?`${e}-`:""}${t.replace(/^--/,"")}`,Fg="data-skip-inverted-colors",II=`& :not([${Fg}], [${Fg}] *)`,kI=e=>{var t,i,a,c,h,f,o,b,P,I,D,z,F,U,$,j,ie,se,Q,de,oe,be;const xe=z2(e.cssVarPrefix);return{"--variant-plainColor":"var(--variant-plainColor) !important","--variant-plainHoverColor":"var(--variant-plainHoverColor) !important","--variant-plainHoverBg":"var(--variant-plainHoverBg) !important","--variant-plainActiveBg":"var(--variant-plainActiveBg) !important","--variant-plainDisabledColor":"var(--variant-plainDisabledColor) !important","--variant-outlinedColor":"var(--variant-outlinedColor) !important","--variant-outlinedBorder":"var(--variant-outlinedBorder) !important","--variant-outlinedHoverColor":"var(--variant-outlinedHoverColor) !important","--variant-outlinedHoverBorder":"var(--variant-outlinedHoverBorder) !important","--variant-outlinedHoverBg":"var(--variant-outlinedHoverBg) !important","--variant-outlinedActiveBg":"var(--variant-outlinedActiveBg) !important","--variant-outlinedDisabledColor":"var(--variant-outlinedDisabledColor) !important","--variant-outlinedDisabledBorder":"var(--variant-outlinedDisabledBorder) !important","--variant-softColor":"var(--variant-softColor) !important","--variant-softHoverColor":"var(--variant-softHoverColor) !important","--variant-softBg":"var(--variant-softBg) !important","--variant-softHoverBg":"var(--variant-softHoverBg) !important","--variant-softActiveBg":"var(--variant-softActiveBg) !important","--variant-softActiveColor":"var(--variant-softActiveColor) !important","--variant-softDisabledColor":"var(--variant-softDisabledColor) !important","--variant-softDisabledBg":"var(--variant-softDisabledBg) !important","--variant-solidColor":"var(--variant-solidColor) !important","--variant-solidBg":"var(--variant-solidBg) !important","--variant-solidHoverBg":"var(--variant-solidHoverBg) !important","--variant-solidActiveBg":"var(--variant-solidActiveBg) !important","--variant-solidDisabledColor":"var(--variant-solidDisabledColor) !important","--variant-solidDisabledBg":"var(--variant-solidDisabledBg) !important","--Badge-ringColor":"var(--Badge-ringColor) !important",colorScheme:"unset",[e.getColorSchemeSelector("light")]:{[xe("--palette-focusVisible")]:`${(t=e.colorSchemes.light)==null?void 0:t.palette.focusVisible} !important`,[xe("--palette-background-body")]:`${(i=e.colorSchemes.light)==null?void 0:i.palette.background.body} !important`,[xe("--palette-background-surface")]:`${(a=e.colorSchemes.light)==null?void 0:a.palette.background.surface} !important`,[xe("--palette-background-popup")]:`${(c=e.colorSchemes.light)==null?void 0:c.palette.background.popup} !important`,[xe("--palette-background-level1")]:`${(h=e.colorSchemes.light)==null?void 0:h.palette.background.level1} !important`,[xe("--palette-background-level2")]:`${(f=e.colorSchemes.light)==null?void 0:f.palette.background.level2} !important`,[xe("--palette-background-level3")]:`${(o=e.colorSchemes.light)==null?void 0:o.palette.background.level3} !important`,[xe("--palette-text-primary")]:`${(b=e.colorSchemes.light)==null?void 0:b.palette.text.primary} !important`,[xe("--palette-text-secondary")]:`${(P=e.colorSchemes.light)==null?void 0:P.palette.text.secondary} !important`,[xe("--palette-text-tertiary")]:`${(I=e.colorSchemes.light)==null?void 0:I.palette.text.tertiary} !important`,[xe("--palette-divider")]:`${(D=e.colorSchemes.light)==null?void 0:D.palette.divider} !important`},[e.getColorSchemeSelector("dark")]:{[xe("--palette-focusVisible")]:`${(z=e.colorSchemes.dark)==null?void 0:z.palette.focusVisible} !important`,[xe("--palette-background-body")]:`${(F=e.colorSchemes.dark)==null?void 0:F.palette.background.body} !important`,[xe("--palette-background-surface")]:`${(U=e.colorSchemes.dark)==null?void 0:U.palette.background.surface} !important`,[xe("--palette-background-popup")]:`${($=e.colorSchemes.dark)==null?void 0:$.palette.background.popup} !important`,[xe("--palette-background-level1")]:`${(j=e.colorSchemes.dark)==null?void 0:j.palette.background.level1} !important`,[xe("--palette-background-level2")]:`${(ie=e.colorSchemes.dark)==null?void 0:ie.palette.background.level2} !important`,[xe("--palette-background-level3")]:`${(se=e.colorSchemes.dark)==null?void 0:se.palette.background.level3} !important`,[xe("--palette-text-primary")]:`${(Q=e.colorSchemes.dark)==null?void 0:Q.palette.text.primary} !important`,[xe("--palette-text-secondary")]:`${(de=e.colorSchemes.dark)==null?void 0:de.palette.text.secondary} !important`,[xe("--palette-text-tertiary")]:`${(oe=e.colorSchemes.dark)==null?void 0:oe.palette.text.tertiary} !important`,[xe("--palette-divider")]:`${(be=e.colorSchemes.dark)==null?void 0:be.palette.divider} !important`}}};function G4(e){return e.theme!==void 0}const Vx=e=>t=>{const i=G4(t)?t.theme:t,a=C2(i.cssVarPrefix),c=z2(i.cssVarPrefix),h=f=>{const o=f.split("-");return a(f,i.palette[o[1]][o[2]])};return{[II]:{"--Badge-ringColor":h(`palette-${e}-solidBg`),"--Icon-color":"currentColor",[`${i.getColorSchemeSelector("light")}, ${i.getColorSchemeSelector("dark")}`]:{colorScheme:"dark",[c("--palette-focusVisible")]:h(`palette-${e}-200`),[c("--palette-background-body")]:"rgba(0 0 0 / 0.1)",[c("--palette-background-surface")]:"rgba(0 0 0 / 0.06)",[c("--palette-background-popup")]:h(`palette-${e}-700`),[c("--palette-background-level1")]:`rgba(${h(`palette-${e}-darkChannel`)} / 0.2)`,[c("--palette-background-level2")]:`rgba(${h(`palette-${e}-darkChannel`)} / 0.36)`,[c("--palette-background-level3")]:`rgba(${h(`palette-${e}-darkChannel`)} / 0.6)`,[c("--palette-text-primary")]:h("palette-common-white"),[c("--palette-text-secondary")]:h(`palette-${e}-200`),[c("--palette-text-tertiary")]:h(`palette-${e}-300`),[c("--palette-text-icon")]:h(`palette-${e}-200`),[c("--palette-divider")]:`rgba(${h(`palette-${e}-lightChannel`)} / 0.32)`,"--variant-plainColor":h(`palette-${e}-50`),"--variant-plainHoverColor":"#fff","--variant-plainHoverBg":`rgba(${h(`palette-${e}-lightChannel`)} / 0.12)`,"--variant-plainActiveBg":`rgba(${h(`palette-${e}-lightChannel`)} / 0.32)`,"--variant-plainDisabledColor":`rgba(${h(`palette-${e}-lightChannel`)} / 0.72)`,"--variant-outlinedColor":h(`palette-${e}-50`),"--variant-outlinedBorder":`rgba(${h(`palette-${e}-lightChannel`)} / 0.5)`,"--variant-outlinedHoverColor":"#fff","--variant-outlinedHoverBorder":h(`palette-${e}-300`),"--variant-outlinedHoverBg":`rgba(${h(`palette-${e}-lightChannel`)} / 0.12)`,"--variant-outlinedActiveBg":`rgba(${h(`palette-${e}-lightChannel`)} / 0.32)`,"--variant-outlinedDisabledColor":`rgba(${h(`palette-${e}-lightChannel`)} / 0.72)`,"--variant-outlinedDisabledBorder":"rgba(255 255 255 / 0.2)","--variant-softColor":h("palette-common-white"),"--variant-softHoverColor":h("palette-common-white"),"--variant-softBg":`rgba(${h(`palette-${e}-lightChannel`)} / 0.24)`,"--variant-softHoverBg":`rgba(${h(`palette-${e}-lightChannel`)} / 0.36)`,"--variant-softActiveBg":`rgba(${h(`palette-${e}-lightChannel`)} / 0.16)`,"--variant-softActiveColor":"#fff","--variant-softDisabledColor":`rgba(${h(`palette-${e}-lightChannel`)} / 0.72)`,"--variant-softDisabledBg":`rgba(${h(`palette-${e}-lightChannel`)} / 0.1)`,"--variant-solidColor":h(`palette-${e}-${e==="neutral"?"600":"500"}`),"--variant-solidBg":h("palette-common-white"),"--variant-solidHoverBg":h("palette-common-white"),"--variant-solidActiveBg":h(`palette-${e}-100`),"--variant-solidDisabledColor":`rgba(${h(`palette-${e}-lightChannel`)} / 0.72)`,"--variant-solidDisabledBg":`rgba(${h(`palette-${e}-lightChannel`)} / 0.1)`}},[`&, & [${Fg}]`]:kI(i)}},Ux=e=>t=>{const{theme:i=t}=t,a=C2(i.cssVarPrefix),c=z2(i.cssVarPrefix),h=f=>{const o=f.split("-");return a(f,i.palette[o[1]][o[2]])};return{[II]:{"--Badge-ringColor":h(`palette-${e}-softBg`),"--Icon-color":"currentColor",[i.getColorSchemeSelector("dark")]:{[c("--palette-focusVisible")]:h(`palette-${e}-300`),[c("--palette-background-body")]:`rgba(${h(`palette-${e}-mainChannel`)} / 0.1)`,[c("--palette-background-surface")]:`rgba(${h(`palette-${e}-mainChannel`)} / 0.08)`,[c("--palette-background-level1")]:`rgba(${h(`palette-${e}-mainChannel`)} / 0.2)`,[c("--palette-background-level2")]:`rgba(${h(`palette-${e}-mainChannel`)} / 0.4)`,[c("--palette-background-level3")]:`rgba(${h(`palette-${e}-mainChannel`)} / 0.6)`,[c("--palette-text-primary")]:h(`palette-${e}-100`),[c("--palette-text-secondary")]:`rgba(${h(`palette-${e}-lightChannel`)} / 0.72)`,[c("--palette-text-tertiary")]:`rgba(${h(`palette-${e}-lightChannel`)} / 0.6)`,[c("--palette-text-icon")]:`rgba(${h(`palette-${e}-lightChannel`)} / 0.6)`,[c("--palette-divider")]:`rgba(${h(`palette-${e}-lightChannel`)} / 0.2)`,"--variant-plainColor":`rgba(${h(`palette-${e}-lightChannel`)} / 1)`,"--variant-plainHoverColor":h(`palette-${e}-50`),"--variant-plainHoverBg":`rgba(${h(`palette-${e}-mainChannel`)} / 0.16)`,"--variant-plainActiveBg":`rgba(${h(`palette-${e}-mainChannel`)} / 0.32)`,"--variant-plainDisabledColor":`rgba(${h(`palette-${e}-mainChannel`)} / 0.72)`,"--variant-outlinedColor":`rgba(${h(`palette-${e}-lightChannel`)} / 1)`,"--variant-outlinedHoverColor":h(`palette-${e}-50`),"--variant-outlinedBg":"initial","--variant-outlinedBorder":`rgba(${h(`palette-${e}-mainChannel`)} / 0.4)`,"--variant-outlinedHoverBorder":h(`palette-${e}-600`),"--variant-outlinedHoverBg":`rgba(${h(`palette-${e}-mainChannel`)} / 0.16)`,"--variant-outlinedActiveBg":`rgba(${h(`palette-${e}-mainChannel`)} / 0.32)`,"--variant-outlinedDisabledColor":`rgba(${h(`palette-${e}-mainChannel`)} / 0.72)`,"--variant-outlinedDisabledBorder":`rgba(${h(`palette-${e}-mainChannel`)} / 0.2)`,"--variant-softColor":h(`palette-${e}-200`),"--variant-softBg":`rgba(${h(`palette-${e}-mainChannel`)} / 0.24)`,"--variant-softHoverColor":"#fff","--variant-softHoverBg":`rgba(${h(`palette-${e}-mainChannel`)} / 0.32)`,"--variant-softActiveBg":`rgba(${h(`palette-${e}-mainChannel`)} / 0.48)`,"--variant-softDisabledColor":`rgba(${h(`palette-${e}-mainChannel`)} / 0.72)`,"--variant-softDisabledBg":`rgba(${h(`palette-${e}-mainChannel`)} / 0.12)`,"--variant-solidColor":"#fff","--variant-solidBg":h(`palette-${e}-500`),"--variant-solidHoverColor":"#fff","--variant-solidHoverBg":h(`palette-${e}-600`),"--variant-solidActiveBg":h(`palette-${e}-600`),"--variant-solidDisabledColor":`rgba(${h(`palette-${e}-mainChannel`)} / 0.72)`,"--variant-solidDisabledBg":`rgba(${h(`palette-${e}-mainChannel`)} / 0.12)`},[i.getColorSchemeSelector("light")]:{[c("--palette-focusVisible")]:h(`palette-${e}-500`),[c("--palette-background-body")]:`rgba(${h(`palette-${e}-mainChannel`)} / 0.1)`,[c("--palette-background-surface")]:`rgba(${h(`palette-${e}-mainChannel`)} / 0.08)`,[c("--palette-background-level1")]:`rgba(${h(`palette-${e}-mainChannel`)} / 0.2)`,[c("--palette-background-level2")]:`rgba(${h(`palette-${e}-mainChannel`)} / 0.32)`,[c("--palette-background-level3")]:`rgba(${h(`palette-${e}-mainChannel`)} / 0.48)`,[c("--palette-text-primary")]:h(`palette-${e}-700`),[c("--palette-text-secondary")]:`rgba(${h(`palette-${e}-darkChannel`)} / 0.8)`,[c("--palette-text-tertiary")]:`rgba(${h(`palette-${e}-darkChannel`)} / 0.68)`,[c("--palette-text-icon")]:h(`palette-${e}-500`),[c("--palette-divider")]:`rgba(${h(`palette-${e}-mainChannel`)} / 0.32)`,"--variant-plainColor":`rgba(${h(`palette-${e}-darkChannel`)} / 0.8)`,"--variant-plainHoverColor":`rgba(${h(`palette-${e}-darkChannel`)} / 1)`,"--variant-plainHoverBg":`rgba(${h(`palette-${e}-mainChannel`)} / 0.12)`,"--variant-plainActiveBg":`rgba(${h(`palette-${e}-mainChannel`)} / 0.24)`,"--variant-plainDisabledColor":`rgba(${h(`palette-${e}-mainChannel`)} / 0.6)`,"--variant-outlinedColor":`rgba(${h(`palette-${e}-mainChannel`)} / 1)`,"--variant-outlinedBorder":`rgba(${h(`palette-${e}-mainChannel`)} / 0.4)`,"--variant-outlinedHoverColor":h(`palette-${e}-600`),"--variant-outlinedHoverBorder":h(`palette-${e}-300`),"--variant-outlinedHoverBg":`rgba(${h(`palette-${e}-mainChannel`)} / 0.12)`,"--variant-outlinedActiveBg":`rgba(${h(`palette-${e}-mainChannel`)} / 0.24)`,"--variant-outlinedDisabledColor":`rgba(${h(`palette-${e}-mainChannel`)} / 0.6)`,"--variant-outlinedDisabledBorder":`rgba(${h(`palette-${e}-mainChannel`)} / 0.12)`,"--variant-softColor":h(`palette-${e}-600`),"--variant-softBg":`rgba(${h(`palette-${e}-lightChannel`)} / 0.8)`,"--variant-softHoverColor":h(`palette-${e}-700`),"--variant-softHoverBg":h(`palette-${e}-200`),"--variant-softActiveBg":h(`palette-${e}-300`),"--variant-softDisabledColor":`rgba(${h(`palette-${e}-mainChannel`)} / 0.6)`,"--variant-softDisabledBg":`rgba(${h(`palette-${e}-mainChannel`)} / 0.08)`,"--variant-solidColor":h("palette-common-white"),"--variant-solidBg":h(`palette-${e}-${e==="neutral"?"700":"500"}`),"--variant-solidHoverColor":h("palette-common-white"),"--variant-solidHoverBg":h(`palette-${e}-600`),"--variant-solidActiveBg":h(`palette-${e}-600`),"--variant-solidDisabledColor":`rgba(${h(`palette-${e}-mainChannel`)} / 0.6)`,"--variant-solidDisabledBg":`rgba(${h(`palette-${e}-mainChannel`)} / 0.08)`}},[`&, & [${Fg}]`]:kI(i)}};function q4(e){return wi("MuiAlert",e)}Si("MuiAlert",["root","startDecorator","endDecorator","colorPrimary","colorDanger","colorNeutral","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]);const H4=["children","className","color","invertedColors","role","variant","size","startDecorator","endDecorator","component","slots","slotProps"],W4=e=>{const{variant:t,color:i,size:a}=e,c={root:["root",a&&`size${xr(a)}`,i&&`color${xr(i)}`,t&&`variant${xr(t)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return di(c,q4,{})},Z4=rr("div",{name:"JoyAlert",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var i;const{p:a,padding:c,borderRadius:h}=tm({theme:e,ownerState:t},["p","padding","borderRadius"]);return[we({"--Alert-radius":e.vars.radius.sm,"--Alert-decoratorChildRadius":"max((var(--Alert-radius) - var(--variant-borderWidth, 0px)) - var(--Alert-padding), min(var(--Alert-padding) + var(--variant-borderWidth, 0px), var(--Alert-radius) / 2))","--Button-minHeight":"var(--Alert-decoratorChildHeight)","--IconButton-size":"var(--Alert-decoratorChildHeight)","--Button-radius":"var(--Alert-decoratorChildRadius)","--IconButton-radius":"var(--Alert-decoratorChildRadius)","--Icon-color":"currentColor"},t.size==="sm"&&{"--Alert-padding":"0.5rem","--Alert-decoratorChildHeight":"1.5rem","--Icon-fontSize":e.vars.fontSize.xl,gap:"0.5rem"},t.size==="md"&&{"--Alert-padding":"0.75rem","--Alert-decoratorChildHeight":"2rem","--Icon-fontSize":e.vars.fontSize.xl,gap:"0.625rem"},t.size==="lg"&&{"--Alert-padding":"1rem","--Alert-decoratorChildHeight":"2.375rem","--Icon-fontSize":e.vars.fontSize.xl2,gap:"0.875rem"},{backgroundColor:e.vars.palette.background.surface,display:"flex",position:"relative",alignItems:"center",padding:"var(--Alert-padding)",borderRadius:"var(--Alert-radius)"},e.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[t.size]}`],{fontWeight:e.vars.fontWeight.md},t.variant==="solid"&&t.color&&t.invertedColors&&Vx(t.color)(e),t.variant==="soft"&&t.color&&t.invertedColors&&Ux(t.color)(e),(i=e.variants[t.variant])==null?void 0:i[t.color]),a!==void 0&&{"--Alert-padding":a},c!==void 0&&{"--Alert-padding":c},h!==void 0&&{"--Alert-radius":h}]}),X4=rr("span",{name:"JoyAlert",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({display:"inherit",flex:"none"}),K4=rr("span",{name:"JoyAlert",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})({display:"inherit",flex:"none",marginLeft:"auto"}),Y4=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoyAlert"}),{children:c,className:h,color:f="neutral",invertedColors:o=!1,role:b="alert",variant:P="soft",size:I="md",startDecorator:D,endDecorator:z,component:F,slots:U={},slotProps:$={}}=a,j=Pr(a,H4),ie=we({},a,{color:f,invertedColors:o,variant:P,size:I}),se=W4(ie),Q=we({},j,{component:F,slots:U,slotProps:$}),[de,oe]=_r("root",{ref:i,className:hi(se.root,h),elementType:Z4,externalForwardedProps:Q,ownerState:ie,additionalProps:{role:b}}),[be,xe]=_r("startDecorator",{className:se.startDecorator,elementType:X4,externalForwardedProps:Q,ownerState:ie}),[Me,Ee]=_r("endDecorator",{className:se.endDecorator,elementType:K4,externalForwardedProps:Q,ownerState:ie});return G.jsxs(de,we({},oe,{children:[D&&G.jsx(be,we({},xe,{children:D})),c,z&&G.jsx(Me,we({},Ee,{children:z}))]}))}),J4=D2(G.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),Q4=D2(G.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),AI=K.createContext(void 0);function Rp(e,t){let i=t,a=e;return e==="outlined"&&(i="neutral",a="plain"),e==="plain"&&(i="neutral"),{variant:a,color:i}}function RI(e,t,i=!1){const a=K.useContext(AI),[c,h]=typeof a=="string"?a.split(":"):[],f=Rp(c||void 0,h||void 0);return f.variant=e||f.variant,f.color=t||(i?h:f.color),f}function DI({children:e,color:t,variant:i}){return G.jsx(AI.Provider,{value:`${i||""}:${t||""}`,children:e})}function e6(e){return wi("MuiIconButton",e)}const Tw=Si("MuiIconButton",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","focusVisible","disabled","sizeSm","sizeMd","sizeLg","loading","loadingIndicator"]),O2=K.createContext({}),zI=K.createContext(void 0);function t6(e){return wi("MuiCircularProgress",e)}Si("MuiCircularProgress",["root","determinate","svg","track","progress","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]);let r6=e=>e,WT;const n6=["color","backgroundColor"],i6=["children","className","color","size","variant","thickness","determinate","value","component","slots","slotProps"],o6=h2({"0%":{transform:"rotate(-90deg)"},"100%":{transform:"rotate(270deg)"}}),s6=e=>{const{determinate:t,color:i,variant:a,size:c}=e,h={root:["root",t&&"determinate",i&&`color${xr(i)}`,a&&`variant${xr(a)}`,c&&`size${xr(c)}`],svg:["svg"],track:["track"],progress:["progress"]};return di(h,t6,{})};function Ym(e,t){return`var(--CircularProgress-${e}Thickness, var(--CircularProgress-thickness, ${t}))`}const a6=rr("span",{name:"JoyCircularProgress",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e,theme:t})=>{var i,a,c,h;const f=((i=t.variants[e.variant])==null?void 0:i[e.color])||{},{color:o,backgroundColor:b}=f,P=Pr(f,n6);return we({"--Icon-fontSize":"calc(0.4 * var(--_root-size))","--CircularProgress-trackColor":b,"--CircularProgress-progressColor":o,"--CircularProgress-percent":e.value,"--CircularProgress-linecap":"round"},e.size==="sm"&&{"--_root-size":"var(--CircularProgress-size, 24px)","--_track-thickness":Ym("track","3px"),"--_progress-thickness":Ym("progress","3px")},e.instanceSize==="sm"&&{"--CircularProgress-size":"24px"},e.size==="md"&&{"--_track-thickness":Ym("track","6px"),"--_progress-thickness":Ym("progress","6px"),"--_root-size":"var(--CircularProgress-size, 40px)"},e.instanceSize==="md"&&{"--CircularProgress-size":"40px"},e.size==="lg"&&{"--_track-thickness":Ym("track","8px"),"--_progress-thickness":Ym("progress","8px"),"--_root-size":"var(--CircularProgress-size, 64px)"},e.instanceSize==="lg"&&{"--CircularProgress-size":"64px"},e.thickness&&{"--_track-thickness":`${e.thickness}px`,"--_progress-thickness":`${e.thickness}px`},{"--_thickness-diff":"calc(var(--_track-thickness) - var(--_progress-thickness))","--_inner-size":"calc(var(--_root-size) - 2 * var(--variant-borderWidth, 0px))","--_outlined-inset":"max(var(--_track-thickness), var(--_progress-thickness))",width:"var(--_root-size)",height:"var(--_root-size)",borderRadius:"var(--_root-size)",margin:"var(--CircularProgress-margin)",boxSizing:"border-box",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0,position:"relative",color:o},e.children&&{fontFamily:t.vars.fontFamily.body,fontWeight:t.vars.fontWeight.md,fontSize:"calc(0.2 * var(--_root-size))"},P,e.variant==="outlined"&&{"&::before":we({content:'""',display:"block",position:"absolute",borderRadius:"inherit",top:"var(--_outlined-inset)",left:"var(--_outlined-inset)",right:"var(--_outlined-inset)",bottom:"var(--_outlined-inset)"},P)},e.variant==="soft"&&{"--CircularProgress-trackColor":t.variants.soft.neutral.backgroundColor,"--CircularProgress-progressColor":(a=t.variants.solid)==null?void 0:a[e.color].backgroundColor},e.variant==="solid"&&{"--CircularProgress-trackColor":(c=t.variants.softHover)==null?void 0:c[e.color].backgroundColor,"--CircularProgress-progressColor":(h=t.variants.solid)==null?void 0:h[e.color].backgroundColor})}),l6=rr("svg",{name:"JoyCircularProgress",slot:"Svg",overridesResolver:(e,t)=>t.svg})({width:"inherit",height:"inherit",display:"inherit",boxSizing:"inherit",position:"absolute",top:"calc(-1 * var(--variant-borderWidth, 0px))",left:"calc(-1 * var(--variant-borderWidth, 0px))"}),c6=rr("circle",{name:"JoyCircularProgress",slot:"track",overridesResolver:(e,t)=>t.track})({cx:"50%",cy:"50%",r:"calc(var(--_inner-size) / 2 - var(--_track-thickness) / 2 + min(0px, var(--_thickness-diff) / 2))",fill:"transparent",strokeWidth:"var(--_track-thickness)",stroke:"var(--CircularProgress-trackColor)"}),u6=rr("circle",{name:"JoyCircularProgress",slot:"progress",overridesResolver:(e,t)=>t.progress})({"--_progress-radius":"calc(var(--_inner-size) / 2 - var(--_progress-thickness) / 2 - max(0px, var(--_thickness-diff) / 2))","--_progress-length":"calc(2 * 3.1415926535 * var(--_progress-radius))",cx:"50%",cy:"50%",r:"var(--_progress-radius)",fill:"transparent",strokeWidth:"var(--_progress-thickness)",stroke:"var(--CircularProgress-progressColor)",strokeLinecap:"var(--CircularProgress-linecap, round)",strokeDasharray:"var(--_progress-length)",strokeDashoffset:"calc(var(--_progress-length) - var(--CircularProgress-percent) * var(--_progress-length) / 100)",transformOrigin:"center",transform:"rotate(-90deg)"},({ownerState:e})=>!e.determinate&&FE(WT||(WT=r6`
      animation: var(--CircularProgress-circulation, 0.8s linear 0s infinite normal none running)
        ${0};
    `),o6)),nm=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoyCircularProgress"}),{children:c,className:h,color:f="primary",size:o="md",variant:b="soft",thickness:P,determinate:I=!1,value:D=I?0:25,component:z,slots:F={},slotProps:U={}}=a,$=Pr(a,i6),j=we({},a,{color:f,size:o,variant:b,thickness:P,value:D,determinate:I,instanceSize:t.size}),ie=s6(j),se=we({},$,{component:z,slots:F,slotProps:U}),[Q,de]=_r("root",{ref:i,className:hi(ie.root,h),elementType:a6,externalForwardedProps:se,ownerState:j,additionalProps:we({role:"progressbar",style:{"--CircularProgress-percent":D}},D&&I&&{"aria-valuenow":Math.round(typeof D=="number"?D:Number(D||0))})}),[oe,be]=_r("svg",{className:ie.svg,elementType:l6,externalForwardedProps:se,ownerState:j}),[xe,Me]=_r("track",{className:ie.track,elementType:c6,externalForwardedProps:se,ownerState:j}),[Ee,re]=_r("progress",{className:ie.progress,elementType:u6,externalForwardedProps:se,ownerState:j});return G.jsxs(Q,we({},de,{children:[G.jsxs(oe,we({},be,{children:[G.jsx(xe,we({},Me)),G.jsx(Ee,we({},re))]})),c]}))}),h6=["children","action","component","color","disabled","variant","loading","loadingIndicator","size","slots","slotProps"],d6=e=>{const{color:t,disabled:i,focusVisible:a,focusVisibleClassName:c,size:h,variant:f,loading:o}=e,b={root:["root",i&&"disabled",a&&"focusVisible",f&&`variant${xr(f)}`,t&&`color${xr(t)}`,h&&`size${xr(h)}`,o&&"loading"],loadingIndicator:["loadingIndicator"]},P=di(b,e6,{});return a&&c&&(P.root+=` ${c}`),P},Gx=rr("button")(({theme:e,ownerState:t})=>{var i,a,c,h;return[we({"--Icon-margin":"initial","--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon},t.instanceSize&&{"--IconButton-size":{sm:"2rem",md:"2.25rem",lg:"2.75rem"}[t.instanceSize]},t.size==="sm"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2rem) / 1.6)","--CircularProgress-size":"20px","--CircularProgress-thickness":"2px",minWidth:"var(--IconButton-size, 2rem)",minHeight:"var(--IconButton-size, 2rem)",fontSize:e.vars.fontSize.sm,paddingInline:"2px"},t.size==="md"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2.25rem) / 1.5)","--CircularProgress-size":"20px","--CircularProgress-thickness":"2px",minWidth:"var(--IconButton-size, 2.25rem)",minHeight:"var(--IconButton-size, 2.25rem)",fontSize:e.vars.fontSize.md,paddingInline:"0.25rem"},t.size==="lg"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2.75rem) / 1.571)","--CircularProgress-size":"28px","--CircularProgress-thickness":"4px",minWidth:"var(--IconButton-size, 2.75rem)",minHeight:"var(--IconButton-size, 2.75rem)",fontSize:e.vars.fontSize.lg,paddingInline:"0.375rem"},{WebkitTapHighlightColor:"transparent",paddingBlock:0,fontFamily:e.vars.fontFamily.body,fontWeight:e.vars.fontWeight.md,margin:"var(--IconButton-margin)",borderRadius:`var(--IconButton-radius, ${e.vars.radius.sm})`,border:"none",boxSizing:"border-box",backgroundColor:"transparent",cursor:"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",[e.focus.selector]:we({"--Icon-color":"currentColor"},e.focus.default)}),we({},(i=e.variants[t.variant])==null?void 0:i[t.color],{"&:hover":{"@media (hover: hover)":we({"--Icon-color":"currentColor"},(a=e.variants[`${t.variant}Hover`])==null?void 0:a[t.color])},'&:active, &[aria-pressed="true"]':we({"--Icon-color":"currentColor"},(c=e.variants[`${t.variant}Active`])==null?void 0:c[t.color]),"&:disabled":(h=e.variants[`${t.variant}Disabled`])==null?void 0:h[t.color]})]}),f6=rr(Gx,{name:"JoyIconButton",slot:"Root",overridesResolver:(e,t)=>t.root})({}),p6=rr("span",{name:"JoyIconButton",slot:"LoadingIndicator",overridesResolver:(e,t)=>t.loadingIndicator})(({theme:e,ownerState:t})=>{var i,a;return we({display:"inherit",position:"absolute",left:"50%",transform:"translateX(-50%)",color:(i=e.variants[t.variant])==null||(i=i[t.color])==null?void 0:i.color},t.disabled&&{color:(a=e.variants[`${t.variant}Disabled`])==null||(a=a[t.color])==null?void 0:a.color})}),sd=K.forwardRef(function(t,i){var a;const c=Ci({props:t,name:"JoyIconButton"}),{children:h,action:f,component:o="button",color:b="neutral",disabled:P,variant:I="plain",loading:D=!1,loadingIndicator:z,size:F="md",slots:U={},slotProps:$={}}=c,j=Pr(c,h6),ie=K.useContext(O2),se=K.useContext(zI),Q=t.variant||ie.variant||I,de=t.size||ie.size||F,oe=t.color||ie.color||b,be=(a=t.loading||t.disabled)!=null?a:ie.disabled||D||P,xe=K.useRef(null),Me=Ea(xe,i),{focusVisible:Ee,setFocusVisible:re,getRootProps:ke}=Uv(we({},c,{disabled:be,rootRef:Me})),Ge=z??G.jsx(nm,{color:oe,thickness:{sm:2,md:3,lg:4}[de]||3});K.useImperativeHandle(f,()=>({focusVisible:()=>{var ze;re(!0),(ze=xe.current)==null||ze.focus()}}),[re]);const Ke=we({},c,{component:o,color:oe,disabled:be,variant:Q,loading:D,size:de,focusVisible:Ee,instanceSize:t.size}),gt=d6(Ke),et=ze=>{var ft;let wt=c.onClick;if(typeof $.root=="function"?wt=$.root(Ke).onClick:$.root&&(wt=$.root.onClick),(ft=wt)==null||ft(ze),se){var xt;(xt=se.onClick)==null||xt.call(se,ze,c.value)}};let qe=c["aria-pressed"];typeof $.root=="function"?qe=$.root(Ke)["aria-pressed"]:$.root&&(qe=$.root["aria-pressed"]),se!=null&&se.value&&(Array.isArray(se.value)?qe=se.value.indexOf(c.value)!==-1:qe=se.value===c.value);const Qe=we({},j,{component:o,slots:U,slotProps:$}),[Ve,je]=_r("root",{ref:i,className:gt.root,elementType:f6,getSlotProps:ke,externalForwardedProps:Qe,ownerState:Ke,additionalProps:{onClick:et,"aria-pressed":qe}}),[ct,ye]=_r("loadingIndicator",{className:gt.loadingIndicator,elementType:p6,externalForwardedProps:Qe,ownerState:Ke});return G.jsx(Ve,we({},je,{children:D?G.jsx(ct,we({},ye,{children:Ge})):h}))});sd.muiName="IconButton";function m6(e){return wi("MuiChip",e)}const Mw=Si("MuiChip",["root","clickable","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","disabled","endDecorator","focusVisible","label","labelSm","labelMd","labelLg","sizeSm","sizeMd","sizeLg","startDecorator","variantPlain","variantSolid","variantSoft","variantOutlined"]),OI=K.createContext({disabled:void 0,variant:void 0,color:void 0}),g6=["children","className","color","onClick","disabled","size","variant","startDecorator","endDecorator","component","slots","slotProps"],y6=e=>{const{disabled:t,size:i,color:a,clickable:c,variant:h,focusVisible:f}=e,o={root:["root",t&&"disabled",a&&`color${xr(a)}`,i&&`size${xr(i)}`,h&&`variant${xr(h)}`,c&&"clickable"],action:["action",t&&"disabled",f&&"focusVisible"],label:["label",i&&`label${xr(i)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return di(o,m6,{})},v6=rr("div",{name:"JoyChip",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var i,a,c;const h=(i=e.variants[t.variant])==null?void 0:i[t.color],{borderRadius:f}=tm({theme:e,ownerState:t},["borderRadius"]);return[we({"--Chip-decoratorChildOffset":"min(calc(var(--Chip-paddingInline) - (var(--_Chip-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Chip-decoratorChildHeight)) / 2), var(--Chip-paddingInline))","--Chip-decoratorChildRadius":"max(var(--_Chip-radius) - var(--variant-borderWidth, 0px) - var(--_Chip-paddingBlock), min(var(--_Chip-paddingBlock) + var(--variant-borderWidth, 0px), var(--_Chip-radius) / 2))","--Chip-deleteRadius":"var(--Chip-decoratorChildRadius)","--Chip-deleteSize":"var(--Chip-decoratorChildHeight)","--Avatar-radius":"var(--Chip-decoratorChildRadius)","--Avatar-size":"var(--Chip-decoratorChildHeight)","--Icon-margin":"initial","--Icon-color":"currentColor","--unstable_actionRadius":"var(--_Chip-radius)"},t.size==="sm"&&{"--Chip-paddingInline":"0.375rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 2 * var(--variant-borderWidth))","--Icon-fontSize":e.vars.fontSize.sm,"--_Chip-minHeight":"var(--Chip-minHeight, 1.25rem)",gap:"3px"},t.size==="md"&&{"--Chip-paddingInline":"0.5rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 0.25rem - 2 * var(--variant-borderWidth))","--Icon-fontSize":e.vars.fontSize.md,"--_Chip-minHeight":"var(--Chip-minHeight, 1.5rem)",gap:"0.25rem"},t.size==="lg"&&{"--Chip-paddingInline":"0.75rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 0.375rem - 2 * var(--variant-borderWidth))","--Icon-fontSize":e.vars.fontSize.lg,"--_Chip-minHeight":"var(--Chip-minHeight, 1.75rem)",gap:"0.375rem"},{"--_Chip-radius":"var(--Chip-radius, 1.5rem)","--_Chip-paddingBlock":"max((var(--_Chip-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Chip-decoratorChildHeight)) / 2, 0px)",minHeight:"var(--_Chip-minHeight)",maxWidth:"max-content",paddingInline:"var(--Chip-paddingInline)",borderRadius:"var(--_Chip-radius)",position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",textDecoration:"none",verticalAlign:"middle",boxSizing:"border-box"},e.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[t.size]}`],{fontWeight:e.vars.fontWeight.md,[`&.${Mw.disabled}`]:{color:(a=e.variants[`${t.variant}Disabled`])==null||(a=a[t.color])==null?void 0:a.color}}),...t.clickable?[{"--variant-borderWidth":"0px",color:h?.color}]:[we({backgroundColor:e.vars.palette.background.surface},h,{[`&.${Mw.disabled}`]:(c=e.variants[`${t.variant}Disabled`])==null?void 0:c[t.color]})],f!==void 0&&{"--_Chip-radius":f}]}),_6=rr("span",{name:"JoyChip",slot:"Label",overridesResolver:(e,t)=>t.label})(({ownerState:e})=>we({display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",order:1,minInlineSize:0,flexGrow:1},e.clickable&&{zIndex:1,pointerEvents:"none"})),x6=rr("button",{name:"JoyChip",slot:"Action",overridesResolver:(e,t)=>t.action})(({theme:e,ownerState:t})=>{var i,a,c,h;return[{"--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,position:"absolute",zIndex:0,top:0,left:0,bottom:0,right:0,width:"100%",border:"none",cursor:"pointer",padding:"initial",margin:"initial",backgroundColor:"initial",textDecoration:"none",borderRadius:"inherit",[e.focus.selector]:e.focus.default},we({backgroundColor:e.vars.palette.background.surface},(i=e.variants[t.variant])==null?void 0:i[t.color]),{"&:hover":{"@media (hover: hover)":(a=e.variants[`${t.variant}Hover`])==null?void 0:a[t.color]}},{"&:active":(c=e.variants[`${t.variant}Active`])==null?void 0:c[t.color]},{[`&.${Mw.disabled}`]:(h=e.variants[`${t.variant}Disabled`])==null?void 0:h[t.color]}]}),b6=rr("span",{name:"JoyChip",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({"--Avatar-marginInlineStart":"calc(var(--Chip-decoratorChildOffset) * -1)","--IconButton-margin":"0 calc(-1 * var(--Chip-paddingInline) / 3) 0 calc(var(--Chip-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Chip-paddingInline) / -4)",display:"inherit",order:0,zIndex:1,pointerEvents:"none"}),w6=rr("span",{name:"JoyChip",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})({"--IconButton-margin":"0 calc(var(--Chip-decoratorChildOffset) * -1) 0 calc(-1 * var(--Chip-paddingInline) / 3)","--Icon-margin":"0 calc(var(--Chip-paddingInline) / -4) 0 0",display:"inherit",order:2,zIndex:1,pointerEvents:"none"}),S6=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoyChip"}),{children:c,className:h,color:f="neutral",onClick:o,disabled:b=!1,size:P="md",variant:I="soft",startDecorator:D,endDecorator:z,component:F,slots:U={},slotProps:$={}}=a,j=Pr(a,g6),ie=!!o||!!$.action,se=we({},a,{disabled:b,size:P,color:f,variant:I,clickable:ie,focusVisible:!1}),Q=typeof $.action=="function"?$.action(se):$.action,de=K.useRef(null),{focusVisible:oe,getRootProps:be}=Uv(we({},Q,{disabled:b,rootRef:de}));se.focusVisible=oe;const xe=y6(se),Me=we({},j,{component:F,slots:U,slotProps:$}),[Ee,re]=_r("root",{ref:i,className:hi(xe.root,h),elementType:v6,externalForwardedProps:Me,ownerState:se}),[ke,Ge]=_r("label",{className:xe.label,elementType:_6,externalForwardedProps:Me,ownerState:se}),Ke=x2(Ge.id),[gt,et]=_r("action",{className:xe.action,elementType:x6,externalForwardedProps:Me,ownerState:se,getSlotProps:be,additionalProps:{"aria-labelledby":Ke,as:Q?.component,onClick:o}}),[qe,Qe]=_r("startDecorator",{className:xe.startDecorator,elementType:b6,externalForwardedProps:Me,ownerState:se}),[Ve,je]=_r("endDecorator",{className:xe.endDecorator,elementType:w6,externalForwardedProps:Me,ownerState:se}),ct=K.useMemo(()=>({disabled:b}),[b]);return G.jsx(OI.Provider,{value:ct,children:G.jsx(DI,{variant:I,color:f,children:G.jsxs(Ee,we({},re,{children:[ie&&G.jsx(gt,we({},et)),G.jsx(ke,we({},Ge,{id:Ke,children:c})),D&&G.jsx(qe,we({},Qe,{children:D})),z&&G.jsx(Ve,we({},je,{children:z}))]}))})})}),C6=D2(G.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Cancel");function T6(e){return wi("MuiChipDelete",e)}Si("MuiChipDelete",["root","disabled","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSolid","variantSoft","variantOutlined"]);var ZT;const M6=["children","variant","color","disabled","onKeyDown","onDelete","onClick","component","slots","slotProps"],P6=["onDelete"],E6=e=>{const{focusVisible:t,variant:i,color:a,disabled:c}=e,h={root:["root",c&&"disabled",t&&"focusVisible",i&&`variant${xr(i)}`,a&&`color${xr(a)}`]};return di(h,T6,{})},I6=rr(Gx,{name:"JoyChipDelete",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({"--IconButton-size":"var(--Chip-deleteSize, 2rem)","--Icon-fontSize":"calc(var(--IconButton-size, 2rem) / 1.3)",minWidth:"var(--IconButton-size, 2rem)",minHeight:"var(--IconButton-size, 2rem)",fontSize:e.vars.fontSize.sm,paddingInline:"2px",pointerEvents:"visible",borderRadius:"var(--Chip-deleteRadius, 50%)",zIndex:1,padding:0})),k6=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoyChipDelete"}),{children:c,variant:h="plain",color:f="neutral",disabled:o,onKeyDown:b,onDelete:P,onClick:I,component:D,slots:z={},slotProps:F={}}=a,U=Pr(a,M6),$=K.useContext(OI),{variant:j=h,color:ie=f}=RI(t.variant,t.color,!0),se=t.color||ie,Q=o??$.disabled,de=K.useRef(null),oe=Ea(de,i),{focusVisible:be,getRootProps:xe}=Uv(we({},a,{disabled:Q,rootRef:oe})),Me=we({},a,{disabled:Q,variant:j,color:se,focusVisible:be}),Ee=E6(Me),re=we({},U,{component:D,slots:z,slotProps:F}),ke=qe=>{!Q&&P&&P(qe),I&&I(qe)},Ge=qe=>{["Backspace","Enter","Delete"].includes(qe.key)&&(qe.preventDefault(),!Q&&P&&P(qe)),b&&b(qe)},[Ke,gt]=_r("root",{ref:i,elementType:I6,getSlotProps:xe,externalForwardedProps:re,ownerState:Me,additionalProps:{as:D,onKeyDown:Ge,onClick:ke},className:Ee.root}),et=Pr(gt,P6);return G.jsx(Ke,we({},et,{children:c??(ZT||(ZT=G.jsx(C6,{})))}))});function A6(e){return wi("MuiInput",e)}const LI=Si("MuiInput",["root","input","formControl","focused","disabled","error","adornedStart","adornedEnd","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid","fullWidth","startDecorator","endDecorator"]),FI=K.createContext(void 0),R6=["aria-describedby","aria-label","aria-labelledby","autoComplete","autoFocus","className","defaultValue","disabled","disabledInProp","error","id","name","onClick","onChange","onKeyDown","onKeyUp","onFocus","onBlur","placeholder","readOnly","required","type","value"];function D6(e,t){var i;const a=K.useContext(FI),{"aria-describedby":c,"aria-label":h,"aria-labelledby":f,autoComplete:o,autoFocus:b,className:P,defaultValue:I,disabled:D,disabledInProp:z,error:F,id:U,name:$,onClick:j,onChange:ie,onKeyDown:se,onKeyUp:Q,onFocus:de,onBlur:oe,placeholder:be,readOnly:xe,required:Me,type:Ee,value:re}=e,ke=Pr(e,R6),{getRootProps:Ge,getInputProps:Ke,focused:gt,error:et,disabled:qe}=qO({disabled:(i=z??a?.disabled)!=null?i:D,defaultValue:I,error:F,onBlur:oe,onClick:j,onChange:ie,onFocus:de,required:Me??a?.required,value:re}),Qe={[t.disabled]:qe,[t.error]:et,[t.focused]:gt,[t.formControl]:!!a,[P]:P},Ve={[t.disabled]:qe};return we({formControl:a,propsToForward:{"aria-describedby":c,"aria-label":h,"aria-labelledby":f,autoComplete:o,autoFocus:b,disabled:qe,id:U,onKeyDown:se,onKeyUp:Q,name:$,placeholder:be,readOnly:xe,type:Ee},rootStateClasses:Qe,inputStateClasses:Ve,getRootProps:Ge,getInputProps:Ke,focused:gt,error:et,disabled:qe},ke)}const z6=["propsToForward","rootStateClasses","inputStateClasses","getRootProps","getInputProps","formControl","focused","error","disabled","fullWidth","size","color","variant","startDecorator","endDecorator","component","slots","slotProps"],O6=e=>{const{disabled:t,fullWidth:i,variant:a,color:c,size:h}=e,f={root:["root",t&&"disabled",i&&"fullWidth",a&&`variant${xr(a)}`,c&&`color${xr(c)}`,h&&`size${xr(h)}`],input:["input"],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return di(f,A6,{})},BI=rr("div")(({theme:e,ownerState:t})=>{var i,a,c,h,f,o;const b=(i=e.variants[`${t.variant}`])==null?void 0:i[t.color];return[we({"--Input-radius":e.vars.radius.sm,"--Input-gap":"0.5rem","--Input-placeholderColor":"inherit","--Input-placeholderOpacity":.64,"--Input-decoratorColor":e.vars.palette.text.icon,"--Input-focused":"0","--Input-focusedThickness":e.vars.focus.thickness,"--Input-focusedHighlight":(a=e.vars.palette[t.color==="neutral"?"primary":t.color])==null?void 0:a[500],[`&:not([${Fg}])`]:we({},t.instanceColor&&{"--_Input-focusedHighlight":(c=e.vars.palette[t.instanceColor==="neutral"?"primary":t.instanceColor])==null?void 0:c[500]},{"--Input-focusedHighlight":`var(--_Input-focusedHighlight, ${e.vars.palette.focusVisible})`})},t.size==="sm"&&{"--Input-minHeight":"2rem","--Input-paddingInline":"0.5rem","--Input-decoratorChildHeight":"min(1.5rem, var(--Input-minHeight))","--Icon-fontSize":e.vars.fontSize.xl},t.size==="md"&&{"--Input-minHeight":"2.25rem","--Input-paddingInline":"0.75rem","--Input-decoratorChildHeight":"min(1.75rem, var(--Input-minHeight))","--Icon-fontSize":e.vars.fontSize.xl2},t.size==="lg"&&{"--Input-minHeight":"2.75rem","--Input-paddingInline":"1rem","--Input-gap":"0.75rem","--Input-decoratorChildHeight":"min(2.25rem, var(--Input-minHeight))","--Icon-fontSize":e.vars.fontSize.xl2},{"--Input-decoratorChildOffset":"min(calc(var(--Input-paddingInline) - (var(--Input-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Input-decoratorChildHeight)) / 2), var(--Input-paddingInline))","--_Input-paddingBlock":"max((var(--Input-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Input-decoratorChildHeight)) / 2, 0px)","--Input-decoratorChildRadius":"max(var(--Input-radius) - var(--variant-borderWidth, 0px) - var(--_Input-paddingBlock), min(var(--_Input-paddingBlock) + var(--variant-borderWidth, 0px), var(--Input-radius) / 2))","--Button-minHeight":"var(--Input-decoratorChildHeight)","--Button-paddingBlock":"0px","--IconButton-size":"var(--Input-decoratorChildHeight)","--Button-radius":"var(--Input-decoratorChildRadius)","--IconButton-radius":"var(--Input-decoratorChildRadius)",boxSizing:"border-box"},t.variant!=="plain"&&{boxShadow:e.shadow.xs},{minWidth:0,minHeight:"var(--Input-minHeight)"},t.fullWidth&&{width:"100%"},{cursor:"text",position:"relative",display:"flex",paddingInline:"var(--Input-paddingInline)",borderRadius:"var(--Input-radius)"},e.typography[`body-${t.size}`],b,{backgroundColor:(h=b?.backgroundColor)!=null?h:e.vars.palette.background.surface,"&::before":{boxSizing:"border-box",content:'""',display:"block",position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,zIndex:1,borderRadius:"inherit",margin:"calc(var(--variant-borderWidth, 0px) * -1)",boxShadow:"var(--Input-focusedInset, inset) 0 0 0 calc(var(--Input-focused) * var(--Input-focusedThickness)) var(--Input-focusedHighlight)"}}),{"&:hover":we({},(f=e.variants[`${t.variant}Hover`])==null?void 0:f[t.color],{backgroundColor:null}),[`&.${LI.disabled}`]:(o=e.variants[`${t.variant}Disabled`])==null?void 0:o[t.color],"&:focus-within::before":{"--Input-focused":"1"}}]}),$I=rr("input")(({ownerState:e})=>({border:"none",minWidth:0,outline:0,padding:0,flex:1,color:"inherit",backgroundColor:"transparent",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontWeight:"inherit",lineHeight:"inherit",textOverflow:"ellipsis","&:-webkit-autofill":we({paddingInline:"var(--Input-paddingInline)"},!e.startDecorator&&{marginInlineStart:"calc(-1 * var(--Input-paddingInline))",paddingInlineStart:"var(--Input-paddingInline)",borderTopLeftRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))",borderBottomLeftRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))"},!e.endDecorator&&{marginInlineEnd:"calc(-1 * var(--Input-paddingInline))",paddingInlineEnd:"var(--Input-paddingInline)",borderTopRightRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))",borderBottomRightRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))"}),"&::-webkit-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&::-moz-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&:-ms-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&::-ms-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"}})),jI=rr("div")({"--Button-margin":"0 0 0 calc(var(--Input-decoratorChildOffset) * -1)","--IconButton-margin":"0 0 0 calc(var(--Input-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Input-paddingInline) / -4)",display:"inherit",alignItems:"center",paddingBlock:"var(--unstable_InputPaddingBlock)",flexWrap:"wrap",marginInlineEnd:"var(--Input-gap)",color:"var(--Input-decoratorColor)",cursor:"initial"}),NI=rr("div")({"--Button-margin":"0 calc(var(--Input-decoratorChildOffset) * -1) 0 0","--IconButton-margin":"0 calc(var(--Input-decoratorChildOffset) * -1) 0 0","--Icon-margin":"0 calc(var(--Input-paddingInline) / -4) 0 0",display:"inherit",alignItems:"center",marginInlineStart:"var(--Input-gap)",color:"var(--Input-decoratorColor)",cursor:"initial"}),L6=rr(BI,{name:"JoyInput",slot:"Root",overridesResolver:(e,t)=>t.root})({}),F6=rr($I,{name:"JoyInput",slot:"Input",overridesResolver:(e,t)=>t.input})({}),B6=rr(jI,{name:"JoyInput",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({}),$6=rr(NI,{name:"JoyInput",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})({}),j6=K.forwardRef(function(t,i){var a,c,h,f,o,b;const P=Ci({props:t,name:"JoyInput"}),I=D6(we({},P,{disabledInProp:t.disabled}),LI),{propsToForward:D,rootStateClasses:z,inputStateClasses:F,getRootProps:U,getInputProps:$,formControl:j,focused:ie,error:se=!1,disabled:Q,fullWidth:de=!1,size:oe="md",color:be="neutral",variant:xe="outlined",startDecorator:Me,endDecorator:Ee,component:re,slots:ke={},slotProps:Ge={}}=I,Ke=Pr(I,z6),gt=(a=(c=t.error)!=null?c:j?.error)!=null?a:se,et=(h=(f=t.size)!=null?f:j?.size)!=null?h:oe,qe=(o=t.color)!=null?o:gt?"danger":(b=j?.color)!=null?b:be,Qe=we({instanceColor:gt?"danger":t.color},P,{fullWidth:de,color:qe,disabled:Q,error:gt,focused:ie,size:et,variant:xe}),Ve=O6(Qe),je=we({},Ke,{component:re,slots:ke,slotProps:Ge}),[ct,ye]=_r("root",{ref:i,className:[Ve.root,z],elementType:L6,getSlotProps:U,externalForwardedProps:je,ownerState:Qe}),[ze,ft]=_r("input",we({},j&&{additionalProps:{id:j.htmlFor,"aria-describedby":j["aria-describedby"]}},{className:[Ve.input,F],elementType:F6,getSlotProps:$,internalForwardedProps:D,externalForwardedProps:je,ownerState:Qe})),[wt,xt]=_r("startDecorator",{className:Ve.startDecorator,elementType:B6,externalForwardedProps:je,ownerState:Qe}),[_t,St]=_r("endDecorator",{className:Ve.endDecorator,elementType:$6,externalForwardedProps:je,ownerState:Qe});return G.jsxs(ct,we({},ye,{children:[Me&&G.jsx(wt,we({},xt,{children:Me})),G.jsx(ze,we({},ft)),Ee&&G.jsx(_t,we({},St,{children:Ee}))]}))});function N6(e){return wi("MuiListSubheader",e)}Si("MuiListSubheader",["root","sticky","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const V6=["component","className","children","id","sticky","variant","color","slots","slotProps"],U6=e=>{const{variant:t,color:i,sticky:a}=e,c={root:["root",a&&"sticky",i&&`color${xr(i)}`,t&&`variant${xr(t)}`]};return di(c,N6,{})},G6=rr("div",{name:"JoyListSubheader",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var i,a;return we({boxSizing:"border-box",display:"flex",alignItems:"center",marginInline:"var(--ListItem-marginInline)",paddingBlock:"var(--ListItem-paddingY)",paddingInlineStart:"var(--ListItem-paddingLeft)",paddingInlineEnd:"var(--ListItem-paddingRight)",minBlockSize:"var(--ListItem-minHeight)"},e.typography["body-xs"],{fontSize:"max(0.75em, 0.625rem)",textTransform:"uppercase",letterSpacing:"0.1em"},t.sticky&&{position:"sticky",top:"var(--ListItem-stickyTop, 0px)",zIndex:1,background:"var(--ListItem-stickyBackground)"},{color:t.color?`var(--_Link-color, rgba(${(i=e.vars.palette[t.color])==null?void 0:i.mainChannel} / 1))`:e.vars.palette.text.tertiary},t.instanceColor&&{[`&:not([${Fg}])`]:{"--_Link-color":e.vars.palette.text.secondary}},(a=e.variants[t.variant])==null?void 0:a[t.color])}),q6=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoyListSubheader"}),{component:c,className:h,children:f,id:o,sticky:b=!1,variant:P,color:I,slots:D={},slotProps:z={}}=a,F=Pr(a,V6),U=x2(o),$=K.useContext(SI);K.useEffect(()=>{$&&$(U||"")},[$,U]);const j=we({instanceColor:t.color},a,{id:U,sticky:b,variant:P,color:P?I??"neutral":I}),ie=U6(j),se=we({},F,{component:c,slots:D,slotProps:z}),[Q,de]=_r("root",{ref:i,className:hi(ie.root,h),elementType:G6,externalForwardedProps:se,ownerState:j,additionalProps:{as:c,id:U}});return G.jsx(Q,we({},de,{children:f}))});function H6(e){return wi("MuiAutocomplete",e)}const gf=Si("MuiAutocomplete",["root","wrapper","input","startDecorator","endDecorator","formControl","focused","disabled","error","multiple","limitTag","hasPopupIcon","hasClearIcon","clearIndicator","popupIndicator","popupIndicatorOpen","listbox","option","loading","noOptions","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]),VI=rr(MI)(({theme:e,ownerState:t})=>{var i;const a=(i=e.variants[t.variant])==null?void 0:i[t.color];return we({"--focus-outline-offset":`calc(${e.vars.focus.thickness} * -1)`,"--ListItem-stickyBackground":a?.backgroundColor||a?.background||e.vars.palette.background.popup,"--ListItem-stickyTop":"calc(var(--List-padding, var(--ListDivider-gap)) * -1)"},I4,{boxShadow:e.shadow.md,borderRadius:`var(--List-radius, ${e.vars.radius.sm})`},!(a!=null&&a.backgroundColor)&&{backgroundColor:e.vars.palette.background.popup},{zIndex:e.vars.zIndex.popup,overflow:"auto",maxHeight:"40vh",position:"relative","&:empty":{visibility:"hidden"},[`& .${X_.nested}, & .${X_.nested} .${A4.root}`]:{position:"initial"}})});rr(VI,{name:"JoyAutocompleteListbox",slot:"Root",overridesResolver:(e,t)=>t.root})({});function W6(e){return wi("MuiAutocompleteOption",e)}Si("MuiAutocompleteOption",["root","focused","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const Z6=["children","component","color","variant","className","slots","slotProps"],X6=e=>{const{color:t,variant:i}=e,a={root:["root",t&&`color${xr(t)}`,i&&`variant${xr(i)}`]};return di(a,W6,{})},UI=rr(EI)(({theme:e,ownerState:t})=>{var i,a;return{'&[aria-disabled="true"]':(i=e.variants[`${t.variant}Disabled`])==null?void 0:i[t.color],'&[aria-selected="true"]':we({},(a=e.variants[`${t.variant}Active`])==null?void 0:a[t.color],{fontWeight:e.vars.fontWeight.md})}}),K6=rr(UI,{name:"JoyAutocompleteOption",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Y6=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoyAutocompleteOption"}),{children:c,component:h="li",color:f="neutral",variant:o="plain",className:b,slots:P={},slotProps:I={}}=a,D=Pr(a,Z6),{variant:z=o,color:F=f}=RI(t.variant,t.color),U=we({},a,{component:h,color:F,variant:z}),$=X6(U),j=we({},D,{component:h,slots:P,slotProps:I}),[ie,se]=_r("root",{ref:i,className:hi($.root,b),elementType:K6,externalForwardedProps:j,ownerState:U,additionalProps:{as:h,role:"option"}});return G.jsx(ie,we({},se,{children:c}))});var XT,KT;const J6=["aria-describedby","aria-label","aria-labelledby","autoComplete","autoHighlight","autoSelect","autoFocus","blurOnSelect","clearIcon","clearOnBlur","clearOnEscape","clearText","closeText","defaultValue","disableCloseOnSelect","disabledItemsFocusable","disableListWrap","disableClearable","disabled","endDecorator","error","filterOptions","filterSelectedOptions","forcePopupIcon","freeSolo","getLimitTagsText","getOptionDisabled","getOptionKey","getOptionLabel","handleHomeEndKeys","includeInputInList","isOptionEqualToValue","groupBy","id","inputValue","limitTags","loading","loadingText","multiple","name","noOptionsText","onChange","onClose","onHighlightChange","onInputChange","onOpen","open","openOnFocus","openText","options","placeholder","popupIcon","readOnly","renderGroup","renderOption","renderTags","required","type","startDecorator","size","color","variant","value","component","selectOnFocus","slots","slotProps"],Q6=["onDelete"],eF=["key"],tF=["onBlur","onFocus","onMouseDown"],rF=["key"],nF=e=>e.current!==null&&e.current.contains(document.activeElement),iF=e=>{var t;return(t=e.label)!=null?t:e},oF=e=>`+${e}`,sF=e=>G.jsxs(ll,{nested:!0,children:[G.jsx(q6,{sticky:!0,children:e.group}),G.jsx(rm,{children:e.children})]},e.key),aF=e=>{const{disabled:t,focused:i,hasClearIcon:a,hasPopupIcon:c,popupOpen:h,variant:f,color:o,size:b,multiple:P}=e,I={root:["root",i&&"focused",a&&"hasClearIcon",c&&"hasPopupIcon",f&&`variant${xr(f)}`,o&&`color${xr(o)}`,b&&`size${xr(b)}`],wrapper:["wrapper",P&&"multiple"],input:["input"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",h&&"popupIndicatorOpen",t&&"disabled"],listbox:["listbox"],option:["option"],loading:["loading"],noOptions:["noOptions"],limitTag:["limitTag"]};return di(I,H6,{})},lF=rr(BI,{name:"JoyAutocomplete",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e})=>we({},e.size==="sm"&&{"--Autocomplete-wrapperGap":"3px"},e.size==="md"&&{"--Autocomplete-wrapperGap":"3px"},e.size==="lg"&&{"--Autocomplete-wrapperGap":"4px"},{"@media (pointer: fine)":{[`&:hover .${gf.clearIndicator}`]:{visibility:"visible"}}},e.multiple&&!e.startDecorator&&{paddingInlineStart:0})),cF=rr("div",{name:"JoyAutocomplete",slot:"Wrapper",overridesResolver:(e,t)=>t.wrapper})(({ownerState:e})=>({flex:1,minWidth:0,display:"flex",alignItems:"center",flexWrap:"wrap",gap:"var(--Autocomplete-wrapperGap)",[`&.${gf.multiple}`]:we({paddingBlock:"var(--Autocomplete-wrapperGap)"},!e.startDecorator&&{paddingInlineStart:"var(--Autocomplete-wrapperGap)"},!e.endDecorator&&{paddingInlineEnd:"var(--Autocomplete-wrapperGap)"})})),uF=rr($I,{name:"JoyAutocomplete",slot:"Input",overridesResolver:(e,t)=>t.input})(({ownerState:e})=>we({minWidth:30,minHeight:"var(--Chip-minHeight)"},e.multiple&&{marginInlineStart:"calc(var(--Autocomplete-wrapperGap) * 2.5)"})),hF=rr(jI,{name:"JoyAutocomplete",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({}),dF=rr(NI,{name:"JoyAutocomplete",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})(({ownerState:e})=>we({},(e.hasClearIcon||e.hasPopupIcon)&&{"--Button-margin":"0px","--IconButton-margin":"0px","--Icon-margin":"0px"})),fF=rr(Gx,{name:"JoyAutocomplete",slot:"ClearIndicator",overridesResolver:(e,t)=>t.clearIndicator})(({ownerState:e})=>we({alignSelf:"center"},!e.hasPopupIcon&&{marginInlineEnd:"calc(var(--Input-decoratorChildOffset) * -1)"},{marginInlineStart:"calc(var(--_Input-paddingBlock) / 2)",visibility:e.focused?"visible":"hidden"})),pF=rr(Gx,{name:"JoyAutocomplete",slot:"PopupIndicator",overridesResolver:(e,t)=>t.popupIndicator})({alignSelf:"center",marginInlineStart:"calc(var(--_Input-paddingBlock) / 2)",marginInlineEnd:"calc(var(--Input-decoratorChildOffset) * -1)",[`&.${gf.popupIndicatorOpen}`]:{transform:"rotate(180deg)","--Icon-color":"currentColor"}}),mF=rr(VI,{name:"JoyAutocomplete",slot:"Listbox",overridesResolver:(e,t)=>t.listbox})(({theme:e})=>({zIndex:`var(--unstable_popup-zIndex, ${e.vars.zIndex.popup})`})),gF=rr(UI,{name:"JoyAutocomplete",slot:"Option",overridesResolver:(e,t)=>t.option})({}),yF=rr(ll,{name:"JoyAutocomplete",slot:"Loading",overridesResolver:(e,t)=>t.loading})(({theme:e})=>({color:(e.vars||e).palette.text.secondary})),vF=rr(ll,{name:"JoyAutocomplete",slot:"NoOptions",overridesResolver:(e,t)=>t.noOptions})(({theme:e})=>({color:(e.vars||e).palette.text.secondary})),_F=rr("div",{name:"JoyAutocomplete",slot:"NoOptions",overridesResolver:(e,t)=>t.noOptions})({marginInlineStart:"calc(var(--Input-paddingInline) / 2)",marginBlockStart:"var(--_Input-paddingBlock)"}),xF=K.forwardRef(function(t,i){var a,c,h,f,o,b,P;const I=Ci({props:t,name:"JoyAutocomplete"}),{"aria-describedby":D,"aria-label":z,"aria-labelledby":F,autoFocus:U,clearIcon:$=XT||(XT=G.jsx(J4,{fontSize:"md"})),clearText:j="Clear",closeText:ie="Close",disableClearable:se=!1,disabled:Q,endDecorator:de,error:oe=!1,forcePopupIcon:be="auto",freeSolo:xe=!1,getLimitTagsText:Me=oF,getOptionLabel:Ee=iF,groupBy:re,id:ke,limitTags:Ge=-1,loading:Ke=!1,loadingText:gt="Loading",multiple:et=!1,name:qe,noOptionsText:Qe="No options",openText:Ve="Open",placeholder:je,popupIcon:ct=KT||(KT=G.jsx(Q4,{})),readOnly:ye=!1,renderGroup:ze=sF,renderOption:ft,renderTags:wt,required:xt,type:_t,startDecorator:St,size:tt="md",color:At="neutral",variant:It="outlined",component:mr,slots:ur={},slotProps:Hr={}}=I,wr=Pr(I,J6),sr=K.useContext(FI),Wt=(a=(c=t.error)!=null?c:sr?.error)!=null?a:oe,yr=(h=(f=t.size)!=null?f:sr?.size)!=null?h:tt,Yt=(o=t.color)!=null?o:Wt?"danger":(b=sr?.color)!=null?b:At,Cr=(P=Q??sr?.disabled)!=null?P:!1,{getRootProps:Rr,getInputProps:Or,getPopupIndicatorProps:Gr,getClearProps:rn,getTagProps:Un,getListboxProps:wn,getOptionProps:He,value:ae,dirty:le,popupOpen:ue,focused:Pe,focusedTag:Re,anchorEl:Ye,setAnchorEl:Xe,inputValue:$e,groupedOptions:Je}=v4(we({},I,{id:ke??sr?.htmlFor,componentName:"Autocomplete",unstable_classNamePrefix:"Mui",unstable_isActiveElementInListbox:nF})),{onMouseDown:Ct}=Or(),{onClick:yt}=Rr(),$t=!se&&!Cr&&le&&!ye,qt=(!xe||be===!0)&&be!==!1,Qt=we({instanceColor:t.color},I,{value:ae,disabled:Cr,focused:Pe,getOptionLabel:Ee,hasOptions:!!Je.length,hasClearIcon:$t,hasPopupIcon:qt,inputFocused:Re===-1,popupOpen:ue,size:yr,color:Yt,variant:It}),br=aF(Qt),tr=we({},wr,{component:mr,slots:ur,slotProps:Hr});let Ze;if(et&&ae.length>0){const Mr=Ei=>{const on=Un(Ei),{onDelete:fi}=on,Ii=Pr(on,Q6);return we({disabled:Cr,size:yr,onClick:fi},Ii)};wt?Ze=wt(ae,Mr,Qt):Ze=ae.map((Ei,on)=>{const fi=Mr({index:on}),{key:Ii}=fi,Rs=Pr(fi,eF);return G.jsx(S6,{size:yr,variant:"soft",color:"neutral",endDecorator:G.jsx(k6,we({},Rs),Ii),sx:{minWidth:0},children:Ee(Ei)},on)})}const Lr=Ea(i,Xe),mn={[gf.disabled]:Cr,[gf.error]:Wt,[gf.focused]:Pe,[gf.formControl]:!!sr},[ar,Dr]=_r("root",{ref:Lr,className:[br.root,mn],elementType:lF,externalForwardedProps:tr,ownerState:Qt,getSlotProps:Rr,additionalProps:{onClick:Mr=>{yt&&yt(Mr),Mr.currentTarget===Mr.target&&Ct&&Ct(Mr)}}}),[ln,Xr]=_r("wrapper",{className:br.wrapper,elementType:cF,externalForwardedProps:tr,ownerState:Qt}),zr={[gf.disabled]:Cr},[Vr,Kr]=_r("input",{className:[br.input,zr],elementType:uF,getSlotProps:Mr=>{const Ei=Or(),{onBlur:on,onFocus:fi,onMouseDown:Ii}=Ei,Rs=Pr(Ei,tF);return we({},Rs,{onBlur:os=>{var gn;on?.(os),(gn=Mr.onBlur)==null||gn.call(Mr,os)},onFocus:os=>{var gn;fi?.(os),(gn=Mr.onFocus)==null||gn.call(Mr,os)},onMouseDown:os=>{var gn;Ii?.(os),(gn=Mr.onMouseDown)==null||gn.call(Mr,os)}})},externalForwardedProps:tr,ownerState:Qt,additionalProps:{autoFocus:U,placeholder:je,name:qe,readOnly:ye,disabled:Cr,required:xt??sr?.required,type:_t,"aria-invalid":Wt||void 0,"aria-label":z,"aria-labelledby":F,"aria-describedby":D??sr?.["aria-describedby"]}}),[Vi,Ui]=_r("startDecorator",{className:br.startDecorator,elementType:hF,externalForwardedProps:tr,ownerState:Qt}),[Et,vn]=_r("endDecorator",{className:br.endDecorator,elementType:dF,externalForwardedProps:tr,ownerState:Qt}),[zn,fs]=_r("clearIndicator",{className:br.clearIndicator,elementType:fF,getSlotProps:rn,externalForwardedProps:tr,ownerState:Qt,getSlotOwnerState:Mr=>({size:Mr.size||yr,variant:Mr.variant||Rp(It,Yt).variant||"plain",color:Mr.color||Rp(It,Yt).color||"neutral",disableColorInversion:!!t.color}),additionalProps:{"aria-label":j,title:j}}),[Ki,jt]=_r("popupIndicator",{className:br.popupIndicator,elementType:pF,getSlotProps:Gr,externalForwardedProps:tr,ownerState:Qt,getSlotOwnerState:Mr=>({size:Mr.size||yr,variant:Mr.variant||Rp(It,Yt).variant||"plain",color:Mr.color||Rp(It,Yt).color||"neutral",disableColorInversion:!!t.color}),additionalProps:{disabled:Cr,"aria-label":ue?ie:Ve,title:ue?ie:Ve,type:"button"}}),[ot,rt]=_r("listbox",{className:br.listbox,elementType:mF,getSlotProps:wn,externalForwardedProps:tr,ownerState:Qt,getSlotOwnerState:Mr=>({size:Mr.size||yr,variant:Mr.variant||It,color:Mr.color||Yt,disableColorInversion:!Mr.disablePortal}),additionalProps:{anchorEl:Ye,open:ue,style:Ye?{width:Ye.clientWidth}:{}}}),[Zt,Tr]=_r("loading",{className:br.loading,elementType:yF,externalForwardedProps:tr,ownerState:Qt}),[Nr,ir]=_r("noOptions",{className:br.noOptions,elementType:vF,externalForwardedProps:tr,ownerState:Qt,additionalProps:{role:"presentation",onMouseDown:Mr=>{Mr.preventDefault()}}}),[An,Gi]=_r("limitTag",{className:br.limitTag,elementType:_F,externalForwardedProps:tr,ownerState:Qt});if(Ge>-1&&Array.isArray(Ze)){const Mr=Ze.length-Ge;!Pe&&Mr>0&&(Ze=Ze.splice(0,Ge),Ze.push(G.jsx(An,we({},Gi,{children:Me(Mr)}),Ze.length)))}const[Ra,pl]=_r("option",{className:br.option,elementType:gF,externalForwardedProps:tr,ownerState:Qt,getSlotOwnerState:Mr=>({variant:Mr.variant||Rp(It,Yt).variant||"plain",color:Mr.color||Rp(It,Yt).color||"neutral",disableColorInversion:!rt.disablePortal}),additionalProps:{as:"li"}}),ml=ft||((Mr,Ei)=>{const{key:on}=Mr,fi=Pr(Mr,rF);return G.jsx(Ra,we({},fi,{children:Ee(Ei)}),on)}),Qs=(Mr,Ei)=>{const on=He({option:Mr,index:Ei});return ml(we({},pl,on),Mr,{selected:!!on["aria-selected"],inputValue:$e,ownerState:Qt})},Yi=K.useMemo(()=>[{name:"offset",options:{offset:[0,4]}},...rt.modifiers||[]],[rt.modifiers]);let nn=null;if(Ye){var nc;nn=G.jsx(DI,{variant:It,color:Yt,children:G.jsx(TI,{nested:!0,children:G.jsxs(ot,we({},rt,{className:hi(rt.className),modifiers:Yi},!((nc=I.slots)!=null&&nc.listbox)&&{as:d4,slots:{root:rt.as||"ul"}},{children:[Je.map((Mr,Ei)=>{if(re){const on=Mr;return ze({key:String(on.key),group:on.group,children:on.options.map((fi,Ii)=>Qs(fi,on.index+Ii))})}return Qs(Mr,Ei)}),Ke&&Je.length===0?G.jsx(Zt,we({},Tr,{children:gt})):null,Je.length===0&&!xe&&!Ke?G.jsx(Nr,we({},ir,{children:Qe})):null]}))})})}return G.jsxs(K.Fragment,{children:[G.jsxs(ar,we({},Dr,{children:[St&&G.jsx(Vi,we({},Ui,{children:St})),G.jsxs(ln,we({},Xr,{children:[Ze,G.jsx(Vr,we({},Kr))]})),de&&G.jsx(Et,we({},vn,{children:de})),$t?G.jsx(zn,we({},fs,{children:$})):null,qt?G.jsx(Ki,we({},jt,{children:ct})):null]})),nn]})}),bF=KE("MuiBox",["root"]),ei=vz({themeId:Fv,defaultTheme:Zg,defaultClassName:bF.root,generateClassName:WE.generate});function wF(e){return wi("MuiTypography",e)}Si("MuiTypography",["root","h1","h2","h3","h4","title-lg","title-md","title-sm","body-lg","body-md","body-sm","body-xs","noWrap","gutterBottom","startDecorator","endDecorator","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);const SF=["color","textColor"],CF=["component","gutterBottom","noWrap","level","levelMapping","children","endDecorator","startDecorator","variant","slots","slotProps"],Y_=K.createContext(!1),GI=K.createContext(!1),TF=e=>{const{gutterBottom:t,noWrap:i,level:a,color:c,variant:h}=e,f={root:["root",a,t&&"gutterBottom",i&&"noWrap",c&&`color${xr(c)}`,h&&`variant${xr(h)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return di(f,wF,{})},MF=rr("span",{name:"JoyTypography",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({display:"inline-flex",marginInlineEnd:"clamp(4px, var(--Typography-gap, 0.375em), 0.75rem)"}),PF=rr("span",{name:"JoyTypography",slot:"endDecorator",overridesResolver:(e,t)=>t.endDecorator})({display:"inline-flex",marginInlineStart:"clamp(4px, var(--Typography-gap, 0.375em), 0.75rem)"}),EF=rr("span",{name:"JoyTypography",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var i,a,c,h,f;const o=t.level!=="inherit"?(i=e.typography[t.level])==null?void 0:i.lineHeight:"1";return we({"--Icon-fontSize":`calc(1em * ${o})`},t.color&&{"--Icon-color":"currentColor"},{margin:"var(--Typography-margin, 0px)"},t.nesting?{display:"inline"}:we({display:"block"},t.unstable_hasSkeleton&&{position:"relative"}),(t.startDecorator||t.endDecorator)&&we({display:"flex",alignItems:"center"},t.nesting&&we({display:"inline-flex"},t.startDecorator&&{verticalAlign:"bottom"})),t.level&&t.level!=="inherit"&&e.typography[t.level],{fontSize:`var(--Typography-fontSize, ${t.level&&t.level!=="inherit"&&(a=(c=e.typography[t.level])==null?void 0:c.fontSize)!=null?a:"inherit"})`},t.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t.gutterBottom&&{marginBottom:"0.35em"},t.color&&{color:`var(--variant-plainColor, rgba(${(h=e.vars.palette[t.color])==null?void 0:h.mainChannel} / 1))`},t.variant&&we({borderRadius:e.vars.radius.xs,paddingBlock:"min(0.1em, 4px)",paddingInline:"0.25em"},!t.nesting&&{marginInline:"-0.25em"},(f=e.variants[t.variant])==null?void 0:f[t.color]))}),YT={h1:"h1",h2:"h2",h3:"h3",h4:"h4","title-lg":"p","title-md":"p","title-sm":"p","body-lg":"p","body-md":"p","body-sm":"p","body-xs":"span",inherit:"p"},Wr=K.forwardRef(function(t,i){var a;const c=Ci({props:t,name:"JoyTypography"}),{color:h,textColor:f}=c,o=Pr(c,SF),b=K.useContext(Y_),P=K.useContext(GI),I=Bx(we({},o,{color:f})),{component:D,gutterBottom:z=!1,noWrap:F=!1,level:U="body-md",levelMapping:$=YT,children:j,endDecorator:ie,startDecorator:se,variant:Q,slots:de={},slotProps:oe={}}=I,be=Pr(I,CF),xe=(a=t.color)!=null?a:Q?h??"neutral":h,Me=b||P?t.level||"inherit":U,Ee=Vv(j,["Skeleton"]),re=D||(b?"span":$[Me]||YT[Me]||"span"),ke=we({},I,{level:Me,component:re,color:xe,gutterBottom:z,noWrap:F,nesting:b,variant:Q,unstable_hasSkeleton:Ee}),Ge=TF(ke),Ke=we({},be,{component:re,slots:de,slotProps:oe}),[gt,et]=_r("root",{ref:i,className:Ge.root,elementType:EF,externalForwardedProps:Ke,ownerState:ke}),[qe,Qe]=_r("startDecorator",{className:Ge.startDecorator,elementType:MF,externalForwardedProps:Ke,ownerState:ke}),[Ve,je]=_r("endDecorator",{className:Ge.endDecorator,elementType:PF,externalForwardedProps:Ke,ownerState:ke});return G.jsx(Y_.Provider,{value:!0,children:G.jsxs(gt,we({},et,{children:[se&&G.jsx(qe,we({},Qe,{children:se})),Ee?K.cloneElement(j,{variant:j.props.variant||"inline"}):j,ie&&G.jsx(Ve,we({},je,{children:ie}))]}))})});Wr.muiName="Typography";function IF(e){return wi("MuiButton",e)}const Bg=Si("MuiButton",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","focusVisible","disabled","sizeSm","sizeMd","sizeLg","fullWidth","startDecorator","endDecorator","loading","loadingIndicatorCenter"]),kF=["children","action","color","variant","size","fullWidth","startDecorator","endDecorator","loading","loadingPosition","loadingIndicator","disabled","component","slots","slotProps"],AF=e=>{const{color:t,disabled:i,focusVisible:a,focusVisibleClassName:c,fullWidth:h,size:f,variant:o,loading:b}=e,P={root:["root",i&&"disabled",a&&"focusVisible",h&&"fullWidth",o&&`variant${xr(o)}`,t&&`color${xr(t)}`,f&&`size${xr(f)}`,b&&"loading"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],loadingIndicatorCenter:["loadingIndicatorCenter"]},I=di(P,IF,{});return a&&c&&(I.root+=` ${c}`),I},RF=rr("span",{name:"JoyButton",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({"--Icon-margin":"0 0 0 calc(var(--Button-gap) / -2)","--CircularProgress-margin":"0 0 0 calc(var(--Button-gap) / -2)",display:"inherit",marginRight:"var(--Button-gap)"}),DF=rr("span",{name:"JoyButton",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})({"--Icon-margin":"0 calc(var(--Button-gap) / -2) 0 0","--CircularProgress-margin":"0 calc(var(--Button-gap) / -2) 0 0",display:"inherit",marginLeft:"var(--Button-gap)"}),zF=rr("span",{name:"JoyButton",slot:"LoadingCenter",overridesResolver:(e,t)=>t.loadingIndicatorCenter})(({theme:e,ownerState:t})=>{var i,a;return we({display:"inherit",position:"absolute",left:"50%",transform:"translateX(-50%)",color:(i=e.variants[t.variant])==null||(i=i[t.color])==null?void 0:i.color},t.disabled&&{color:(a=e.variants[`${t.variant}Disabled`])==null||(a=a[t.color])==null?void 0:a.color})}),OF=({theme:e,ownerState:t})=>{var i,a,c,h;return[we({"--Icon-margin":"initial","--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon},t.size==="sm"&&{"--Icon-fontSize":e.vars.fontSize.lg,"--CircularProgress-size":"20px","--CircularProgress-thickness":"2px","--Button-gap":"0.375rem",minHeight:"var(--Button-minHeight, 2rem)",fontSize:e.vars.fontSize.sm,paddingBlock:"var(--Button-paddingBlock, 0.25rem)",paddingInline:"0.75rem"},t.size==="md"&&{"--Icon-fontSize":e.vars.fontSize.xl,"--CircularProgress-size":"20px","--CircularProgress-thickness":"2px","--Button-gap":"0.5rem",minHeight:"var(--Button-minHeight, 2.25rem)",fontSize:e.vars.fontSize.sm,paddingBlock:"var(--Button-paddingBlock, 0.375rem)",paddingInline:"1rem"},t.size==="lg"&&{"--Icon-fontSize":e.vars.fontSize.xl2,"--CircularProgress-size":"28px","--CircularProgress-thickness":"4px","--Button-gap":"0.75rem",minHeight:"var(--Button-minHeight, 2.75rem)",fontSize:e.vars.fontSize.md,paddingBlock:"var(--Button-paddingBlock, 0.5rem)",paddingInline:"1.5rem"},{WebkitTapHighlightColor:"transparent",boxSizing:"border-box",borderRadius:`var(--Button-radius, ${e.vars.radius.sm})`,margin:"var(--Button-margin)",border:"none",backgroundColor:"transparent",cursor:"pointer",userSelect:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",textDecoration:"none",fontFamily:e.vars.fontFamily.body,fontWeight:e.vars.fontWeight.lg,lineHeight:e.vars.lineHeight.md},t.fullWidth&&{width:"100%"},{[e.focus.selector]:e.focus.default}),we({},(i=e.variants[t.variant])==null?void 0:i[t.color],{"&:hover":{"@media (hover: hover)":(a=e.variants[`${t.variant}Hover`])==null?void 0:a[t.color]},'&:active, &[aria-pressed="true"]':(c=e.variants[`${t.variant}Active`])==null?void 0:c[t.color],[`&.${Bg.disabled}`]:(h=e.variants[`${t.variant}Disabled`])==null?void 0:h[t.color]},t.loadingPosition==="center"&&{[`&.${Bg.loading}`]:{color:"transparent"}})]},LF=rr("button",{name:"JoyButton",slot:"Root",overridesResolver:(e,t)=>t.root})(OF),Ia=K.forwardRef(function(t,i){var a;const c=Ci({props:t,name:"JoyButton"}),{children:h,action:f,color:o="primary",variant:b="solid",size:P="md",fullWidth:I=!1,startDecorator:D,endDecorator:z,loading:F=!1,loadingPosition:U="center",loadingIndicator:$,disabled:j,component:ie,slots:se={},slotProps:Q={}}=c,de=Pr(c,kF),oe=K.useContext(O2),be=K.useContext(zI),xe=t.variant||oe.variant||b,Me=t.size||oe.size||P,Ee=t.color||oe.color||o,re=(a=t.loading||t.disabled)!=null?a:oe.disabled||F||j,ke=K.useRef(null),Ge=Ea(ke,i),{focusVisible:Ke,setFocusVisible:gt,getRootProps:et}=Uv(we({},c,{disabled:re,rootRef:Ge})),qe=$??G.jsx(nm,{color:Ee,thickness:{sm:2,md:3,lg:4}[Me]||3});K.useImperativeHandle(f,()=>({focusVisible:()=>{var It;gt(!0),(It=ke.current)==null||It.focus()}}),[gt]);const Qe=we({},c,{color:Ee,fullWidth:I,variant:xe,size:Me,focusVisible:Ke,loading:F,loadingPosition:U,disabled:re}),Ve=AF(Qe),je=It=>{var mr;let ur=c.onClick;if(typeof Q.root=="function"?ur=Q.root(Qe).onClick:Q.root&&(ur=Q.root.onClick),(mr=ur)==null||mr(It),be){var Hr;(Hr=be.onClick)==null||Hr.call(be,It,c.value)}};let ct=c["aria-pressed"];typeof Q.root=="function"?ct=Q.root(Qe)["aria-pressed"]:Q.root&&(ct=Q.root["aria-pressed"]),be!=null&&be.value&&(Array.isArray(be.value)?ct=be.value.indexOf(c.value)!==-1:ct=be.value===c.value);const ye=we({},de,{component:ie,slots:se,slotProps:Q}),[ze,ft]=_r("root",{ref:i,className:Ve.root,elementType:LF,externalForwardedProps:ye,getSlotProps:et,ownerState:Qe,additionalProps:{onClick:je,"aria-pressed":ct}}),[wt,xt]=_r("startDecorator",{className:Ve.startDecorator,elementType:RF,externalForwardedProps:ye,ownerState:Qe}),[_t,St]=_r("endDecorator",{className:Ve.endDecorator,elementType:DF,externalForwardedProps:ye,ownerState:Qe}),[tt,At]=_r("loadingIndicatorCenter",{className:Ve.loadingIndicatorCenter,elementType:zF,externalForwardedProps:ye,ownerState:Qe});return G.jsxs(ze,we({},ft,{children:[(D||F&&U==="start")&&G.jsx(wt,we({},xt,{children:F&&U==="start"?qe:D})),h,F&&U==="center"&&G.jsx(tt,we({},At,{children:qe})),(z||F&&U==="end")&&G.jsx(_t,we({},St,{children:F&&U==="end"?qe:z}))]}))});Ia.muiName="Button";function FF(e){return wi("MuiButtonGroup",e)}Si("MuiButtonGroup",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg","horizontal","vertical"]);const BF=["buttonFlex","className","component","disabled","size","color","variant","children","orientation","slots","slotProps","spacing"],$F=e=>{const{size:t,variant:i,color:a,orientation:c}=e,h={root:["root",c,i&&`variant${xr(i)}`,a&&`color${xr(a)}`,t&&`size${xr(t)}`]};return di(h,FF,{})},jF=rr("div")(({theme:e,ownerState:t})=>{var i,a,c;const{borderRadius:h}=tm({theme:e,ownerState:t},["borderRadius"]),f=t.orientation==="vertical"?"var(--ButtonGroup-radius) var(--ButtonGroup-radius) var(--unstable_childRadius) var(--unstable_childRadius)":"var(--ButtonGroup-radius) var(--unstable_childRadius) var(--unstable_childRadius) var(--ButtonGroup-radius)",o=t.orientation==="vertical"?"var(--unstable_childRadius) var(--unstable_childRadius) var(--ButtonGroup-radius) var(--ButtonGroup-radius)":"var(--unstable_childRadius) var(--ButtonGroup-radius) var(--ButtonGroup-radius) var(--unstable_childRadius)",b=t.orientation==="vertical"?"calc(var(--ButtonGroup-separatorSize) * -1) 0 0 0":"0 0 0 calc(var(--ButtonGroup-separatorSize) * -1)",P={};mO(e.breakpoints,t.spacing,(F,U)=>{if(U!==null){var $;F(P,{"--ButtonGroup-connected":U.toString().match(/^0(?!\.)/)?"1":"0",gap:typeof U=="string"?U:($=e.spacing)==null?void 0:$.call(e,U)})}});const I=(i=e.variants.outlined)==null?void 0:i[t.color],D=(a=e.variants.outlinedDisabled)==null?void 0:a[t.color],z=(c=e.variants.outlinedHover)==null?void 0:c[t.color];return[we({"--ButtonGroup-separatorSize":t.variant==="outlined"?"1px":"calc(var(--ButtonGroup-connected) * 1px)","--ButtonGroup-separatorColor":I?.borderColor,"--ButtonGroup-radius":e.vars.radius.sm,"--Divider-inset":"0.5rem","--unstable_childRadius":"calc((1 - var(--ButtonGroup-connected)) * var(--ButtonGroup-radius) - var(--variant-borderWidth, 0px))"},P,{display:"flex",borderRadius:"var(--ButtonGroup-radius)",flexDirection:t.orientation==="vertical"?"column":"row","& > [data-first-child]":we({"--Button-radius":f,"--IconButton-radius":f},t.orientation==="horizontal"&&{borderRight:"var(--ButtonGroup-separatorSize) solid var(--ButtonGroup-separatorColor)"},t.orientation==="vertical"&&{borderBottom:"var(--ButtonGroup-separatorSize) solid var(--ButtonGroup-separatorColor)"}),"& > :not([data-first-child]):not([data-last-child]):not(:only-child)":we({"--Button-radius":"var(--unstable_childRadius)","--IconButton-radius":"var(--unstable_childRadius)",borderRadius:"var(--unstable_childRadius)"},t.orientation==="horizontal"&&{borderLeft:"var(--ButtonGroup-separatorSize) solid var(--ButtonGroup-separatorColor)",borderRight:"var(--ButtonGroup-separatorSize) solid var(--ButtonGroup-separatorColor)"},t.orientation==="vertical"&&{borderTop:"var(--ButtonGroup-separatorSize) solid var(--ButtonGroup-separatorColor)",borderBottom:"var(--ButtonGroup-separatorSize) solid var(--ButtonGroup-separatorColor)"}),"& > [data-last-child]":we({"--Button-radius":o,"--IconButton-radius":o},t.orientation==="horizontal"&&{borderLeft:"var(--ButtonGroup-separatorSize) solid var(--ButtonGroup-separatorColor)"},t.orientation==="vertical"&&{borderTop:"var(--ButtonGroup-separatorSize) solid var(--ButtonGroup-separatorColor)"}),"& > :only-child":{"--Button-radius":"var(--ButtonGroup-radius)","--IconButton-radius":"var(--ButtonGroup-radius)"},"& > :not([data-first-child]):not(:only-child)":{"--Button-margin":b,"--IconButton-margin":b},[`& .${Bg.root}, & .${Tw.root}`]:we({"&:not(:disabled)":{zIndex:1},"&:disabled":{"--ButtonGroup-separatorColor":D?.borderColor}},t.variant==="outlined"&&{"&:hover":{"--ButtonGroup-separatorColor":z?.borderColor}},{[`&:hover, ${e.focus.selector}`]:{zIndex:2}})},t.buttonFlex&&{[`& > *:not(.${Tw.root})`]:{flex:t.buttonFlex},[`& > :not(button) > .${Bg.root}`]:{width:"100%"}}),h!==void 0&&{"--ButtonGroup-radius":h}]}),NF=rr(jF,{name:"JoyButtonGroup",slot:"Root",overridesResolver:(e,t)=>t.root})({}),VF=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoyButtonGroup"}),{buttonFlex:c,className:h,component:f="div",disabled:o=!1,size:b="md",color:P="neutral",variant:I="outlined",children:D,orientation:z="horizontal",slots:F={},slotProps:U={},spacing:$=0}=a,j=Pr(a,BF),ie=we({},a,{buttonFlex:c,color:P,component:f,orientation:z,spacing:$,size:b,variant:I}),se=$F(ie),Q=we({},j,{component:f,slots:F,slotProps:U}),[de,oe]=_r("root",{ref:i,className:hi(se.root,h),elementType:NF,externalForwardedProps:Q,additionalProps:{role:"group"},ownerState:ie}),be=K.useMemo(()=>({variant:I,color:P,size:b,disabled:o}),[I,P,b,o]);return G.jsx(de,we({},oe,{children:G.jsx(O2.Provider,{value:be,children:K.Children.map(D,(xe,Me)=>{if(!K.isValidElement(xe))return xe;const Ee={};if(Vv(xe,["Divider"])){var re,ke;const Ge=xe.props;Ee.inset=(re=Ge?.inset)!=null?re:"context";const Ke=z==="vertical"?"horizontal":"vertical";Ee.orientation=(ke=Ge?.orientation)!=null?ke:Ke,Ee.role="presentation",Ee.component="span"}return K.Children.count(D)>1&&(Me===0&&(Ee["data-first-child"]=""),Me===K.Children.count(D)-1&&(Ee["data-last-child"]="")),K.cloneElement(xe,Ee)})})}))});function UF(e){return wi("MuiCard",e)}const GF=Si("MuiCard",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg","horizontal","vertical"]),qF=["className","color","component","invertedColors","size","variant","children","orientation","slots","slotProps"],HF=e=>{const{size:t,variant:i,color:a,orientation:c}=e,h={root:["root",c,i&&`variant${xr(i)}`,a&&`color${xr(a)}`,t&&`size${xr(t)}`]};return di(h,UF,{})},WF=rr("div")(({theme:e,ownerState:t})=>{var i;const{p:a,padding:c,borderRadius:h}=tm({theme:e,ownerState:t},["p","padding","borderRadius"]);return[we({"--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,"--Card-childRadius":"max((var(--Card-radius) - var(--variant-borderWidth, 0px)) - var(--Card-padding), min(var(--Card-padding) / 2, (var(--Card-radius) - var(--variant-borderWidth, 0px)) / 2))","--AspectRatio-radius":"var(--Card-childRadius)","--unstable_actionMargin":"calc(-1 * var(--variant-borderWidth, 0px))","--unstable_actionRadius":"var(--Card-radius)","--CardCover-radius":"calc(var(--Card-radius) - var(--variant-borderWidth, 0px))","--CardOverflow-offset":"calc(-1 * var(--Card-padding))","--CardOverflow-radius":"calc(var(--Card-radius) - var(--variant-borderWidth, 0px))","--Divider-inset":"calc(-1 * var(--Card-padding))"},t.size==="sm"&&{"--Card-radius":e.vars.radius.sm,"--Card-padding":"0.625rem",gap:"0.5rem"},t.size==="md"&&{"--Card-radius":e.vars.radius.md,"--Card-padding":"1rem",gap:"0.75rem 1rem"},t.size==="lg"&&{"--Card-radius":e.vars.radius.lg,"--Card-padding":"1.5rem",gap:"1rem 1.5rem"},{padding:"var(--Card-padding)",borderRadius:"var(--Card-radius)",backgroundColor:e.vars.palette.background.surface,position:"relative",display:"flex",flexDirection:t.orientation==="horizontal"?"row":"column"},e.typography[`body-${t.size}`],t.variant==="solid"&&t.color&&t.invertedColors&&Vx(t.color)(e),t.variant==="soft"&&t.color&&t.invertedColors&&Ux(t.color)(e),(i=e.variants[t.variant])==null?void 0:i[t.color]),a!==void 0&&{"--Card-padding":a},c!==void 0&&{"--Card-padding":c},h!==void 0&&{"--Card-radius":h}]}),ZF=rr(WF,{name:"JoyCard",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Hv=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoyCard"}),{className:c,color:h="neutral",component:f="div",invertedColors:o=!1,size:b="md",variant:P="outlined",children:I,orientation:D="vertical",slots:z={},slotProps:F={}}=a,U=Pr(a,qF),$=we({},a,{color:h,component:f,orientation:D,size:b,variant:P,invertedColors:o}),j=HF($),ie=we({},U,{component:f,slots:z,slotProps:F}),[se,Q]=_r("root",{ref:i,className:hi(j.root,c),elementType:ZF,externalForwardedProps:ie,ownerState:$});return G.jsx(se,we({},Q,{children:K.Children.map(I,(de,oe)=>{if(!K.isValidElement(de))return de;const be={};if(Vv(de,["Divider"])){var xe,Me;const Ee=de.props;be.inset=(xe=Ee?.inset)!=null?xe:"context";const re=D==="vertical"?"horizontal":"vertical";be.orientation=(Me=Ee?.orientation)!=null?Me:re}return oe===0&&(be["data-first-child"]=""),oe===K.Children.count(I)-1&&(be["data-last-child"]=""),K.cloneElement(de,be)})}))});function XF(e){return wi("MuiCardActions",e)}Si("MuiCardActions",["root"]);const qI=Si("MuiCardOverflow",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);function KF(e){return wi("MuiDivider",e)}const YF=Si("MuiDivider",["root","horizontal","vertical","insetContext","insetNone"]),JF=["className","component","children","buttonFlex","orientation","slots","slotProps"],QF=()=>di({root:["root"]},XF,{}),eB=rr("div")(({ownerState:e})=>{var t;return we({"--Button-radius":"var(--Card-childRadius)","--IconButton-radius":"var(--Card-childRadius)",display:"flex"},((t=e.orientation)==null?void 0:t.startsWith("horizontal"))&&{alignItems:"center"},{flexDirection:e.orientation==="horizontal"?"row":"column"},e.orientation==="horizontal-reverse"&&{flexDirection:"row-reverse"},{zIndex:1,gap:"calc(0.625 * var(--Card-padding))",padding:"var(--unstable_padding)","--unstable_padding":"calc(0.75 * var(--Card-padding)) 0 0 0",[`.${qI.root} > &`]:{"--unstable_padding":"calc(0.75 * var(--Card-padding)) 0 var(--Card-padding)"},[`.${GF.root} > .${YF.root} + &`]:{"--unstable_padding":"0"}},e.buttonFlex?{[`& > :not(.${Tw.root})`]:{flex:e.buttonFlex},[`& > :not(button) > .${Bg.root}`]:{width:"100%"}}:{[`& > .${Bg.root}:only-child`]:{flex:"auto"}})}),tB=rr(eB,{name:"JoyCardActions",slot:"Root",overridesResolver:(e,t)=>t.root})({}),rB=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoyCardActions"}),{className:c,component:h="div",children:f,buttonFlex:o,orientation:b="horizontal",slots:P={},slotProps:I={}}=a,D=Pr(a,JF),z=we({},D,{component:h,slots:P,slotProps:I}),F=we({},a,{component:h,buttonFlex:o,orientation:b}),U=QF(),[$,j]=_r("root",{ref:i,className:hi(U.root,c),elementType:tB,externalForwardedProps:z,ownerState:F});return G.jsx($,we({},j,{children:f}))});function nB(e){return wi("MuiCardContent",e)}Si("MuiCardContent",["root"]);const iB=["className","component","children","orientation","slots","slotProps"],oB=()=>di({root:["root"]},nB,{}),sB=rr("div")(({ownerState:e})=>({display:"flex",flexDirection:e.orientation==="horizontal"?"row":"column",flex:9999,zIndex:1,columnGap:"var(--Card-padding)",rowGap:"max(2px, calc(0.1875 * var(--Card-padding)))",padding:"var(--unstable_padding)",[`.${qI.root} > &`]:{"--unstable_padding":"calc(var(--Card-padding) * 0.75) 0px"}})),aB=rr(sB,{name:"JoyCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})({}),lB=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoyCardContent"}),{className:c,component:h="div",children:f,orientation:o="vertical",slots:b={},slotProps:P={}}=a,I=Pr(a,iB),D=we({},I,{component:h,slots:b,slotProps:P}),z=we({},a,{component:h,orientation:o}),F=oB(),[U,$]=_r("root",{ref:i,className:hi(F.root,c),elementType:aB,externalForwardedProps:D,ownerState:z});return G.jsx(U,we({},$,{children:f}))});function cB(e){const{children:t,disableColorScheme:i=!1}=e;return G.jsxs(K.Fragment,{children:[G.jsx(DO,{styles:a=>{var c,h;const f={};i||Object.entries(a.colorSchemes).forEach(([b,P])=>{var I;f[a.getColorSchemeSelector(b).replace(/\s*&/,"")]={colorScheme:(I=P.palette)==null?void 0:I.mode}});const o=(c=(h=a.components)==null||(h=h.JoyTypography)==null||(h=h.defaultProps)==null?void 0:h.level)!=null?c:"body-md";return we({html:{WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:a.vars.fontWeight.lg},body:we({margin:0,color:a.vars.palette.text.primary,fontFamily:a.vars.fontFamily.body},a.typography[o],{backgroundColor:a.vars.palette.background.body,"@media print":{backgroundColor:a.vars.palette.common.white},"&::backdrop":{backgroundColor:a.vars.palette.background.backdrop}})},f)},defaultTheme:Zg}),t]})}const uB=["className","children","component","inset","orientation","role","slots","slotProps"],hB=e=>{const{orientation:t,inset:i}=e,a={root:["root",t,i&&`inset${xr(i)}`]};return di(a,KF,{})},HI=rr("hr",{name:"JoyDivider",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>we({"--Divider-thickness":"1px","--Divider-lineColor":e.vars.palette.divider},t.inset==="none"&&{"--_Divider-inset":"0px"},t.inset==="context"&&{"--_Divider-inset":"var(--Divider-inset, 0px)"},{margin:"initial",marginInline:t.orientation==="vertical"?"initial":"var(--_Divider-inset)",marginBlock:t.orientation==="vertical"?"var(--_Divider-inset)":"initial",position:"relative",alignSelf:"stretch",flexShrink:0},t.children?we({"--Divider-gap":e.spacing(1),"--Divider-childPosition":"50%",display:"flex",flexDirection:t.orientation==="vertical"?"column":"row",alignItems:"center",whiteSpace:"nowrap",textAlign:"center",border:0},e.typography["body-sm"],{"&::before, &::after":{position:"relative",inlineSize:t.orientation==="vertical"?"var(--Divider-thickness)":"initial",blockSize:t.orientation==="vertical"?"initial":"var(--Divider-thickness)",backgroundColor:"var(--Divider-lineColor)",content:'""'},"&::before":{marginInlineEnd:t.orientation==="vertical"?"initial":"min(var(--Divider-childPosition) * 999, var(--Divider-gap))",marginBlockEnd:t.orientation==="vertical"?"min(var(--Divider-childPosition) * 999, var(--Divider-gap))":"initial",flexBasis:"var(--Divider-childPosition)"},"&::after":{marginInlineStart:t.orientation==="vertical"?"initial":"min((100% - var(--Divider-childPosition)) * 999, var(--Divider-gap))",marginBlockStart:t.orientation==="vertical"?"min((100% - var(--Divider-childPosition)) * 999, var(--Divider-gap))":"initial",flexBasis:"calc(100% - var(--Divider-childPosition))"}}):{border:"none",listStyle:"none",backgroundColor:"var(--Divider-lineColor)",inlineSize:t.orientation==="vertical"?"var(--Divider-thickness)":"initial",blockSize:t.orientation==="vertical"?"initial":"var(--Divider-thickness)"})),Xg=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoyDivider"}),{className:c,children:h,component:f=h!=null?"div":"hr",inset:o,orientation:b="horizontal",role:P=f!=="hr"?"separator":void 0,slots:I={},slotProps:D={}}=a,z=Pr(a,uB),F=we({},a,{inset:o,role:P,orientation:b,component:f}),U=hB(F),$=we({},z,{component:f,slots:I,slotProps:D}),[j,ie]=_r("root",{ref:i,className:hi(U.root,c),elementType:HI,externalForwardedProps:$,ownerState:F,additionalProps:we({as:f,role:P},P==="separator"&&b==="vertical"&&{"aria-orientation":"vertical"})});return G.jsx(j,we({},ie,{children:h}))});Xg.muiName="Divider";function dB(e){return wi("MuiLink",e)}const JT=Si("MuiLink",["root","disabled","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","focusVisible","variantPlain","variantOutlined","variantSoft","variantSolid","underlineNone","underlineHover","underlineAlways","h1","h2","h3","h4","title-lg","title-md","title-sm","body-lg","body-md","body-sm","body-xs","startDecorator","endDecorator"]),fB=["color","textColor","variant"],pB=["children","disabled","onBlur","onFocus","level","overlay","underline","endDecorator","startDecorator","component","slots","slotProps"],mB=e=>{const{level:t,color:i,variant:a,underline:c,focusVisible:h,disabled:f}=e,o={root:["root",i&&`color${xr(i)}`,f&&"disabled",h&&"focusVisible",t,c&&`underline${xr(c)}`,a&&`variant${xr(a)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return di(o,dB,{})},gB=rr("span",{name:"JoyLink",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})(({ownerState:e})=>{var t;return we({display:"inline-flex",marginInlineEnd:"clamp(4px, var(--Link-gap, 0.375em), 0.75rem)"},typeof e.startDecorator!="string"&&(e.alignItems==="flex-start"||((t=e.sx)==null?void 0:t.alignItems)==="flex-start")&&{marginTop:"2px"})}),yB=rr("span",{name:"JoyLink",slot:"endDecorator",overridesResolver:(e,t)=>t.endDecorator})(({ownerState:e})=>{var t;return we({display:"inline-flex",marginInlineStart:"clamp(4px, var(--Link-gap, 0.25em), 0.5rem)"},typeof e.startDecorator!="string"&&(e.alignItems==="flex-start"||((t=e.sx)==null?void 0:t.alignItems)==="flex-start")&&{marginTop:"2px"})}),vB=rr("a",{name:"JoyLink",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var i,a,c,h,f,o,b;return[we({"--Icon-fontSize":"1.25em","--Icon-color":"currentColor","--CircularProgress-size":"1.25em","--CircularProgress-thickness":"3px"},t.level&&t.level!=="inherit"&&e.typography[t.level],t.level==="inherit"&&{font:"inherit"},t.underline==="none"&&{textDecoration:"none"},t.underline==="hover"&&{textDecoration:"none","&:hover":{"@media (hover: hover)":{textDecorationLine:"underline"}}},t.underline==="always"&&{textDecoration:"underline"},t.startDecorator&&{verticalAlign:"bottom"},{textDecorationThickness:"max(0.08em, 1px)",textUnderlineOffset:"0.15em",display:"inline-flex",alignItems:"center",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:e.vars.radius.xs,padding:0,cursor:"pointer",textDecorationColor:`var(--variant-outlinedBorder, rgba(${(i=e.vars.palette[t.color])==null?void 0:i.mainChannel} / var(--Link-underlineOpacity, 0.72)))`},t.variant?we({paddingBlock:"min(0.1em, 4px)",paddingInline:"0.25em"},!t.nesting&&{marginInline:"-0.25em"}):{color:`var(--variant-plainColor, rgba(${(a=e.vars.palette[t.color])==null?void 0:a.mainChannel} / 1))`,[`&.${JT.disabled}`]:{pointerEvents:"none",color:`var(--variant-plainDisabledColor, rgba(${(c=e.vars.palette[t.color])==null?void 0:c.mainChannel} / 0.6))`}},{userSelect:t.component==="button"?"none":void 0,MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"}},t.overlay?{position:"initial","&::after":{content:'""',display:"block",position:"absolute",top:0,left:0,bottom:0,right:0,borderRadius:"var(--unstable_actionRadius, inherit)",margin:"var(--unstable_actionMargin)"},[`${e.focus.selector}`]:{"&::after":e.focus.default}}:{position:"relative",[e.focus.selector]:e.focus.default}),t.variant&&we({},(h=e.variants[t.variant])==null?void 0:h[t.color],{"&:hover":{"@media (hover: hover)":(f=e.variants[`${t.variant}Hover`])==null?void 0:f[t.color]},"&:active":(o=e.variants[`${t.variant}Active`])==null?void 0:o[t.color],[`&.${JT.disabled}`]:(b=e.variants[`${t.variant}Disabled`])==null?void 0:b[t.color]})]}),_B=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoyLink"}),{color:c="primary",textColor:h,variant:f}=a,o=Pr(a,fB),b=K.useContext(Y_),P=K.useContext(GI),I=Bx(we({},o,{color:h})),{children:D,disabled:z=!1,onBlur:F,onFocus:U,level:$="body-md",overlay:j=!1,underline:ie="hover",endDecorator:se,startDecorator:Q,component:de,slots:oe={},slotProps:be={}}=I,xe=Pr(I,pB),Me=b||P?t.level||"inherit":$,{isFocusVisibleRef:Ee,onBlur:re,onFocus:ke,ref:Ge}=nI(),[Ke,gt]=K.useState(!1),et=Ea(i,Ge),qe=St=>{re(St),Ee.current===!1&&gt(!1),F&&F(St)},Qe=St=>{ke(St),Ee.current===!0&&gt(!0),U&&U(St)},Ve=we({},I,{color:c,disabled:z,focusVisible:Ke,underline:ie,variant:f,level:Me,overlay:j,nesting:b}),je=mB(Ve),ct=we({},xe,{component:de,slots:oe,slotProps:be}),[ye,ze]=_r("root",{additionalProps:{onBlur:qe,onFocus:Qe},ref:et,className:je.root,elementType:vB,externalForwardedProps:ct,ownerState:Ve}),[ft,wt]=_r("startDecorator",{className:je.startDecorator,elementType:gB,externalForwardedProps:ct,ownerState:Ve}),[xt,_t]=_r("endDecorator",{className:je.endDecorator,elementType:yB,externalForwardedProps:ct,ownerState:Ve});return G.jsx(Y_.Provider,{value:!0,children:G.jsxs(ye,we({},ze,{children:[Q&&G.jsx(ft,we({},wt,{children:Q})),Vv(D,["Skeleton"])?K.cloneElement(D,{variant:D.props.variant||"inline"}):D,se&&G.jsx(xt,we({},_t,{children:se}))]}))})});function xB(e){return wi("MuiListDivider",e)}Si("MuiListDivider",["root","insetGutter","insetStartDecorator","insetStartContent","horizontal","vertical"]);const bB=["component","role","className","children","inset","orientation","slots","slotProps"],wB=e=>{const{orientation:t,inset:i}=e,a={root:["root",t,i&&i!=="context"&&`inset${xr(i)}`]};return di(a,xB,{})},SB=rr(HI,{name:"JoyListDivider",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e})=>we({},e.inset==="context"&&{"--Divider-inset":"calc(-1 * var(--List-padding))"},e.row&&we({marginInline:"var(--ListDivider-gap)"},e.inset==="gutter"&&{marginBlock:"var(--ListItem-paddingY)"},e["data-first-child"]===void 0&&{marginInlineStart:"calc(var(--List-gap) + var(--ListDivider-gap))"}),!e.row&&we({},e["data-first-child"]===void 0&&{marginBlockStart:"calc(var(--List-gap) + var(--ListDivider-gap))"},{marginBlockEnd:"var(--ListDivider-gap)"},e.inset==="gutter"&&{marginInlineStart:"var(--ListItem-paddingLeft)",marginInlineEnd:"var(--ListItem-paddingRight)"},e.inset==="startDecorator"&&{marginInlineStart:"var(--ListItem-paddingLeft)"},e.inset==="startContent"&&{marginInlineStart:"calc(var(--ListItem-paddingLeft) + var(--ListItemDecorator-size))"}))),yf=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoyListDivider"}),c=K.useContext(Nx),h=K.useContext(R2),{component:f,role:o,className:b,children:P,inset:I="context",orientation:D,slots:z={},slotProps:F={}}=a,U=Pr(a,bB),[$]=h?.split(":")||["",""],j=f||($&&!$.match(/^(ul|ol|menu)$/)?"div":"li"),ie=o||(j==="li"?"separator":void 0),se=D||(c?"vertical":"horizontal"),Q=we({},a,{inset:I,row:c,orientation:se,component:j,role:ie}),de=wB(Q),oe=we({},U,{component:j,slots:z,slotProps:F}),[be,xe]=_r("root",{ref:i,className:hi(de.root,b),elementType:SB,externalForwardedProps:oe,ownerState:Q,additionalProps:we({as:j,role:ie},ie==="separator"&&se==="vertical"&&{"aria-orientation":"vertical"})});return G.jsx(be,we({},xe,{children:P}))});function CB(e){return wi("MuiListItemContent",e)}Si("MuiListItemContent",["root"]);const TB=["component","className","children","slots","slotProps"],MB=()=>di({root:["root"]},CB,{}),PB=rr("div",{name:"JoyListItemContent",slot:"Root",overridesResolver:(e,t)=>t.root})({flex:"1 1 auto",minWidth:0}),J_=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoyListItemContent"}),{component:c,className:h,children:f,slots:o={},slotProps:b={}}=a,P=Pr(a,TB),I=we({},a),D=MB(),z=we({},P,{component:c,slots:o,slotProps:b}),[F,U]=_r("root",{ref:i,className:hi(D.root,h),elementType:PB,externalForwardedProps:z,ownerState:I});return G.jsx(F,we({},U,{children:f}))});function EB(e){return wi("MuiListItemDecorator",e)}Si("MuiListItemDecorator",["root"]);const IB=["component","className","children","slots","slotProps"],kB=()=>di({root:["root"]},EB,{}),AB=rr("span",{name:"JoyListItemDecorator",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e})=>we({boxSizing:"border-box",display:"inline-flex",alignItems:`var(--unstable_ListItemDecorator-alignItems, ${e.parentOrientation==="horizontal"?"center":"initial"})`},e.parentOrientation==="horizontal"?{minInlineSize:"var(--ListItemDecorator-size)",marginInlineEnd:"calc(-1 * var(--ListItem-gap))"}:{minBlockSize:"var(--ListItemDecorator-size)",justifyContent:"center",marginBlockEnd:"calc(-1 * var(--ListItem-gap))"})),Kc=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoyListItemDecorator"}),{component:c,className:h,children:f,slots:o={},slotProps:b={}}=a,P=Pr(a,IB),I=K.useContext(PI),D=we({parentOrientation:I},a),z=kB(),F=we({},P,{component:c,slots:o,slotProps:b}),[U,$]=_r("root",{ref:i,className:hi(z.root,h),elementType:AB,externalForwardedProps:F,ownerState:D});return G.jsx(U,we({},$,{children:f}))});function RB(e){return wi("MuiSheet",e)}Si("MuiSheet",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);const DB=["className","color","component","variant","invertedColors","slots","slotProps"],zB=e=>{const{variant:t,color:i}=e,a={root:["root",t&&`variant${xr(t)}`,i&&`color${xr(i)}`]};return di(a,RB,{})},OB=rr("div",{name:"JoySheet",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var i,a;const c=(i=e.variants[t.variant])==null?void 0:i[t.color],{borderRadius:h,bgcolor:f,backgroundColor:o,background:b}=tm({theme:e,ownerState:t},["borderRadius","bgcolor","backgroundColor","background"]),P=Rg(e,`palette.${f}`)||f||Rg(e,`palette.${o}`)||o||b||c?.backgroundColor||c?.background||e.vars.palette.background.surface;return[we({"--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,"--ListItem-stickyBackground":P==="transparent"?"initial":P,"--Sheet-background":P==="transparent"?"initial":P},h!==void 0&&{"--List-radius":`calc(${h} - var(--variant-borderWidth, 0px))`,"--unstable_actionRadius":`calc(${h} - var(--variant-borderWidth, 0px))`},{backgroundColor:e.vars.palette.background.surface,position:"relative"}),we({},e.typography["body-md"],t.variant==="solid"&&t.color&&t.invertedColors&&Vx(t.color)(e),t.variant==="soft"&&t.color&&t.invertedColors&&Ux(t.color)(e),(a=e.variants[t.variant])==null?void 0:a[t.color],c)]}),WI=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoySheet"}),{className:c,color:h="neutral",component:f="div",variant:o="plain",invertedColors:b=!1,slots:P={},slotProps:I={}}=a,D=Pr(a,DB),z=we({},a,{color:h,component:f,invertedColors:b,variant:o}),F=zB(z),U=we({},D,{component:f,slots:P,slotProps:I}),[$,j]=_r("root",{ref:i,className:hi(F.root,c),elementType:OB,externalForwardedProps:U,ownerState:z});return G.jsx($,we({},j))});function LB(e){return wi("MuiSnackbar",e)}Si("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","colorPrimary","colorDanger","colorNeutral","colorSuccess","colorWarning","endDecorator","sizeSm","sizeMd","sizeLg","startDecorator","variantPlain","variantOutlined","variantSoft","variantSolid"]);const FB=["anchorOrigin","animationDuration","autoHideDuration","color","children","className","component","disableWindowBlurListener","endDecorator","invertedColors","onBlur","onClose","onFocus","onMouseEnter","onMouseLeave","onUnmount","open","resumeHideDuration","size","slots","slotProps","startDecorator","variant"];let ZI=e=>e,QT,eM;const BB=e=>{const{variant:t,color:i,size:a,anchorOrigin:c}=e,h={root:["root",a&&`size${xr(a)}`,i&&`color${xr(i)}`,t&&`variant${xr(t)}`,`anchorOrigin${xr(c.vertical)}${xr(c.horizontal)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return di(h,LB,{})},$B=h2(QT||(QT=ZI`
  0% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(calc(var(--_Snackbar-anchorBottom, 1) * 100%));
    opacity: 0;
  }
  50% {
    opacity: 1;
  }
  100% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(0);
  }
`)),jB=h2(eM||(eM=ZI`
  0% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(0);
    opacity: 1;
  }
  100% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(calc(var(--_Snackbar-anchorBottom, 1) * 100%));
    opacity: 0;
  }
`)),NB=rr("div",{name:"JoySnackbar",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var i,a,c,h,f,o,b;const{p:P,padding:I,borderRadius:D}=tm({theme:e,ownerState:t},["p","padding","borderRadius"]);return[we({"--Snackbar-radius":e.vars.radius.sm,"--Snackbar-decoratorChildRadius":"max((var(--Snackbar-radius) - var(--variant-borderWidth, 0px)) - var(--Snackbar-padding), min(var(--Snackbar-padding) + var(--variant-borderWidth, 0px), var(--Snackbar-radius) / 2))","--Button-minHeight":"var(--Snackbar-decoratorChildHeight)","--IconButton-size":"var(--Snackbar-decoratorChildHeight)","--Button-radius":"var(--Snackbar-decoratorChildRadius)","--IconButton-radius":"var(--Snackbar-decoratorChildRadius)","--Icon-color":"currentColor"},t.size==="sm"&&{"--Snackbar-padding":"0.75rem","--Snackbar-inset":"0.5rem","--Snackbar-decoratorChildHeight":"1.5rem","--Icon-fontSize":e.vars.fontSize.xl,gap:"0.5rem"},t.size==="md"&&{"--Snackbar-padding":"1rem","--Snackbar-inset":"0.75rem","--Snackbar-decoratorChildHeight":"2rem","--Icon-fontSize":e.vars.fontSize.xl,gap:"0.625rem"},t.size==="lg"&&{"--Snackbar-padding":"1.25rem","--Snackbar-inset":"1rem","--Snackbar-decoratorChildHeight":"2.375rem","--Icon-fontSize":e.vars.fontSize.xl2,gap:"0.875rem"},{zIndex:e.vars.zIndex.snackbar,position:"fixed",display:"flex",alignItems:"center",minWidth:300,top:((i=t.anchorOrigin)==null?void 0:i.vertical)==="top"?"var(--Snackbar-inset)":void 0,left:((a=t.anchorOrigin)==null?void 0:a.horizontal)==="left"?"var(--Snackbar-inset)":void 0,bottom:((c=t.anchorOrigin)==null?void 0:c.vertical)==="bottom"?"var(--Snackbar-inset)":void 0,right:((h=t.anchorOrigin)==null?void 0:h.horizontal)==="right"?"var(--Snackbar-inset)":void 0},((f=t.anchorOrigin)==null?void 0:f.horizontal)==="center"&&{"--Snackbar-translateX":"-50%",left:"50%",transform:"translateX(var(--Snackbar-translateX))"},((o=t.anchorOrigin)==null?void 0:o.vertical)==="top"&&{"--_Snackbar-anchorBottom":"-1"},{animation:`${$B} ${t.animationDuration}ms forwards`},!t.open&&{animationName:jB},{boxShadow:e.vars.shadow.lg,backgroundColor:e.vars.palette.background.surface,padding:"var(--Snackbar-padding)",borderRadius:"var(--Snackbar-radius)"},e.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[t.size]}`],t.variant==="solid"&&t.color&&t.invertedColors&&Vx(t.color)(e),t.variant==="soft"&&t.color&&t.invertedColors&&Ux(t.color)(e),(b=e.variants[t.variant])==null?void 0:b[t.color]),P!==void 0&&{"--Snackbar-padding":P},I!==void 0&&{"--Snackbar-padding":I},D!==void 0&&{"--Snackbar-radius":D}]}),VB=rr("span",{name:"JoySnackbar",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({display:"inherit",flex:"none"}),UB=rr("span",{name:"JoySnackbar",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})({display:"inherit",flex:"none",marginLeft:"auto"}),GB={vertical:"bottom",horizontal:"right"},qB=K.forwardRef(function(t,i){const a=Ci({props:t,name:"JoySnackbar"}),{anchorOrigin:c=GB,animationDuration:h=300,autoHideDuration:f=null,color:o="neutral",children:b,className:P,component:I,disableWindowBlurListener:D=!1,endDecorator:z,invertedColors:F=!1,onUnmount:U,open:$,size:j="md",slots:ie={},slotProps:se,startDecorator:Q,variant:de="outlined"}=a,oe=Pr(a,FB),[be,xe]=K.useState(!0),[Me,Ee]=K.useState(!1),re=K.useRef(U);re.current=U,K.useEffect(()=>{if($)Ee(!1),xe(!1);else{Ee(!0);const wt=setTimeout(()=>{var xt;xe(!0),Ee(!1),(xt=re.current)==null||xt.call(re)},h);return()=>{clearTimeout(wt)}}},[$,h]);const ke=we({},a,{anchorOrigin:c,autoHideDuration:f,color:o,animationDuration:h,disableWindowBlurListener:D,invertedColors:F,size:j,variant:de});delete ke.onUnmount;const Ge=BB(ke),{getRootProps:Ke,onClickAway:gt}=f4(ke),et=wt=>{Me||gt(wt)},qe=we({},oe,{component:I,slots:ie,slotProps:se}),[Qe,Ve]=_r("root",{ref:i,className:hi(Ge.root,P),elementType:NB,externalForwardedProps:qe,getSlotProps:Ke,ownerState:ke}),[je,ct]=_r("startDecorator",{className:Ge.startDecorator,elementType:VB,externalForwardedProps:qe,ownerState:ke}),[ye,ze]=_r("endDecorator",{className:Ge.endDecorator,elementType:UB,externalForwardedProps:qe,ownerState:ke}),ft=ie.clickAway||VO;return!$&&be?null:G.jsx(ft,we({onClickAway:et},typeof se?.clickAway=="function"?se.clickAway(ke):se?.clickAway,{children:G.jsxs(Qe,we({},Ve,{children:[Q&&G.jsx(je,we({},ct,{children:Q})),b,z&&G.jsx(ye,we({},ze,{children:z}))]}))}))}),dn=SO({createStyledComponent:rr("div",{name:"JoyStack",slot:"Root",overridesResolver:(e,t)=>t.root}),useThemeProps:e=>Ci({props:e,name:"JoyStack"})});function Hp(e,...t){const i=new URL(`https://mui.com/production-error/?code=${e}`);return t.forEach(a=>i.searchParams.append("args[]",a)),`Minified MUI error #${e}; visit ${i} for the full message.`}const Wv="$$material";function HB(e){return e==null||Object.keys(e).length===0}function XI(e){const{styles:t,defaultTheme:i={}}=e,a=typeof t=="function"?c=>t(HB(c)?i:c):t;return G.jsx(LE,{styles:a})}function WB(e,t){return q_(e,t)}function ZB(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}const tM=[];function wf(e){return tM[0]=e,$v(tM)}var Mb={exports:{}},ui={};var rM;function XB(){if(rM)return ui;rM=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),h=Symbol.for("react.consumer"),f=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),z=Symbol.for("react.view_transition"),F=Symbol.for("react.client.reference");function U($){if(typeof $=="object"&&$!==null){var j=$.$$typeof;switch(j){case e:switch($=$.type,$){case i:case c:case a:case b:case P:case z:return $;default:switch($=$&&$.$$typeof,$){case f:case o:case D:case I:return $;case h:return $;default:return j}}case t:return j}}}return ui.ContextConsumer=h,ui.ContextProvider=f,ui.Element=e,ui.ForwardRef=o,ui.Fragment=i,ui.Lazy=D,ui.Memo=I,ui.Portal=t,ui.Profiler=c,ui.StrictMode=a,ui.Suspense=b,ui.SuspenseList=P,ui.isContextConsumer=function($){return U($)===h},ui.isContextProvider=function($){return U($)===f},ui.isElement=function($){return typeof $=="object"&&$!==null&&$.$$typeof===e},ui.isForwardRef=function($){return U($)===o},ui.isFragment=function($){return U($)===i},ui.isLazy=function($){return U($)===D},ui.isMemo=function($){return U($)===I},ui.isPortal=function($){return U($)===t},ui.isProfiler=function($){return U($)===c},ui.isStrictMode=function($){return U($)===a},ui.isSuspense=function($){return U($)===b},ui.isSuspenseList=function($){return U($)===P},ui.isValidElementType=function($){return typeof $=="string"||typeof $=="function"||$===i||$===c||$===a||$===b||$===P||typeof $=="object"&&$!==null&&($.$$typeof===D||$.$$typeof===I||$.$$typeof===f||$.$$typeof===h||$.$$typeof===o||$.$$typeof===F||$.getModuleId!==void 0)},ui.typeOf=U,ui}var nM;function KB(){return nM||(nM=1,Mb.exports=XB()),Mb.exports}var KI=KB();function Hu(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function YI(e){if(K.isValidElement(e)||KI.isValidElementType(e)||!Hu(e))return e;const t={};return Object.keys(e).forEach(i=>{t[i]=YI(e[i])}),t}function hl(e,t,i={clone:!0}){const a=i.clone?{...e}:e;return Hu(e)&&Hu(t)&&Object.keys(t).forEach(c=>{K.isValidElement(t[c])||KI.isValidElementType(t[c])?a[c]=t[c]:Hu(t[c])&&Object.prototype.hasOwnProperty.call(e,c)&&Hu(e[c])?a[c]=hl(e[c],t[c],i):i.clone?a[c]=Hu(t[c])?YI(t[c]):t[c]:a[c]=t[c]}),a}const YB=e=>{const t=Object.keys(e).map(i=>({key:i,val:e[i]}))||[];return t.sort((i,a)=>i.val-a.val),t.reduce((i,a)=>({...i,[a.key]:a.val}),{})};function JB(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:i="px",step:a=5,...c}=e,h=YB(t),f=Object.keys(h);function o(z){return`@media (min-width:${typeof t[z]=="number"?t[z]:z}${i})`}function b(z){return`@media (max-width:${(typeof t[z]=="number"?t[z]:z)-a/100}${i})`}function P(z,F){const U=f.indexOf(F);return`@media (min-width:${typeof t[z]=="number"?t[z]:z}${i}) and (max-width:${(U!==-1&&typeof t[f[U]]=="number"?t[f[U]]:F)-a/100}${i})`}function I(z){return f.indexOf(z)+1<f.length?P(z,f[f.indexOf(z)+1]):o(z)}function D(z){const F=f.indexOf(z);return F===0?o(f[1]):F===f.length-1?b(f[F]):P(z,f[f.indexOf(z)+1]).replace("@media","@media not all and")}return{keys:f,values:h,up:o,down:b,between:P,only:I,not:D,unit:i,...c}}function iM(e,t){if(!e.containerQueries)return t;const i=Object.keys(t).filter(a=>a.startsWith("@container")).sort((a,c)=>{const h=/min-width:\s*([0-9.]+)/;return+(a.match(h)?.[1]||0)-+(c.match(h)?.[1]||0)});return i.length?i.reduce((a,c)=>{const h=t[c];return delete a[c],a[c]=h,a},{...t}):t}function QB(e,t){return t==="@"||t.startsWith("@")&&(e.some(i=>t.startsWith(`@${i}`))||!!t.match(/^@\d/))}function e$(e,t){const i=t.match(/^@([^/]+)?\/?(.+)?$/);if(!i)return null;const[,a,c]=i,h=Number.isNaN(+a)?a||0:+a;return e.containerQueries(c).up(h)}function t$(e){const t=(h,f)=>h.replace("@media",f?`@container ${f}`:"@container");function i(h,f){h.up=(...o)=>t(e.breakpoints.up(...o),f),h.down=(...o)=>t(e.breakpoints.down(...o),f),h.between=(...o)=>t(e.breakpoints.between(...o),f),h.only=(...o)=>t(e.breakpoints.only(...o),f),h.not=(...o)=>{const b=t(e.breakpoints.not(...o),f);return b.includes("not all and")?b.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):b}}const a={},c=h=>(i(a,h),a);return i(c),{...e,containerQueries:c}}const r$={borderRadius:4};function rv(e,t){return t?hl(e,t,{clone:!1}):e}const qx={xs:0,sm:600,md:900,lg:1200,xl:1536},oM={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${qx[e]}px)`},n$={containerQueries:e=>({up:t=>{let i=typeof t=="number"?t:qx[t]||t;return typeof i=="number"&&(i=`${i}px`),e?`@container ${e} (min-width:${i})`:`@container (min-width:${i})`}})};function ad(e,t,i){const a=e.theme||{};if(Array.isArray(t)){const h=a.breakpoints||oM;return t.reduce((f,o,b)=>(f[h.up(h.keys[b])]=i(t[b]),f),{})}if(typeof t=="object"){const h=a.breakpoints||oM;return Object.keys(t).reduce((f,o)=>{if(QB(h.keys,o)){const b=e$(a.containerQueries?a:n$,o);b&&(f[b]=i(t[o],o))}else if(Object.keys(h.values||qx).includes(o)){const b=h.up(o);f[b]=i(t[o],o)}else{const b=o;f[b]=t[b]}return f},{})}return i(t)}function i$(e={}){return e.keys?.reduce((i,a)=>{const c=e.up(a);return i[c]={},i},{})||{}}function sM(e,t){return e.reduce((i,a)=>{const c=i[a];return(!c||Object.keys(c).length===0)&&delete i[a],i},t)}function $g(e){if(typeof e!="string")throw new Error(Hp(7));return e.charAt(0).toUpperCase()+e.slice(1)}function Hx(e,t,i=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&i){const a=`vars.${t}`.split(".").reduce((c,h)=>c&&c[h]?c[h]:null,e);if(a!=null)return a}return t.split(".").reduce((a,c)=>a&&a[c]!=null?a[c]:null,e)}function Q_(e,t,i,a=i){let c;return typeof e=="function"?c=e(i):Array.isArray(e)?c=e[i]||a:c=Hx(e,i)||a,t&&(c=t(c,a,e)),c}function xo(e){const{prop:t,cssProperty:i=e.prop,themeKey:a,transform:c}=e,h=f=>{if(f[t]==null)return null;const o=f[t],b=f.theme,P=Hx(b,a)||{};return ad(f,o,D=>{let z=Q_(P,c,D);return D===z&&typeof D=="string"&&(z=Q_(P,c,`${t}${D==="default"?"":$g(D)}`,D)),i===!1?z:{[i]:z}})};return h.propTypes={},h.filterProps=[t],h}function o$(e){const t={};return i=>(t[i]===void 0&&(t[i]=e(i)),t[i])}const s$={m:"margin",p:"padding"},a$={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},aM={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},l$=o$(e=>{if(e.length>2)if(aM[e])e=aM[e];else return[e];const[t,i]=e.split(""),a=s$[t],c=a$[i]||"";return Array.isArray(c)?c.map(h=>a+h):[a+c]}),L2=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],F2=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...L2,...F2];function Zv(e,t,i,a){const c=Hx(e,t,!0)??i;return typeof c=="number"||typeof c=="string"?h=>typeof h=="string"?h:typeof c=="string"?c.startsWith("var(")&&h===0?0:c.startsWith("var(")&&h===1?c:`calc(${h} * ${c})`:c*h:Array.isArray(c)?h=>{if(typeof h=="string")return h;const f=Math.abs(h),o=c[f];return h>=0?o:typeof o=="number"?-o:typeof o=="string"&&o.startsWith("var(")?`calc(-1 * ${o})`:`-${o}`}:typeof c=="function"?c:()=>{}}function B2(e){return Zv(e,"spacing",8)}function Xv(e,t){return typeof t=="string"||t==null?t:e(t)}function c$(e,t){return i=>e.reduce((a,c)=>(a[c]=Xv(t,i),a),{})}function u$(e,t,i,a){if(!t.includes(i))return null;const c=l$(i),h=c$(c,a),f=e[i];return ad(e,f,h)}function JI(e,t){const i=B2(e.theme);return Object.keys(e).map(a=>u$(e,t,a,i)).reduce(rv,{})}function uo(e){return JI(e,L2)}uo.propTypes={};uo.filterProps=L2;function ho(e){return JI(e,F2)}ho.propTypes={};ho.filterProps=F2;function QI(e=8,t=B2({spacing:e})){if(e.mui)return e;const i=(...a)=>(a.length===0?[1]:a).map(h=>{const f=t(h);return typeof f=="number"?`${f}px`:f}).join(" ");return i.mui=!0,i}function Wx(...e){const t=e.reduce((a,c)=>(c.filterProps.forEach(h=>{a[h]=c}),a),{}),i=a=>Object.keys(a).reduce((c,h)=>t[h]?rv(c,t[h](a)):c,{});return i.propTypes={},i.filterProps=e.reduce((a,c)=>a.concat(c.filterProps),[]),i}function Hl(e){return typeof e!="number"?e:`${e}px solid`}function rc(e,t){return xo({prop:e,themeKey:"borders",transform:t})}const h$=rc("border",Hl),d$=rc("borderTop",Hl),f$=rc("borderRight",Hl),p$=rc("borderBottom",Hl),m$=rc("borderLeft",Hl),g$=rc("borderColor"),y$=rc("borderTopColor"),v$=rc("borderRightColor"),_$=rc("borderBottomColor"),x$=rc("borderLeftColor"),b$=rc("outline",Hl),w$=rc("outlineColor"),Zx=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=Zv(e.theme,"shape.borderRadius",4),i=a=>({borderRadius:Xv(t,a)});return ad(e,e.borderRadius,i)}return null};Zx.propTypes={};Zx.filterProps=["borderRadius"];Wx(h$,d$,f$,p$,m$,g$,y$,v$,_$,x$,Zx,b$,w$);const Xx=e=>{if(e.gap!==void 0&&e.gap!==null){const t=Zv(e.theme,"spacing",8),i=a=>({gap:Xv(t,a)});return ad(e,e.gap,i)}return null};Xx.propTypes={};Xx.filterProps=["gap"];const Kx=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=Zv(e.theme,"spacing",8),i=a=>({columnGap:Xv(t,a)});return ad(e,e.columnGap,i)}return null};Kx.propTypes={};Kx.filterProps=["columnGap"];const Yx=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=Zv(e.theme,"spacing",8),i=a=>({rowGap:Xv(t,a)});return ad(e,e.rowGap,i)}return null};Yx.propTypes={};Yx.filterProps=["rowGap"];const S$=xo({prop:"gridColumn"}),C$=xo({prop:"gridRow"}),T$=xo({prop:"gridAutoFlow"}),M$=xo({prop:"gridAutoColumns"}),P$=xo({prop:"gridAutoRows"}),E$=xo({prop:"gridTemplateColumns"}),I$=xo({prop:"gridTemplateRows"}),k$=xo({prop:"gridTemplateAreas"}),A$=xo({prop:"gridArea"});Wx(Xx,Kx,Yx,S$,C$,T$,M$,P$,E$,I$,k$,A$);function Sg(e,t){return t==="grey"?t:e}const R$=xo({prop:"color",themeKey:"palette",transform:Sg}),D$=xo({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Sg}),z$=xo({prop:"backgroundColor",themeKey:"palette",transform:Sg});Wx(R$,D$,z$);function il(e){return e<=1&&e!==0?`${e*100}%`:e}const O$=xo({prop:"width",transform:il}),$2=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=i=>{const a=e.theme?.breakpoints?.values?.[i]||qx[i];return a?e.theme?.breakpoints?.unit!=="px"?{maxWidth:`${a}${e.theme.breakpoints.unit}`}:{maxWidth:a}:{maxWidth:il(i)}};return ad(e,e.maxWidth,t)}return null};$2.filterProps=["maxWidth"];const L$=xo({prop:"minWidth",transform:il}),F$=xo({prop:"height",transform:il}),B$=xo({prop:"maxHeight",transform:il}),$$=xo({prop:"minHeight",transform:il});xo({prop:"size",cssProperty:"width",transform:il});xo({prop:"size",cssProperty:"height",transform:il});const j$=xo({prop:"boxSizing"});Wx(O$,$2,L$,F$,B$,$$,j$);const Kv={border:{themeKey:"borders",transform:Hl},borderTop:{themeKey:"borders",transform:Hl},borderRight:{themeKey:"borders",transform:Hl},borderBottom:{themeKey:"borders",transform:Hl},borderLeft:{themeKey:"borders",transform:Hl},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Hl},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Zx},color:{themeKey:"palette",transform:Sg},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Sg},backgroundColor:{themeKey:"palette",transform:Sg},p:{style:ho},pt:{style:ho},pr:{style:ho},pb:{style:ho},pl:{style:ho},px:{style:ho},py:{style:ho},padding:{style:ho},paddingTop:{style:ho},paddingRight:{style:ho},paddingBottom:{style:ho},paddingLeft:{style:ho},paddingX:{style:ho},paddingY:{style:ho},paddingInline:{style:ho},paddingInlineStart:{style:ho},paddingInlineEnd:{style:ho},paddingBlock:{style:ho},paddingBlockStart:{style:ho},paddingBlockEnd:{style:ho},m:{style:uo},mt:{style:uo},mr:{style:uo},mb:{style:uo},ml:{style:uo},mx:{style:uo},my:{style:uo},margin:{style:uo},marginTop:{style:uo},marginRight:{style:uo},marginBottom:{style:uo},marginLeft:{style:uo},marginX:{style:uo},marginY:{style:uo},marginInline:{style:uo},marginInlineStart:{style:uo},marginInlineEnd:{style:uo},marginBlock:{style:uo},marginBlockStart:{style:uo},marginBlockEnd:{style:uo},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Xx},rowGap:{style:Yx},columnGap:{style:Kx},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:il},maxWidth:{style:$2},minWidth:{transform:il},height:{transform:il},maxHeight:{transform:il},minHeight:{transform:il},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function N$(...e){const t=e.reduce((a,c)=>a.concat(Object.keys(c)),[]),i=new Set(t);return e.every(a=>i.size===Object.keys(a).length)}function V$(e,t){return typeof e=="function"?e(t):e}function U$(){function e(i,a,c,h){const f={[i]:a,theme:c},o=h[i];if(!o)return{[i]:a};const{cssProperty:b=i,themeKey:P,transform:I,style:D}=o;if(a==null)return null;if(P==="typography"&&a==="inherit")return{[i]:a};const z=Hx(c,P)||{};return D?D(f):ad(f,a,U=>{let $=Q_(z,I,U);return U===$&&typeof U=="string"&&($=Q_(z,I,`${i}${U==="default"?"":$g(U)}`,U)),b===!1?$:{[b]:$}})}function t(i){const{sx:a,theme:c={},nested:h}=i||{};if(!a)return null;const f=c.unstable_sxConfig??Kv;function o(b){let P=b;if(typeof b=="function")P=b(c);else if(typeof b!="object")return b;if(!P)return null;const I=i$(c.breakpoints),D=Object.keys(I);let z=I;return Object.keys(P).forEach(F=>{const U=V$(P[F],c);if(U!=null)if(typeof U=="object")if(f[F])z=rv(z,e(F,U,c,f));else{const $=ad({theme:c},U,j=>({[F]:j}));N$($,U)?z[F]=t({sx:U,theme:c,nested:!0}):z=rv(z,$)}else z=rv(z,e(F,U,c,f))}),!h&&c.modularCssLayers?{"@layer sx":iM(c,sM(D,z))}:iM(c,sM(D,z))}return Array.isArray(a)?a.map(o):o(a)}return t}const Wp=U$();Wp.filterProps=["sx"];function G$(e,t){const i=this;if(i.vars){if(!i.colorSchemes?.[e]||typeof i.getColorSchemeSelector!="function")return{};let a=i.getColorSchemeSelector(e);return a==="&"?t:((a.includes("data-")||a.includes("."))&&(a=`*:where(${a.replace(/\s*&$/,"")}) &`),{[a]:t})}return i.palette.mode===e?t:{}}function Jx(e={},...t){const{breakpoints:i={},palette:a={},spacing:c,shape:h={},...f}=e,o=JB(i),b=QI(c);let P=hl({breakpoints:o,direction:"ltr",components:{},palette:{mode:"light",...a},spacing:b,shape:{...r$,...h}},f);return P=t$(P),P.applyStyles=G$,P=t.reduce((I,D)=>hl(I,D),P),P.unstable_sxConfig={...Kv,...f?.unstable_sxConfig},P.unstable_sx=function(D){return Wp({sx:D,theme:this})},P}function q$(e){return Object.keys(e).length===0}function Qx(e=null){const t=K.useContext(em);return!t||q$(t)?e:t}const H$=Jx();function e1(e=H$){return Qx(e)}function Pb(e){const t=wf(e);return e!==t&&t.styles?(t.styles.match(/^@layer\s+[^{]*$/)||(t.styles=`@layer global{${t.styles}}`),t):e}function W$({styles:e,themeId:t,defaultTheme:i={}}){const a=e1(i),c=t&&a[t]||a;let h=typeof e=="function"?e(c):e;return c.modularCssLayers&&(Array.isArray(h)?h=h.map(f=>Pb(typeof f=="function"?f(c):f)):h=Pb(h)),G.jsx(XI,{styles:h})}const Z$=e=>{const t={systemProps:{},otherProps:{}},i=e?.theme?.unstable_sxConfig??Kv;return Object.keys(e).forEach(a=>{i[a]?t.systemProps[a]=e[a]:t.otherProps[a]=e[a]}),t};function X$(e){const{sx:t,...i}=e,{systemProps:a,otherProps:c}=Z$(i);let h;return Array.isArray(t)?h=[a,...t]:typeof t=="function"?h=(...f)=>{const o=t(...f);return Hu(o)?{...a,...o}:a}:h={...a,...t},{...c,sx:h}}const lM=e=>e,K$=()=>{let e=lM;return{configure(t){e=t},generate(t){return e(t)},reset(){e=lM}}},Y$=K$(),J$={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function t1(e,t,i="Mui"){const a=J$[t];return a?`${i}-${a}`:`${Y$.generate(e)}-${t}`}function ek(e,t,i="Mui"){const a={};return t.forEach(c=>{a[c]=t1(e,c,i)}),a}function tk(e){const{variants:t,...i}=e,a={variants:t,style:wf(i),isProcessed:!0};return a.style===i||t&&t.forEach(c=>{typeof c.style!="function"&&(c.style=wf(c.style))}),a}const Q$=Jx();function Eb(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}function jp(e,t){return t&&e&&typeof e=="object"&&e.styles&&!e.styles.startsWith("@layer")&&(e.styles=`@layer ${t}{${String(e.styles)}}`),e}function ej(e){return e?(t,i)=>i[e]:null}function tj(e,t,i){e.theme=nj(e.theme)?i:e.theme[t]||e.theme}function R_(e,t,i){const a=typeof t=="function"?t(e):t;if(Array.isArray(a))return a.flatMap(c=>R_(e,c,i));if(Array.isArray(a?.variants)){let c;if(a.isProcessed)c=i?jp(a.style,i):a.style;else{const{variants:h,...f}=a;c=i?jp(wf(f),i):f}return rk(e,a.variants,[c],i)}return a?.isProcessed?i?jp(wf(a.style),i):a.style:i?jp(wf(a),i):a}function rk(e,t,i=[],a=void 0){let c;e:for(let h=0;h<t.length;h+=1){const f=t[h];if(typeof f.props=="function"){if(c??={...e,...e.ownerState,ownerState:e.ownerState},!f.props(c))continue}else for(const o in f.props)if(e[o]!==f.props[o]&&e.ownerState?.[o]!==f.props[o])continue e;typeof f.style=="function"?(c??={...e,...e.ownerState,ownerState:e.ownerState},i.push(a?jp(wf(f.style(c)),a):f.style(c))):i.push(a?jp(wf(f.style),a):f.style)}return i}function nk(e={}){const{themeId:t,defaultTheme:i=Q$,rootShouldForwardProp:a=Eb,slotShouldForwardProp:c=Eb}=e;function h(o){tj(o,t,i)}return(o,b={})=>{ZB(o,be=>be.filter(xe=>xe!==Wp));const{name:P,slot:I,skipVariantsResolver:D,skipSx:z,overridesResolver:F=ej(oj(I)),...U}=b,$=P&&P.startsWith("Mui")||I?"components":"custom",j=D!==void 0?D:I&&I!=="Root"&&I!=="root"||!1,ie=z||!1;let se=Eb;I==="Root"||I==="root"?se=a:I?se=c:ij(o)&&(se=void 0);const Q=WB(o,{shouldForwardProp:se,label:rj(),...U}),de=be=>{if(be.__emotion_real===be)return be;if(typeof be=="function")return function(Me){return R_(Me,be,Me.theme.modularCssLayers?$:void 0)};if(Hu(be)){const xe=tk(be);return function(Ee){return xe.variants?R_(Ee,xe,Ee.theme.modularCssLayers?$:void 0):Ee.theme.modularCssLayers?jp(xe.style,$):xe.style}}return be},oe=(...be)=>{const xe=[],Me=be.map(de),Ee=[];if(xe.push(h),P&&F&&Ee.push(function(Ke){const et=Ke.theme.components?.[P]?.styleOverrides;if(!et)return null;const qe={};for(const Qe in et)qe[Qe]=R_(Ke,et[Qe],Ke.theme.modularCssLayers?"theme":void 0);return F(Ke,qe)}),P&&!j&&Ee.push(function(Ke){const et=Ke.theme?.components?.[P]?.variants;return et?rk(Ke,et,[],Ke.theme.modularCssLayers?"theme":void 0):null}),ie||Ee.push(Wp),Array.isArray(Me[0])){const Ge=Me.shift(),Ke=new Array(xe.length).fill(""),gt=new Array(Ee.length).fill("");let et;et=[...Ke,...Ge,...gt],et.raw=[...Ke,...Ge.raw,...gt],xe.unshift(et)}const re=[...xe,...Me,...Ee],ke=Q(...re);return o.muiName&&(ke.muiName=o.muiName),ke};return Q.withConfig&&(oe.withConfig=Q.withConfig),oe}}function rj(e,t){return void 0}function nj(e){for(const t in e)return!1;return!0}function ij(e){return typeof e=="string"&&e.charCodeAt(0)>96}function oj(e){return e&&e.charAt(0).toLowerCase()+e.slice(1)}const sj=nk();function ex(e,t,i=!1){const a={...t};for(const c in e)if(Object.prototype.hasOwnProperty.call(e,c)){const h=c;if(h==="components"||h==="slots")a[h]={...e[h],...a[h]};else if(h==="componentsProps"||h==="slotProps"){const f=e[h],o=t[h];if(!o)a[h]=f||{};else if(!f)a[h]=o;else{a[h]={...o};for(const b in f)if(Object.prototype.hasOwnProperty.call(f,b)){const P=b;a[h][P]=ex(f[P],o[P],i)}}}else h==="className"&&i&&t.className?a.className=hi(e?.className,t?.className):h==="style"&&i&&t.style?a.style={...e?.style,...t?.style}:a[h]===void 0&&(a[h]=e[h])}return a}function ik(e){const{theme:t,name:i,props:a}=e;return!t||!t.components||!t.components[i]||!t.components[i].defaultProps?a:ex(t.components[i].defaultProps,a)}function aj({props:e,name:t,defaultTheme:i,themeId:a}){let c=e1(i);return a&&(c=c[a]||c),ik({theme:c,name:t,props:e})}const j2=typeof window<"u"?K.useLayoutEffect:K.useEffect;function lj(e,t,i,a,c){const[h,f]=K.useState(()=>c&&i?i(e).matches:a?a(e).matches:t);return j2(()=>{if(!i)return;const o=i(e),b=()=>{f(o.matches)};return b(),o.addEventListener("change",b),()=>{o.removeEventListener("change",b)}},[e,i]),h}const cj={...yv},ok=cj.useSyncExternalStore;function uj(e,t,i,a,c){const h=K.useCallback(()=>t,[t]),f=K.useMemo(()=>{if(c&&i)return()=>i(e).matches;if(a!==null){const{matches:I}=a(e);return()=>I}return h},[h,e,a,c,i]),[o,b]=K.useMemo(()=>{if(i===null)return[h,()=>()=>{}];const I=i(e);return[()=>I.matches,D=>(I.addEventListener("change",D),()=>{I.removeEventListener("change",D)})]},[h,i,e]);return ok(b,o,f)}function sk(e={}){const{themeId:t}=e;return function(a,c={}){let h=Qx();h&&t&&(h=h[t]||h);const f=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:o=!1,matchMedia:b=f?window.matchMedia:null,ssrMatchMedia:P=null,noSsr:I=!1}=ik({name:"MuiUseMediaQuery",props:c,theme:h});let D=typeof a=="function"?a(h):a;return D=D.replace(/^@media( ?)/m,""),D.includes("print")&&console.warn(["MUI: You have provided a `print` query to the `useMediaQuery` hook.","Using the print media query to modify print styles can lead to unexpected results.","Consider using the `displayPrint` field in the `sx` prop instead.","More information about `displayPrint` on our docs: https://mui.com/system/display/#display-in-print."].join(`
`)),(ok!==void 0?uj:lj)(D,o,b,P,I)}}sk();function hj(e,t=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,i))}function N2(e,t=0,i=1){return hj(e,t,i)}function dj(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let i=e.match(t);return i&&i[0].length===1&&(i=i.map(a=>a+a)),i?`rgb${i.length===4?"a":""}(${i.map((a,c)=>c<3?parseInt(a,16):Math.round(parseInt(a,16)/255*1e3)/1e3).join(", ")})`:""}function Tf(e){if(e.type)return e;if(e.charAt(0)==="#")return Tf(dj(e));const t=e.indexOf("("),i=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(i))throw new Error(Hp(9,e));let a=e.substring(t+1,e.length-1),c;if(i==="color"){if(a=a.split(" "),c=a.shift(),a.length===4&&a[3].charAt(0)==="/"&&(a[3]=a[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(c))throw new Error(Hp(10,c))}else a=a.split(",");return a=a.map(h=>parseFloat(h)),{type:i,values:a,colorSpace:c}}const fj=e=>{const t=Tf(e);return t.values.slice(0,3).map((i,a)=>t.type.includes("hsl")&&a!==0?`${i}%`:i).join(" ")},Gy=(e,t)=>{try{return fj(e)}catch{return e}};function r1(e){const{type:t,colorSpace:i}=e;let{values:a}=e;return t.includes("rgb")?a=a.map((c,h)=>h<3?parseInt(c,10):c):t.includes("hsl")&&(a[1]=`${a[1]}%`,a[2]=`${a[2]}%`),t.includes("color")?a=`${i} ${a.join(" ")}`:a=`${a.join(", ")}`,`${t}(${a})`}function ak(e){e=Tf(e);const{values:t}=e,i=t[0],a=t[1]/100,c=t[2]/100,h=a*Math.min(c,1-c),f=(P,I=(P+i/30)%12)=>c-h*Math.max(Math.min(I-3,9-I,1),-1);let o="rgb";const b=[Math.round(f(0)*255),Math.round(f(8)*255),Math.round(f(4)*255)];return e.type==="hsla"&&(o+="a",b.push(t[3])),r1({type:o,values:b})}function Pw(e){e=Tf(e);let t=e.type==="hsl"||e.type==="hsla"?Tf(ak(e)).values:e.values;return t=t.map(i=>(e.type!=="color"&&(i/=255),i<=.03928?i/12.92:((i+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function pj(e,t){const i=Pw(e),a=Pw(t);return(Math.max(i,a)+.05)/(Math.min(i,a)+.05)}function mj(e,t){return e=Tf(e),t=N2(t),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${t}`:e.values[3]=t,r1(e)}function c_(e,t,i){try{return mj(e,t)}catch{return e}}function V2(e,t){if(e=Tf(e),t=N2(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let i=0;i<3;i+=1)e.values[i]*=1-t;return r1(e)}function _i(e,t,i){try{return V2(e,t)}catch{return e}}function U2(e,t){if(e=Tf(e),t=N2(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let i=0;i<3;i+=1)e.values[i]+=(255-e.values[i])*t;else if(e.type.includes("color"))for(let i=0;i<3;i+=1)e.values[i]+=(1-e.values[i])*t;return r1(e)}function xi(e,t,i){try{return U2(e,t)}catch{return e}}function gj(e,t=.15){return Pw(e)>.5?V2(e,t):U2(e,t)}function u_(e,t,i){try{return gj(e,t)}catch{return e}}const lk=K.createContext(null);function G2(){return K.useContext(lk)}const yj=typeof Symbol=="function"&&Symbol.for,vj=yj?Symbol.for("mui.nested"):"__THEME_NESTED__";function _j(e,t){return typeof t=="function"?t(e):{...e,...t}}function xj(e){const{children:t,theme:i}=e,a=G2(),c=K.useMemo(()=>{const h=a===null?{...i}:_j(a,i);return h!=null&&(h[vj]=a!==null),h},[i,a]);return G.jsx(lk.Provider,{value:c,children:t})}const bj=K.createContext();function wj({value:e,...t}){return G.jsx(bj.Provider,{value:e??!0,...t})}const ck=K.createContext(void 0);function Sj({value:e,children:t}){return G.jsx(ck.Provider,{value:e,children:t})}function Cj(e){const{theme:t,name:i,props:a}=e;if(!t||!t.components||!t.components[i])return a;const c=t.components[i];return c.defaultProps?ex(c.defaultProps,a,t.components.mergeClassNameAndStyle):!c.styleOverrides&&!c.variants?ex(c,a,t.components.mergeClassNameAndStyle):a}function Tj({props:e,name:t}){const i=K.useContext(ck);return Cj({props:e,name:t,theme:{components:i}})}let cM=0;function Mj(e){const[t,i]=K.useState(e),a=e||t;return K.useEffect(()=>{t==null&&(cM+=1,i(`mui-${cM}`))},[t]),a}const Pj={...yv},uM=Pj.useId;function Ej(e){return uM!==void 0?uM():Mj(e)}function Ij(e){const t=Qx(),i=Ej()||"",{modularCssLayers:a}=e;let c="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!a||t!==null?c="":typeof a=="string"?c=a.replace(/mui(?!\.)/g,c):c=`@layer ${c};`,j2(()=>{const h=document.querySelector("head");if(!h)return;const f=h.firstChild;if(c){if(f&&f.hasAttribute?.("data-mui-layer-order")&&f.getAttribute("data-mui-layer-order")===i)return;const o=document.createElement("style");o.setAttribute("data-mui-layer-order",i),o.textContent=c,h.prepend(o)}else h.querySelector(`style[data-mui-layer-order="${i}"]`)?.remove()},[c,i]),c?G.jsx(W$,{styles:c}):null}const hM={};function dM(e,t,i,a=!1){return K.useMemo(()=>{const c=e&&t[e]||t;if(typeof i=="function"){const h=i(c),f=e?{...t,[e]:h}:h;return a?()=>f:f}return e?{...t,[e]:i}:{...t,...i}},[e,t,i,a])}function kj(e){const{children:t,theme:i,themeId:a}=e,c=Qx(hM),h=G2()||hM,f=dM(a,c,i),o=dM(a,h,i,!0),b=(a?f[a]:f).direction==="rtl",P=Ij(f);return G.jsx(xj,{theme:o,children:G.jsx(em.Provider,{value:f,children:G.jsx(wj,{value:b,children:G.jsxs(Sj,{value:a?f[a].components:f.components,children:[P,t]})})})})}const fM={theme:void 0};function Aj(e){let t,i;return function(c){let h=t;return(h===void 0||c.theme!==i)&&(fM.theme=c.theme,h=tk(e(fM)),t=h,i=c.theme),h}}const q2="mode",H2="color-scheme",Rj="data-color-scheme";function Dj(e){const{defaultMode:t="system",defaultLightColorScheme:i="light",defaultDarkColorScheme:a="dark",modeStorageKey:c=q2,colorSchemeStorageKey:h=H2,attribute:f=Rj,colorSchemeNode:o="document.documentElement",nonce:b}=e||{};let P="",I=f;if(f==="class"&&(I=".%s"),f==="data"&&(I="[data-%s]"),I.startsWith(".")){const z=I.substring(1);P+=`${o}.classList.remove('${z}'.replace('%s', light), '${z}'.replace('%s', dark));
      ${o}.classList.add('${z}'.replace('%s', colorScheme));`}const D=I.match(/\[([^\]]+)\]/);if(D){const[z,F]=D[1].split("=");F||(P+=`${o}.removeAttribute('${z}'.replace('%s', light));
      ${o}.removeAttribute('${z}'.replace('%s', dark));`),P+=`
      ${o}.setAttribute('${z}'.replace('%s', colorScheme), ${F?`${F}.replace('%s', colorScheme)`:'""'});`}else P+=`${o}.setAttribute('${I}', colorScheme);`;return G.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?b:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${c}') || '${t}';
  const dark = localStorage.getItem('${h}-dark') || '${a}';
  const light = localStorage.getItem('${h}-light') || '${i}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${P}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function zj(){}const Oj=({key:e,storageWindow:t})=>(!t&&typeof window<"u"&&(t=window),{get(i){if(typeof window>"u")return;if(!t)return i;let a;try{a=t.localStorage.getItem(e)}catch{}return a||i},set:i=>{if(t)try{t.localStorage.setItem(e,i)}catch{}},subscribe:i=>{if(!t)return zj;const a=c=>{const h=c.newValue;c.key===e&&i(h)};return t.addEventListener("storage",a),()=>{t.removeEventListener("storage",a)}}});function Ib(){}function pM(e){if(typeof window<"u"&&typeof window.matchMedia=="function"&&e==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function uk(e,t){if(e.mode==="light"||e.mode==="system"&&e.systemMode==="light")return t("light");if(e.mode==="dark"||e.mode==="system"&&e.systemMode==="dark")return t("dark")}function Lj(e){return uk(e,t=>{if(t==="light")return e.lightColorScheme;if(t==="dark")return e.darkColorScheme})}function Fj(e){const{defaultMode:t="light",defaultLightColorScheme:i,defaultDarkColorScheme:a,supportedColorSchemes:c=[],modeStorageKey:h=q2,colorSchemeStorageKey:f=H2,storageWindow:o=typeof window>"u"?void 0:window,storageManager:b=Oj,noSsr:P=!1}=e,I=c.join(","),D=c.length>1,z=K.useMemo(()=>b?.({key:h,storageWindow:o}),[b,h,o]),F=K.useMemo(()=>b?.({key:`${f}-light`,storageWindow:o}),[b,f,o]),U=K.useMemo(()=>b?.({key:`${f}-dark`,storageWindow:o}),[b,f,o]),[$,j]=K.useState(()=>{const Me=z?.get(t)||t,Ee=F?.get(i)||i,re=U?.get(a)||a;return{mode:Me,systemMode:pM(Me),lightColorScheme:Ee,darkColorScheme:re}}),[ie,se]=K.useState(P||!D);K.useEffect(()=>{se(!0)},[]);const Q=Lj($),de=K.useCallback(Me=>{j(Ee=>{if(Me===Ee.mode)return Ee;const re=Me??t;return z?.set(re),{...Ee,mode:re,systemMode:pM(re)}})},[z,t]),oe=K.useCallback(Me=>{Me?typeof Me=="string"?Me&&!I.includes(Me)?console.error(`\`${Me}\` does not exist in \`theme.colorSchemes\`.`):j(Ee=>{const re={...Ee};return uk(Ee,ke=>{ke==="light"&&(F?.set(Me),re.lightColorScheme=Me),ke==="dark"&&(U?.set(Me),re.darkColorScheme=Me)}),re}):j(Ee=>{const re={...Ee},ke=Me.light===null?i:Me.light,Ge=Me.dark===null?a:Me.dark;return ke&&(I.includes(ke)?(re.lightColorScheme=ke,F?.set(ke)):console.error(`\`${ke}\` does not exist in \`theme.colorSchemes\`.`)),Ge&&(I.includes(Ge)?(re.darkColorScheme=Ge,U?.set(Ge)):console.error(`\`${Ge}\` does not exist in \`theme.colorSchemes\`.`)),re}):j(Ee=>(F?.set(i),U?.set(a),{...Ee,lightColorScheme:i,darkColorScheme:a}))},[I,F,U,i,a]),be=K.useCallback(Me=>{$.mode==="system"&&j(Ee=>{const re=Me?.matches?"dark":"light";return Ee.systemMode===re?Ee:{...Ee,systemMode:re}})},[$.mode]),xe=K.useRef(be);return xe.current=be,K.useEffect(()=>{if(typeof window.matchMedia!="function"||!D)return;const Me=(...re)=>xe.current(...re),Ee=window.matchMedia("(prefers-color-scheme: dark)");return Ee.addListener(Me),Me(Ee),()=>{Ee.removeListener(Me)}},[D]),K.useEffect(()=>{if(D){const Me=z?.subscribe(ke=>{(!ke||["light","dark","system"].includes(ke))&&de(ke||t)})||Ib,Ee=F?.subscribe(ke=>{(!ke||I.match(ke))&&oe({light:ke})})||Ib,re=U?.subscribe(ke=>{(!ke||I.match(ke))&&oe({dark:ke})})||Ib;return()=>{Me(),Ee(),re()}}},[oe,de,I,t,o,D,z,F,U]),{...$,mode:ie?$.mode:void 0,systemMode:ie?$.systemMode:void 0,colorScheme:ie?Q:void 0,setMode:de,setColorScheme:oe}}const Bj="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function $j(e){const{themeId:t,theme:i={},modeStorageKey:a=q2,colorSchemeStorageKey:c=H2,disableTransitionOnChange:h=!1,defaultColorScheme:f,resolveTheme:o}=e,b={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},P=K.createContext(void 0),I=()=>K.useContext(P)||b,D={},z={};function F(ie){const{children:se,theme:Q,modeStorageKey:de=a,colorSchemeStorageKey:oe=c,disableTransitionOnChange:be=h,storageManager:xe,storageWindow:Me=typeof window>"u"?void 0:window,documentNode:Ee=typeof document>"u"?void 0:document,colorSchemeNode:re=typeof document>"u"?void 0:document.documentElement,disableNestedContext:ke=!1,disableStyleSheetGeneration:Ge=!1,defaultMode:Ke="system",forceThemeRerender:gt=!1,noSsr:et}=ie,qe=K.useRef(!1),Qe=G2(),Ve=K.useContext(P),je=!!Ve&&!ke,ct=K.useMemo(()=>Q||(typeof i=="function"?i():i),[Q]),ye=ct[t],ze=ye||ct,{colorSchemes:ft=D,components:wt=z,cssVarPrefix:xt}=ze,_t=Object.keys(ft).filter(He=>!!ft[He]).join(","),St=K.useMemo(()=>_t.split(","),[_t]),tt=typeof f=="string"?f:f.light,At=typeof f=="string"?f:f.dark,It=ft[tt]&&ft[At]?Ke:ft[ze.defaultColorScheme]?.palette?.mode||ze.palette?.mode,{mode:mr,setMode:ur,systemMode:Hr,lightColorScheme:wr,darkColorScheme:sr,colorScheme:Wt,setColorScheme:yr}=Fj({supportedColorSchemes:St,defaultLightColorScheme:tt,defaultDarkColorScheme:At,modeStorageKey:de,colorSchemeStorageKey:oe,defaultMode:It,storageManager:xe,storageWindow:Me,noSsr:et});let Yt=mr,Cr=Wt;je&&(Yt=Ve.mode,Cr=Ve.colorScheme);let Rr=Cr||ze.defaultColorScheme;ze.vars&&!gt&&(Rr=ze.defaultColorScheme);const Or=K.useMemo(()=>{const He=ze.generateThemeVars?.()||ze.vars,ae={...ze,components:wt,colorSchemes:ft,cssVarPrefix:xt,vars:He};if(typeof ae.generateSpacing=="function"&&(ae.spacing=ae.generateSpacing()),Rr){const le=ft[Rr];le&&typeof le=="object"&&Object.keys(le).forEach(ue=>{le[ue]&&typeof le[ue]=="object"?ae[ue]={...ae[ue],...le[ue]}:ae[ue]=le[ue]})}return o?o(ae):ae},[ze,Rr,wt,ft,xt]),Gr=ze.colorSchemeSelector;j2(()=>{if(Cr&&re&&Gr&&Gr!=="media"){const He=Gr;let ae=Gr;if(He==="class"&&(ae=".%s"),He==="data"&&(ae="[data-%s]"),He?.startsWith("data-")&&!He.includes("%s")&&(ae=`[${He}="%s"]`),ae.startsWith("."))re.classList.remove(...St.map(le=>ae.substring(1).replace("%s",le))),re.classList.add(ae.substring(1).replace("%s",Cr));else{const le=ae.replace("%s",Cr).match(/\[([^\]]+)\]/);if(le){const[ue,Pe]=le[1].split("=");Pe||St.forEach(Re=>{re.removeAttribute(ue.replace(Cr,Re))}),re.setAttribute(ue,Pe?Pe.replace(/"|'/g,""):"")}else re.setAttribute(ae,Cr)}}},[Cr,Gr,re,St]),K.useEffect(()=>{let He;if(be&&qe.current&&Ee){const ae=Ee.createElement("style");ae.appendChild(Ee.createTextNode(Bj)),Ee.head.appendChild(ae),window.getComputedStyle(Ee.body),He=setTimeout(()=>{Ee.head.removeChild(ae)},1)}return()=>{clearTimeout(He)}},[Cr,be,Ee]),K.useEffect(()=>(qe.current=!0,()=>{qe.current=!1}),[]);const rn=K.useMemo(()=>({allColorSchemes:St,colorScheme:Cr,darkColorScheme:sr,lightColorScheme:wr,mode:Yt,setColorScheme:yr,setMode:ur,systemMode:Hr}),[St,Cr,sr,wr,Yt,yr,ur,Hr,Or.colorSchemeSelector]);let Un=!0;(Ge||ze.cssVariables===!1||je&&Qe?.cssVarPrefix===xt)&&(Un=!1);const wn=G.jsxs(K.Fragment,{children:[G.jsx(kj,{themeId:ye?t:void 0,theme:Or,children:se}),Un&&G.jsx(XI,{styles:Or.generateStyleSheets?.()||[]})]});return je?wn:G.jsx(P.Provider,{value:rn,children:wn})}const U=typeof f=="string"?f:f.light,$=typeof f=="string"?f:f.dark;return{CssVarsProvider:F,useColorScheme:I,getInitColorSchemeScript:ie=>Dj({colorSchemeStorageKey:c,defaultLightColorScheme:U,defaultDarkColorScheme:$,modeStorageKey:a,...ie})}}function jj(e=""){function t(...a){if(!a.length)return"";const c=a[0];return typeof c=="string"&&!c.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${e?`${e}-`:""}${c}${t(...a.slice(1))})`:`, ${c}`}return(a,...c)=>`var(--${e?`${e}-`:""}${a}${t(...c)})`}const mM=(e,t,i,a=[])=>{let c=e;t.forEach((h,f)=>{f===t.length-1?Array.isArray(c)?c[Number(h)]=i:c&&typeof c=="object"&&(c[h]=i):c&&typeof c=="object"&&(c[h]||(c[h]=a.includes(h)?[]:{}),c=c[h])})},Nj=(e,t,i)=>{function a(c,h=[],f=[]){Object.entries(c).forEach(([o,b])=>{(!i||i&&!i([...h,o]))&&b!=null&&(typeof b=="object"&&Object.keys(b).length>0?a(b,[...h,o],Array.isArray(b)?[...f,o]:f):t([...h,o],b,f))})}a(e)},Vj=(e,t)=>typeof t=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(a=>e.includes(a))||e[e.length-1].toLowerCase().includes("opacity")?t:`${t}px`:t;function kb(e,t){const{prefix:i,shouldSkipGeneratingVar:a}=t||{},c={},h={},f={};return Nj(e,(o,b,P)=>{if((typeof b=="string"||typeof b=="number")&&(!a||!a(o,b))){const I=`--${i?`${i}-`:""}${o.join("-")}`,D=Vj(o,b);Object.assign(c,{[I]:D}),mM(h,o,`var(${I})`,P),mM(f,o,`var(${I}, ${D})`,P)}},o=>o[0]==="vars"),{css:c,vars:h,varsWithDefaults:f}}function Uj(e,t={}){const{getSelector:i=j,disableCssColorScheme:a,colorSchemeSelector:c}=t,{colorSchemes:h={},components:f,defaultColorScheme:o="light",...b}=e,{vars:P,css:I,varsWithDefaults:D}=kb(b,t);let z=D;const F={},{[o]:U,...$}=h;if(Object.entries($||{}).forEach(([Q,de])=>{const{vars:oe,css:be,varsWithDefaults:xe}=kb(de,t);z=hl(z,xe),F[Q]={css:be,vars:oe}}),U){const{css:Q,vars:de,varsWithDefaults:oe}=kb(U,t);z=hl(z,oe),F[o]={css:Q,vars:de}}function j(Q,de){let oe=c;if(c==="class"&&(oe=".%s"),c==="data"&&(oe="[data-%s]"),c?.startsWith("data-")&&!c.includes("%s")&&(oe=`[${c}="%s"]`),Q){if(oe==="media")return e.defaultColorScheme===Q?":root":{[`@media (prefers-color-scheme: ${h[Q]?.palette?.mode||Q})`]:{":root":de}};if(oe)return e.defaultColorScheme===Q?`:root, ${oe.replace("%s",String(Q))}`:oe.replace("%s",String(Q))}return":root"}return{vars:z,generateThemeVars:()=>{let Q={...P};return Object.entries(F).forEach(([,{vars:de}])=>{Q=hl(Q,de)}),Q},generateStyleSheets:()=>{const Q=[],de=e.defaultColorScheme||"light";function oe(Me,Ee){Object.keys(Ee).length&&Q.push(typeof Me=="string"?{[Me]:{...Ee}}:Me)}oe(i(void 0,{...I}),I);const{[de]:be,...xe}=F;if(be){const{css:Me}=be,Ee=h[de]?.palette?.mode,re=!a&&Ee?{colorScheme:Ee,...Me}:{...Me};oe(i(de,{...re}),re)}return Object.entries(xe).forEach(([Me,{css:Ee}])=>{const re=h[Me]?.palette?.mode,ke=!a&&re?{colorScheme:re,...Ee}:{...Ee};oe(i(Me,{...ke}),ke)}),Q}}}function Gj(e){return function(i){return e==="media"?`@media (prefers-color-scheme: ${i})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${i}"] &`:e==="class"?`.${i} &`:e==="data"?`[data-${i}] &`:`${e.replace("%s",i)} &`:"&"}}function W2(e,t,i=void 0){const a={};for(const c in e){const h=e[c];let f="",o=!0;for(let b=0;b<h.length;b+=1){const P=h[b];P&&(f+=(o===!0?"":" ")+t(P),o=!1,i&&i[P]&&(f+=" "+i[P]))}a[c]=f}return a}function qj(e,t){return K.isValidElement(e)&&t.indexOf(e.type.muiName??e.type?._payload?.value?.muiName)!==-1}const Hj=(e,t)=>e.filter(i=>t.includes(i)),Kg=(e,t,i)=>{const a=e.keys[0];Array.isArray(t)?t.forEach((c,h)=>{i((f,o)=>{h<=e.keys.length-1&&(h===0?Object.assign(f,o):f[e.up(e.keys[h])]=o)},c)}):t&&typeof t=="object"?(Object.keys(t).length>e.keys.length?e.keys:Hj(e.keys,Object.keys(t))).forEach(h=>{if(e.keys.includes(h)){const f=t[h];f!==void 0&&i((o,b)=>{a===h?Object.assign(o,b):o[e.up(h)]=b},f)}}):(typeof t=="number"||typeof t=="string")&&i((c,h)=>{Object.assign(c,h)},t)};function tx(e){return`--Grid-${e}Spacing`}function n1(e){return`--Grid-parent-${e}Spacing`}const gM="--Grid-columns",Cg="--Grid-parent-columns",Wj=({theme:e,ownerState:t})=>{const i={};return Kg(e.breakpoints,t.size,(a,c)=>{let h={};c==="grow"&&(h={flexBasis:0,flexGrow:1,maxWidth:"100%"}),c==="auto"&&(h={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"}),typeof c=="number"&&(h={flexGrow:0,flexBasis:"auto",width:`calc(100% * ${c} / var(${Cg}) - (var(${Cg}) - ${c}) * (var(${n1("column")}) / var(${Cg})))`}),a(i,h)}),i},Zj=({theme:e,ownerState:t})=>{const i={};return Kg(e.breakpoints,t.offset,(a,c)=>{let h={};c==="auto"&&(h={marginLeft:"auto"}),typeof c=="number"&&(h={marginLeft:c===0?"0px":`calc(100% * ${c} / var(${Cg}) + var(${n1("column")}) * ${c} / var(${Cg}))`}),a(i,h)}),i},Xj=({theme:e,ownerState:t})=>{if(!t.container)return{};const i={[gM]:12};return Kg(e.breakpoints,t.columns,(a,c)=>{const h=c??12;a(i,{[gM]:h,"> *":{[Cg]:h}})}),i},Kj=({theme:e,ownerState:t})=>{if(!t.container)return{};const i={};return Kg(e.breakpoints,t.rowSpacing,(a,c)=>{const h=typeof c=="string"?c:e.spacing?.(c);a(i,{[tx("row")]:h,"> *":{[n1("row")]:h}})}),i},Yj=({theme:e,ownerState:t})=>{if(!t.container)return{};const i={};return Kg(e.breakpoints,t.columnSpacing,(a,c)=>{const h=typeof c=="string"?c:e.spacing?.(c);a(i,{[tx("column")]:h,"> *":{[n1("column")]:h}})}),i},Jj=({theme:e,ownerState:t})=>{if(!t.container)return{};const i={};return Kg(e.breakpoints,t.direction,(a,c)=>{a(i,{flexDirection:c})}),i},Qj=({ownerState:e})=>({minWidth:0,boxSizing:"border-box",...e.container&&{display:"flex",flexWrap:"wrap",...e.wrap&&e.wrap!=="wrap"&&{flexWrap:e.wrap},gap:`var(${tx("row")}) var(${tx("column")})`}}),eN=e=>{const t=[];return Object.entries(e).forEach(([i,a])=>{a!==!1&&a!==void 0&&t.push(`grid-${i}-${String(a)}`)}),t},tN=(e,t="xs")=>{function i(a){return a===void 0?!1:typeof a=="string"&&!Number.isNaN(Number(a))||typeof a=="number"&&a>0}if(i(e))return[`spacing-${t}-${String(e)}`];if(typeof e=="object"&&!Array.isArray(e)){const a=[];return Object.entries(e).forEach(([c,h])=>{i(h)&&a.push(`spacing-${c}-${String(h)}`)}),a}return[]},rN=e=>e===void 0?[]:typeof e=="object"?Object.entries(e).map(([t,i])=>`direction-${t}-${i}`):[`direction-xs-${String(e)}`];function nN(e,t){e.item!==void 0&&delete e.item,e.zeroMinWidth!==void 0&&delete e.zeroMinWidth,t.keys.forEach(i=>{e[i]!==void 0&&delete e[i]})}const iN=Jx(),oN=sj("div",{name:"MuiGrid",slot:"Root"});function sN(e){return aj({props:e,name:"MuiGrid",defaultTheme:iN})}function aN(e={}){const{createStyledComponent:t=oN,useThemeProps:i=sN,useTheme:a=e1,componentName:c="MuiGrid"}=e,h=(P,I)=>{const{container:D,direction:z,spacing:F,wrap:U,size:$}=P,j={root:["root",D&&"container",U!=="wrap"&&`wrap-xs-${String(U)}`,...rN(z),...eN($),...D?tN(F,I.breakpoints.keys[0]):[]]};return W2(j,ie=>t1(c,ie),{})};function f(P,I,D=()=>!0){const z={};return P===null||(Array.isArray(P)?P.forEach((F,U)=>{F!==null&&D(F)&&I.keys[U]&&(z[I.keys[U]]=F)}):typeof P=="object"?Object.keys(P).forEach(F=>{const U=P[F];U!=null&&D(U)&&(z[F]=U)}):z[I.keys[0]]=P),z}const o=t(Xj,Yj,Kj,Wj,Jj,Qj,Zj),b=K.forwardRef(function(I,D){const z=a(),F=i(I),U=X$(F);nN(U,z.breakpoints);const{className:$,children:j,columns:ie=12,container:se=!1,component:Q="div",direction:de="row",wrap:oe="wrap",size:be={},offset:xe={},spacing:Me=0,rowSpacing:Ee=Me,columnSpacing:re=Me,unstable_level:ke=0,...Ge}=U,Ke=f(be,z.breakpoints,ye=>ye!==!1),gt=f(xe,z.breakpoints),et=I.columns??(ke?void 0:ie),qe=I.spacing??(ke?void 0:Me),Qe=I.rowSpacing??I.spacing??(ke?void 0:Ee),Ve=I.columnSpacing??I.spacing??(ke?void 0:re),je={...U,level:ke,columns:et,container:se,direction:de,wrap:oe,spacing:qe,rowSpacing:Qe,columnSpacing:Ve,size:Ke,offset:gt},ct=h(je,z);return G.jsx(o,{ref:D,as:Q,ownerState:je,className:hi(ct.root,$),...Ge,children:K.Children.map(j,ye=>K.isValidElement(ye)&&qj(ye,["Grid"])&&se&&ye.props.container?K.cloneElement(ye,{unstable_level:ye.props?.unstable_level??ke+1}):ye)})});return b.muiName="Grid",b}const Tv={black:"#000",white:"#fff"},lN={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Jm={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},Qm={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},$y={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},eg={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},tg={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},rg={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function hk(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Tv.white,default:Tv.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const cN=hk();function dk(){return{text:{primary:Tv.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Tv.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const yM=dk();function vM(e,t,i,a){const c=a.light||a,h=a.dark||a*1.5;e[t]||(e.hasOwnProperty(i)?e[t]=e[i]:t==="light"?e.light=U2(e.main,c):t==="dark"&&(e.dark=V2(e.main,h)))}function uN(e="light"){return e==="dark"?{main:eg[200],light:eg[50],dark:eg[400]}:{main:eg[700],light:eg[400],dark:eg[800]}}function hN(e="light"){return e==="dark"?{main:Jm[200],light:Jm[50],dark:Jm[400]}:{main:Jm[500],light:Jm[300],dark:Jm[700]}}function dN(e="light"){return e==="dark"?{main:Qm[500],light:Qm[300],dark:Qm[700]}:{main:Qm[700],light:Qm[400],dark:Qm[800]}}function fN(e="light"){return e==="dark"?{main:tg[400],light:tg[300],dark:tg[700]}:{main:tg[700],light:tg[500],dark:tg[900]}}function pN(e="light"){return e==="dark"?{main:rg[400],light:rg[300],dark:rg[700]}:{main:rg[800],light:rg[500],dark:rg[900]}}function mN(e="light"){return e==="dark"?{main:$y[400],light:$y[300],dark:$y[700]}:{main:"#ed6c02",light:$y[500],dark:$y[900]}}function Z2(e){const{mode:t="light",contrastThreshold:i=3,tonalOffset:a=.2,...c}=e,h=e.primary||uN(t),f=e.secondary||hN(t),o=e.error||dN(t),b=e.info||fN(t),P=e.success||pN(t),I=e.warning||mN(t);function D($){return pj($,yM.text.primary)>=i?yM.text.primary:cN.text.primary}const z=({color:$,name:j,mainShade:ie=500,lightShade:se=300,darkShade:Q=700})=>{if($={...$},!$.main&&$[ie]&&($.main=$[ie]),!$.hasOwnProperty("main"))throw new Error(Hp(11,j?` (${j})`:"",ie));if(typeof $.main!="string")throw new Error(Hp(12,j?` (${j})`:"",JSON.stringify($.main)));return vM($,"light",se,a),vM($,"dark",Q,a),$.contrastText||($.contrastText=D($.main)),$};let F;return t==="light"?F=hk():t==="dark"&&(F=dk()),hl({common:{...Tv},mode:t,primary:z({color:h,name:"primary"}),secondary:z({color:f,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:z({color:o,name:"error"}),warning:z({color:I,name:"warning"}),info:z({color:b,name:"info"}),success:z({color:P,name:"success"}),grey:lN,contrastThreshold:i,getContrastText:D,augmentColor:z,tonalOffset:a,...F},c)}function gN(e){const t={};return Object.entries(e).forEach(a=>{const[c,h]=a;typeof h=="object"&&(t[c]=`${h.fontStyle?`${h.fontStyle} `:""}${h.fontVariant?`${h.fontVariant} `:""}${h.fontWeight?`${h.fontWeight} `:""}${h.fontStretch?`${h.fontStretch} `:""}${h.fontSize||""}${h.lineHeight?`/${h.lineHeight} `:""}${h.fontFamily||""}`)}),t}function yN(e,t){return{toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}},...t}}function vN(e){return Math.round(e*1e5)/1e5}const _M={textTransform:"uppercase"},xM='"Roboto", "Helvetica", "Arial", sans-serif';function fk(e,t){const{fontFamily:i=xM,fontSize:a=14,fontWeightLight:c=300,fontWeightRegular:h=400,fontWeightMedium:f=500,fontWeightBold:o=700,htmlFontSize:b=16,allVariants:P,pxToRem:I,...D}=typeof t=="function"?t(e):t,z=a/14,F=I||(j=>`${j/b*z}rem`),U=(j,ie,se,Q,de)=>({fontFamily:i,fontWeight:j,fontSize:F(ie),lineHeight:se,...i===xM?{letterSpacing:`${vN(Q/ie)}em`}:{},...de,...P}),$={h1:U(c,96,1.167,-1.5),h2:U(c,60,1.2,-.5),h3:U(h,48,1.167,0),h4:U(h,34,1.235,.25),h5:U(h,24,1.334,0),h6:U(f,20,1.6,.15),subtitle1:U(h,16,1.75,.15),subtitle2:U(f,14,1.57,.1),body1:U(h,16,1.5,.15),body2:U(h,14,1.43,.15),button:U(f,14,1.75,.4,_M),caption:U(h,12,1.66,.4),overline:U(h,12,2.66,1,_M),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return hl({htmlFontSize:b,pxToRem:F,fontFamily:i,fontSize:a,fontWeightLight:c,fontWeightRegular:h,fontWeightMedium:f,fontWeightBold:o,...$},D,{clone:!1})}const _N=.2,xN=.14,bN=.12;function Ni(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${_N})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${xN})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${bN})`].join(",")}const wN=["none",Ni(0,2,1,-1,0,1,1,0,0,1,3,0),Ni(0,3,1,-2,0,2,2,0,0,1,5,0),Ni(0,3,3,-2,0,3,4,0,0,1,8,0),Ni(0,2,4,-1,0,4,5,0,0,1,10,0),Ni(0,3,5,-1,0,5,8,0,0,1,14,0),Ni(0,3,5,-1,0,6,10,0,0,1,18,0),Ni(0,4,5,-2,0,7,10,1,0,2,16,1),Ni(0,5,5,-3,0,8,10,1,0,3,14,2),Ni(0,5,6,-3,0,9,12,1,0,3,16,2),Ni(0,6,6,-3,0,10,14,1,0,4,18,3),Ni(0,6,7,-4,0,11,15,1,0,4,20,3),Ni(0,7,8,-4,0,12,17,2,0,5,22,4),Ni(0,7,8,-4,0,13,19,2,0,5,24,4),Ni(0,7,9,-4,0,14,21,2,0,5,26,4),Ni(0,8,9,-5,0,15,22,2,0,6,28,5),Ni(0,8,10,-5,0,16,24,2,0,6,30,5),Ni(0,8,11,-5,0,17,26,2,0,6,32,5),Ni(0,9,11,-5,0,18,28,2,0,7,34,6),Ni(0,9,12,-6,0,19,29,2,0,7,36,6),Ni(0,10,13,-6,0,20,31,3,0,8,38,7),Ni(0,10,13,-6,0,21,33,3,0,8,40,7),Ni(0,10,14,-6,0,22,35,3,0,8,42,7),Ni(0,11,14,-7,0,23,36,3,0,9,44,8),Ni(0,11,15,-7,0,24,38,3,0,9,46,8)],SN={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},pk={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function bM(e){return`${Math.round(e)}ms`}function CN(e){if(!e)return 0;const t=e/36;return Math.min(Math.round((4+15*t**.25+t/5)*10),3e3)}function TN(e){const t={...SN,...e.easing},i={...pk,...e.duration};return{getAutoHeightDuration:CN,create:(c=["all"],h={})=>{const{duration:f=i.standard,easing:o=t.easeInOut,delay:b=0,...P}=h;return(Array.isArray(c)?c:[c]).map(I=>`${I} ${typeof f=="string"?f:bM(f)} ${o} ${typeof b=="string"?b:bM(b)}`).join(",")},...e,easing:t,duration:i}}const MN={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function PN(e){return Hu(e)||typeof e>"u"||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||Array.isArray(e)}function mk(e={}){const t={...e};function i(a){const c=Object.entries(a);for(let h=0;h<c.length;h++){const[f,o]=c[h];!PN(o)||f.startsWith("unstable_")?delete a[f]:Hu(o)&&(a[f]={...o},i(a[f]))}}return i(t),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(t,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function Ew(e={},...t){const{breakpoints:i,mixins:a={},spacing:c,palette:h={},transitions:f={},typography:o={},shape:b,...P}=e;if(e.vars&&e.generateThemeVars===void 0)throw new Error(Hp(20));const I=Z2(h),D=Jx(e);let z=hl(D,{mixins:yN(D.breakpoints,a),palette:I,shadows:wN.slice(),typography:fk(I,o),transitions:TN(f),zIndex:{...MN}});return z=hl(z,P),z=t.reduce((F,U)=>hl(F,U),z),z.unstable_sxConfig={...Kv,...P?.unstable_sxConfig},z.unstable_sx=function(U){return Wp({sx:U,theme:this})},z.toRuntimeSource=mk,z}function EN(e){let t;return e<1?t=5.11916*e**2:t=4.5*Math.log(e+1)+2,Math.round(t*10)/1e3}const IN=[...Array(25)].map((e,t)=>{if(t===0)return"none";const i=EN(t);return`linear-gradient(rgba(255 255 255 / ${i}), rgba(255 255 255 / ${i}))`});function gk(e){return{inputPlaceholder:e==="dark"?.5:.42,inputUnderline:e==="dark"?.7:.42,switchTrackDisabled:e==="dark"?.2:.12,switchTrack:e==="dark"?.3:.38}}function yk(e){return e==="dark"?IN:[]}function kN(e){const{palette:t={mode:"light"},opacity:i,overlays:a,...c}=e,h=Z2(t);return{palette:h,opacity:{...gk(h.mode),...i},overlays:a||yk(h.mode),...c}}function AN(e){return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||e[0]==="palette"&&!!e[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const RN=e=>[...[...Array(25)].map((t,i)=>`--${e?`${e}-`:""}overlays-${i}`),`--${e?`${e}-`:""}palette-AppBar-darkBg`,`--${e?`${e}-`:""}palette-AppBar-darkColor`],DN=e=>(t,i)=>{const a=e.rootSelector||":root",c=e.colorSchemeSelector;let h=c;if(c==="class"&&(h=".%s"),c==="data"&&(h="[data-%s]"),c?.startsWith("data-")&&!c.includes("%s")&&(h=`[${c}="%s"]`),e.defaultColorScheme===t){if(t==="dark"){const f={};return RN(e.cssVarPrefix).forEach(o=>{f[o]=i[o],delete i[o]}),h==="media"?{[a]:i,"@media (prefers-color-scheme: dark)":{[a]:f}}:h?{[h.replace("%s",t)]:f,[`${a}, ${h.replace("%s",t)}`]:i}:{[a]:{...i,...f}}}if(h&&h!=="media")return`${a}, ${h.replace("%s",String(t))}`}else if(t){if(h==="media")return{[`@media (prefers-color-scheme: ${String(t)})`]:{[a]:i}};if(h)return h.replace("%s",String(t))}return a};function zN(e,t){t.forEach(i=>{e[i]||(e[i]={})})}function Mt(e,t,i){!e[t]&&i&&(e[t]=i)}function qy(e){return typeof e!="string"||!e.startsWith("hsl")?e:ak(e)}function Yh(e,t){`${t}Channel`in e||(e[`${t}Channel`]=Gy(qy(e[t])))}function ON(e){return typeof e=="number"?`${e}px`:typeof e=="string"||typeof e=="function"||Array.isArray(e)?e:"8px"}const Vu=e=>{try{return e()}catch{}},LN=(e="mui")=>jj(e);function Ab(e,t,i,a){if(!t)return;t=t===!0?{}:t;const c=a==="dark"?"dark":"light";if(!i){e[a]=kN({...t,palette:{mode:c,...t?.palette}});return}const{palette:h,...f}=Ew({...i,palette:{mode:c,...t?.palette}});return e[a]={...t,palette:h,opacity:{...gk(c),...t?.opacity},overlays:t?.overlays||yk(c)},f}function vk(e={},...t){const{colorSchemes:i={light:!0},defaultColorScheme:a,disableCssColorScheme:c=!1,cssVarPrefix:h="mui",shouldSkipGeneratingVar:f=AN,colorSchemeSelector:o=i.light&&i.dark?"media":void 0,rootSelector:b=":root",...P}=e,I=Object.keys(i)[0],D=a||(i.light&&I!=="light"?"light":I),z=LN(h),{[D]:F,light:U,dark:$,...j}=i,ie={...j};let se=F;if((D==="dark"&&!("dark"in i)||D==="light"&&!("light"in i))&&(se=!0),!se)throw new Error(Hp(21,D));const Q=Ab(ie,se,P,D);U&&!ie.light&&Ab(ie,U,void 0,"light"),$&&!ie.dark&&Ab(ie,$,void 0,"dark");let de={defaultColorScheme:D,...Q,cssVarPrefix:h,colorSchemeSelector:o,rootSelector:b,getCssVar:z,colorSchemes:ie,font:{...gN(Q.typography),...Q.font},spacing:ON(P.spacing)};Object.keys(de.colorSchemes).forEach(Ee=>{const re=de.colorSchemes[Ee].palette,ke=Ge=>{const Ke=Ge.split("-"),gt=Ke[1],et=Ke[2];return z(Ge,re[gt][et])};if(re.mode==="light"&&(Mt(re.common,"background","#fff"),Mt(re.common,"onBackground","#000")),re.mode==="dark"&&(Mt(re.common,"background","#000"),Mt(re.common,"onBackground","#fff")),zN(re,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),re.mode==="light"){Mt(re.Alert,"errorColor",_i(re.error.light,.6)),Mt(re.Alert,"infoColor",_i(re.info.light,.6)),Mt(re.Alert,"successColor",_i(re.success.light,.6)),Mt(re.Alert,"warningColor",_i(re.warning.light,.6)),Mt(re.Alert,"errorFilledBg",ke("palette-error-main")),Mt(re.Alert,"infoFilledBg",ke("palette-info-main")),Mt(re.Alert,"successFilledBg",ke("palette-success-main")),Mt(re.Alert,"warningFilledBg",ke("palette-warning-main")),Mt(re.Alert,"errorFilledColor",Vu(()=>re.getContrastText(re.error.main))),Mt(re.Alert,"infoFilledColor",Vu(()=>re.getContrastText(re.info.main))),Mt(re.Alert,"successFilledColor",Vu(()=>re.getContrastText(re.success.main))),Mt(re.Alert,"warningFilledColor",Vu(()=>re.getContrastText(re.warning.main))),Mt(re.Alert,"errorStandardBg",xi(re.error.light,.9)),Mt(re.Alert,"infoStandardBg",xi(re.info.light,.9)),Mt(re.Alert,"successStandardBg",xi(re.success.light,.9)),Mt(re.Alert,"warningStandardBg",xi(re.warning.light,.9)),Mt(re.Alert,"errorIconColor",ke("palette-error-main")),Mt(re.Alert,"infoIconColor",ke("palette-info-main")),Mt(re.Alert,"successIconColor",ke("palette-success-main")),Mt(re.Alert,"warningIconColor",ke("palette-warning-main")),Mt(re.AppBar,"defaultBg",ke("palette-grey-100")),Mt(re.Avatar,"defaultBg",ke("palette-grey-400")),Mt(re.Button,"inheritContainedBg",ke("palette-grey-300")),Mt(re.Button,"inheritContainedHoverBg",ke("palette-grey-A100")),Mt(re.Chip,"defaultBorder",ke("palette-grey-400")),Mt(re.Chip,"defaultAvatarColor",ke("palette-grey-700")),Mt(re.Chip,"defaultIconColor",ke("palette-grey-700")),Mt(re.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Mt(re.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Mt(re.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Mt(re.LinearProgress,"primaryBg",xi(re.primary.main,.62)),Mt(re.LinearProgress,"secondaryBg",xi(re.secondary.main,.62)),Mt(re.LinearProgress,"errorBg",xi(re.error.main,.62)),Mt(re.LinearProgress,"infoBg",xi(re.info.main,.62)),Mt(re.LinearProgress,"successBg",xi(re.success.main,.62)),Mt(re.LinearProgress,"warningBg",xi(re.warning.main,.62)),Mt(re.Skeleton,"bg",`rgba(${ke("palette-text-primaryChannel")} / 0.11)`),Mt(re.Slider,"primaryTrack",xi(re.primary.main,.62)),Mt(re.Slider,"secondaryTrack",xi(re.secondary.main,.62)),Mt(re.Slider,"errorTrack",xi(re.error.main,.62)),Mt(re.Slider,"infoTrack",xi(re.info.main,.62)),Mt(re.Slider,"successTrack",xi(re.success.main,.62)),Mt(re.Slider,"warningTrack",xi(re.warning.main,.62));const Ge=u_(re.background.default,.8);Mt(re.SnackbarContent,"bg",Ge),Mt(re.SnackbarContent,"color",Vu(()=>re.getContrastText(Ge))),Mt(re.SpeedDialAction,"fabHoverBg",u_(re.background.paper,.15)),Mt(re.StepConnector,"border",ke("palette-grey-400")),Mt(re.StepContent,"border",ke("palette-grey-400")),Mt(re.Switch,"defaultColor",ke("palette-common-white")),Mt(re.Switch,"defaultDisabledColor",ke("palette-grey-100")),Mt(re.Switch,"primaryDisabledColor",xi(re.primary.main,.62)),Mt(re.Switch,"secondaryDisabledColor",xi(re.secondary.main,.62)),Mt(re.Switch,"errorDisabledColor",xi(re.error.main,.62)),Mt(re.Switch,"infoDisabledColor",xi(re.info.main,.62)),Mt(re.Switch,"successDisabledColor",xi(re.success.main,.62)),Mt(re.Switch,"warningDisabledColor",xi(re.warning.main,.62)),Mt(re.TableCell,"border",xi(c_(re.divider,1),.88)),Mt(re.Tooltip,"bg",c_(re.grey[700],.92))}if(re.mode==="dark"){Mt(re.Alert,"errorColor",xi(re.error.light,.6)),Mt(re.Alert,"infoColor",xi(re.info.light,.6)),Mt(re.Alert,"successColor",xi(re.success.light,.6)),Mt(re.Alert,"warningColor",xi(re.warning.light,.6)),Mt(re.Alert,"errorFilledBg",ke("palette-error-dark")),Mt(re.Alert,"infoFilledBg",ke("palette-info-dark")),Mt(re.Alert,"successFilledBg",ke("palette-success-dark")),Mt(re.Alert,"warningFilledBg",ke("palette-warning-dark")),Mt(re.Alert,"errorFilledColor",Vu(()=>re.getContrastText(re.error.dark))),Mt(re.Alert,"infoFilledColor",Vu(()=>re.getContrastText(re.info.dark))),Mt(re.Alert,"successFilledColor",Vu(()=>re.getContrastText(re.success.dark))),Mt(re.Alert,"warningFilledColor",Vu(()=>re.getContrastText(re.warning.dark))),Mt(re.Alert,"errorStandardBg",_i(re.error.light,.9)),Mt(re.Alert,"infoStandardBg",_i(re.info.light,.9)),Mt(re.Alert,"successStandardBg",_i(re.success.light,.9)),Mt(re.Alert,"warningStandardBg",_i(re.warning.light,.9)),Mt(re.Alert,"errorIconColor",ke("palette-error-main")),Mt(re.Alert,"infoIconColor",ke("palette-info-main")),Mt(re.Alert,"successIconColor",ke("palette-success-main")),Mt(re.Alert,"warningIconColor",ke("palette-warning-main")),Mt(re.AppBar,"defaultBg",ke("palette-grey-900")),Mt(re.AppBar,"darkBg",ke("palette-background-paper")),Mt(re.AppBar,"darkColor",ke("palette-text-primary")),Mt(re.Avatar,"defaultBg",ke("palette-grey-600")),Mt(re.Button,"inheritContainedBg",ke("palette-grey-800")),Mt(re.Button,"inheritContainedHoverBg",ke("palette-grey-700")),Mt(re.Chip,"defaultBorder",ke("palette-grey-700")),Mt(re.Chip,"defaultAvatarColor",ke("palette-grey-300")),Mt(re.Chip,"defaultIconColor",ke("palette-grey-300")),Mt(re.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Mt(re.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Mt(re.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Mt(re.LinearProgress,"primaryBg",_i(re.primary.main,.5)),Mt(re.LinearProgress,"secondaryBg",_i(re.secondary.main,.5)),Mt(re.LinearProgress,"errorBg",_i(re.error.main,.5)),Mt(re.LinearProgress,"infoBg",_i(re.info.main,.5)),Mt(re.LinearProgress,"successBg",_i(re.success.main,.5)),Mt(re.LinearProgress,"warningBg",_i(re.warning.main,.5)),Mt(re.Skeleton,"bg",`rgba(${ke("palette-text-primaryChannel")} / 0.13)`),Mt(re.Slider,"primaryTrack",_i(re.primary.main,.5)),Mt(re.Slider,"secondaryTrack",_i(re.secondary.main,.5)),Mt(re.Slider,"errorTrack",_i(re.error.main,.5)),Mt(re.Slider,"infoTrack",_i(re.info.main,.5)),Mt(re.Slider,"successTrack",_i(re.success.main,.5)),Mt(re.Slider,"warningTrack",_i(re.warning.main,.5));const Ge=u_(re.background.default,.98);Mt(re.SnackbarContent,"bg",Ge),Mt(re.SnackbarContent,"color",Vu(()=>re.getContrastText(Ge))),Mt(re.SpeedDialAction,"fabHoverBg",u_(re.background.paper,.15)),Mt(re.StepConnector,"border",ke("palette-grey-600")),Mt(re.StepContent,"border",ke("palette-grey-600")),Mt(re.Switch,"defaultColor",ke("palette-grey-300")),Mt(re.Switch,"defaultDisabledColor",ke("palette-grey-600")),Mt(re.Switch,"primaryDisabledColor",_i(re.primary.main,.55)),Mt(re.Switch,"secondaryDisabledColor",_i(re.secondary.main,.55)),Mt(re.Switch,"errorDisabledColor",_i(re.error.main,.55)),Mt(re.Switch,"infoDisabledColor",_i(re.info.main,.55)),Mt(re.Switch,"successDisabledColor",_i(re.success.main,.55)),Mt(re.Switch,"warningDisabledColor",_i(re.warning.main,.55)),Mt(re.TableCell,"border",_i(c_(re.divider,1),.68)),Mt(re.Tooltip,"bg",c_(re.grey[700],.92))}Yh(re.background,"default"),Yh(re.background,"paper"),Yh(re.common,"background"),Yh(re.common,"onBackground"),Yh(re,"divider"),Object.keys(re).forEach(Ge=>{const Ke=re[Ge];Ge!=="tonalOffset"&&Ke&&typeof Ke=="object"&&(Ke.main&&Mt(re[Ge],"mainChannel",Gy(qy(Ke.main))),Ke.light&&Mt(re[Ge],"lightChannel",Gy(qy(Ke.light))),Ke.dark&&Mt(re[Ge],"darkChannel",Gy(qy(Ke.dark))),Ke.contrastText&&Mt(re[Ge],"contrastTextChannel",Gy(qy(Ke.contrastText))),Ge==="text"&&(Yh(re[Ge],"primary"),Yh(re[Ge],"secondary")),Ge==="action"&&(Ke.active&&Yh(re[Ge],"active"),Ke.selected&&Yh(re[Ge],"selected")))})}),de=t.reduce((Ee,re)=>hl(Ee,re),de);const oe={prefix:h,disableCssColorScheme:c,shouldSkipGeneratingVar:f,getSelector:DN(de)},{vars:be,generateThemeVars:xe,generateStyleSheets:Me}=Uj(de,oe);return de.vars=be,Object.entries(de.colorSchemes[de.defaultColorScheme]).forEach(([Ee,re])=>{de[Ee]=re}),de.generateThemeVars=xe,de.generateStyleSheets=Me,de.generateSpacing=function(){return QI(P.spacing,B2(this))},de.getColorSchemeSelector=Gj(o),de.spacing=de.generateSpacing(),de.shouldSkipGeneratingVar=f,de.unstable_sxConfig={...Kv,...P?.unstable_sxConfig},de.unstable_sx=function(re){return Wp({sx:re,theme:this})},de.toRuntimeSource=mk,de}function wM(e,t,i){e.colorSchemes&&i&&(e.colorSchemes[t]={...i!==!0&&i,palette:Z2({...i===!0?{}:i.palette,mode:t})})}function _k(e={},...t){const{palette:i,cssVariables:a=!1,colorSchemes:c=i?void 0:{light:!0},defaultColorScheme:h=i?.mode,...f}=e,o=h||"light",b=c?.[o],P={...c,...i?{[o]:{...typeof b!="boolean"&&b,palette:i}}:void 0};if(a===!1){if(!("colorSchemes"in e))return Ew(e,...t);let I=i;"palette"in e||P[o]&&(P[o]!==!0?I=P[o].palette:o==="dark"&&(I={mode:"dark"}));const D=Ew({...e,palette:I},...t);return D.defaultColorScheme=o,D.colorSchemes=P,D.palette.mode==="light"&&(D.colorSchemes.light={...P.light!==!0&&P.light,palette:D.palette},wM(D,"dark",P.dark)),D.palette.mode==="dark"&&(D.colorSchemes.dark={...P.dark!==!0&&P.dark,palette:D.palette},wM(D,"light",P.light)),D}return!i&&!("light"in P)&&o==="light"&&(P.light=!0),vk({...f,colorSchemes:P,defaultColorScheme:o,...typeof a!="boolean"&&a},...t)}const xk=_k();function Yv(){const e=e1(xk);return e[Wv]||e}function FN(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const BN=e=>FN(e)&&e!=="classes",Jv=nk({themeId:Wv,defaultTheme:xk,rootShouldForwardProp:BN}),h_={colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:$N}=$j({themeId:Wv,theme:()=>_k({cssVariables:!0}),colorSchemeStorageKey:h_.colorSchemeStorageKey,modeStorageKey:h_.modeStorageKey,defaultColorScheme:{light:h_.defaultLightColorScheme,dark:h_.defaultDarkColorScheme},resolveTheme:e=>{const t={...e,typography:fk(e.palette,e.typography)};return t.unstable_sx=function(a){return Wp({sx:a,theme:this})},t}});function jN(e){return G.jsx($N,{...e})}var NN=Object.create,bk=Object.defineProperty,VN=Object.getOwnPropertyDescriptor,wk=Object.getOwnPropertyNames,UN=Object.getPrototypeOf,GN=Object.prototype.hasOwnProperty,ah=(e,t)=>function(){return t||(0,e[wk(e)[0]])((t={exports:{}}).exports,t),t.exports},qN=(e,t,i,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(var c=wk(t),h=0,f=c.length,o;h<f;h++)o=c[h],!GN.call(e,o)&&o!==i&&bk(e,o,{get:(b=>t[b]).bind(null,o),enumerable:!(a=VN(t,o))||a.enumerable});return e},bo=(e,t,i)=>(i=e!=null?NN(UN(e)):{},qN(bk(i,"default",{value:e,enumerable:!0}),e)),Sk=ah({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/typeof.js"(e,t){function i(a){"@babel/helpers - typeof";return t.exports=i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},t.exports.__esModule=!0,t.exports.default=t.exports,i(a)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}}),HN=ah({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/toPrimitive.js"(e,t){var i=Sk().default;function a(c,h){if(i(c)!="object"||!c)return c;var f=c[Symbol.toPrimitive];if(f!==void 0){var o=f.call(c,h||"default");if(i(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(h==="string"?String:Number)(c)}t.exports=a,t.exports.__esModule=!0,t.exports.default=t.exports}}),WN=ah({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/toPropertyKey.js"(e,t){var i=Sk().default,a=HN();function c(h){var f=a(h,"string");return i(f)=="symbol"?f:f+""}t.exports=c,t.exports.__esModule=!0,t.exports.default=t.exports}}),im=ah({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/defineProperty.js"(e,t){var i=WN();function a(c,h,f){return(h=i(h))in c?Object.defineProperty(c,h,{value:f,enumerable:!0,configurable:!0,writable:!0}):c[h]=f,c}t.exports=a,t.exports.__esModule=!0,t.exports.default=t.exports}}),ou=ah({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/objectSpread2.js"(e,t){var i=im();function a(h,f){var o=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);f&&(b=b.filter(function(P){return Object.getOwnPropertyDescriptor(h,P).enumerable})),o.push.apply(o,b)}return o}function c(h){for(var f=1;f<arguments.length;f++){var o=arguments[f]!=null?arguments[f]:{};f%2?a(Object(o),!0).forEach(function(b){i(h,b,o[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(o,b))})}return h}t.exports=c,t.exports.__esModule=!0,t.exports.default=t.exports}});function Qv(e){const t={subscribe(i){let a=null,c=!1,h=!1,f=!1;function o(){if(a===null){f=!0;return}h||(h=!0,typeof a=="function"?a():a&&a.unsubscribe())}return a=e({next(b){var P;c||(P=i.next)===null||P===void 0||P.call(i,b)},error(b){var P;c||(c=!0,(P=i.error)===null||P===void 0||P.call(i,b),o())},complete(){var b;c||(c=!0,(b=i.complete)===null||b===void 0||b.call(i),o())}}),f&&o(),{unsubscribe:o}},pipe(...i){return i.reduce(ZN,t)}};return t}function ZN(e,t){return t(e)}function XN(e){const t=new AbortController;return new Promise((a,c)=>{let h=!1;function f(){h||(h=!0,o.unsubscribe())}t.signal.addEventListener("abort",()=>{c(t.signal.reason)});const o=e.subscribe({next(b){h=!0,a(b),f()},error(b){c(b)},complete(){t.abort(),f()}})})}function KN(e){return t=>{let i=0,a=null;const c=[];function h(){a||(a=t.subscribe({next(o){for(const P of c){var b;(b=P.next)===null||b===void 0||b.call(P,o)}},error(o){for(const P of c){var b;(b=P.error)===null||b===void 0||b.call(P,o)}},complete(){for(const b of c){var o;(o=b.complete)===null||o===void 0||o.call(b)}}}))}function f(){if(i===0&&a){const o=a;a=null,o.unsubscribe()}}return Qv(o=>(i++,c.push(o),h(),{unsubscribe(){i--,f();const b=c.findIndex(P=>P===o);b>-1&&c.splice(b,1)}}))}}function Ck(e){let t=e;const i=[],a=f=>{t!==void 0&&f.next(t),i.push(f)},c=f=>{i.splice(i.indexOf(f),1)},h=Qv(f=>(a(f),()=>{c(f)}));return h.next=f=>{if(t!==f){t=f;for(const o of i)o.next(f)}},h.get=()=>t,h}function YN(e){return Qv(t=>{function i(c=0,h=e.op){const f=e.links[c];if(!f)throw new Error("No more links to execute - did you forget to add an ending link?");return f({op:h,next(b){return i(c+1,b)}})}return i().subscribe(t)})}function Mv(e){return!!e&&!Array.isArray(e)&&typeof e=="object"}function JN(){return Object.create(null)}const SM=e=>e();function CM(e=0){return new Promise(t=>setTimeout(t,e))}var QN=Object.create,Tk=Object.defineProperty,e8=Object.getOwnPropertyDescriptor,Mk=Object.getOwnPropertyNames,t8=Object.getPrototypeOf,r8=Object.prototype.hasOwnProperty,e0=(e,t)=>function(){return t||(0,e[Mk(e)[0]])((t={exports:{}}).exports,t),t.exports},n8=(e,t,i,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(var c=Mk(t),h=0,f=c.length,o;h<f;h++)o=c[h],!r8.call(e,o)&&o!==i&&Tk(e,o,{get:(b=>t[b]).bind(null,o),enumerable:!(a=e8(t,o))||a.enumerable});return e},i1=(e,t,i)=>(i=e!=null?QN(t8(e)):{},n8(Tk(i,"default",{value:e,enumerable:!0}),e));const Pk=()=>{},TM=e=>{Object.freeze&&Object.freeze(e)};function Ek(e,t,i){var a;const c=t.join(".");return(a=i[c])!==null&&a!==void 0||(i[c]=new Proxy(Pk,{get(h,f){if(!(typeof f!="string"||f==="then"))return Ek(e,[...t,f],i)},apply(h,f,o){const b=t[t.length-1];let P={args:o,path:t};return b==="call"?P={args:o.length>=2?[o[1]]:[],path:t.slice(0,-1)}:b==="apply"&&(P={args:o.length>=2?o[1]:[],path:t.slice(0,-1)}),TM(P.args),TM(P.path),e(P)}})),i[c]}const i8=e=>Ek(e,[],JN()),o8=e=>new Proxy(Pk,{get(t,i){if(i!=="then")return e(i)}});var Ik=e0({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/typeof.js"(e,t){function i(a){"@babel/helpers - typeof";return t.exports=i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},t.exports.__esModule=!0,t.exports.default=t.exports,i(a)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}}),s8=e0({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/toPrimitive.js"(e,t){var i=Ik().default;function a(c,h){if(i(c)!="object"||!c)return c;var f=c[Symbol.toPrimitive];if(f!==void 0){var o=f.call(c,h||"default");if(i(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(h==="string"?String:Number)(c)}t.exports=a,t.exports.__esModule=!0,t.exports.default=t.exports}}),a8=e0({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/toPropertyKey.js"(e,t){var i=Ik().default,a=s8();function c(h){var f=a(h,"string");return i(f)=="symbol"?f:f+""}t.exports=c,t.exports.__esModule=!0,t.exports.default=t.exports}}),kk=e0({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/defineProperty.js"(e,t){var i=a8();function a(c,h,f){return(h=i(h))in c?Object.defineProperty(c,h,{value:f,enumerable:!0,configurable:!0,writable:!0}):c[h]=f,c}t.exports=a,t.exports.__esModule=!0,t.exports.default=t.exports}}),X2=e0({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/objectSpread2.js"(e,t){var i=kk();function a(h,f){var o=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);f&&(b=b.filter(function(P){return Object.getOwnPropertyDescriptor(h,P).enumerable})),o.push.apply(o,b)}return o}function c(h){for(var f=1;f<arguments.length;f++){var o=arguments[f]!=null?arguments[f]:{};f%2?a(Object(o),!0).forEach(function(b){i(h,b,o[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(o,b))})}return h}t.exports=c,t.exports.__esModule=!0,t.exports.default=t.exports}});i1(X2());i1(kk());var d_=i1(X2());function l8(e,t){if("error"in e){const a=t.deserialize(e.error);return{ok:!1,error:(0,d_.default)((0,d_.default)({},e),{},{error:a})}}return{ok:!0,result:(0,d_.default)((0,d_.default)({},e.result),(!e.result.type||e.result.type==="data")&&{type:"data",data:t.deserialize(e.result.data)})}}var Rb=class extends Error{constructor(){super("Unable to transform response from server")}};function c8(e,t){let i;try{i=l8(e,t)}catch{throw new Rb}if(!i.ok&&(!Mv(i.error.error)||typeof i.error.error.code!="number"))throw new Rb;if(i.ok&&!Mv(i.result))throw new Rb;return i}i1(X2());var f_=bo(im()),ng=bo(ou());function u8(e){return e instanceof Fp}function h8(e){return Mv(e)&&Mv(e.error)&&typeof e.error.code=="number"&&typeof e.error.message=="string"}function d8(e,t){return typeof e=="string"?e:Mv(e)&&typeof e.message=="string"?e.message:t}var Fp=class D_ extends Error{constructor(t,i){var a,c;const h=i?.cause;super(t,{cause:h}),(0,f_.default)(this,"cause",void 0),(0,f_.default)(this,"shape",void 0),(0,f_.default)(this,"data",void 0),(0,f_.default)(this,"meta",void 0),this.meta=i?.meta,this.cause=h,this.shape=i==null||(a=i.result)===null||a===void 0?void 0:a.error,this.data=i==null||(c=i.result)===null||c===void 0?void 0:c.error.data,this.name="TRPCClientError",Object.setPrototypeOf(this,D_.prototype)}static from(t,i={}){const a=t;return u8(a)?(i.meta&&(a.meta=(0,ng.default)((0,ng.default)({},a.meta),i.meta)),a):h8(a)?new D_(a.error.message,(0,ng.default)((0,ng.default)({},i),{},{result:a})):new D_(d8(a,"Unknown error"),(0,ng.default)((0,ng.default)({},i),{},{cause:a}))}};function f8(e){const t=e;return t?"input"in t?t:{input:t,output:t}:{input:{serialize:i=>i,deserialize:i=>i},output:{serialize:i=>i,deserialize:i=>i}}}bo(ou());bo(ou());bo(ou());bo(ou());const p8={enabled:!1,closeMs:0},m8={enabled:!1,pongTimeoutMs:1e3,intervalMs:5e3},g8=e=>e===0?0:Math.min(1e3*2**e,3e4),Ak=(e,...t)=>typeof e=="function"?e(...t):e;var y8=bo(im()),ig=class Rk extends Error{constructor(t){super(t.message,{cause:t.cause}),this.name="TRPCWebSocketClosedError",Object.setPrototypeOf(this,Rk.prototype)}},v8=class{constructor(e,t){this.onTimeout=e,this.timeoutMs=t,(0,y8.default)(this,"timeout",void 0)}reset(){this.timeout&&(clearTimeout(this.timeout),this.timeout=setTimeout(this.onTimeout,this.timeoutMs))}start(){clearTimeout(this.timeout),this.timeout=setTimeout(this.onTimeout,this.timeoutMs)}stop(){clearTimeout(this.timeout),this.timeout=void 0}};function Dk(){let e,t;return{promise:new Promise((a,c)=>{e=a,t=c}),resolve:e,reject:t}}async function _8(e){const t=await Ak(e.url);if(!e.connectionParams)return t;const a=`${t.includes("?")?"&":"?"}connectionParams=1`;return t+a}async function x8(e){const t={method:"connectionParams",data:await Ak(e)};return JSON.stringify(t)}var MM=bo(im()),b8=class{constructor(){(0,MM.default)(this,"outgoingRequests",new Array),(0,MM.default)(this,"pendingRequests",{})}register(e,t){const{promise:i,resolve:a}=Dk();return this.outgoingRequests.push({id:String(e.id),message:e,end:i,callbacks:{next:t.next,complete:()=>{t.complete(),a()},error:c=>{t.error(c),a()}}}),()=>{this.delete(e.id),t.complete(),a()}}delete(e){e!==null&&(this.outgoingRequests=this.outgoingRequests.filter(({id:t})=>t!==String(e)),delete this.pendingRequests[String(e)])}flush(){const e=this.outgoingRequests;this.outgoingRequests=[];for(const t of e)this.pendingRequests[t.id]=t;return e}getPendingRequests(){return Object.values(this.pendingRequests)}getPendingRequest(e){return e===null?null:this.pendingRequests[String(e)]}getOutgoingRequests(){return this.outgoingRequests}getRequests(){return[...this.getOutgoingRequests().map(e=>({state:"outgoing",message:e.message,end:e.end,callbacks:e.callbacks})),...this.getPendingRequests().map(e=>({state:"pending",message:e.message,end:e.end,callbacks:e.callbacks}))]}hasPendingRequests(){return this.getPendingRequests().length>0}hasPendingSubscriptions(){return this.getPendingRequests().some(e=>e.message.method==="subscription")}hasOutgoingRequests(){return this.outgoingRequests.length>0}},Dp=bo(im());function w8(e){const{promise:t,resolve:i,reject:a}=Dk();return e.addEventListener("open",()=>{e.removeEventListener("error",a),i()}),e.addEventListener("error",a),t}function S8(e,{intervalMs:t,pongTimeoutMs:i}){let a,c;function h(){a=setTimeout(()=>{e.send("PING"),c=setTimeout(()=>{e.close()},i)},t)}function f(){clearTimeout(a),h()}function o(){clearTimeout(c),f()}e.addEventListener("open",h),e.addEventListener("message",({data:b})=>{clearTimeout(a),h(),b==="PONG"&&o()}),e.addEventListener("close",()=>{clearTimeout(a),clearTimeout(c)})}var zk=class Iw{constructor(t){var i;if((0,Dp.default)(this,"id",++Iw.connectCount),(0,Dp.default)(this,"WebSocketPonyfill",void 0),(0,Dp.default)(this,"urlOptions",void 0),(0,Dp.default)(this,"keepAliveOpts",void 0),(0,Dp.default)(this,"wsObservable",Ck(null)),(0,Dp.default)(this,"openPromise",null),this.WebSocketPonyfill=(i=t.WebSocketPonyfill)!==null&&i!==void 0?i:WebSocket,!this.WebSocketPonyfill)throw new Error("No WebSocket implementation found - you probably don't want to use this on the server, but if you do you need to pass a `WebSocket`-ponyfill");this.urlOptions=t.urlOptions,this.keepAliveOpts=t.keepAlive}get ws(){return this.wsObservable.get()}set ws(t){this.wsObservable.next(t)}isOpen(){return!!this.ws&&this.ws.readyState===this.WebSocketPonyfill.OPEN&&!this.openPromise}isClosed(){return!!this.ws&&(this.ws.readyState===this.WebSocketPonyfill.CLOSING||this.ws.readyState===this.WebSocketPonyfill.CLOSED)}async open(){var t=this;if(t.openPromise)return t.openPromise;t.id=++Iw.connectCount;const i=_8(t.urlOptions).then(a=>new t.WebSocketPonyfill(a));t.openPromise=i.then(async a=>{t.ws=a,a.addEventListener("message",function({data:c}){c==="PING"&&this.send("PONG")}),t.keepAliveOpts.enabled&&S8(a,t.keepAliveOpts),a.addEventListener("close",()=>{t.ws===a&&(t.ws=null)}),await w8(a),t.urlOptions.connectionParams&&a.send(await x8(t.urlOptions.connectionParams))});try{await t.openPromise}finally{t.openPromise=null}}async close(){var t=this;try{await t.openPromise}finally{var i;(i=t.ws)===null||i===void 0||i.close()}}};(0,Dp.default)(zk,"connectCount",0);function C8(e){return e.isOpen()?{id:e.id,state:"open",ws:e.ws}:e.isClosed()?{id:e.id,state:"closed",ws:e.ws}:e.ws?{id:e.id,state:"connecting",ws:e.ws}:null}var Jh=bo(im()),og=bo(ou()),T8=class{constructor(e){var t;(0,Jh.default)(this,"connectionState",void 0),(0,Jh.default)(this,"allowReconnect",!1),(0,Jh.default)(this,"requestManager",new b8),(0,Jh.default)(this,"activeConnection",void 0),(0,Jh.default)(this,"reconnectRetryDelay",void 0),(0,Jh.default)(this,"inactivityTimeout",void 0),(0,Jh.default)(this,"callbacks",void 0),(0,Jh.default)(this,"lazyMode",void 0),(0,Jh.default)(this,"reconnecting",null),this.callbacks={onOpen:e.onOpen,onClose:e.onClose,onError:e.onError};const i=(0,og.default)((0,og.default)({},p8),e.lazy);this.inactivityTimeout=new v8(()=>{if(this.requestManager.hasOutgoingRequests()||this.requestManager.hasPendingRequests()){this.inactivityTimeout.reset();return}this.close().catch(()=>null)},i.closeMs),this.activeConnection=new zk({WebSocketPonyfill:e.WebSocket,urlOptions:e,keepAlive:(0,og.default)((0,og.default)({},m8),e.keepAlive)}),this.activeConnection.wsObservable.subscribe({next:a=>{a&&this.setupWebSocketListeners(a)}}),this.reconnectRetryDelay=(t=e.retryDelayMs)!==null&&t!==void 0?t:g8,this.lazyMode=i.enabled,this.connectionState=Ck({type:"state",state:i.enabled?"idle":"connecting",error:null}),this.lazyMode||this.open().catch(()=>null)}async open(){var e=this;e.allowReconnect=!0,e.connectionState.get().state==="idle"&&e.connectionState.next({type:"state",state:"connecting",error:null});try{await e.activeConnection.open()}catch(t){return e.reconnect(new ig({message:"Initialization error",cause:t})),e.reconnecting}}async close(){var e=this;e.allowReconnect=!1,e.inactivityTimeout.stop();const t=[];for(const i of e.requestManager.getRequests())i.message.method==="subscription"?i.callbacks.complete():i.state==="outgoing"?i.callbacks.error(Fp.from(new ig({message:"Closed before connection was established"}))):t.push(i.end);await Promise.all(t).catch(()=>null),await e.activeConnection.close().catch(()=>null),e.connectionState.next({type:"state",state:"idle",error:null})}request({op:{id:e,type:t,path:i,input:a,signal:c},transformer:h,lastEventId:f}){return Qv(o=>{const b=this.batchSend({id:e,method:t,params:{input:h.input.serialize(a),path:i,lastEventId:f}},(0,og.default)((0,og.default)({},o),{},{next(P){const I=c8(P,h.output);if(!I.ok){o.error(Fp.from(I.error));return}o.next({result:I.result})}}));return()=>{b(),t==="subscription"&&this.activeConnection.isOpen()&&this.send({id:e,method:"subscription.stop"}),c?.removeEventListener("abort",b)}})}get connection(){return C8(this.activeConnection)}reconnect(e){var t=this;if(this.connectionState.next({type:"state",state:"connecting",error:Fp.from(e)}),this.reconnecting)return;const i=async a=>{try{await CM(t.reconnectRetryDelay(a)),t.allowReconnect&&(await t.activeConnection.close(),await t.activeConnection.open(),t.requestManager.hasPendingRequests()&&t.send(t.requestManager.getPendingRequests().map(({message:c})=>c))),t.reconnecting=null}catch{await i(a+1)}};this.reconnecting=i(0)}setupWebSocketListeners(e){var t=this;const i=a=>{const c=this.requestManager.getPendingRequests();for(const{message:h,callbacks:f}of c)h.method!=="subscription"&&(f.error(Fp.from(a??new ig({message:"WebSocket closed",cause:a}))),this.requestManager.delete(h.id))};e.addEventListener("open",()=>{SM(async()=>{var a,c;t.lazyMode&&t.inactivityTimeout.start(),(a=(c=t.callbacks).onOpen)===null||a===void 0||a.call(c),t.connectionState.next({type:"state",state:"pending",error:null})}).catch(a=>{e.close(3e3),i(a)})}),e.addEventListener("message",({data:a})=>{if(this.inactivityTimeout.reset(),typeof a!="string"||["PING","PONG"].includes(a))return;const c=JSON.parse(a);if("method"in c){this.handleIncomingRequest(c);return}this.handleResponseMessage(c)}),e.addEventListener("close",a=>{var c,h;i(a),(c=(h=this.callbacks).onClose)===null||c===void 0||c.call(h,a),(!this.lazyMode||this.requestManager.hasPendingSubscriptions())&&this.reconnect(new ig({message:"WebSocket closed",cause:a}))}),e.addEventListener("error",a=>{var c,h;i(a),(c=(h=this.callbacks).onError)===null||c===void 0||c.call(h,a),this.reconnect(new ig({message:"WebSocket closed",cause:a}))})}handleResponseMessage(e){const t=this.requestManager.getPendingRequest(e.id);if(!t)return;t.callbacks.next(e);let i=!0;"result"in e&&t.message.method==="subscription"&&(e.result.type==="data"&&(t.message.params.lastEventId=e.result.id),e.result.type!=="stopped"&&(i=!1)),i&&(t.callbacks.complete(),this.requestManager.delete(e.id))}handleIncomingRequest(e){e.method==="reconnect"&&this.reconnect(new ig({message:"Server requested reconnect"}))}send(e){if(!this.activeConnection.isOpen())throw new Error("Active connection is not open");const t=e instanceof Array?e:[e];this.activeConnection.ws.send(JSON.stringify(t.length===1?t[0]:t))}batchSend(e,t){var i=this;return this.inactivityTimeout.reset(),SM(async()=>{i.activeConnection.isOpen()||await i.open(),await CM(0),i.requestManager.hasOutgoingRequests()&&i.send(i.requestManager.flush().map(({message:a})=>a))}).catch(a=>{this.requestManager.delete(e.id),t.error(Fp.from(a))}),this.requestManager.register(e,t)}};function M8(e){return new T8(e)}function P8(e){const{client:t}=e,i=f8(e.transformer);return()=>({op:a})=>Qv(c=>{const h=a.type==="subscription"?t.connectionState.subscribe({next(o){c.next({result:o,context:a.context})}}):null,f=t.request({op:a,transformer:i}).subscribe(c);return()=>{f.unsubscribe(),h?.unsubscribe()}})}var Db=bo(im()),PM=bo(ou()),E8=class{constructor(e){(0,Db.default)(this,"links",void 0),(0,Db.default)(this,"runtime",void 0),(0,Db.default)(this,"requestId",void 0),this.requestId=0,this.runtime={},this.links=e.links.map(t=>t(this.runtime))}$request(e){var t;return YN({links:this.links,op:(0,PM.default)((0,PM.default)({},e),{},{context:(t=e.context)!==null&&t!==void 0?t:{},id:++this.requestId})}).pipe(KN())}async requestAsPromise(e){var t=this;try{const i=t.$request(e);return(await XN(i)).result.data}catch(i){throw Fp.from(i)}}query(e,t,i){return this.requestAsPromise({type:"query",path:e,input:t,context:i?.context,signal:i?.signal})}mutation(e,t,i){return this.requestAsPromise({type:"mutation",path:e,input:t,context:i?.context,signal:i?.signal})}subscription(e,t,i){return this.$request({type:"subscription",path:e,input:t,context:i.context,signal:i.signal}).subscribe({next(c){switch(c.result.type){case"state":{var h;(h=i.onConnectionStateChange)===null||h===void 0||h.call(i,c.result);break}case"started":{var f;(f=i.onStarted)===null||f===void 0||f.call(i,{context:c.context});break}case"stopped":{var o;(o=i.onStopped)===null||o===void 0||o.call(i);break}case"data":case void 0:{var b;(b=i.onData)===null||b===void 0||b.call(i,c.result.data);break}}},error(c){var h;(h=i.onError)===null||h===void 0||h.call(i,c)},complete(){var c;(c=i.onComplete)===null||c===void 0||c.call(i)}})}};const I8=Symbol.for("trpc_untypedClient"),k8={query:"query",mutate:"mutation",subscribe:"subscription"},A8=e=>k8[e];function R8(e){const t=i8(({path:i,args:a})=>{const c=[...i],h=A8(c.pop()),f=c.join(".");return e[h](f,...a)});return o8(i=>i===I8?e:t[i])}function D8(e){const t=new E8(e);return R8(t)}bo(ou());bo(ou());var z8=ah({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/asyncIterator.js"(e,t){function i(c){var h,f,o,b=2;for(typeof Symbol<"u"&&(f=Symbol.asyncIterator,o=Symbol.iterator);b--;){if(f&&(h=c[f])!=null)return h.call(c);if(o&&(h=c[o])!=null)return new a(h.call(c));f="@@asyncIterator",o="@@iterator"}throw new TypeError("Object is not async iterable")}function a(c){function h(f){if(Object(f)!==f)return Promise.reject(new TypeError(f+" is not an object."));var o=f.done;return Promise.resolve(f.value).then(function(b){return{value:b,done:o}})}return a=function(o){this.s=o,this.n=o.next},a.prototype={s:null,n:null,next:function(){return h(this.n.apply(this.s,arguments))},return:function(o){var b=this.s.return;return b===void 0?Promise.resolve({value:o,done:!0}):h(b.apply(this.s,arguments))},throw:function(o){var b=this.s.return;return b===void 0?Promise.reject(o):h(b.apply(this.s,arguments))}},new a(c)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}});bo(z8());bo(ou());var O8=ah({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/usingCtx.js"(e,t){function i(){var a=typeof SuppressedError=="function"?SuppressedError:function(o,b){var P=Error();return P.name="SuppressedError",P.error=o,P.suppressed=b,P},c={},h=[];function f(o,b){if(b!=null){if(Object(b)!==b)throw new TypeError("using declarations can only be used with objects, functions, null, or undefined.");if(o)var P=b[Symbol.asyncDispose||Symbol.for("Symbol.asyncDispose")];if(P===void 0&&(P=b[Symbol.dispose||Symbol.for("Symbol.dispose")],o))var I=P;if(typeof P!="function")throw new TypeError("Object is not disposable.");I&&(P=function(){try{I.call(b)}catch(z){return Promise.reject(z)}}),h.push({v:b,d:P,a:o})}else o&&h.push({d:b,a:o});return b}return{e:c,u:f.bind(null,!1),a:f.bind(null,!0),d:function(){var b,P=this.e,I=0;function D(){for(;b=h.pop();)try{if(!b.a&&I===1)return I=0,h.push(b),Promise.resolve().then(D);if(b.d){var F=b.d.call(b.v);if(b.a)return I|=2,Promise.resolve(F).then(D,z)}else I|=1}catch(U){return z(U)}if(I===1)return P!==c?Promise.reject(P):Promise.resolve();if(P!==c)throw P}function z(F){return P=P!==c?new a(F,P):F,D()}return D()}}}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}}),Ok=ah({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/OverloadYield.js"(e,t){function i(a,c){this.v=a,this.k=c}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}}),L8=ah({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/awaitAsyncGenerator.js"(e,t){var i=Ok();function a(c){return new i(c,0)}t.exports=a,t.exports.__esModule=!0,t.exports.default=t.exports}}),F8=ah({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/wrapAsyncGenerator.js"(e,t){var i=Ok();function a(h){return function(){return new c(h.apply(this,arguments))}}function c(h){var f,o;function b(I,D){try{var z=h[I](D),F=z.value,U=F instanceof i;Promise.resolve(U?F.v:F).then(function($){if(U){var j=I==="return"?"return":"next";if(!F.k||$.done)return b(j,$);$=h[j]($).value}P(z.done?"return":"normal",$)},function($){b("throw",$)})}catch($){P("throw",$)}}function P(I,D){switch(I){case"return":f.resolve({value:D,done:!0});break;case"throw":f.reject(D);break;default:f.resolve({value:D,done:!1})}(f=f.next)?b(f.key,f.arg):o=null}this._invoke=function(I,D){return new Promise(function(z,F){var U={key:I,arg:D,resolve:z,reject:F,next:null};o?o=o.next=U:(f=o=U,b(I,D))})},typeof h.return!="function"&&(this.return=void 0)}c.prototype[typeof Symbol=="function"&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},c.prototype.next=function(h){return this._invoke("next",h)},c.prototype.throw=function(h){return this._invoke("throw",h)},c.prototype.return=function(h){return this._invoke("return",h)},t.exports=a,t.exports.__esModule=!0,t.exports.default=t.exports}});bo(O8());bo(L8());bo(F8());bo(ou());function kn(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];throw new Error(typeof e=="number"?"[MobX] minified error nr: "+e+(i.length?" "+i.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+e)}var B8={};function o1(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:B8}var Lk=Object.assign,rx=Object.getOwnPropertyDescriptor,eh=Object.defineProperty,s1=Object.prototype,kw=[];Object.freeze(kw);var K2={};Object.freeze(K2);var $8=typeof Proxy<"u",j8=Object.toString();function Fk(){$8||kn("Proxy not available")}function Bk(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}var pg=function(){};function tu(e){return typeof e=="function"}function Zp(e){var t=typeof e;switch(t){case"string":case"symbol":case"number":return!0}return!1}function a1(e){return e!==null&&typeof e=="object"}function ld(e){if(!a1(e))return!1;var t=Object.getPrototypeOf(e);if(t==null)return!0;var i=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i.toString()===j8}function $k(e){var t=e?.constructor;return t?t.name==="GeneratorFunction"||t.displayName==="GeneratorFunction":!1}function t0(e,t,i){eh(e,t,{enumerable:!1,writable:!0,configurable:!0,value:i})}function jk(e,t,i){eh(e,t,{enumerable:!1,writable:!1,configurable:!0,value:i})}function om(e,t){var i="isMobX"+e;return t.prototype[i]=!0,function(a){return a1(a)&&a[i]===!0}}function Yg(e){return e!=null&&Object.prototype.toString.call(e)==="[object Map]"}function N8(e){var t=Object.getPrototypeOf(e),i=Object.getPrototypeOf(t),a=Object.getPrototypeOf(i);return a===null}function td(e){return e!=null&&Object.prototype.toString.call(e)==="[object Set]"}var Nk=typeof Object.getOwnPropertySymbols<"u";function V8(e){var t=Object.keys(e);if(!Nk)return t;var i=Object.getOwnPropertySymbols(e);return i.length?[].concat(t,i.filter(function(a){return s1.propertyIsEnumerable.call(e,a)})):t}var jg=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Nk?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function Vk(e){return e===null?null:typeof e=="object"?""+e:e}function nd(e,t){return s1.hasOwnProperty.call(e,t)}var U8=Object.getOwnPropertyDescriptors||function(t){var i={};return jg(t).forEach(function(a){i[a]=rx(t,a)}),i};function ol(e,t){return!!(e&t)}function sl(e,t,i){return i?e|=t:e&=~t,e}function EM(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=Array(t);i<t;i++)a[i]=e[i];return a}function G8(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,H8(a.key),a)}}function Jg(e,t,i){return t&&G8(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function mg(e,t){var i=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i)return(i=i.call(e)).next.bind(i);if(Array.isArray(e)||(i=W8(e))||t){i&&(e=i);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mf(){return Mf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)({}).hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},Mf.apply(null,arguments)}function Uk(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Aw(e,t)}function Aw(e,t){return Aw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},Aw(e,t)}function q8(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function H8(e){var t=q8(e,"string");return typeof t=="symbol"?t:t+""}function W8(e,t){if(e){if(typeof e=="string")return EM(e,t);var i={}.toString.call(e).slice(8,-1);return i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set"?Array.from(e):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?EM(e,t):void 0}}var Xu=Symbol("mobx-stored-annotations");function th(e){function t(i,a){if(n0(a))return e.decorate_20223_(i,a);r0(i,a,e)}return Object.assign(t,e)}function r0(e,t,i){nd(e,Xu)||t0(e,Xu,Mf({},e[Xu])),e7(i)||(e[Xu][t]=i)}function Z8(e){return nd(e,Xu)||t0(e,Xu,Mf({},e[Xu])),e[Xu]}function n0(e){return typeof e=="object"&&typeof e.kind=="string"}var jr=Symbol("mobx administration"),Df=function(){function e(i){i===void 0&&(i="Atom"),this.name_=void 0,this.flags_=0,this.observers_=new Set,this.lastAccessedBy_=0,this.lowestObserverState_=Dn.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=i}var t=e.prototype;return t.onBO=function(){this.onBOL&&this.onBOL.forEach(function(a){return a()})},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(a){return a()})},t.reportObserved=function(){return aA(this)},t.reportChanged=function(){Kl(),lA(this),Yl()},t.toString=function(){return this.name_},Jg(e,[{key:"isBeingObserved",get:function(){return ol(this.flags_,e.isBeingObservedMask_)},set:function(a){this.flags_=sl(this.flags_,e.isBeingObservedMask_,a)}},{key:"isPendingUnobservation",get:function(){return ol(this.flags_,e.isPendingUnobservationMask_)},set:function(a){this.flags_=sl(this.flags_,e.isPendingUnobservationMask_,a)}},{key:"diffValue",get:function(){return ol(this.flags_,e.diffValueMask_)?1:0},set:function(a){this.flags_=sl(this.flags_,e.diffValueMask_,a===1)}}])}();Df.isBeingObservedMask_=1;Df.isPendingUnobservationMask_=2;Df.diffValueMask_=4;var Y2=om("Atom",Df);function Gk(e,t,i){t===void 0&&(t=pg),i===void 0&&(i=pg);var a=new Df(e);return t!==pg&&tV(a,t),i!==pg&&gA(a,i),a}function X8(e,t){return AA(e,t)}function K8(e,t){return Object.is?Object.is(e,t):e===t?e!==0||1/e===1/t:e!==e&&t!==t}var Pf={structural:X8,default:K8};function Xp(e,t,i){return wA(e)?e:Array.isArray(e)?bi.array(e,{name:i}):ld(e)?bi.object(e,void 0,{name:i}):Yg(e)?bi.map(e,{name:i}):td(e)?bi.set(e,{name:i}):typeof e=="function"&&!Ev(e)&&!Iv(e)?$k(e)?Ng(e):Pv(i,e):e}function Y8(e,t,i){if(e==null||p1(e)||f1(e)||am(e)||Wu(e))return e;if(Array.isArray(e))return bi.array(e,{name:i,deep:!1});if(ld(e))return bi.object(e,void 0,{name:i,deep:!1});if(Yg(e))return bi.map(e,{name:i,deep:!1});if(td(e))return bi.set(e,{name:i,deep:!1})}function l1(e){return e}function J8(e,t){return AA(e,t)?t:e}var Q8="override";function e7(e){return e.annotationType_===Q8}function i0(e,t){return{annotationType_:e,options_:t,make_:t7,extend_:r7,decorate_20223_:n7}}function t7(e,t,i,a){var c;if((c=this.options_)!=null&&c.bound)return this.extend_(e,t,i,!1)===null?0:1;if(a===e.target_)return this.extend_(e,t,i,!1)===null?0:2;if(Ev(i.value))return 1;var h=qk(e,this,t,i,!1);return eh(a,t,h),2}function r7(e,t,i,a){var c=qk(e,this,t,i);return e.defineProperty_(t,c,a)}function n7(e,t){var i=t.kind,a=t.name,c=t.addInitializer,h=this,f=function(P){var I,D,z,F;return Ef((I=(D=h.options_)==null?void 0:D.name)!=null?I:a.toString(),P,(z=(F=h.options_)==null?void 0:F.autoAction)!=null?z:!1)};if(i=="field")return function(b){var P,I=b;return Ev(I)||(I=f(I)),(P=h.options_)!=null&&P.bound&&(I=I.bind(this),I.isMobxAction=!0),I};if(i=="method"){var o;return Ev(e)||(e=f(e)),(o=this.options_)!=null&&o.bound&&c(function(){var b=this,P=b[a].bind(b);P.isMobxAction=!0,b[a]=P}),e}kn("Cannot apply '"+h.annotationType_+"' to '"+String(a)+"' (kind: "+i+"):"+(`
'`+h.annotationType_+"' can only be used on properties with a function value."))}function i7(e,t,i,a){t.annotationType_,a.value}function qk(e,t,i,a,c){var h,f,o,b,P,I,D;c===void 0&&(c=er.safeDescriptors),i7(e,t,i,a);var z=a.value;if((h=t.options_)!=null&&h.bound){var F;z=z.bind((F=e.proxy_)!=null?F:e.target_)}return{value:Ef((f=(o=t.options_)==null?void 0:o.name)!=null?f:i.toString(),z,(b=(P=t.options_)==null?void 0:P.autoAction)!=null?b:!1,(I=t.options_)!=null&&I.bound?(D=e.proxy_)!=null?D:e.target_:void 0),configurable:c?e.isPlainObject_:!0,enumerable:!1,writable:!c}}function Hk(e,t){return{annotationType_:e,options_:t,make_:o7,extend_:s7,decorate_20223_:a7}}function o7(e,t,i,a){var c;if(a===e.target_)return this.extend_(e,t,i,!1)===null?0:2;if((c=this.options_)!=null&&c.bound&&(!nd(e.target_,t)||!Iv(e.target_[t]))&&this.extend_(e,t,i,!1)===null)return 0;if(Iv(i.value))return 1;var h=Wk(e,this,t,i,!1,!1);return eh(a,t,h),2}function s7(e,t,i,a){var c,h=Wk(e,this,t,i,(c=this.options_)==null?void 0:c.bound);return e.defineProperty_(t,h,a)}function a7(e,t){var i,a=t.name,c=t.addInitializer;return Iv(e)||(e=Ng(e)),(i=this.options_)!=null&&i.bound&&c(function(){var h=this,f=h[a].bind(h);f.isMobXFlow=!0,h[a]=f}),e}function l7(e,t,i,a){t.annotationType_,a.value}function Wk(e,t,i,a,c,h){h===void 0&&(h=er.safeDescriptors),l7(e,t,i,a);var f=a.value;if(Iv(f)||(f=Ng(f)),c){var o;f=f.bind((o=e.proxy_)!=null?o:e.target_),f.isMobXFlow=!0}return{value:f,configurable:h?e.isPlainObject_:!0,enumerable:!1,writable:!h}}function J2(e,t){return{annotationType_:e,options_:t,make_:c7,extend_:u7,decorate_20223_:h7}}function c7(e,t,i){return this.extend_(e,t,i,!1)===null?0:1}function u7(e,t,i,a){return d7(e,this,t,i),e.defineComputedProperty_(t,Mf({},this.options_,{get:i.get,set:i.set}),a)}function h7(e,t){var i=this,a=t.name,c=t.addInitializer;return c(function(){var h=lm(this)[jr],f=Mf({},i.options_,{get:e,context:this});f.name||(f.name="ObservableObject."+a.toString()),h.values_.set(a,new ru(f))}),function(){return this[jr].getObservablePropValue_(a)}}function d7(e,t,i,a){t.annotationType_,a.get}function c1(e,t){return{annotationType_:e,options_:t,make_:f7,extend_:p7,decorate_20223_:m7}}function f7(e,t,i){return this.extend_(e,t,i,!1)===null?0:1}function p7(e,t,i,a){var c,h;return g7(e,this),e.defineObservableProperty_(t,i.value,(c=(h=this.options_)==null?void 0:h.enhancer)!=null?c:Xp,a)}function m7(e,t){var i=this,a=t.kind,c=t.name,h=new WeakSet;function f(o,b){var P,I,D=lm(o)[jr],z=new Up(b,(P=(I=i.options_)==null?void 0:I.enhancer)!=null?P:Xp,"ObservableObject."+c.toString(),!1);D.values_.set(c,z),h.add(o)}if(a=="accessor")return{get:function(){return h.has(this)||f(this,e.get.call(this)),this[jr].getObservablePropValue_(c)},set:function(b){return h.has(this)||f(this,b),this[jr].setObservablePropValue_(c,b)},init:function(b){return h.has(this)||f(this,b),b}}}function g7(e,t,i,a){t.annotationType_}var y7="true",v7=Zk();function Zk(e){return{annotationType_:y7,options_:e,make_:_7,extend_:x7,decorate_20223_:b7}}function _7(e,t,i,a){var c,h;if(i.get)return Sf.make_(e,t,i,a);if(i.set){var f=Ef(t.toString(),i.set);return a===e.target_?e.defineProperty_(t,{configurable:er.safeDescriptors?e.isPlainObject_:!0,set:f})===null?0:2:(eh(a,t,{configurable:!0,set:f}),2)}if(a!==e.target_&&typeof i.value=="function"){var o;if($k(i.value)){var b,P=(b=this.options_)!=null&&b.autoBind?Ng.bound:Ng;return P.make_(e,t,i,a)}var I=(o=this.options_)!=null&&o.autoBind?Pv.bound:Pv;return I.make_(e,t,i,a)}var D=((c=this.options_)==null?void 0:c.deep)===!1?bi.ref:bi;if(typeof i.value=="function"&&(h=this.options_)!=null&&h.autoBind){var z;i.value=i.value.bind((z=e.proxy_)!=null?z:e.target_)}return D.make_(e,t,i,a)}function x7(e,t,i,a){var c,h;if(i.get)return Sf.extend_(e,t,i,a);if(i.set)return e.defineProperty_(t,{configurable:er.safeDescriptors?e.isPlainObject_:!0,set:Ef(t.toString(),i.set)},a);if(typeof i.value=="function"&&(c=this.options_)!=null&&c.autoBind){var f;i.value=i.value.bind((f=e.proxy_)!=null?f:e.target_)}var o=((h=this.options_)==null?void 0:h.deep)===!1?bi.ref:bi;return o.extend_(e,t,i,a)}function b7(e,t){kn("'"+this.annotationType_+"' cannot be used as a decorator")}var w7="observable",S7="observable.ref",C7="observable.shallow",T7="observable.struct",Xk={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(Xk);function p_(e){return e||Xk}var Rw=c1(w7),M7=c1(S7,{enhancer:l1}),P7=c1(C7,{enhancer:Y8}),E7=c1(T7,{enhancer:J8}),Kk=th(Rw);function m_(e){return e.deep===!0?Xp:e.deep===!1?l1:k7(e.defaultDecorator)}function I7(e){var t;return e?(t=e.defaultDecorator)!=null?t:Zk(e):void 0}function k7(e){var t,i;return e&&(t=(i=e.options_)==null?void 0:i.enhancer)!=null?t:Xp}function Yk(e,t,i){if(n0(t))return Rw.decorate_20223_(e,t);if(Zp(t)){r0(e,t,Rw);return}return wA(e)?e:ld(e)?bi.object(e,t,i):Array.isArray(e)?bi.array(e,t):Yg(e)?bi.map(e,t):td(e)?bi.set(e,t):typeof e=="object"&&e!==null?e:bi.box(e,t)}Lk(Yk,Kk);var A7={box:function(t,i){var a=p_(i);return new Up(t,m_(a),a.name,!0,a.equals)},array:function(t,i){var a=p_(i);return(er.useProxies===!1||a.proxy===!1?MV:gV)(t,m_(a),a.name)},map:function(t,i){var a=p_(i);return new TA(t,m_(a),a.name)},set:function(t,i){var a=p_(i);return new MA(t,m_(a),a.name)},object:function(t,i,a){return zf(function(){return _A(er.useProxies===!1||a?.proxy===!1?lm({},a):dV({},a),t,i)})},ref:th(M7),shallow:th(P7),deep:Kk,struct:th(E7)},bi=Lk(Yk,A7),Jk="computed",R7="computed.struct",Dw=J2(Jk),D7=J2(R7,{equals:Pf.structural}),Sf=function(t,i){if(n0(i))return Dw.decorate_20223_(t,i);if(Zp(i))return r0(t,i,Dw);if(ld(t))return th(J2(Jk,t));var a=ld(i)?i:{};return a.get=t,a.name||(a.name=t.name||""),new ru(a)};Object.assign(Sf,Dw);Sf.struct=th(D7);var IM,kM,nx=0,z7=1,O7=(IM=(kM=rx(function(){},"name"))==null?void 0:kM.configurable)!=null?IM:!1,AM={value:"action",configurable:!0,writable:!1,enumerable:!1};function Ef(e,t,i,a){i===void 0&&(i=!1);function c(){return Qk(e,i,t,a||this,arguments)}return c.isMobxAction=!0,c.toString=function(){return t.toString()},O7&&(AM.value=e,eh(c,"name",AM)),c}function Qk(e,t,i,a,c){var h=L7(e,t);try{return i.apply(a,c)}catch(f){throw h.error_=f,f}finally{F7(h)}}function L7(e,t,i,a){var c=!1,h=0,f=er.trackingDerivation,o=!t||!f;Kl();var b=er.allowStateChanges;o&&(sm(),b=u1(!0));var P=Q2(!0),I={runAsAction_:o,prevDerivation_:f,prevAllowStateChanges_:b,prevAllowStateReads_:P,notifySpy_:c,startTime_:h,actionId_:z7++,parentActionId_:nx};return nx=I.actionId_,I}function F7(e){nx!==e.actionId_&&kn(30),nx=e.parentActionId_,e.error_!==void 0&&(er.suppressReactionErrors=!0),h1(e.prevAllowStateChanges_),nv(e.prevAllowStateReads_),Yl(),e.runAsAction_&&id(e.prevDerivation_),er.suppressReactionErrors=!1}function eA(e,t){var i=u1(e);try{return t()}finally{h1(i)}}function u1(e){var t=er.allowStateChanges;return er.allowStateChanges=e,t}function h1(e){er.allowStateChanges=e}var Up=function(e){function t(a,c,h,f,o){var b;return h===void 0&&(h="ObservableValue"),o===void 0&&(o=Pf.default),b=e.call(this,h)||this,b.enhancer=void 0,b.name_=void 0,b.equals=void 0,b.hasUnreportedChange_=!1,b.interceptors_=void 0,b.changeListeners_=void 0,b.value_=void 0,b.dehancer=void 0,b.enhancer=c,b.name_=h,b.equals=o,b.value_=c(a,void 0,h),b}Uk(t,e);var i=t.prototype;return i.dehanceValue=function(c){return this.dehancer!==void 0?this.dehancer(c):c},i.set=function(c){this.value_,c=this.prepareNewValue_(c),c!==er.UNCHANGED&&this.setNewValue_(c)},i.prepareNewValue_=function(c){if(Wl(this)){var h=Zl(this,{object:this,type:rh,newValue:c});if(!h)return er.UNCHANGED;c=h.newValue}return c=this.enhancer(c,this.value_,this.name_),this.equals(this.value_,c)?er.UNCHANGED:c},i.setNewValue_=function(c){var h=this.value_;this.value_=c,this.reportChanged(),Yc(this)&&Jc(this,{type:rh,object:this,newValue:c,oldValue:h})},i.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},i.intercept_=function(c){return o0(this,c)},i.observe_=function(c,h){return h&&c({observableKind:"value",debugObjectName:this.name_,object:this,type:rh,newValue:this.value_,oldValue:void 0}),s0(this,c)},i.raw=function(){return this.value_},i.toJSON=function(){return this.get()},i.toString=function(){return this.name_+"["+this.value_+"]"},i.valueOf=function(){return Vk(this.get())},i[Symbol.toPrimitive]=function(){return this.valueOf()},t}(Df),ru=function(){function e(i){this.dependenciesState_=Dn.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.observers_=new Set,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=Dn.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new ox(null),this.name_=void 0,this.triggeredBy_=void 0,this.flags_=0,this.derivation=void 0,this.setter_=void 0,this.isTracing_=ix.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,i.get||kn(31),this.derivation=i.get,this.name_=i.name||"ComputedValue",i.set&&(this.setter_=Ef("ComputedValue-setter",i.set)),this.equals_=i.equals||(i.compareStructural||i.struct?Pf.structural:Pf.default),this.scope_=i.context,this.requiresReaction_=i.requiresReaction,this.keepAlive_=!!i.keepAlive}var t=e.prototype;return t.onBecomeStale_=function(){V7(this)},t.onBO=function(){this.onBOL&&this.onBOL.forEach(function(a){return a()})},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(a){return a()})},t.get=function(){if(this.isComputing&&kn(32,this.name_,this.derivation),er.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)zw(this)&&(this.warnAboutUntrackedRead_(),Kl(),this.value_=this.computeValue_(!1),Yl());else if(aA(this),zw(this)){var a=er.trackingContext;this.keepAlive_&&!a&&(er.trackingContext=this),this.trackAndCompute()&&N7(this),er.trackingContext=a}var c=this.value_;if(z_(c))throw c.cause;return c},t.set=function(a){if(this.setter_){this.isRunningSetter&&kn(33,this.name_),this.isRunningSetter=!0;try{this.setter_.call(this.scope_,a)}finally{this.isRunningSetter=!1}}else kn(34,this.name_)},t.trackAndCompute=function(){var a=this.value_,c=this.dependenciesState_===Dn.NOT_TRACKING_,h=this.computeValue_(!0),f=c||z_(a)||z_(h)||!this.equals_(a,h);return f&&(this.value_=h),f},t.computeValue_=function(a){this.isComputing=!0;var c=u1(!1),h;if(a)h=tA(this,this.derivation,this.scope_);else if(er.disableErrorBoundaries===!0)h=this.derivation.call(this.scope_);else try{h=this.derivation.call(this.scope_)}catch(f){h=new ox(f)}return h1(c),this.isComputing=!1,h},t.suspend_=function(){this.keepAlive_||(Ow(this),this.value_=void 0)},t.observe_=function(a,c){var h=this,f=!0,o=void 0;return pA(function(){var b=h.get();if(!f||c){var P=sm();a({observableKind:"computed",debugObjectName:h.name_,type:rh,object:h,newValue:b,oldValue:o}),id(P)}f=!1,o=b})},t.warnAboutUntrackedRead_=function(){},t.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},t.valueOf=function(){return Vk(this.get())},t[Symbol.toPrimitive]=function(){return this.valueOf()},Jg(e,[{key:"isComputing",get:function(){return ol(this.flags_,e.isComputingMask_)},set:function(a){this.flags_=sl(this.flags_,e.isComputingMask_,a)}},{key:"isRunningSetter",get:function(){return ol(this.flags_,e.isRunningSetterMask_)},set:function(a){this.flags_=sl(this.flags_,e.isRunningSetterMask_,a)}},{key:"isBeingObserved",get:function(){return ol(this.flags_,e.isBeingObservedMask_)},set:function(a){this.flags_=sl(this.flags_,e.isBeingObservedMask_,a)}},{key:"isPendingUnobservation",get:function(){return ol(this.flags_,e.isPendingUnobservationMask_)},set:function(a){this.flags_=sl(this.flags_,e.isPendingUnobservationMask_,a)}},{key:"diffValue",get:function(){return ol(this.flags_,e.diffValueMask_)?1:0},set:function(a){this.flags_=sl(this.flags_,e.diffValueMask_,a===1)}}])}();ru.isComputingMask_=1;ru.isRunningSetterMask_=2;ru.isBeingObservedMask_=4;ru.isPendingUnobservationMask_=8;ru.diffValueMask_=16;var d1=om("ComputedValue",ru),Dn;(function(e){e[e.NOT_TRACKING_=-1]="NOT_TRACKING_",e[e.UP_TO_DATE_=0]="UP_TO_DATE_",e[e.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",e[e.STALE_=2]="STALE_"})(Dn||(Dn={}));var ix;(function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"})(ix||(ix={}));var ox=function(t){this.cause=void 0,this.cause=t};function z_(e){return e instanceof ox}function zw(e){switch(e.dependenciesState_){case Dn.UP_TO_DATE_:return!1;case Dn.NOT_TRACKING_:case Dn.STALE_:return!0;case Dn.POSSIBLY_STALE_:{for(var t=Q2(!0),i=sm(),a=e.observing_,c=a.length,h=0;h<c;h++){var f=a[h];if(d1(f)){if(er.disableErrorBoundaries)f.get();else try{f.get()}catch{return id(i),nv(t),!0}if(e.dependenciesState_===Dn.STALE_)return id(i),nv(t),!0}}return nA(e),id(i),nv(t),!1}}}function tA(e,t,i){var a=Q2(!0);nA(e),e.newObserving_=new Array(e.runId_===0?100:e.observing_.length),e.unboundDepsCount_=0,e.runId_=++er.runId;var c=er.trackingDerivation;er.trackingDerivation=e,er.inBatch++;var h;if(er.disableErrorBoundaries===!0)h=t.call(i);else try{h=t.call(i)}catch(f){h=new ox(f)}return er.inBatch--,er.trackingDerivation=c,B7(e),nv(a),h}function B7(e){for(var t=e.observing_,i=e.observing_=e.newObserving_,a=Dn.UP_TO_DATE_,c=0,h=e.unboundDepsCount_,f=0;f<h;f++){var o=i[f];o.diffValue===0&&(o.diffValue=1,c!==f&&(i[c]=o),c++),o.dependenciesState_>a&&(a=o.dependenciesState_)}for(i.length=c,e.newObserving_=null,h=t.length;h--;){var b=t[h];b.diffValue===0&&oA(b,e),b.diffValue=0}for(;c--;){var P=i[c];P.diffValue===1&&(P.diffValue=0,j7(P,e))}a!==Dn.UP_TO_DATE_&&(e.dependenciesState_=a,e.onBecomeStale_())}function Ow(e){var t=e.observing_;e.observing_=[];for(var i=t.length;i--;)oA(t[i],e);e.dependenciesState_=Dn.NOT_TRACKING_}function rA(e){var t=sm();try{return e()}finally{id(t)}}function sm(){var e=er.trackingDerivation;return er.trackingDerivation=null,e}function id(e){er.trackingDerivation=e}function Q2(e){var t=er.allowStateReads;return er.allowStateReads=e,t}function nv(e){er.allowStateReads=e}function nA(e){if(e.dependenciesState_!==Dn.UP_TO_DATE_){e.dependenciesState_=Dn.UP_TO_DATE_;for(var t=e.observing_,i=t.length;i--;)t[i].lowestObserverState_=Dn.UP_TO_DATE_}}var O_=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},L_=!0,iA=!1,er=function(){var e=o1();return e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(L_=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==new O_().version&&(L_=!1),L_?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new O_):(setTimeout(function(){iA||kn(35)},1),new O_)}();function $7(){if((er.pendingReactions.length||er.inBatch||er.isRunningReactions)&&kn(36),iA=!0,L_){var e=o1();--e.__mobxInstanceCount===0&&(e.__mobxGlobals=void 0),er=new O_}}function j7(e,t){e.observers_.add(t),e.lowestObserverState_>t.dependenciesState_&&(e.lowestObserverState_=t.dependenciesState_)}function oA(e,t){e.observers_.delete(t),e.observers_.size===0&&sA(e)}function sA(e){e.isPendingUnobservation===!1&&(e.isPendingUnobservation=!0,er.pendingUnobservations.push(e))}function Kl(){er.inBatch++}function Yl(){if(--er.inBatch===0){cA();for(var e=er.pendingUnobservations,t=0;t<e.length;t++){var i=e[t];i.isPendingUnobservation=!1,i.observers_.size===0&&(i.isBeingObserved&&(i.isBeingObserved=!1,i.onBUO()),i instanceof ru&&i.suspend_())}er.pendingUnobservations=[]}}function aA(e){var t=er.trackingDerivation;return t!==null?(t.runId_!==e.lastAccessedBy_&&(e.lastAccessedBy_=t.runId_,t.newObserving_[t.unboundDepsCount_++]=e,!e.isBeingObserved&&er.trackingContext&&(e.isBeingObserved=!0,e.onBO())),e.isBeingObserved):(e.observers_.size===0&&er.inBatch>0&&sA(e),!1)}function lA(e){e.lowestObserverState_!==Dn.STALE_&&(e.lowestObserverState_=Dn.STALE_,e.observers_.forEach(function(t){t.dependenciesState_===Dn.UP_TO_DATE_&&t.onBecomeStale_(),t.dependenciesState_=Dn.STALE_}))}function N7(e){e.lowestObserverState_!==Dn.STALE_&&(e.lowestObserverState_=Dn.STALE_,e.observers_.forEach(function(t){t.dependenciesState_===Dn.POSSIBLY_STALE_?t.dependenciesState_=Dn.STALE_:t.dependenciesState_===Dn.UP_TO_DATE_&&(e.lowestObserverState_=Dn.UP_TO_DATE_)}))}function V7(e){e.lowestObserverState_===Dn.UP_TO_DATE_&&(e.lowestObserverState_=Dn.POSSIBLY_STALE_,e.observers_.forEach(function(t){t.dependenciesState_===Dn.UP_TO_DATE_&&(t.dependenciesState_=Dn.POSSIBLY_STALE_,t.onBecomeStale_())}))}var oh=function(){function e(i,a,c,h){i===void 0&&(i="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=Dn.NOT_TRACKING_,this.runId_=0,this.unboundDepsCount_=0,this.flags_=0,this.isTracing_=ix.NONE,this.name_=i,this.onInvalidate_=a,this.errorHandler_=c,this.requiresObservable_=h}var t=e.prototype;return t.onBecomeStale_=function(){this.schedule_()},t.schedule_=function(){this.isScheduled||(this.isScheduled=!0,er.pendingReactions.push(this),cA())},t.runReaction_=function(){if(!this.isDisposed){Kl(),this.isScheduled=!1;var a=er.trackingContext;if(er.trackingContext=this,zw(this)){this.isTrackPending=!0;try{this.onInvalidate_()}catch(c){this.reportExceptionInDerivation_(c)}}er.trackingContext=a,Yl()}},t.track=function(a){if(!this.isDisposed){Kl(),this.isRunning=!0;var c=er.trackingContext;er.trackingContext=this;var h=tA(this,a,void 0);er.trackingContext=c,this.isRunning=!1,this.isTrackPending=!1,this.isDisposed&&Ow(this),z_(h)&&this.reportExceptionInDerivation_(h.cause),Yl()}},t.reportExceptionInDerivation_=function(a){var c=this;if(this.errorHandler_){this.errorHandler_(a,this);return}if(er.disableErrorBoundaries)throw a;var h="[mobx] uncaught error in '"+this+"'";er.suppressReactionErrors||console.error(h,a),er.globalReactionErrorHandlers.forEach(function(f){return f(a,c)})},t.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.isRunning||(Kl(),Ow(this),Yl()))},t.getDisposer_=function(a){var c=this,h=function f(){c.dispose(),a==null||a.removeEventListener==null||a.removeEventListener("abort",f)};return a==null||a.addEventListener==null||a.addEventListener("abort",h),h[jr]=this,h},t.toString=function(){return"Reaction["+this.name_+"]"},t.trace=function(a){},Jg(e,[{key:"isDisposed",get:function(){return ol(this.flags_,e.isDisposedMask_)},set:function(a){this.flags_=sl(this.flags_,e.isDisposedMask_,a)}},{key:"isScheduled",get:function(){return ol(this.flags_,e.isScheduledMask_)},set:function(a){this.flags_=sl(this.flags_,e.isScheduledMask_,a)}},{key:"isTrackPending",get:function(){return ol(this.flags_,e.isTrackPendingMask_)},set:function(a){this.flags_=sl(this.flags_,e.isTrackPendingMask_,a)}},{key:"isRunning",get:function(){return ol(this.flags_,e.isRunningMask_)},set:function(a){this.flags_=sl(this.flags_,e.isRunningMask_,a)}},{key:"diffValue",get:function(){return ol(this.flags_,e.diffValueMask_)?1:0},set:function(a){this.flags_=sl(this.flags_,e.diffValueMask_,a===1)}}])}();oh.isDisposedMask_=1;oh.isScheduledMask_=2;oh.isTrackPendingMask_=4;oh.isRunningMask_=8;oh.diffValueMask_=16;var U7=100,Lw=function(t){return t()};function cA(){er.inBatch>0||er.isRunningReactions||Lw(G7)}function G7(){er.isRunningReactions=!0;for(var e=er.pendingReactions,t=0;e.length>0;){++t===U7&&(console.error("[mobx] cycle in reaction: "+e[0]),e.splice(0));for(var i=e.splice(0),a=0,c=i.length;a<c;a++)i[a].runReaction_()}er.isRunningReactions=!1}var sx=om("Reaction",oh);function q7(e){var t=Lw;Lw=function(a){return e(function(){return t(a)})}}function iv(){return!1}function H7(e){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var uA="action",W7="action.bound",hA="autoAction",Z7="autoAction.bound",dA="<unnamed action>",Fw=i0(uA),X7=i0(W7,{bound:!0}),Bw=i0(hA,{autoAction:!0}),K7=i0(Z7,{autoAction:!0,bound:!0});function fA(e){var t=function(a,c){if(tu(a))return Ef(a.name||dA,a,e);if(tu(c))return Ef(a,c,e);if(n0(c))return(e?Bw:Fw).decorate_20223_(a,c);if(Zp(c))return r0(a,c,e?Bw:Fw);if(Zp(a))return th(i0(e?hA:uA,{name:a,autoAction:e}))};return t}var Ir=fA(!1);Object.assign(Ir,Fw);var Pv=fA(!0);Object.assign(Pv,Bw);Ir.bound=th(X7);Pv.bound=th(K7);function jy(e){return Qk(e.name||dA,!1,e,this,void 0)}function Ev(e){return tu(e)&&e.isMobxAction===!0}function pA(e,t){var i,a,c,h;t===void 0&&(t=K2);var f=(i=(a=t)==null?void 0:a.name)!=null?i:"Autorun",o=!t.scheduler&&!t.delay,b;if(o)b=new oh(f,function(){this.track(D)},t.onError,t.requiresObservable);else{var P=mA(t),I=!1;b=new oh(f,function(){I||(I=!0,P(function(){I=!1,b.isDisposed||b.track(D)}))},t.onError,t.requiresObservable)}function D(){e(b)}return(c=t)!=null&&(c=c.signal)!=null&&c.aborted||b.schedule_(),b.getDisposer_((h=t)==null?void 0:h.signal)}var Y7=function(t){return t()};function mA(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:Y7}function sg(e,t,i){var a,c,h;i===void 0&&(i=K2);var f=(a=i.name)!=null?a:"Reaction",o=Ir(f,i.onError?J7(i.onError,t):t),b=!i.scheduler&&!i.delay,P=mA(i),I=!0,D=!1,z,F=i.compareStructural?Pf.structural:i.equals||Pf.default,U=new oh(f,function(){I||b?$():D||(D=!0,P($))},i.onError,i.requiresObservable);function $(){if(D=!1,!U.isDisposed){var j=!1,ie=z;U.track(function(){var se=eA(!1,function(){return e(U)});j=I||!F(z,se),z=se}),(I&&i.fireImmediately||!I&&j)&&o(z,ie,U),I=!1}}return(c=i)!=null&&(c=c.signal)!=null&&c.aborted||U.schedule_(),U.getDisposer_((h=i)==null?void 0:h.signal)}function J7(e,t){return function(){try{return t.apply(this,arguments)}catch(i){e.call(this,i)}}}var Q7="onBO",eV="onBUO";function tV(e,t,i){return yA(Q7,e,t,i)}function gA(e,t,i){return yA(eV,e,t,i)}function yA(e,t,i,a){var c=cx(t),h=tu(a)?a:i,f=e+"L";return c[f]?c[f].add(h):c[f]=new Set([h]),function(){var o=c[f];o&&(o.delete(h),o.size===0&&delete c[f])}}var rV="never",g_="always",nV="observed";function vA(e){e.isolateGlobalState===!0&&$7();var t=e.useProxies,i=e.enforceActions;if(t!==void 0&&(er.useProxies=t===g_?!0:t===rV?!1:typeof Proxy<"u"),t==="ifavailable"&&(er.verifyProxies=!0),i!==void 0){var a=i===g_?g_:i===nV;er.enforceActions=a,er.allowStateChanges=!(a===!0||a===g_)}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(c){c in e&&(er[c]=!!e[c])}),er.allowStateReads=!er.observableRequiresReaction,e.reactionScheduler&&q7(e.reactionScheduler)}function _A(e,t,i,a){var c=U8(t);return zf(function(){var h=lm(e,a)[jr];jg(c).forEach(function(f){h.extend_(f,c[f],i&&f in i?i[f]:!0)})}),e}function iV(e,t){return xA(cx(e,t))}function xA(e){var t={name:e.name_};return e.observing_&&e.observing_.length>0&&(t.dependencies=oV(e.observing_).map(xA)),t}function oV(e){return Array.from(new Set(e))}var sV=0;function bA(){this.message="FLOW_CANCELLED"}bA.prototype=Object.create(Error.prototype);var zb=Hk("flow"),aV=Hk("flow.bound",{bound:!0}),Ng=Object.assign(function(t,i){if(n0(i))return zb.decorate_20223_(t,i);if(Zp(i))return r0(t,i,zb);var a=t,c=a.name||"<unnamed flow>",h=function(){var o=this,b=arguments,P=++sV,I=Ir(c+" - runid: "+P+" - init",a).apply(o,b),D,z=void 0,F=new Promise(function(U,$){var j=0;D=$;function ie(de){z=void 0;var oe;try{oe=Ir(c+" - runid: "+P+" - yield "+j++,I.next).call(I,de)}catch(be){return $(be)}Q(oe)}function se(de){z=void 0;var oe;try{oe=Ir(c+" - runid: "+P+" - yield "+j++,I.throw).call(I,de)}catch(be){return $(be)}Q(oe)}function Q(de){if(tu(de?.then)){de.then(Q,$);return}return de.done?U(de.value):(z=Promise.resolve(de.value),z.then(ie,se))}ie(void 0)});return F.cancel=Ir(c+" - runid: "+P+" - cancel",function(){try{z&&RM(z);var U=I.return(void 0),$=Promise.resolve(U.value);$.then(pg,pg),RM($),D(new bA)}catch(j){D(j)}}),F};return h.isMobXFlow=!0,h},zb);Ng.bound=th(aV);function RM(e){tu(e.cancel)&&e.cancel()}function Iv(e){return e?.isMobXFlow===!0}function lV(e,t){return e?p1(e)||!!e[jr]||Y2(e)||sx(e)||d1(e):!1}function wA(e){return lV(e)}function rd(e,t){t===void 0&&(t=void 0),Kl();try{return e.apply(t)}finally{Yl()}}function cV(e,t,i){return arguments.length===1||t&&typeof t=="object"?uV(e,t):SA(e,t,{})}function SA(e,t,i){var a;if(typeof i.timeout=="number"){var c=new Error("WHEN_TIMEOUT");a=setTimeout(function(){if(!f[jr].isDisposed)if(f(),i.onError)i.onError(c);else throw c},i.timeout)}i.name="When";var h=Ef("When-effect",t),f=pA(function(o){var b=eA(!1,e);b&&(o.dispose(),a&&clearTimeout(a),h())},i);return f}function uV(e,t){var i;if(t!=null&&(i=t.signal)!=null&&i.aborted)return Object.assign(Promise.reject(new Error("WHEN_ABORTED")),{cancel:function(){return null}});var a,c,h=new Promise(function(f,o){var b,P=SA(e,f,Mf({},t,{onError:o}));a=function(){P(),o(new Error("WHEN_CANCELLED"))},c=function(){P(),o(new Error("WHEN_ABORTED"))},t==null||(b=t.signal)==null||b.addEventListener==null||b.addEventListener("abort",c)}).finally(function(){var f;return t==null||(f=t.signal)==null||f.removeEventListener==null?void 0:f.removeEventListener("abort",c)});return h.cancel=a,h}function ag(e){return e[jr]}var hV={has:function(t,i){return ag(t).has_(i)},get:function(t,i){return ag(t).get_(i)},set:function(t,i,a){var c;return Zp(i)?(c=ag(t).set_(i,a,!0))!=null?c:!0:!1},deleteProperty:function(t,i){var a;return Zp(i)?(a=ag(t).delete_(i,!0))!=null?a:!0:!1},defineProperty:function(t,i,a){var c;return(c=ag(t).defineProperty_(i,a))!=null?c:!0},ownKeys:function(t){return ag(t).ownKeys_()},preventExtensions:function(t){kn(13)}};function dV(e,t){var i,a;return Fk(),e=lm(e,t),(a=(i=e[jr]).proxy_)!=null?a:i.proxy_=new Proxy(e,hV)}function Wl(e){return e.interceptors_!==void 0&&e.interceptors_.length>0}function o0(e,t){var i=e.interceptors_||(e.interceptors_=[]);return i.push(t),Bk(function(){var a=i.indexOf(t);a!==-1&&i.splice(a,1)})}function Zl(e,t){var i=sm();try{for(var a=[].concat(e.interceptors_||[]),c=0,h=a.length;c<h&&(t=a[c](t),t&&!t.type&&kn(14),!!t);c++);return t}finally{id(i)}}function Yc(e){return e.changeListeners_!==void 0&&e.changeListeners_.length>0}function s0(e,t){var i=e.changeListeners_||(e.changeListeners_=[]);return i.push(t),Bk(function(){var a=i.indexOf(t);a!==-1&&i.splice(a,1)})}function Jc(e,t){var i=sm(),a=e.changeListeners_;if(a){a=a.slice();for(var c=0,h=a.length;c<h;c++)a[c](t);id(i)}}function fV(e,t,i){return zf(function(){var a,c=lm(e,i)[jr];(a=t)!=null||(t=Z8(e)),jg(t).forEach(function(h){return c.make_(h,t[h])})}),e}var Ob=Symbol("mobx-keys");function eS(e,t,i){return ld(e)?_A(e,e,t,i):(zf(function(){var a=lm(e,i)[jr];if(!e[Ob]){var c=Object.getPrototypeOf(e),h=new Set([].concat(jg(e),jg(c)));h.delete("constructor"),h.delete(jr),t0(c,Ob,h)}e[Ob].forEach(function(f){return a.make_(f,t&&f in t?t[f]:!0)})}),e)}var DM="splice",rh="update",pV=1e4,mV={get:function(t,i){var a=t[jr];return i===jr?a:i==="length"?a.getArrayLength_():typeof i=="string"&&!isNaN(i)?a.get_(parseInt(i)):nd(ax,i)?ax[i]:t[i]},set:function(t,i,a){var c=t[jr];return i==="length"&&c.setArrayLength_(a),typeof i=="symbol"||isNaN(i)?t[i]=a:c.set_(parseInt(i),a),!0},preventExtensions:function(){kn(15)}},tS=function(){function e(i,a,c,h){i===void 0&&(i="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=c,this.legacyMode_=h,this.atom_=new Df(i),this.enhancer_=function(f,o){return a(f,o,"ObservableArray[..]")}}var t=e.prototype;return t.dehanceValue_=function(a){return this.dehancer!==void 0?this.dehancer(a):a},t.dehanceValues_=function(a){return this.dehancer!==void 0&&a.length>0?a.map(this.dehancer):a},t.intercept_=function(a){return o0(this,a)},t.observe_=function(a,c){return c===void 0&&(c=!1),c&&a({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),s0(this,a)},t.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},t.setArrayLength_=function(a){(typeof a!="number"||isNaN(a)||a<0)&&kn("Out of range: "+a);var c=this.values_.length;if(a!==c)if(a>c){for(var h=new Array(a-c),f=0;f<a-c;f++)h[f]=void 0;this.spliceWithArray_(c,0,h)}else this.spliceWithArray_(a,c-a)},t.updateArrayLength_=function(a,c){a!==this.lastKnownLength_&&kn(16),this.lastKnownLength_+=c,this.legacyMode_&&c>0&&kA(a+c+1)},t.spliceWithArray_=function(a,c,h){var f=this;this.atom_;var o=this.values_.length;if(a===void 0?a=0:a>o?a=o:a<0&&(a=Math.max(0,o+a)),arguments.length===1?c=o-a:c==null?c=0:c=Math.max(0,Math.min(c,o-a)),h===void 0&&(h=kw),Wl(this)){var b=Zl(this,{object:this.proxy_,type:DM,index:a,removedCount:c,added:h});if(!b)return kw;c=b.removedCount,h=b.added}if(h=h.length===0?h:h.map(function(D){return f.enhancer_(D,void 0)}),this.legacyMode_){var P=h.length-c;this.updateArrayLength_(o,P)}var I=this.spliceItemsIntoValues_(a,c,h);return(c!==0||h.length!==0)&&this.notifyArraySplice_(a,h,I),this.dehanceValues_(I)},t.spliceItemsIntoValues_=function(a,c,h){if(h.length<pV){var f;return(f=this.values_).splice.apply(f,[a,c].concat(h))}else{var o=this.values_.slice(a,a+c),b=this.values_.slice(a+c);this.values_.length+=h.length-c;for(var P=0;P<h.length;P++)this.values_[a+P]=h[P];for(var I=0;I<b.length;I++)this.values_[a+h.length+I]=b[I];return o}},t.notifyArrayChildUpdate_=function(a,c,h){var f=!this.owned_&&iv(),o=Yc(this),b=o||f?{observableKind:"array",object:this.proxy_,type:rh,debugObjectName:this.atom_.name_,index:a,newValue:c,oldValue:h}:null;this.atom_.reportChanged(),o&&Jc(this,b)},t.notifyArraySplice_=function(a,c,h){var f=!this.owned_&&iv(),o=Yc(this),b=o||f?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:DM,index:a,removed:h,added:c,removedCount:h.length,addedCount:c.length}:null;this.atom_.reportChanged(),o&&Jc(this,b)},t.get_=function(a){if(this.legacyMode_&&a>=this.values_.length){console.warn("[mobx] Out of bounds read: "+a);return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[a])},t.set_=function(a,c){var h=this.values_;if(this.legacyMode_&&a>h.length&&kn(17,a,h.length),a<h.length){this.atom_;var f=h[a];if(Wl(this)){var o=Zl(this,{type:rh,object:this.proxy_,index:a,newValue:c});if(!o)return;c=o.newValue}c=this.enhancer_(c,f);var b=c!==f;b&&(h[a]=c,this.notifyArrayChildUpdate_(a,c,f))}else{for(var P=new Array(a+1-h.length),I=0;I<P.length-1;I++)P[I]=void 0;P[P.length-1]=c,this.spliceWithArray_(h.length,0,P)}},e}();function gV(e,t,i,a){return i===void 0&&(i="ObservableArray"),a===void 0&&(a=!1),Fk(),zf(function(){var c=new tS(i,t,a,!1);jk(c.values_,jr,c);var h=new Proxy(c.values_,mV);return c.proxy_=h,e&&e.length&&c.spliceWithArray_(0,0,e),h})}var ax={clear:function(){return this.splice(0)},replace:function(t){var i=this[jr];return i.spliceWithArray_(0,i.values_.length,t)},toJSON:function(){return this.slice()},splice:function(t,i){for(var a=arguments.length,c=new Array(a>2?a-2:0),h=2;h<a;h++)c[h-2]=arguments[h];var f=this[jr];switch(arguments.length){case 0:return[];case 1:return f.spliceWithArray_(t);case 2:return f.spliceWithArray_(t,i)}return f.spliceWithArray_(t,i,c)},spliceWithArray:function(t,i,a){return this[jr].spliceWithArray_(t,i,a)},push:function(){for(var t=this[jr],i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return t.spliceWithArray_(t.values_.length,0,a),t.values_.length},pop:function(){return this.splice(Math.max(this[jr].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var t=this[jr],i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return t.spliceWithArray_(0,0,a),t.values_.length},reverse:function(){return er.trackingDerivation&&kn(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){er.trackingDerivation&&kn(37,"sort");var t=this.slice();return t.sort.apply(t,arguments),this.replace(t),this},remove:function(t){var i=this[jr],a=i.dehanceValues_(i.values_).indexOf(t);return a>-1?(this.splice(a,1),!0):!1}};Pi("at",fl);Pi("concat",fl);Pi("flat",fl);Pi("includes",fl);Pi("indexOf",fl);Pi("join",fl);Pi("lastIndexOf",fl);Pi("slice",fl);Pi("toString",fl);Pi("toLocaleString",fl);Pi("toSorted",fl);Pi("toSpliced",fl);Pi("with",fl);Pi("every",su);Pi("filter",su);Pi("find",su);Pi("findIndex",su);Pi("findLast",su);Pi("findLastIndex",su);Pi("flatMap",su);Pi("forEach",su);Pi("map",su);Pi("some",su);Pi("toReversed",su);Pi("reduce",CA);Pi("reduceRight",CA);function Pi(e,t){typeof Array.prototype[e]=="function"&&(ax[e]=t(e))}function fl(e){return function(){var t=this[jr];t.atom_.reportObserved();var i=t.dehanceValues_(t.values_);return i[e].apply(i,arguments)}}function su(e){return function(t,i){var a=this,c=this[jr];c.atom_.reportObserved();var h=c.dehanceValues_(c.values_);return h[e](function(f,o){return t.call(i,f,o,a)})}}function CA(e){return function(){var t=this,i=this[jr];i.atom_.reportObserved();var a=i.dehanceValues_(i.values_),c=arguments[0];return arguments[0]=function(h,f,o){return c(h,f,o,t)},a[e].apply(a,arguments)}}var yV=om("ObservableArrayAdministration",tS);function f1(e){return a1(e)&&yV(e[jr])}var vV={},_f="add",lx="delete",TA=function(){function e(i,a,c){var h=this;a===void 0&&(a=Xp),c===void 0&&(c="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[jr]=vV,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=a,this.name_=c,tu(Map)||kn(18),zf(function(){h.keysAtom_=Gk("ObservableMap.keys()"),h.data_=new Map,h.hasMap_=new Map,i&&h.merge(i)})}var t=e.prototype;return t.has_=function(a){return this.data_.has(a)},t.has=function(a){var c=this;if(!er.trackingDerivation)return this.has_(a);var h=this.hasMap_.get(a);if(!h){var f=h=new Up(this.has_(a),l1,"ObservableMap.key?",!1);this.hasMap_.set(a,f),gA(f,function(){return c.hasMap_.delete(a)})}return h.get()},t.set=function(a,c){var h=this.has_(a);if(Wl(this)){var f=Zl(this,{type:h?rh:_f,object:this,newValue:c,name:a});if(!f)return this;c=f.newValue}return h?this.updateValue_(a,c):this.addValue_(a,c),this},t.delete=function(a){var c=this;if(this.keysAtom_,Wl(this)){var h=Zl(this,{type:lx,object:this,name:a});if(!h)return!1}if(this.has_(a)){var f=iv(),o=Yc(this),b=o||f?{observableKind:"map",debugObjectName:this.name_,type:lx,object:this,oldValue:this.data_.get(a).value_,name:a}:null;return rd(function(){var P;c.keysAtom_.reportChanged(),(P=c.hasMap_.get(a))==null||P.setNewValue_(!1);var I=c.data_.get(a);I.setNewValue_(void 0),c.data_.delete(a)}),o&&Jc(this,b),!0}return!1},t.updateValue_=function(a,c){var h=this.data_.get(a);if(c=h.prepareNewValue_(c),c!==er.UNCHANGED){var f=iv(),o=Yc(this),b=o||f?{observableKind:"map",debugObjectName:this.name_,type:rh,object:this,oldValue:h.value_,name:a,newValue:c}:null;h.setNewValue_(c),o&&Jc(this,b)}},t.addValue_=function(a,c){var h=this;this.keysAtom_,rd(function(){var P,I=new Up(c,h.enhancer_,"ObservableMap.key",!1);h.data_.set(a,I),c=I.value_,(P=h.hasMap_.get(a))==null||P.setNewValue_(!0),h.keysAtom_.reportChanged()});var f=iv(),o=Yc(this),b=o||f?{observableKind:"map",debugObjectName:this.name_,type:_f,object:this,name:a,newValue:c}:null;o&&Jc(this,b)},t.get=function(a){return this.has(a)?this.dehanceValue_(this.data_.get(a).get()):this.dehanceValue_(void 0)},t.dehanceValue_=function(a){return this.dehancer!==void 0?this.dehancer(a):a},t.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},t.values=function(){var a=this,c=this.keys();return zM({next:function(){var f=c.next(),o=f.done,b=f.value;return{done:o,value:o?void 0:a.get(b)}}})},t.entries=function(){var a=this,c=this.keys();return zM({next:function(){var f=c.next(),o=f.done,b=f.value;return{done:o,value:o?void 0:[b,a.get(b)]}}})},t[Symbol.iterator]=function(){return this.entries()},t.forEach=function(a,c){for(var h=mg(this),f;!(f=h()).done;){var o=f.value,b=o[0],P=o[1];a.call(c,P,b,this)}},t.merge=function(a){var c=this;return am(a)&&(a=new Map(a)),rd(function(){ld(a)?V8(a).forEach(function(h){return c.set(h,a[h])}):Array.isArray(a)?a.forEach(function(h){var f=h[0],o=h[1];return c.set(f,o)}):Yg(a)?(N8(a)||kn(19,a),a.forEach(function(h,f){return c.set(f,h)})):a!=null&&kn(20,a)}),this},t.clear=function(){var a=this;rd(function(){rA(function(){for(var c=mg(a.keys()),h;!(h=c()).done;){var f=h.value;a.delete(f)}})})},t.replace=function(a){var c=this;return rd(function(){for(var h=_V(a),f=new Map,o=!1,b=mg(c.data_.keys()),P;!(P=b()).done;){var I=P.value;if(!h.has(I)){var D=c.delete(I);if(D)o=!0;else{var z=c.data_.get(I);f.set(I,z)}}}for(var F=mg(h.entries()),U;!(U=F()).done;){var $=U.value,j=$[0],ie=$[1],se=c.data_.has(j);if(c.set(j,ie),c.data_.has(j)){var Q=c.data_.get(j);f.set(j,Q),se||(o=!0)}}if(!o)if(c.data_.size!==f.size)c.keysAtom_.reportChanged();else for(var de=c.data_.keys(),oe=f.keys(),be=de.next(),xe=oe.next();!be.done;){if(be.value!==xe.value){c.keysAtom_.reportChanged();break}be=de.next(),xe=oe.next()}c.data_=f}),this},t.toString=function(){return"[object ObservableMap]"},t.toJSON=function(){return Array.from(this)},t.observe_=function(a,c){return s0(this,a)},t.intercept_=function(a){return o0(this,a)},Jg(e,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Map"}}])}(),am=om("ObservableMap",TA);function zM(e){return e[Symbol.toStringTag]="MapIterator",nS(e)}function _V(e){if(Yg(e)||am(e))return e;if(Array.isArray(e))return new Map(e);if(ld(e)){var t=new Map;for(var i in e)t.set(i,e[i]);return t}else return kn(21,e)}var xV={},MA=function(){function e(i,a,c){var h=this;a===void 0&&(a=Xp),c===void 0&&(c="ObservableSet"),this.name_=void 0,this[jr]=xV,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=c,tu(Set)||kn(22),this.enhancer_=function(f,o){return a(f,o,c)},zf(function(){h.atom_=Gk(h.name_),i&&h.replace(i)})}var t=e.prototype;return t.dehanceValue_=function(a){return this.dehancer!==void 0?this.dehancer(a):a},t.clear=function(){var a=this;rd(function(){rA(function(){for(var c=mg(a.data_.values()),h;!(h=c()).done;){var f=h.value;a.delete(f)}})})},t.forEach=function(a,c){for(var h=mg(this),f;!(f=h()).done;){var o=f.value;a.call(c,o,o,this)}},t.add=function(a){var c=this;if(this.atom_,Wl(this)){var h=Zl(this,{type:_f,object:this,newValue:a});if(!h)return this}if(!this.has(a)){rd(function(){c.data_.add(c.enhancer_(a,void 0)),c.atom_.reportChanged()});var f=!1,o=Yc(this),b=o||f?{observableKind:"set",debugObjectName:this.name_,type:_f,object:this,newValue:a}:null;o&&Jc(this,b)}return this},t.delete=function(a){var c=this;if(Wl(this)){var h=Zl(this,{type:lx,object:this,oldValue:a});if(!h)return!1}if(this.has(a)){var f=!1,o=Yc(this),b=o||f?{observableKind:"set",debugObjectName:this.name_,type:lx,object:this,oldValue:a}:null;return rd(function(){c.atom_.reportChanged(),c.data_.delete(a)}),o&&Jc(this,b),!0}return!1},t.has=function(a){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(a))},t.entries=function(){var a=0,c=Array.from(this.keys()),h=Array.from(this.values());return OM({next:function(){var o=a;return a+=1,o<h.length?{value:[c[o],h[o]],done:!1}:{value:void 0,done:!0}}})},t.keys=function(){return this.values()},t.values=function(){this.atom_.reportObserved();var a=this,c=0,h=Array.from(this.data_.values());return OM({next:function(){return c<h.length?{value:a.dehanceValue_(h[c++]),done:!1}:{value:void 0,done:!0}}})},t.intersection=function(a){if(td(a)&&!Wu(a))return a.intersection(this);var c=new Set(this);return c.intersection(a)},t.union=function(a){if(td(a)&&!Wu(a))return a.union(this);var c=new Set(this);return c.union(a)},t.difference=function(a){return new Set(this).difference(a)},t.symmetricDifference=function(a){if(td(a)&&!Wu(a))return a.symmetricDifference(this);var c=new Set(this);return c.symmetricDifference(a)},t.isSubsetOf=function(a){return new Set(this).isSubsetOf(a)},t.isSupersetOf=function(a){return new Set(this).isSupersetOf(a)},t.isDisjointFrom=function(a){if(td(a)&&!Wu(a))return a.isDisjointFrom(this);var c=new Set(this);return c.isDisjointFrom(a)},t.replace=function(a){var c=this;return Wu(a)&&(a=new Set(a)),rd(function(){Array.isArray(a)?(c.clear(),a.forEach(function(h){return c.add(h)})):td(a)?(c.clear(),a.forEach(function(h){return c.add(h)})):a!=null&&kn("Cannot initialize set from "+a)}),this},t.observe_=function(a,c){return s0(this,a)},t.intercept_=function(a){return o0(this,a)},t.toJSON=function(){return Array.from(this)},t.toString=function(){return"[object ObservableSet]"},t[Symbol.iterator]=function(){return this.values()},Jg(e,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Set"}}])}(),Wu=om("ObservableSet",MA);function OM(e){return e[Symbol.toStringTag]="SetIterator",nS(e)}var LM=Object.create(null),FM="remove",PA=function(){function e(i,a,c,h){a===void 0&&(a=new Map),h===void 0&&(h=v7),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=i,this.values_=a,this.name_=c,this.defaultAnnotation_=h,this.keysAtom_=new Df("ObservableObject.keys"),this.isPlainObject_=ld(this.target_)}var t=e.prototype;return t.getObservablePropValue_=function(a){return this.values_.get(a).get()},t.setObservablePropValue_=function(a,c){var h=this.values_.get(a);if(h instanceof ru)return h.set(c),!0;if(Wl(this)){var f=Zl(this,{type:rh,object:this.proxy_||this.target_,name:a,newValue:c});if(!f)return null;c=f.newValue}if(c=h.prepareNewValue_(c),c!==er.UNCHANGED){var o=Yc(this),b=!1,P=o||b?{type:rh,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:h.value_,name:a,newValue:c}:null;h.setNewValue_(c),o&&Jc(this,P)}return!0},t.get_=function(a){return er.trackingDerivation&&!nd(this.target_,a)&&this.has_(a),this.target_[a]},t.set_=function(a,c,h){return h===void 0&&(h=!1),nd(this.target_,a)?this.values_.has(a)?this.setObservablePropValue_(a,c):h?Reflect.set(this.target_,a,c):(this.target_[a]=c,!0):this.extend_(a,{value:c,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,h)},t.has_=function(a){if(!er.trackingDerivation)return a in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var c=this.pendingKeys_.get(a);return c||(c=new Up(a in this.target_,l1,"ObservableObject.key?",!1),this.pendingKeys_.set(a,c)),c.get()},t.make_=function(a,c){if(c===!0&&(c=this.defaultAnnotation_),c!==!1){if(!(a in this.target_)){var h;if((h=this.target_[Xu])!=null&&h[a])return;kn(1,c.annotationType_,this.name_+"."+a.toString())}for(var f=this.target_;f&&f!==s1;){var o=rx(f,a);if(o){var b=c.make_(this,a,o,f);if(b===0)return;if(b===1)break}f=Object.getPrototypeOf(f)}$M(this,c,a)}},t.extend_=function(a,c,h,f){if(f===void 0&&(f=!1),h===!0&&(h=this.defaultAnnotation_),h===!1)return this.defineProperty_(a,c,f);var o=h.extend_(this,a,c,f);return o&&$M(this,h,a),o},t.defineProperty_=function(a,c,h){h===void 0&&(h=!1),this.keysAtom_;try{Kl();var f=this.delete_(a);if(!f)return f;if(Wl(this)){var o=Zl(this,{object:this.proxy_||this.target_,name:a,type:_f,newValue:c.value});if(!o)return null;var b=o.newValue;c.value!==b&&(c=Mf({},c,{value:b}))}if(h){if(!Reflect.defineProperty(this.target_,a,c))return!1}else eh(this.target_,a,c);this.notifyPropertyAddition_(a,c.value)}finally{Yl()}return!0},t.defineObservableProperty_=function(a,c,h,f){f===void 0&&(f=!1),this.keysAtom_;try{Kl();var o=this.delete_(a);if(!o)return o;if(Wl(this)){var b=Zl(this,{object:this.proxy_||this.target_,name:a,type:_f,newValue:c});if(!b)return null;c=b.newValue}var P=BM(a),I={configurable:er.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:P.get,set:P.set};if(f){if(!Reflect.defineProperty(this.target_,a,I))return!1}else eh(this.target_,a,I);var D=new Up(c,h,"ObservableObject.key",!1);this.values_.set(a,D),this.notifyPropertyAddition_(a,D.value_)}finally{Yl()}return!0},t.defineComputedProperty_=function(a,c,h){h===void 0&&(h=!1),this.keysAtom_;try{Kl();var f=this.delete_(a);if(!f)return f;if(Wl(this)){var o=Zl(this,{object:this.proxy_||this.target_,name:a,type:_f,newValue:void 0});if(!o)return null}c.name||(c.name="ObservableObject.key"),c.context=this.proxy_||this.target_;var b=BM(a),P={configurable:er.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:b.get,set:b.set};if(h){if(!Reflect.defineProperty(this.target_,a,P))return!1}else eh(this.target_,a,P);this.values_.set(a,new ru(c)),this.notifyPropertyAddition_(a,void 0)}finally{Yl()}return!0},t.delete_=function(a,c){if(c===void 0&&(c=!1),this.keysAtom_,!nd(this.target_,a))return!0;if(Wl(this)){var h=Zl(this,{object:this.proxy_||this.target_,name:a,type:FM});if(!h)return null}try{var f;Kl();var o=Yc(this),b=!1,P=this.values_.get(a),I=void 0;if(!P&&(o||b)){var D;I=(D=rx(this.target_,a))==null?void 0:D.value}if(c){if(!Reflect.deleteProperty(this.target_,a))return!1}else delete this.target_[a];if(P&&(this.values_.delete(a),P instanceof Up&&(I=P.value_),lA(P)),this.keysAtom_.reportChanged(),(f=this.pendingKeys_)==null||(f=f.get(a))==null||f.set(a in this.target_),o||b){var z={type:FM,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:I,name:a};o&&Jc(this,z)}}finally{Yl()}return!0},t.observe_=function(a,c){return s0(this,a)},t.intercept_=function(a){return o0(this,a)},t.notifyPropertyAddition_=function(a,c){var h,f=Yc(this),o=!1;if(f||o){var b=f||o?{type:_f,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:a,newValue:c}:null;f&&Jc(this,b)}(h=this.pendingKeys_)==null||(h=h.get(a))==null||h.set(!0),this.keysAtom_.reportChanged()},t.ownKeys_=function(){return this.keysAtom_.reportObserved(),jg(this.target_)},t.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},e}();function lm(e,t){var i;if(nd(e,jr))return e;var a=(i=t?.name)!=null?i:"ObservableObject",c=new PA(e,new Map,String(a),I7(t));return t0(e,jr,c),e}var bV=om("ObservableObjectAdministration",PA);function BM(e){return LM[e]||(LM[e]={get:function(){return this[jr].getObservablePropValue_(e)},set:function(i){return this[jr].setObservablePropValue_(e,i)}})}function p1(e){return a1(e)?bV(e[jr]):!1}function $M(e,t,i){var a;(a=e.target_[Xu])==null||delete a[i]}var wV=IA(0),SV=function(){var e=!1,t={};return Object.defineProperty(t,"0",{set:function(){e=!0}}),Object.create(t)[0]=1,e===!1}(),Lb=0,EA=function(){};function CV(e,t){Object.setPrototypeOf?Object.setPrototypeOf(e.prototype,t):e.prototype.__proto__!==void 0?e.prototype.__proto__=t:e.prototype=t}CV(EA,Array.prototype);var rS=function(e){function t(a,c,h,f){var o;return h===void 0&&(h="ObservableArray"),f===void 0&&(f=!1),o=e.call(this)||this,zf(function(){var b=new tS(h,c,f,!0);b.proxy_=o,jk(o,jr,b),a&&a.length&&o.spliceWithArray(0,0,a),SV&&Object.defineProperty(o,"0",wV)}),o}Uk(t,e);var i=t.prototype;return i.concat=function(){this[jr].atom_.reportObserved();for(var c=arguments.length,h=new Array(c),f=0;f<c;f++)h[f]=arguments[f];return Array.prototype.concat.apply(this.slice(),h.map(function(o){return f1(o)?o.slice():o}))},i[Symbol.iterator]=function(){var a=this,c=0;return nS({next:function(){return c<a.length?{value:a[c++],done:!1}:{done:!0,value:void 0}}})},Jg(t,[{key:"length",get:function(){return this[jr].getArrayLength_()},set:function(c){this[jr].setArrayLength_(c)}},{key:Symbol.toStringTag,get:function(){return"Array"}}])}(EA);Object.entries(ax).forEach(function(e){var t=e[0],i=e[1];t!=="concat"&&t0(rS.prototype,t,i)});function IA(e){return{enumerable:!1,configurable:!0,get:function(){return this[jr].get_(e)},set:function(i){this[jr].set_(e,i)}}}function TV(e){eh(rS.prototype,""+e,IA(e))}function kA(e){if(e>Lb){for(var t=Lb;t<e+100;t++)TV(t);Lb=e}}kA(1e3);function MV(e,t,i){return new rS(e,t,i)}function cx(e,t){if(typeof e=="object"&&e!==null){if(f1(e))return t!==void 0&&kn(23),e[jr].atom_;if(Wu(e))return e.atom_;if(am(e)){if(t===void 0)return e.keysAtom_;var i=e.data_.get(t)||e.hasMap_.get(t);return i||kn(25,t,$w(e)),i}if(p1(e)){if(!t)return kn(26);var a=e[jr].values_.get(t);return a||kn(27,t,$w(e)),a}if(Y2(e)||d1(e)||sx(e))return e}else if(tu(e)&&sx(e[jr]))return e[jr];kn(28)}function PV(e,t){if(e||kn(29),Y2(e)||d1(e)||sx(e)||am(e)||Wu(e))return e;if(e[jr])return e[jr];kn(24,e)}function $w(e,t){var i;if(t!==void 0)i=cx(e,t);else{if(Ev(e))return e.name;p1(e)||am(e)||Wu(e)?i=PV(e):i=cx(e)}return i.name_}function zf(e){var t=sm(),i=u1(!0);Kl();try{return e()}finally{Yl(),h1(i),id(t)}}var jM=s1.toString;function AA(e,t,i){return i===void 0&&(i=-1),jw(e,t,i)}function jw(e,t,i,a,c){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var h=typeof e;if(h!=="function"&&h!=="object"&&typeof t!="object")return!1;var f=jM.call(e);if(f!==jM.call(t))return!1;switch(f){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t);case"[object Map]":case"[object Set]":i>=0&&i++;break}e=NM(e),t=NM(t);var o=f==="[object Array]";if(!o){if(typeof e!="object"||typeof t!="object")return!1;var b=e.constructor,P=t.constructor;if(b!==P&&!(tu(b)&&b instanceof b&&tu(P)&&P instanceof P)&&"constructor"in e&&"constructor"in t)return!1}if(i===0)return!1;i<0&&(i=-1),a=a||[],c=c||[];for(var I=a.length;I--;)if(a[I]===e)return c[I]===t;if(a.push(e),c.push(t),o){if(I=e.length,I!==t.length)return!1;for(;I--;)if(!jw(e[I],t[I],i-1,a,c))return!1}else{var D=Object.keys(e),z;if(I=D.length,Object.keys(t).length!==I)return!1;for(;I--;)if(z=D[I],!(nd(t,z)&&jw(e[z],t[z],i-1,a,c)))return!1}return a.pop(),c.pop(),!0}function NM(e){return f1(e)?e.slice():Yg(e)||am(e)||td(e)||Wu(e)?Array.from(e.entries()):e}var VM,EV=((VM=o1().Iterator)==null?void 0:VM.prototype)||{};function nS(e){return e[Symbol.iterator]=IV,Object.assign(Object.create(EV),e)}function IV(){return this}["Symbol","Map","Set"].forEach(function(e){var t=o1();typeof t[e]>"u"&&kn("MobX requires global '"+e+"' to be available or polyfilled")});typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:H7,extras:{getDebugName:$w},$mobx:jr});var y_={},UM;function kV(){if(UM)return y_;UM=1;var e=dI();return y_.createRoot=e.createRoot,y_.hydrateRoot=e.hydrateRoot,y_}var AV=kV();const RA=Aj;function iS(e){return Tj(e)}function RV(e){return t1("MuiSvgIcon",e)}ek("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const DV=e=>{const{color:t,fontSize:i,classes:a}=e,c={root:["root",t!=="inherit"&&`color${$g(t)}`,`fontSize${$g(i)}`]};return W2(c,RV,a)},zV=Jv("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.color!=="inherit"&&t[`color${$g(i.color)}`],t[`fontSize${$g(i.fontSize)}`]]}})(RA(({theme:e})=>({userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:e.transitions?.create?.("fill",{duration:(e.vars??e).transitions?.duration?.shorter}),variants:[{props:t=>!t.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:e.typography?.pxToRem?.(20)||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:e.typography?.pxToRem?.(24)||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:e.typography?.pxToRem?.(35)||"2.1875rem"}},...Object.entries((e.vars??e).palette).filter(([,t])=>t&&t.main).map(([t])=>({props:{color:t},style:{color:(e.vars??e).palette?.[t]?.main}})),{props:{color:"action"},style:{color:(e.vars??e).palette?.action?.active}},{props:{color:"disabled"},style:{color:(e.vars??e).palette?.action?.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}))),Nw=K.forwardRef(function(t,i){const a=iS({props:t,name:"MuiSvgIcon"}),{children:c,className:h,color:f="inherit",component:o="svg",fontSize:b="medium",htmlColor:P,inheritViewBox:I=!1,titleAccess:D,viewBox:z="0 0 24 24",...F}=a,U=K.isValidElement(c)&&c.type==="svg",$={...a,color:f,component:o,fontSize:b,instanceFontSize:t.fontSize,inheritViewBox:I,viewBox:z,hasSvgAsChild:U},j={};I||(j.viewBox=z);const ie=DV($);return G.jsxs(zV,{as:o,className:hi(ie.root,h),focusable:"false",color:P,"aria-hidden":D?void 0:!0,role:D?"img":void 0,ref:i,...j,...F,...U&&c.props,ownerState:$,children:[U?c.props.children:c,D?G.jsx("title",{children:D}):null]})});Nw.muiName="SvgIcon";function ai(e,t){function i(a,c){return G.jsx(Nw,{"data-testid":void 0,ref:c,...a,children:e})}return i.muiName=Nw.muiName,K.memo(K.forwardRef(i))}function OV(e,t=166){let i;function a(...c){const h=()=>{e.apply(this,c)};clearTimeout(i),i=setTimeout(h,t)}return a.clear=()=>{clearTimeout(i)},a}function LV(e){return e&&e.ownerDocument||document}function DA(e){return LV(e).defaultView||window}function oS(...e){const t=K.useRef(void 0),i=K.useCallback(a=>{const c=e.map(h=>{if(h==null)return null;if(typeof h=="function"){const f=h,o=f(a);return typeof o=="function"?o:()=>{f(null)}}return h.current=a,()=>{h.current=null}});return()=>{c.forEach(h=>h?.())}},e);return K.useMemo(()=>e.every(a=>a==null)?null:a=>{t.current&&(t.current(),t.current=void 0),a!=null&&(t.current=i(a))},e)}const FV=ai(G.jsx("path",{d:"M21 3 3 10.53v.98l6.84 2.65L12.48 21h.98z"})),BV=ai(G.jsx("path",{d:"M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27zM12 17.3c-.72 0-1.3-.58-1.3-1.3s.58-1.3 1.3-1.3 1.3.58 1.3 1.3-.58 1.3-1.3 1.3m1-4.3h-2V7h2z"}));var GM=function(e){return typeof e=="object"&&e!==null},$V=function(e){var t=e.value,i=t===void 0?"":t,a=e.numInputs,c=a===void 0?4:a,h=e.onChange,f=e.onPaste,o=e.renderInput,b=e.shouldAutoFocus,P=b===void 0?!1:b,I=e.inputType,D=I===void 0?"text":I,z=e.renderSeparator,F=e.placeholder,U=e.containerStyle,$=e.inputStyle,j=e.skipDefaultStyles,ie=j===void 0?!1:j,se=hn.useState(0),Q=se[0],de=se[1],oe=hn.useRef([]),be=function(){return i?i.toString().split(""):[]},xe=D==="number"||D==="tel";hn.useEffect(function(){oe.current=oe.current.slice(0,c)},[c]),hn.useEffect(function(){var je;P&&((je=oe.current[0])===null||je===void 0||je.focus())},[P]);var Me=function(){if(typeof F=="string"){if(F.length===c)return F;F.length>0&&console.error("Length of the placeholder should be equal to the number of inputs.")}},Ee=function(je){var ct=xe?!isNaN(Number(je)):typeof je=="string";return ct&&je.trim().length===1},re=function(je){var ct=je.target.value;Ee(ct)&&(qe(ct),et(Q+1))},ke=function(je){var ct=je.nativeEvent,ye=je.target.value;if(!Ee(ye)){if(ye.length===c){var ze=ye.split("").some(function(ft){return!Ee(ft)});ze||(Qe(ye.split("")),et(c-1))}ct.data===null&&ct.inputType==="deleteContentBackward"&&(je.preventDefault(),qe(""),et(Q-1)),je.target.value=""}},Ge=function(je){return function(ct){de(ct),je.target.select()}},Ke=function(){de(Q-1)},gt=function(je){var ct=be();[je.code,je.key].includes("Backspace")?(je.preventDefault(),qe(""),et(Q-1)):je.code==="Delete"?(je.preventDefault(),qe("")):je.code==="ArrowLeft"?(je.preventDefault(),et(Q-1)):je.code==="ArrowRight"||je.key===ct[Q]?(je.preventDefault(),et(Q+1)):(je.code==="Spacebar"||je.code==="Space"||je.code==="ArrowUp"||je.code==="ArrowDown")&&je.preventDefault()},et=function(je){var ct,ye,ze=Math.max(Math.min(c-1,je),0);oe.current[ze]&&((ct=oe.current[ze])===null||ct===void 0||ct.focus(),(ye=oe.current[ze])===null||ye===void 0||ye.select(),de(ze))},qe=function(je){var ct=be();ct[Q]=je[0],Qe(ct)},Qe=function(je){var ct=je.join("");h(ct)},Ve=function(je){var ct;je.preventDefault();var ye=be(),ze=Q,ft=je.clipboardData.getData("text/plain").slice(0,c-Q).split("");if(!(xe&&ft.some(function(xt){return isNaN(Number(xt))}))){for(var wt=0;wt<c;++wt)wt>=Q&&ft.length>0&&(ye[wt]=(ct=ft.shift())!==null&&ct!==void 0?ct:"",ze++);et(ze),Qe(ye)}};return hn.createElement("div",{style:Object.assign({display:"flex",alignItems:"center"},GM(U)&&U),className:typeof U=="string"?U:void 0,onPaste:f},Array.from({length:c},function(je,ct){return ct}).map(function(je){var ct,ye,ze;return hn.createElement(hn.Fragment,{key:je},o({value:(ct=be()[je])!==null&&ct!==void 0?ct:"",placeholder:(ze=(ye=Me())===null||ye===void 0?void 0:ye[je])!==null&&ze!==void 0?ze:void 0,ref:function(ft){return oe.current[je]=ft},onChange:re,onFocus:function(ft){return Ge(ft)(je)},onBlur:Ke,onKeyDown:gt,onPaste:Ve,autoComplete:"off","aria-label":"Please enter OTP character ".concat(je+1),style:Object.assign(ie?{}:{width:"1em",textAlign:"center"},GM($)?$:{}),className:typeof $=="string"?$:void 0,type:D,inputMode:xe?"numeric":"text",onInput:ke},je),je<c-1&&(typeof z=="function"?z(je):z))}))};function Ca(e,t){if(e==null)throw new Error(t);return e}function Np(e,t){if(!e)throw new Error(`assertion failed: ${t}`)}class Uo extends Error{constructor(t){super("unreachable value "+JSON.stringify(t))}}class ba{static checkArgument(t,i){if(!t)throw new Error(i)}static checkState(t,i){if(!t)throw new Error(i)}static checkExists(t,i){return Ca(t,i)}}function jV(e,t){return UV(e,t,(i,a,c,h)=>[(i+c)/2,(a+h)/2])}function NV([e,t,i,a]){return jV([e,t],[i,a])}function VV(e){let t=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY,h=!1;for(const f of e)h=!0,Array.isArray(f)?(t=Math.min(t,f[0]),a=Math.max(a,f[0]),i=Math.min(i,f[1]),c=Math.max(c,f[1])):(t=Math.min(t,f.x),a=Math.max(a,f.x),i=Math.min(i,f.y),c=Math.max(c,f.y));return ba.checkArgument(h),[t,i,a,c]}function qM(e,t){let i,a;return Array.isArray(e)?(ba.checkArgument(e.length>=2),i=e[0],a=e[1]):(i=e.x,a=e.y),t(i,a)}function UV(e,t,i){const[a,c]=qM(e,(o,b)=>[o,b]),[h,f]=qM(t,(o,b)=>[o,b]);return i(a,c,h,f)}const GV=new Set(["fastest","shortest","smallRoads"]),qV="modulepreload",HV=function(e){return"/"+e},HM={},WV=function(t,i,a){let c=Promise.resolve();if(i&&i.length>0){let P=function(I){return Promise.all(I.map(D=>Promise.resolve(D).then(z=>({status:"fulfilled",value:z}),z=>({status:"rejected",reason:z}))))};var f=P;document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),b=o?.nonce||o?.getAttribute("nonce");c=P(i.map(I=>{if(I=HV(I),I in HM)return;HM[I]=!0;const D=I.endsWith(".css"),z=D?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${I}"]${z}`))return;const F=document.createElement("link");if(F.rel=D?"stylesheet":qV,D||(F.as="script"),F.crossOrigin="",F.href=I,b&&F.setAttribute("nonce",b),document.head.appendChild(F),D)return new Promise((U,$)=>{F.addEventListener("load",U),F.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${I}`)))})}))}function h(o){const b=new Event("vite:preloadError",{cancelable:!0});if(b.payload=o,window.dispatchEvent(b),!b.defaultPrevented)throw o}return c.then(o=>{for(const b of o||[])b.status==="rejected"&&h(b.reason);return t().catch(h)})},zA=K.createContext(null);function ZV(){const e=K.useContext(zA)?.maps,t=K.useContext(cm);return K.useMemo(()=>({...e,current:t?.map}),[e,t])}function XV(e,t){const i=Array.isArray(e)?e[0]:e?e.x:0,a=Array.isArray(e)?e[1]:e?e.y:0,c=Array.isArray(t)?t[0]:t?t.x:0,h=Array.isArray(t)?t[1]:t?t.y:0;return i===c&&a===h}function wa(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!wa(e[i],t[i]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(const c of i)if(!t.hasOwnProperty(c)||!wa(e[c],t[c]))return!1;return!0}return!1}function WM(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function ZM(e,t){const i=t.viewState||t,a={};if("longitude"in i&&"latitude"in i&&(i.longitude!==e.center.lng||i.latitude!==e.center.lat)){const c=e.center.constructor;a.center=new c(i.longitude,i.latitude)}return"zoom"in i&&i.zoom!==e.zoom&&(a.zoom=i.zoom),"bearing"in i&&i.bearing!==e.bearing&&(a.bearing=i.bearing),"pitch"in i&&i.pitch!==e.pitch&&(a.pitch=i.pitch),i.padding&&e.padding&&!wa(i.padding,e.padding)&&(a.padding=i.padding),a}const KV=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function XM(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const a of e.layers)t[a.id]=a;const i=e.layers.map(a=>{let c=null;"interactive"in a&&(c=Object.assign({},a),delete c.interactive);const h=t[a.ref];if(h){c=c||Object.assign({},a),delete c.ref;for(const f of KV)f in h&&(c[f]=h[f])}return c||a});return{...e,layers:i}}const KM={version:8,sources:{},layers:[]},YM={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},JM={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},QM={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},YV=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],JV=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Vg{constructor(t,i,a){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=c=>{const h=this.props[QM[c.type]];h?h(c):c.type==="error"&&console.error(c.error)},this._onCameraEvent=c=>{if(this._internalUpdate)return;c.viewState=this._propsedCameraUpdate||WM(this._map.transform);const h=this.props[JM[c.type]];h&&h(c)},this._onCameraUpdate=c=>this._internalUpdate?c:(this._propsedCameraUpdate=WM(c),ZM(c,this.props)),this._onPointerEvent=c=>{(c.type==="mousemove"||c.type==="mouseout")&&this._updateHover(c);const h=this.props[YM[c.type]];h&&(this.props.interactiveLayerIds&&c.type!=="mouseover"&&c.type!=="mouseout"&&(c.features=this._hoveredFeatures||this._queryRenderedFeatures(c.point)),h(c),delete c.features)},this._MapClass=t,this.props=i,this._initialize(a)}get map(){return this._map}setProps(t){const i=this.props;this.props=t;const a=this._updateSettings(t,i),c=this._updateSize(t),h=this._updateViewState(t);this._updateStyle(t,i),this._updateStyleComponents(t),this._updateHandlers(t,i),(a||c||h&&!this._map.isMoving())&&this.redraw()}static reuse(t,i){const a=Vg.savedMaps.pop();if(!a)return null;const c=a.map,h=c.getContainer();for(i.className=h.className;h.childNodes.length>0;)i.appendChild(h.childNodes[0]);c._container=i;const f=c._resizeObserver;f&&(f.disconnect(),f.observe(i)),a.setProps({...t,styleDiffing:!1}),c.resize();const{initialViewState:o}=t;return o&&(o.bounds?c.fitBounds(o.bounds,{...o.fitBoundsOptions,duration:0}):a._updateViewState(o)),c.isStyleLoaded()?c.fire("load"):c.once("style.load",()=>c.fire("load")),c._update(),a}_initialize(t){const{props:i}=this,{mapStyle:a=KM}=i,c={...i,...i.initialViewState,container:t,style:XM(a)},h=c.initialViewState||c.viewState||c;if(Object.assign(c,{center:[h.longitude||0,h.latitude||0],zoom:h.zoom||0,pitch:h.pitch||0,bearing:h.bearing||0}),i.gl){const o=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=o,i.gl)}const f=new this._MapClass(c);h.padding&&f.setPadding(h.padding),i.cursor&&(f.getCanvas().style.cursor=i.cursor),f.transformCameraUpdate=this._onCameraUpdate,f.on("style.load",()=>{this._styleComponents={light:f.getLight(),sky:f.getSky(),projection:f.getProjection?.(),terrain:f.getTerrain()},this._updateStyleComponents(this.props)}),f.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const o in YM)f.on(o,this._onPointerEvent);for(const o in JM)f.on(o,this._onCameraEvent);for(const o in QM)f.on(o,this._onEvent);this._map=f}recycle(){this.map.getContainer().querySelector("[mapboxgl-children]")?.remove(),Vg.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_updateSize(t){const{viewState:i}=t;if(i){const a=this._map;if(i.width!==a.transform.width||i.height!==a.transform.height)return a.resize(),!0}return!1}_updateViewState(t){const i=this._map,a=i.transform;if(!i.isMoving()){const h=ZM(a,t);if(Object.keys(h).length>0)return this._internalUpdate=!0,i.jumpTo(h),this._internalUpdate=!1,!0}return!1}_updateSettings(t,i){const a=this._map;let c=!1;for(const h of YV)h in t&&!wa(t[h],i[h])&&(c=!0,a[`set${h[0].toUpperCase()}${h.slice(1)}`]?.call(a,t[h]));return c}_updateStyle(t,i){if(t.cursor!==i.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==i.mapStyle){const{mapStyle:a=KM,styleDiffing:c=!0}=t,h={diff:c};"localIdeographFontFamily"in t&&(h.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(XM(a),h)}}_updateStyleComponents({light:t,projection:i,sky:a,terrain:c}){const h=this._map,f=this._styleComponents;h.style._loaded&&(t&&!wa(t,f.light)&&(f.light=t,h.setLight(t)),i&&!wa(i,f.projection)&&i!==f.projection?.type&&(f.projection=typeof i=="string"?{type:i}:i,h.setProjection?.(f.projection)),a&&!wa(a,f.sky)&&(f.sky=a,h.setSky(a)),c!==void 0&&!wa(c,f.terrain)&&(!c||h.getSource(c.source))&&(f.terrain=c,h.setTerrain(c)))}_updateHandlers(t,i){const a=this._map;for(const c of JV){const h=t[c]??!0,f=i[c]??!0;wa(h,f)||(h?a[c].enable(h):a[c].disable())}}_queryRenderedFeatures(t){const i=this._map,{interactiveLayerIds:a=[]}=this.props;try{return i.queryRenderedFeatures(t,{layers:a.filter(i.getLayer.bind(i))})}catch{return[]}}_updateHover(t){const{props:i}=this;if(i.interactiveLayerIds&&(i.onMouseMove||i.onMouseEnter||i.onMouseLeave)){const c=t.type,h=this._hoveredFeatures?.length>0,f=this._queryRenderedFeatures(t.point),o=f.length>0;!o&&h&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=f,o&&!h&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=c}else this._hoveredFeatures=null}}Vg.savedMaps=[];const QV=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function e9(e){if(!e)return null;const t=e.map,i={getMap:()=>t};for(const a of t9(t))!(a in i)&&!QV.includes(a)&&(i[a]=t[a].bind(t));return i}function t9(e){const t=new Set;let i=e;for(;i;){for(const a of Object.getOwnPropertyNames(i))a[0]!=="_"&&typeof e[a]=="function"&&a!=="fire"&&a!=="setEventedParent"&&t.add(a);i=Object.getPrototypeOf(i)}return Array.from(t)}const r9=typeof document<"u"?K.useLayoutEffect:K.useEffect;function n9(e,t){const{RTLTextPlugin:i,maxParallelImageRequests:a,workerCount:c,workerUrl:h}=t;if(i&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:f,lazy:o=!0}=typeof i=="string"?{pluginUrl:i}:i;e.setRTLTextPlugin(f,b=>{b&&console.error(b)},o)}a!==void 0&&e.setMaxParallelImageRequests(a),c!==void 0&&e.setWorkerCount(c),h!==void 0&&e.setWorkerUrl(h)}const cm=K.createContext(null);function i9(e,t){const i=K.useContext(zA),[a,c]=K.useState(null),h=K.useRef(),{current:f}=K.useRef({mapLib:null,map:null});K.useEffect(()=>{const P=e.mapLib;let I=!0,D;return Promise.resolve(P||WV(()=>Promise.resolve().then(()=>M9),void 0)).then(z=>{if(!I)return;if(!z)throw new Error("Invalid mapLib");const F="Map"in z?z:z.default;if(!F.Map)throw new Error("Invalid mapLib");n9(F,e),e.reuseMaps&&(D=Vg.reuse(e,h.current)),D||(D=new Vg(F.Map,e,h.current)),f.map=e9(D),f.mapLib=F,c(D),i?.onMapMount(f.map,e.id)}).catch(z=>{const{onError:F}=e;F?F({type:"error",target:null,originalEvent:null,error:z}):console.error(z)}),()=>{I=!1,D&&(i?.onMapUnmount(e.id),e.reuseMaps?D.recycle():D.destroy())}},[]),r9(()=>{a&&a.setProps(e)}),K.useImperativeHandle(t,()=>f.map,[a]);const o=K.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),b={height:"100%"};return K.createElement("div",{id:e.id,ref:h,style:o},a&&K.createElement(cm.Provider,{value:f},K.createElement("div",{"mapboxgl-children":"",style:b},e.children)))}const o9=K.forwardRef(i9),s9=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function cd(e,t){if(!e||!t)return;const i=e.style;for(const a in t){const c=t[a];Number.isFinite(c)&&!s9.test(a)?i[a]=`${c}px`:i[a]=c}}function OA(e,t){if(e===t)return null;const i=eP(e),a=eP(t),c=[];for(const h of a)i.has(h)||c.push(h);for(const h of i)a.has(h)||c.push(h);return c.length===0?null:c}function eP(e){return new Set(e?e.trim().split(/\s+/):[])}const ux=K.memo(K.forwardRef((e,t)=>{const{map:i,mapLib:a}=K.useContext(cm),c=K.useRef({props:e}),h=K.useMemo(()=>{let ie=!1;K.Children.forEach(e.children,de=>{de&&(ie=!0)});const se={...e,element:ie?document.createElement("div"):void 0},Q=new a.Marker(se);return Q.setLngLat([e.longitude,e.latitude]),Q.getElement().addEventListener("click",de=>{c.current.props.onClick?.({type:"click",target:Q,originalEvent:de})}),Q.on("dragstart",de=>{const oe=de;oe.lngLat=h.getLngLat(),c.current.props.onDragStart?.(oe)}),Q.on("drag",de=>{const oe=de;oe.lngLat=h.getLngLat(),c.current.props.onDrag?.(oe)}),Q.on("dragend",de=>{const oe=de;oe.lngLat=h.getLngLat(),c.current.props.onDragEnd?.(oe)}),Q},[]);K.useEffect(()=>(h.addTo(i.getMap()),()=>{h.remove()}),[]);const{longitude:f,latitude:o,offset:b,style:P,draggable:I=!1,popup:D=null,rotation:z=0,rotationAlignment:F="auto",pitchAlignment:U="auto"}=e;K.useEffect(()=>{cd(h.getElement(),P)},[P]),K.useImperativeHandle(t,()=>h,[]);const $=c.current.props;(h.getLngLat().lng!==f||h.getLngLat().lat!==o)&&h.setLngLat([f,o]),b&&!XV(h.getOffset(),b)&&h.setOffset(b),h.isDraggable()!==I&&h.setDraggable(I),h.getRotation()!==z&&h.setRotation(z),h.getRotationAlignment()!==F&&h.setRotationAlignment(F),h.getPitchAlignment()!==U&&h.setPitchAlignment(U),h.getPopup()!==D&&h.setPopup(D);const j=OA($.className,e.className);if(j)for(const ie of j)h.toggleClassName(ie);return c.current.props=e,Zu.createPortal(e.children,h.getElement())}));K.memo(K.forwardRef((e,t)=>{const{map:i,mapLib:a}=K.useContext(cm),c=K.useMemo(()=>document.createElement("div"),[]),h=K.useRef({props:e}),f=K.useMemo(()=>{const o={...e},b=new a.Popup(o);return b.setLngLat([e.longitude,e.latitude]),b.once("open",P=>{h.current.props.onOpen?.(P)}),b},[]);if(K.useEffect(()=>{const o=b=>{h.current.props.onClose?.(b)};return f.on("close",o),f.setDOMContent(c).addTo(i.getMap()),()=>{f.off("close",o),f.isOpen()&&f.remove()}},[]),K.useEffect(()=>{cd(f.getElement(),e.style)},[e.style]),K.useImperativeHandle(t,()=>f,[]),f.isOpen()){const o=h.current.props;(f.getLngLat().lng!==e.longitude||f.getLngLat().lat!==e.latitude)&&f.setLngLat([e.longitude,e.latitude]),e.offset&&!wa(o.offset,e.offset)&&f.setOffset(e.offset),(o.anchor!==e.anchor||o.maxWidth!==e.maxWidth)&&(f.options.anchor=e.anchor,f.setMaxWidth(e.maxWidth));const b=OA(o.className,e.className);if(b)for(const P of b)f.toggleClassName(P);h.current.props=e}return Zu.createPortal(e.children,c)}));function um(e,t,i,a){const c=K.useContext(cm),h=K.useMemo(()=>e(c),[]);return K.useEffect(()=>{const f=t,o=null,b=typeof t=="function"?t:null,{map:P}=c;return P.hasControl(h)||(P.addControl(h,f?.position),o&&o(c)),()=>{b&&b(c),P.hasControl(h)&&P.removeControl(h)}},[]),h}function a9(e){const t=um(({mapLib:i})=>new i.AttributionControl(e),{position:e.position});return K.useEffect(()=>{cd(t._container,e.style)},[e.style]),null}K.memo(a9);function l9(e){const t=um(({mapLib:i})=>new i.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return K.useEffect(()=>{cd(t._controlContainer,e.style)},[e.style]),null}K.memo(l9);function c9(e,t){const i=K.useRef({props:e}),a=um(({mapLib:c})=>{const h=new c.GeolocateControl(e),f=h._setupUI;return h._setupUI=()=>{h._container.hasChildNodes()||f()},h.on("geolocate",o=>{i.current.props.onGeolocate?.(o)}),h.on("error",o=>{i.current.props.onError?.(o)}),h.on("outofmaxbounds",o=>{i.current.props.onOutOfMaxBounds?.(o)}),h.on("trackuserlocationstart",o=>{i.current.props.onTrackUserLocationStart?.(o)}),h.on("trackuserlocationend",o=>{i.current.props.onTrackUserLocationEnd?.(o)}),h},{position:e.position});return i.current.props=e,K.useImperativeHandle(t,()=>a,[]),K.useEffect(()=>{cd(a._container,e.style)},[e.style]),null}K.memo(K.forwardRef(c9));function u9(e){const t=um(({mapLib:i})=>new i.NavigationControl(e),{position:e.position});return K.useEffect(()=>{cd(t._container,e.style)},[e.style]),null}K.memo(u9);function h9(e){const t=um(({mapLib:h})=>new h.ScaleControl(e),{position:e.position}),i=K.useRef(e),a=i.current;i.current=e;const{style:c}=e;return e.maxWidth!==void 0&&e.maxWidth!==a.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==a.unit&&t.setUnit(e.unit),K.useEffect(()=>{cd(t._container,c)},[c]),null}K.memo(h9);function d9(e){const t=um(({mapLib:i})=>new i.TerrainControl(e),{position:e.position});return K.useEffect(()=>{cd(t._container,e.style)},[e.style]),null}K.memo(d9);function f9(e){const t=um(({mapLib:i})=>new i.LogoControl(e),{position:e.position});return K.useEffect(()=>{cd(t._container,e.style)},[e.style]),null}K.memo(f9);function hx(e,t){if(!e)throw new Error(t)}let p9=0;function m9(e,t,i){if(e.style&&e.style._loaded){const a={...i};return delete a.id,delete a.children,e.addSource(t,a),e.getSource(t)}return null}function g9(e,t,i){hx(t.id===i.id,"source id changed"),hx(t.type===i.type,"source type changed");let a="",c=0;for(const f in t)f!=="children"&&f!=="id"&&!wa(i[f],t[f])&&(a=f,c++);if(!c)return;const h=t.type;if(h==="geojson")e.setData(t.data);else if(h==="image")e.updateImage({url:t.url,coordinates:t.coordinates});else switch(a){case"coordinates":e.setCoordinates?.(t.coordinates);break;case"url":e.setUrl?.(t.url);break;case"tiles":e.setTiles?.(t.tiles);break;default:console.warn(`Unable to update <Source> prop: ${a}`)}}function Xc(e){const t=K.useContext(cm).map.getMap(),i=K.useRef(e),[,a]=K.useState(0),c=K.useMemo(()=>e.id||`jsx-source-${p9++}`,[]);K.useEffect(()=>{if(t){const f=()=>setTimeout(()=>a(o=>o+1),0);return t.on("styledata",f),f(),()=>{if(t.off("styledata",f),t.style&&t.style._loaded&&t.getSource(c)){const o=t.getStyle()?.layers;if(o)for(const b of o)b.source===c&&t.removeLayer(b.id);t.removeSource(c)}}}},[t]);let h=t&&t.style&&t.getSource(c);return h?g9(h,e,i.current):h=m9(t,c,e),i.current=e,h&&K.Children.map(e.children,f=>f&&K.cloneElement(f,{source:c}))||null}function y9(e,t,i,a){if(hx(i.id===a.id,"layer id changed"),hx(i.type===a.type,"layer type changed"),i.type==="custom"||a.type==="custom")return;const{layout:c={},paint:h={},filter:f,minzoom:o,maxzoom:b,beforeId:P}=i;if(P!==a.beforeId&&e.moveLayer(t,P),c!==a.layout){const I=a.layout||{};for(const D in c)wa(c[D],I[D])||e.setLayoutProperty(t,D,c[D]);for(const D in I)c.hasOwnProperty(D)||e.setLayoutProperty(t,D,void 0)}if(h!==a.paint){const I=a.paint||{};for(const D in h)wa(h[D],I[D])||e.setPaintProperty(t,D,h[D]);for(const D in I)h.hasOwnProperty(D)||e.setPaintProperty(t,D,void 0)}wa(f,a.filter)||e.setFilter(t,f),(o!==a.minzoom||b!==a.maxzoom)&&e.setLayerZoomRange(t,o,b)}function v9(e,t,i){if(e.style&&e.style._loaded&&(!("source"in i)||e.getSource(i.source))){const a={...i,id:t};delete a.beforeId,e.addLayer(a,i.beforeId)}}let _9=0;function Qr(e){const t=K.useContext(cm).map.getMap(),i=K.useRef(e),[,a]=K.useState(0),c=K.useMemo(()=>e.id||`jsx-layer-${_9++}`,[]);if(K.useEffect(()=>{if(t){const f=()=>a(o=>o+1);return t.on("styledata",f),f(),()=>{t.off("styledata",f),t.style&&t.style._loaded&&t.getLayer(c)&&t.removeLayer(c)}}},[t]),t&&t.style&&t.getLayer(c))try{y9(t,c,e,i.current)}catch(f){console.warn(f)}else v9(t,c,e);return i.current=e,null}const x9={"text-color":"hsl(42, 10%, 14%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 100%)"},b9={"text-color":"hsl(42, 10%, 24%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 100%)"},w9={"text-color":"hsl(42, 10%, 86%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 0%)"},S9={"text-color":"hsl(42, 10%, 76%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 0%)"},m1={light:{water:"#b2cdfb",land:"#f8f8f8",stateBorder:"#aaa",countryBorder:"#ccc",primaryTextPaint:x9,secondaryTextPaint:b9,hiddenRoad:"#e9e9e8",footprint:"#e9e9e8",ferryLine:"#6c90ff88",ferryLabel:"#6c80ff",ferryHalo:"#eeeeffcc",trainLine:"#aaa",trainLabel:"#555c",trainHalo:"#eefc",mapAreaOutline:"#999a"},dark:{water:"#36415d",land:"#1a1a1a",stateBorder:"#555",countryBorder:"#333",primaryTextPaint:w9,secondaryTextPaint:S9,hiddenRoad:"#404038",footprint:"#30302f88",ferryLine:"#6c90ff88",ferryLabel:"#6c80ff",ferryHalo:"#303028cc",trainLine:"#888",trainLabel:"#eeec",trainHalo:"#303028cc",mapAreaOutline:"#777a"}};var F_={exports:{}};var C9=F_.exports,tP;function T9(){return tP||(tP=1,function(e,t){(function(i,a){e.exports=a()})(C9,function(){var i={},a={};function c(f,o,b){if(a[f]=b,f==="index"){var P="var sharedModule = {}; ("+a.shared+")(sharedModule); ("+a.worker+")(sharedModule);",I={};return a.shared(I),a.index(i,I),typeof window<"u"&&i.setWorkerUrl(window.URL.createObjectURL(new Blob([P],{type:"text/javascript"}))),i}}c("shared",["exports"],function(f){function o(l,r,s,d){return new(s||(s=Promise))(function(g,_){function x(R){try{E(d.next(R))}catch(L){_(L)}}function C(R){try{E(d.throw(R))}catch(L){_(L)}}function E(R){var L;R.done?g(R.value):(L=R.value,L instanceof s?L:new s(function(V){V(L)})).then(x,C)}E((d=d.apply(l,r||[])).next())})}function b(l,r){this.x=l,this.y=r}function P(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var I,D;typeof SuppressedError=="function"&&SuppressedError,b.prototype={clone(){return new b(this.x,this.y)},add(l){return this.clone()._add(l)},sub(l){return this.clone()._sub(l)},multByPoint(l){return this.clone()._multByPoint(l)},divByPoint(l){return this.clone()._divByPoint(l)},mult(l){return this.clone()._mult(l)},div(l){return this.clone()._div(l)},rotate(l){return this.clone()._rotate(l)},rotateAround(l,r){return this.clone()._rotateAround(l,r)},matMult(l){return this.clone()._matMult(l)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(l){return this.x===l.x&&this.y===l.y},dist(l){return Math.sqrt(this.distSqr(l))},distSqr(l){const r=l.x-this.x,s=l.y-this.y;return r*r+s*s},angle(){return Math.atan2(this.y,this.x)},angleTo(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith(l){return this.angleWithSep(l.x,l.y)},angleWithSep(l,r){return Math.atan2(this.x*r-this.y*l,this.x*l+this.y*r)},_matMult(l){const r=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=r,this},_add(l){return this.x+=l.x,this.y+=l.y,this},_sub(l){return this.x-=l.x,this.y-=l.y,this},_mult(l){return this.x*=l,this.y*=l,this},_div(l){return this.x/=l,this.y/=l,this},_multByPoint(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint(l){return this.x/=l.x,this.y/=l.y,this},_unit(){return this._div(this.mag()),this},_perp(){const l=this.y;return this.y=this.x,this.x=-l,this},_rotate(l){const r=Math.cos(l),s=Math.sin(l),d=s*this.x+r*this.y;return this.x=r*this.x-s*this.y,this.y=d,this},_rotateAround(l,r){const s=Math.cos(l),d=Math.sin(l),g=r.y+d*(this.x-r.x)+s*(this.y-r.y);return this.x=r.x+s*(this.x-r.x)-d*(this.y-r.y),this.y=g,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:b},b.convert=function(l){if(l instanceof b)return l;if(Array.isArray(l))return new b(+l[0],+l[1]);if(l.x!==void 0&&l.y!==void 0)return new b(+l.x,+l.y);throw new Error("Expected [x, y] or {x, y} point format")};var z=function(){if(D)return I;function l(r,s,d,g){this.cx=3*r,this.bx=3*(d-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(g-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=s,this.p2x=d,this.p2y=g}return D=1,I=l,l.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,s){if(s===void 0&&(s=1e-6),r<0)return 0;if(r>1)return 1;for(var d=r,g=0;g<8;g++){var _=this.sampleCurveX(d)-r;if(Math.abs(_)<s)return d;var x=this.sampleCurveDerivativeX(d);if(Math.abs(x)<1e-6)break;d-=_/x}var C=0,E=1;for(d=r,g=0;g<20&&(_=this.sampleCurveX(d),!(Math.abs(_-r)<s));g++)r>_?C=d:E=d,d=.5*(E-C)+C;return d},solve:function(r,s){return this.sampleCurveY(this.solveCurveX(r,s))}},I}(),F=P(z);let U,$;function j(){return U==null&&(U=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),U}function ie(){if($==null&&($=!1,j())){const r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let d=0;d<5*5;d++){const g=4*d;r.fillStyle=`rgb(${g},${g+1},${g+2})`,r.fillRect(d%5,Math.floor(d/5),1,1)}const s=r.getImageData(0,0,5,5).data;for(let d=0;d<5*5*4;d++)if(d%4!=3&&s[d]!==d){$=!0;break}}}return $||!1}var se=1e-6,Q=typeof Float32Array<"u"?Float32Array:Array;function de(){var l=new Q(9);return Q!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}function oe(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function be(){var l=new Q(3);return Q!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l}function xe(l){var r=l[0],s=l[1],d=l[2];return Math.sqrt(r*r+s*s+d*d)}function Me(l,r,s){var d=new Q(3);return d[0]=l,d[1]=r,d[2]=s,d}function Ee(l,r,s){return l[0]=r[0]+s[0],l[1]=r[1]+s[1],l[2]=r[2]+s[2],l}function re(l,r,s){return l[0]=r[0]*s,l[1]=r[1]*s,l[2]=r[2]*s,l}function ke(l,r,s){var d=r[0],g=r[1],_=r[2],x=s[0],C=s[1],E=s[2];return l[0]=g*E-_*C,l[1]=_*x-d*E,l[2]=d*C-g*x,l}var Ge,Ke=xe;function gt(l,r,s){var d=r[0],g=r[1],_=r[2],x=r[3];return l[0]=s[0]*d+s[4]*g+s[8]*_+s[12]*x,l[1]=s[1]*d+s[5]*g+s[9]*_+s[13]*x,l[2]=s[2]*d+s[6]*g+s[10]*_+s[14]*x,l[3]=s[3]*d+s[7]*g+s[11]*_+s[15]*x,l}function et(){var l=new Q(4);return Q!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l[3]=1,l}function qe(l,r,s,d){var g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",_=Math.PI/360;r*=_,d*=_,s*=_;var x=Math.sin(r),C=Math.cos(r),E=Math.sin(s),R=Math.cos(s),L=Math.sin(d),V=Math.cos(d);switch(g){case"xyz":l[0]=x*R*V+C*E*L,l[1]=C*E*V-x*R*L,l[2]=C*R*L+x*E*V,l[3]=C*R*V-x*E*L;break;case"xzy":l[0]=x*R*V-C*E*L,l[1]=C*E*V-x*R*L,l[2]=C*R*L+x*E*V,l[3]=C*R*V+x*E*L;break;case"yxz":l[0]=x*R*V+C*E*L,l[1]=C*E*V-x*R*L,l[2]=C*R*L-x*E*V,l[3]=C*R*V+x*E*L;break;case"yzx":l[0]=x*R*V+C*E*L,l[1]=C*E*V+x*R*L,l[2]=C*R*L-x*E*V,l[3]=C*R*V-x*E*L;break;case"zxy":l[0]=x*R*V-C*E*L,l[1]=C*E*V+x*R*L,l[2]=C*R*L+x*E*V,l[3]=C*R*V-x*E*L;break;case"zyx":l[0]=x*R*V-C*E*L,l[1]=C*E*V+x*R*L,l[2]=C*R*L-x*E*V,l[3]=C*R*V+x*E*L;break;default:throw new Error("Unknown angle order "+g)}return l}function Qe(){var l=new Q(2);return Q!=Float32Array&&(l[0]=0,l[1]=0),l}function Ve(l,r){var s=new Q(2);return s[0]=l,s[1]=r,s}be(),Ge=new Q(4),Q!=Float32Array&&(Ge[0]=0,Ge[1]=0,Ge[2]=0,Ge[3]=0),be(),Me(1,0,0),Me(0,1,0),et(),et(),de(),Qe();const je=8192;function ct(l,r,s){return r*(je/(l.tileSize*Math.pow(2,s-l.tileID.overscaledZ)))}function ye(l,r){return(l%r+r)%r}function ze(l,r,s){return l*(1-s)+r*s}function ft(l){if(l<=0)return 0;if(l>=1)return 1;const r=l*l,s=r*l;return 4*(l<.5?s:3*(l-r)+s-.75)}function wt(l,r,s,d){const g=new F(l,r,s,d);return _=>g.solve(_)}const xt=wt(.25,.1,.25,1);function _t(l,r,s){return Math.min(s,Math.max(r,l))}function St(l,r,s){const d=s-r,g=((l-r)%d+d)%d+r;return g===r?s:g}function tt(l,...r){for(const s of r)for(const d in s)l[d]=s[d];return l}let At=1;function It(l,r,s){const d={};for(const g in l)d[g]=r.call(this,l[g],g,l);return d}function mr(l,r,s){const d={};for(const g in l)r.call(this,l[g],g,l)&&(d[g]=l[g]);return d}function ur(l){return Array.isArray(l)?l.map(ur):typeof l=="object"&&l?It(l,ur):l}const Hr={};function wr(l){Hr[l]||(typeof console<"u"&&console.warn(l),Hr[l]=!0)}function sr(l,r,s){return(s.y-l.y)*(r.x-l.x)>(r.y-l.y)*(s.x-l.x)}function Wt(l){return typeof WorkerGlobalScope<"u"&&l!==void 0&&l instanceof WorkerGlobalScope}let yr=null;function Yt(l){return typeof ImageBitmap<"u"&&l instanceof ImageBitmap}const Cr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Rr(l,r,s,d,g){return o(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const _=new VideoFrame(l,{timestamp:0});try{const x=_?.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const C=x.startsWith("BGR"),E=new Uint8ClampedArray(d*g*4);if(yield _.copyTo(E,function(R,L,V,H,Z){const J=4*Math.max(-L,0),ee=(Math.max(0,V)-V)*H*4+J,ne=4*H,fe=Math.max(0,L),Te=Math.max(0,V);return{rect:{x:fe,y:Te,width:Math.min(R.width,L+H)-fe,height:Math.min(R.height,V+Z)-Te},layout:[{offset:ee,stride:ne}]}}(l,r,s,d,g)),C)for(let R=0;R<E.length;R+=4){const L=E[R];E[R]=E[R+2],E[R+2]=L}return E}finally{_.close()}})}let Or,Gr;function rn(l,r,s,d){return l.addEventListener(r,s,d),{unsubscribe:()=>{l.removeEventListener(r,s,d)}}}function Un(l){return l*Math.PI/180}function wn(l){return l/Math.PI*180}const He={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},ae={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},le="AbortError";class ue extends Error{constructor(r=le){super(r instanceof Error?r.message:r),this.name=le,r instanceof Error&&r.stack&&(this.stack=r.stack)}}function Pe(l){return l.name===le}const Re={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Ye(l){return Re.REGISTERED_PROTOCOLS[l.substring(0,l.indexOf("://"))]}const Xe="global-dispatcher";class $e extends Error{constructor(r,s,d,g){super(`AJAXError: ${s} (${r}): ${d}`),this.status=r,this.statusText=s,this.url=d,this.body=g}}const Je=()=>Wt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ct=function(l,r){if(/:\/\//.test(l.url)&&!/^https?:|^file:/.test(l.url)){const d=Ye(l.url);if(d)return d(l,r);if(Wt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:l,targetMapId:Xe},r)}if(!(/^file:/.test(s=l.url)||/^file:/.test(Je())&&!/^\w+:/.test(s))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(d,g){return o(this,void 0,void 0,function*(){const _=new Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,cache:d.cache,referrer:Je(),signal:g.signal});let x,C;d.type!=="json"||_.headers.has("Accept")||_.headers.set("Accept","application/json");try{x=yield fetch(_)}catch(R){throw Pe(R)?R:new $e(0,R.message,d.url,new Blob)}if(!x.ok){const R=yield x.blob();throw new $e(x.status,x.statusText,d.url,R)}C=d.type==="arrayBuffer"||d.type==="image"?x.arrayBuffer():d.type==="json"?x.json():x.text();const E=yield C;return g.signal.throwIfAborted(),{data:E,cacheControl:x.headers.get("Cache-Control"),expires:x.headers.get("Expires")}})}(l,r);if(Wt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:l,mustQueue:!0,targetMapId:Xe},r)}var s;return function(d,g){return new Promise((_,x)=>{var C;const E=new XMLHttpRequest;E.open(d.method||"GET",d.url,!0),d.type!=="arrayBuffer"&&d.type!=="image"||(E.responseType="arraybuffer");for(const R in d.headers)E.setRequestHeader(R,d.headers[R]);d.type==="json"&&(E.responseType="text",!((C=d.headers)===null||C===void 0)&&C.Accept||E.setRequestHeader("Accept","application/json")),E.withCredentials=d.credentials==="include",E.onerror=()=>{x(new Error(E.statusText))},E.onload=()=>{if(!g.signal.aborted)if((E.status>=200&&E.status<300||E.status===0)&&E.response!==null){let R=E.response;if(d.type==="json")try{R=JSON.parse(E.response)}catch(L){return void x(L)}_({data:R,cacheControl:E.getResponseHeader("Cache-Control"),expires:E.getResponseHeader("Expires")})}else{const R=new Blob([E.response],{type:E.getResponseHeader("Content-Type")});x(new $e(E.status,E.statusText,d.url,R))}},g.signal.addEventListener("abort",()=>{E.abort(),x(new ue(g.signal.reason))}),E.send(d.body)})}(l,r)};function yt(l){if(!l||l.indexOf("://")<=0||l.indexOf("data:image/")===0||l.indexOf("blob:")===0)return!0;const r=new URL(l),s=window.location;return r.protocol===s.protocol&&r.host===s.host}function $t(l,r,s){s[l]&&s[l].indexOf(r)!==-1||(s[l]=s[l]||[],s[l].push(r))}function qt(l,r,s){if(s&&s[l]){const d=s[l].indexOf(r);d!==-1&&s[l].splice(d,1)}}class Qt{constructor(r,s={}){tt(this,s),this.type=r}}class br extends Qt{constructor(r,s={}){super("error",tt({error:r},s))}}class tr{on(r,s){return this._listeners=this._listeners||{},$t(r,s,this._listeners),{unsubscribe:()=>{this.off(r,s)}}}off(r,s){return qt(r,s,this._listeners),qt(r,s,this._oneTimeListeners),this}once(r,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},$t(r,s,this._oneTimeListeners),this):new Promise(d=>this.once(r,d))}fire(r,s){typeof r=="string"&&(r=new Qt(r,s||{}));const d=r.type;if(this.listens(d)){r.target=this;const g=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const C of g)C.call(this,r);const _=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const C of _)qt(d,C,this._oneTimeListeners),C.call(this,r);const x=this._eventedParent;x&&(tt(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(r))}else r instanceof br&&console.error(r.error);return this}listens(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)}setEventedParent(r,s){return this._eventedParent=r,this._eventedParentData=s,this}}var Ze={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number",length:2},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"filter"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},filter:{type:"boolean",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"expression_name",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}},interpolation:{type:"array",value:"interpolation_name",minimum:1},interpolation_name:{type:"enum",values:{linear:{syntax:{overloads:[{parameters:[],"output-type":"interpolation"}],parameters:[]}},exponential:{syntax:{overloads:[{parameters:["base"],"output-type":"interpolation"}],parameters:[{name:"base",type:"number literal"}]}},"cubic-bezier":{syntax:{overloads:[{parameters:["x1","y1","x2","y2"],"output-type":"interpolation"}],parameters:[{name:"x1",type:"number literal"},{name:"y1",type:"number literal"},{name:"x2",type:"number literal"},{name:"y2",type:"number literal"}]}}}}};const Lr=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function mn(l,r){const s={};for(const d in l)d!=="ref"&&(s[d]=l[d]);return Lr.forEach(d=>{d in r&&(s[d]=r[d])}),s}function ar(l,r){if(Array.isArray(l)){if(!Array.isArray(r)||l.length!==r.length)return!1;for(let s=0;s<l.length;s++)if(!ar(l[s],r[s]))return!1;return!0}if(typeof l=="object"&&l!==null&&r!==null){if(typeof r!="object"||Object.keys(l).length!==Object.keys(r).length)return!1;for(const s in l)if(!ar(l[s],r[s]))return!1;return!0}return l===r}function Dr(l,r){l.push(r)}function ln(l,r,s){Dr(s,{command:"addSource",args:[l,r[l]]})}function Xr(l,r,s){Dr(r,{command:"removeSource",args:[l]}),s[l]=!0}function zr(l,r,s,d){Xr(l,s,d),ln(l,r,s)}function Vr(l,r,s){let d;for(d in l[s])if(Object.prototype.hasOwnProperty.call(l[s],d)&&d!=="data"&&!ar(l[s][d],r[s][d]))return!1;for(d in r[s])if(Object.prototype.hasOwnProperty.call(r[s],d)&&d!=="data"&&!ar(l[s][d],r[s][d]))return!1;return!0}function Kr(l,r,s,d,g,_){l=l||{},r=r||{};for(const x in l)Object.prototype.hasOwnProperty.call(l,x)&&(ar(l[x],r[x])||s.push({command:_,args:[d,x,r[x],g]}));for(const x in r)Object.prototype.hasOwnProperty.call(r,x)&&!Object.prototype.hasOwnProperty.call(l,x)&&(ar(l[x],r[x])||s.push({command:_,args:[d,x,r[x],g]}))}function Vi(l){return l.id}function Ui(l,r){return l[r.id]=r,l}class Et{constructor(r,s,d,g){this.message=(r?`${r}: `:"")+d,g&&(this.identifier=g),s!=null&&s.__line__&&(this.line=s.__line__)}}function vn(l,...r){for(const s of r)for(const d in s)l[d]=s[d];return l}class zn extends Error{constructor(r,s){super(s),this.message=s,this.key=r}}class fs{constructor(r,s=[]){this.parent=r,this.bindings={};for(const[d,g]of s)this.bindings[d]=g}concat(r){return new fs(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const Ki={kind:"null"},jt={kind:"number"},ot={kind:"string"},rt={kind:"boolean"},Zt={kind:"color"},Tr={kind:"projectionDefinition"},Nr={kind:"object"},ir={kind:"value"},An={kind:"collator"},Gi={kind:"formatted"},Ra={kind:"padding"},pl={kind:"colorArray"},Gn={kind:"numberArray"},ml={kind:"resolvedImage"},Qs={kind:"variableAnchorOffsetCollection"};function Yi(l,r){return{kind:"array",itemType:l,N:r}}function nn(l){if(l.kind==="array"){const r=nn(l.itemType);return typeof l.N=="number"?`array<${r}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${r}>`}return l.kind}const nc=[Ki,jt,ot,rt,Zt,Tr,Gi,Nr,Yi(ir),Ra,Gn,pl,ml,Qs];function Mr(l,r){if(r.kind==="error")return null;if(l.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!Mr(l.itemType,r.itemType))&&(typeof l.N!="number"||l.N===r.N))return null}else{if(l.kind===r.kind)return null;if(l.kind==="value"){for(const s of nc)if(!Mr(s,r))return null}}return`Expected ${nn(l)} but found ${nn(r)} instead.`}function Ei(l,r){return r.some(s=>s.kind===l.kind)}function on(l,r){return r.some(s=>s==="null"?l===null:s==="array"?Array.isArray(l):s==="object"?l&&!Array.isArray(l)&&typeof l=="object":s===typeof l)}function fi(l,r){return l.kind==="array"&&r.kind==="array"?l.itemType.kind===r.itemType.kind&&typeof l.N=="number":l.kind===r.kind}const Ii=.96422,Rs=.82521,os=4/29,gn=6/29,lh=3*gn*gn,ch=gn*gn*gn,Da=Math.PI/180,uh=180/Math.PI;function hm(l){return(l%=360)<0&&(l+=360),l}function dm([l,r,s,d]){let g,_;const x=hd((.2225045*(l=lu(l))+.7168786*(r=lu(r))+.0606169*(s=lu(s)))/1);l===r&&r===s?g=_=x:(g=hd((.4360747*l+.3850649*r+.1430804*s)/Ii),_=hd((.0139322*l+.0971045*r+.7141733*s)/Rs));const C=116*x-16;return[C<0?0:C,500*(g-x),200*(x-_),d]}function lu(l){return l<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function hd(l){return l>ch?Math.pow(l,1/3):l/lh+os}function hh([l,r,s,d]){let g=(l+16)/116,_=isNaN(r)?g:g+r/500,x=isNaN(s)?g:g-s/200;return g=1*Lf(g),_=Ii*Lf(_),x=Rs*Lf(x),[ic(3.1338561*_-1.6168667*g-.4906146*x),ic(-.9787684*_+1.9161415*g+.033454*x),ic(.0719453*_-.2289914*g+1.4052427*x),d]}function ic(l){return(l=l<=.00304?12.92*l:1.055*Math.pow(l,1/2.4)-.055)<0?0:l>1?1:l}function Lf(l){return l>gn?l*l*l:lh*(l-os)}const Ff=Object.hasOwn||function(l,r){return Object.prototype.hasOwnProperty.call(l,r)};function fn(l,r){return Ff(l,r)?l[r]:void 0}function dh(l){return parseInt(l.padEnd(2,l),16)/255}function Bf(l,r){return gl(r?l/100:l,0,1)}function gl(l,r,s){return Math.min(Math.max(r,l),s)}function dd(l){return!l.some(Number.isNaN)}const cu={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function za(l,r,s){return l+s*(r-l)}function yl(l,r,s){return l.map((d,g)=>za(d,r[g],s))}class Fr{constructor(r,s,d,g=1,_=!0){this.r=r,this.g=s,this.b=d,this.a=g,_||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[r,s,d,g]))}static parse(r){if(r instanceof Fr)return r;if(typeof r!="string")return;const s=function(d){if((d=d.toLowerCase().trim())==="transparent")return[0,0,0,0];const g=fn(cu,d);if(g){const[x,C,E]=g;return[x/255,C/255,E/255,1]}if(d.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(d)){const x=d.length<6?1:2;let C=1;return[dh(d.slice(C,C+=x)),dh(d.slice(C,C+=x)),dh(d.slice(C,C+=x)),dh(d.slice(C,C+x)||"ff")]}if(d.startsWith("rgb")){const x=d.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[C,E,R,L,V,H,Z,J,ee,ne,fe,Te]=x,pe=[L||" ",Z||" ",ne].join("");if(pe==="  "||pe==="  /"||pe===",,"||pe===",,,"){const me=[R,H,ee].join(""),Ie=me==="%%%"?100:me===""?255:0;if(Ie){const Fe=[gl(+E/Ie,0,1),gl(+V/Ie,0,1),gl(+J/Ie,0,1),fe?Bf(+fe,Te):1];if(dd(Fe))return Fe}}return}}const _=d.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[x,C,E,R,L,V,H,Z,J]=_,ee=[E||" ",L||" ",H].join("");if(ee==="  "||ee==="  /"||ee===",,"||ee===",,,"){const ne=[+C,gl(+R,0,100),gl(+V,0,100),Z?Bf(+Z,J):1];if(dd(ne))return function([fe,Te,pe,me]){function Ie(Fe){const nt=(Fe+fe/30)%12,bt=Te*Math.min(pe,1-pe);return pe-bt*Math.max(-1,Math.min(nt-3,9-nt,1))}return fe=hm(fe),Te/=100,pe/=100,[Ie(0),Ie(8),Ie(4),me]}(ne)}}}(r);return s?new Fr(...s,!1):void 0}get rgb(){const{r,g:s,b:d,a:g}=this,_=g||1/0;return this.overwriteGetter("rgb",[r/_,s/_,d/_,g])}get hcl(){return this.overwriteGetter("hcl",function(r){const[s,d,g,_]=dm(r),x=Math.sqrt(d*d+g*g);return[Math.round(1e4*x)?hm(Math.atan2(g,d)*uh):NaN,x,s,_]}(this.rgb))}get lab(){return this.overwriteGetter("lab",dm(this.rgb))}overwriteGetter(r,s){return Object.defineProperty(this,r,{value:s}),s}toString(){const[r,s,d,g]=this.rgb;return`rgba(${[r,s,d].map(_=>Math.round(255*_)).join(",")},${g})`}static interpolate(r,s,d,g="rgb"){switch(g){case"rgb":{const[_,x,C,E]=yl(r.rgb,s.rgb,d);return new Fr(_,x,C,E,!1)}case"hcl":{const[_,x,C,E]=r.hcl,[R,L,V,H]=s.hcl;let Z,J;if(isNaN(_)||isNaN(R))isNaN(_)?isNaN(R)?Z=NaN:(Z=R,C!==1&&C!==0||(J=L)):(Z=_,V!==1&&V!==0||(J=x));else{let pe=R-_;R>_&&pe>180?pe-=360:R<_&&_-R>180&&(pe+=360),Z=_+d*pe}const[ee,ne,fe,Te]=function([pe,me,Ie,Fe]){return pe=isNaN(pe)?0:pe*Da,hh([Ie,Math.cos(pe)*me,Math.sin(pe)*me,Fe])}([Z,J??za(x,L,d),za(C,V,d),za(E,H,d)]);return new Fr(ee,ne,fe,Te,!1)}case"lab":{const[_,x,C,E]=hh(yl(r.lab,s.lab,d));return new Fr(_,x,C,E,!1)}}}}Fr.black=new Fr(0,0,0,1),Fr.white=new Fr(1,1,1,1),Fr.transparent=new Fr(0,0,0,0),Fr.red=new Fr(1,0,0,1);class ea{constructor(r,s,d){this.sensitivity=r?s?"variant":"case":s?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,s){return this.collator.compare(r,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const vl=["bottom","center","top"];class ta{constructor(r,s,d,g,_,x){this.text=r,this.image=s,this.scale=d,this.fontStack=g,this.textColor=_,this.verticalAlign=x}}class Ji{constructor(r){this.sections=r}static fromString(r){return new Ji([new ta(r,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(r=>r.text.length!==0||r.image&&r.image.name.length!==0)}static factory(r){return r instanceof Ji?r:Ji.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}}class Oi{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Oi)return r;if(typeof r=="number")return new Oi([r,r,r,r]);if(Array.isArray(r)&&!(r.length<1||r.length>4)){for(const s of r)if(typeof s!="number")return;switch(r.length){case 1:r=[r[0],r[0],r[0],r[0]];break;case 2:r=[r[0],r[1],r[0],r[1]];break;case 3:r=[r[0],r[1],r[2],r[1]]}return new Oi(r)}}toString(){return JSON.stringify(this.values)}static interpolate(r,s,d){return new Oi(yl(r.values,s.values,d))}}class _n{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof _n)return r;if(typeof r=="number")return new _n([r]);if(Array.isArray(r)){for(const s of r)if(typeof s!="number")return;return new _n(r)}}toString(){return JSON.stringify(this.values)}static interpolate(r,s,d){return new _n(yl(r.values,s.values,d))}}class Sr{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Sr)return r;if(typeof r=="string"){const d=Fr.parse(r);return d?new Sr([d]):void 0}if(!Array.isArray(r))return;const s=[];for(const d of r){if(typeof d!="string")return;const g=Fr.parse(d);if(!g)return;s.push(g)}return new Sr(s)}toString(){return JSON.stringify(this.values)}static interpolate(r,s,d,g="rgb"){const _=[];if(r.values.length!=s.values.length)throw new Error(`colorArray: Arrays have mismatched length (${r.values.length} vs. ${s.values.length}), cannot interpolate.`);for(let x=0;x<r.values.length;x++)_.push(Fr.interpolate(r.values[x],s.values[x],d,g));return new Sr(_)}}class Mn extends Error{constructor(r){super(r),this.name="RuntimeError"}toJSON(){return this.message}}const ps=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Do{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Do)return r;if(Array.isArray(r)&&!(r.length<1)&&r.length%2==0){for(let s=0;s<r.length;s+=2){const d=r[s],g=r[s+1];if(typeof d!="string"||!ps.has(d)||!Array.isArray(g)||g.length!==2||typeof g[0]!="number"||typeof g[1]!="number")return}return new Do(r)}}toString(){return JSON.stringify(this.values)}static interpolate(r,s,d){const g=r.values,_=s.values;if(g.length!==_.length)throw new Mn(`Cannot interpolate values of different length. from: ${r.toString()}, to: ${s.toString()}`);const x=[];for(let C=0;C<g.length;C+=2){if(g[C]!==_[C])throw new Mn(`Cannot interpolate values containing mismatched anchors. from[${C}]: ${g[C]}, to[${C}]: ${_[C]}`);x.push(g[C]);const[E,R]=g[C+1],[L,V]=_[C+1];x.push([za(E,L,d),za(R,V,d)])}return new Do(x)}}class Go{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new Go({name:r,available:!1}):null}}class Qi{constructor(r,s,d){this.from=r,this.to=s,this.transition=d}static interpolate(r,s,d){return new Qi(r,s,d)}static parse(r){return r instanceof Qi?r:Array.isArray(r)&&r.length===3&&typeof r[0]=="string"&&typeof r[1]=="string"&&typeof r[2]=="number"?new Qi(r[0],r[1],r[2]):typeof r=="object"&&typeof r.from=="string"&&typeof r.to=="string"&&typeof r.transition=="number"?new Qi(r.from,r.to,r.transition):typeof r=="string"?new Qi(r,r,1):void 0}}function oc(l,r,s,d){return typeof l=="number"&&l>=0&&l<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof s=="number"&&s>=0&&s<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[l,r,s,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[l,r,s,d]:[l,r,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function _l(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof Qi||l instanceof Fr||l instanceof ea||l instanceof Ji||l instanceof Oi||l instanceof _n||l instanceof Sr||l instanceof Do||l instanceof Go)return!0;if(Array.isArray(l)){for(const r of l)if(!_l(r))return!1;return!0}if(typeof l=="object"){for(const r in l)if(!_l(l[r]))return!1;return!0}return!1}function qn(l){if(l===null)return Ki;if(typeof l=="string")return ot;if(typeof l=="boolean")return rt;if(typeof l=="number")return jt;if(l instanceof Fr)return Zt;if(l instanceof Qi)return Tr;if(l instanceof ea)return An;if(l instanceof Ji)return Gi;if(l instanceof Oi)return Ra;if(l instanceof _n)return Gn;if(l instanceof Sr)return pl;if(l instanceof Do)return Qs;if(l instanceof Go)return ml;if(Array.isArray(l)){const r=l.length;let s;for(const d of l){const g=qn(d);if(s){if(s===g)continue;s=ir;break}s=g}return Yi(s||ir,r)}return Nr}function Ds(l){const r=typeof l;return l===null?"":r==="string"||r==="number"||r==="boolean"?String(l):l instanceof Fr||l instanceof Qi||l instanceof Ji||l instanceof Oi||l instanceof _n||l instanceof Sr||l instanceof Do||l instanceof Go?l.toString():JSON.stringify(l)}class zo{constructor(r,s){this.type=r,this.value=s}static parse(r,s){if(r.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!_l(r[1]))return s.error("invalid value");const d=r[1];let g=qn(d);const _=s.expectedType;return g.kind!=="array"||g.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(g=_),new zo(g,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const sc={string:ot,number:jt,boolean:rt,object:Nr};class qo{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");let d,g=1;const _=r[0];if(_==="array"){let C,E;if(r.length>2){const R=r[1];if(typeof R!="string"||!(R in sc)||R==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);C=sc[R],g++}else C=ir;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return s.error('The length argument to "array" must be a positive integer literal',2);E=r[2],g++}d=Yi(C,E)}else{if(!sc[_])throw new Error(`Types doesn't contain name = ${_}`);d=sc[_]}const x=[];for(;g<r.length;g++){const C=s.parse(r[g],g,ir);if(!C)return null;x.push(C)}return new qo(d,x)}evaluate(r){for(let s=0;s<this.args.length;s++){const d=this.args[s].evaluate(r);if(!Mr(this.type,qn(d)))return d;if(s===this.args.length-1)throw new Mn(`Expected value to be of type ${nn(this.type)}, but found ${nn(qn(d))} instead.`)}throw new Error}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const ac={"to-boolean":rt,"to-color":Zt,"to-number":jt,"to-string":ot};class zs{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const d=r[0];if(!ac[d])throw new Error(`Can't parse ${d} as it is not part of the known types`);if((d==="to-boolean"||d==="to-string")&&r.length!==2)return s.error("Expected one argument.");const g=ac[d],_=[];for(let x=1;x<r.length;x++){const C=s.parse(r[x],x,ir);if(!C)return null;_.push(C)}return new zs(g,_)}evaluate(r){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(r);case"color":{let s,d;for(const g of this.args){if(s=g.evaluate(r),d=null,s instanceof Fr)return s;if(typeof s=="string"){const _=r.parseColor(s);if(_)return _}else if(Array.isArray(s)&&(d=s.length<3||s.length>4?`Invalid rgba value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:oc(s[0],s[1],s[2],s[3]),!d))return new Fr(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Mn(d||`Could not parse color from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"padding":{let s;for(const d of this.args){s=d.evaluate(r);const g=Oi.parse(s);if(g)return g}throw new Mn(`Could not parse padding from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"numberArray":{let s;for(const d of this.args){s=d.evaluate(r);const g=_n.parse(s);if(g)return g}throw new Mn(`Could not parse numberArray from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"colorArray":{let s;for(const d of this.args){s=d.evaluate(r);const g=Sr.parse(s);if(g)return g}throw new Mn(`Could not parse colorArray from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"variableAnchorOffsetCollection":{let s;for(const d of this.args){s=d.evaluate(r);const g=Do.parse(s);if(g)return g}throw new Mn(`Could not parse variableAnchorOffsetCollection from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"number":{let s=null;for(const d of this.args){if(s=d.evaluate(r),s===null)return 0;const g=Number(s);if(!isNaN(g))return g}throw new Mn(`Could not convert ${JSON.stringify(s)} to number.`)}case"formatted":return Ji.fromString(Ds(this.args[0].evaluate(r)));case"resolvedImage":return Go.fromString(Ds(this.args[0].evaluate(r)));case"projectionDefinition":return this.args[0].evaluate(r);default:return Ds(this.args[0].evaluate(r))}}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const fh=["Unknown","Point","LineString","Polygon"];class ph{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?fh[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(r){let s=this._parseColorCache.get(r);return s||(s=Fr.parse(r),this._parseColorCache.set(r,s)),s}}class xl{constructor(r,s,d=[],g,_=new fs,x=[]){this.registry=r,this.path=d,this.key=d.map(C=>`[${C}]`).join(""),this.scope=_,this.errors=x,this.expectedType=g,this._isConstant=s}parse(r,s,d,g,_={}){return s?this.concat(s,d,g)._parse(r,_):this._parse(r,_)}_parse(r,s){function d(g,_,x){return x==="assert"?new qo(_,[g]):x==="coerce"?new zs(_,[g]):g}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=r[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[g];if(_){let x=_.parse(r,this);if(!x)return null;if(this.expectedType){const C=this.expectedType,E=x.type;if(C.kind!=="string"&&C.kind!=="number"&&C.kind!=="boolean"&&C.kind!=="object"&&C.kind!=="array"||E.kind!=="value"){if(C.kind==="projectionDefinition"&&["string","array"].includes(E.kind)||["color","formatted","resolvedImage"].includes(C.kind)&&["value","string"].includes(E.kind)||["padding","numberArray"].includes(C.kind)&&["value","number","array"].includes(E.kind)||C.kind==="colorArray"&&["value","string","array"].includes(E.kind)||C.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(E.kind))x=d(x,C,s.typeAnnotation||"coerce");else if(this.checkSubtype(C,E))return null}else x=d(x,C,s.typeAnnotation||"assert")}if(!(x instanceof zo)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const C=new ph;try{x=new zo(x.type,x.evaluate(C))}catch(E){return this.error(E.message),null}}return x}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,s,d){const g=typeof r=="number"?this.path.concat(r):this.path,_=d?this.scope.concat(d):this.scope;return new xl(this.registry,this._isConstant,g,s||null,_,this.errors)}error(r,...s){const d=`${this.key}${s.map(g=>`[${g}]`).join("")}`;this.errors.push(new zn(d,r))}checkSubtype(r,s){const d=Mr(r,s);return d&&this.error(d),d}}class sn{constructor(r,s){this.type=s.type,this.bindings=[].concat(r),this.result=s}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const s of this.bindings)r(s[1]);r(this.result)}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const d=[];for(let _=1;_<r.length-1;_+=2){const x=r[_];if(typeof x!="string")return s.error(`Expected string, but found ${typeof x} instead.`,_);if(/[^a-zA-Z0-9_]/.test(x))return s.error("Variable names must contain only alphanumeric characters or '_'.",_);const C=s.parse(r[_+1],_+1);if(!C)return null;d.push([x,C])}const g=s.parse(r[r.length-1],r.length-1,s.expectedType,d);return g?new sn(d,g):null}outputDefined(){return this.result.outputDefined()}}class bl{constructor(r,s){this.type=s.type,this.name=r,this.boundExpression=s}static parse(r,s){if(r.length!==2||typeof r[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const d=r[1];return s.scope.has(d)?new bl(d,s.scope.get(d)):s.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}}class Zr{constructor(r,s,d){this.type=r,this.index=s,this.input=d}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const d=s.parse(r[1],1,jt),g=s.parse(r[2],2,Yi(s.expectedType||ir));return d&&g?new Zr(g.type.itemType,d,g):null}evaluate(r){const s=this.index.evaluate(r),d=this.input.evaluate(r);if(s<0)throw new Mn(`Array index out of bounds: ${s} < 0.`);if(s>=d.length)throw new Mn(`Array index out of bounds: ${s} > ${d.length-1}.`);if(s!==Math.floor(s))throw new Mn(`Array index must be an integer, but found ${s} instead.`);return d[s]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}}class Br{constructor(r,s){this.type=rt,this.needle=r,this.haystack=s}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const d=s.parse(r[1],1,ir),g=s.parse(r[2],2,ir);return d&&g?Ei(d.type,[rt,ot,jt,Ki,ir])?new Br(d,g):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${nn(d.type)} instead`):null}evaluate(r){const s=this.needle.evaluate(r),d=this.haystack.evaluate(r);if(!d)return!1;if(!on(s,["boolean","string","number","null"]))throw new Mn(`Expected first argument to be of type boolean, string, number or null, but found ${nn(qn(s))} instead.`);if(!on(d,["string","array"]))throw new Mn(`Expected second argument to be of type array or string, but found ${nn(qn(d))} instead.`);return d.indexOf(s)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}}class Oa{constructor(r,s,d){this.type=jt,this.needle=r,this.haystack=s,this.fromIndex=d}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 2 or 3 arguments, but found ${r.length-1} instead.`);const d=s.parse(r[1],1,ir),g=s.parse(r[2],2,ir);if(!d||!g)return null;if(!Ei(d.type,[rt,ot,jt,Ki,ir]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${nn(d.type)} instead`);if(r.length===4){const _=s.parse(r[3],3,jt);return _?new Oa(d,g,_):null}return new Oa(d,g)}evaluate(r){const s=this.needle.evaluate(r),d=this.haystack.evaluate(r);if(!on(s,["boolean","string","number","null"]))throw new Mn(`Expected first argument to be of type boolean, string, number or null, but found ${nn(qn(s))} instead.`);let g;if(this.fromIndex&&(g=this.fromIndex.evaluate(r)),on(d,["string"])){const _=d.indexOf(s,g);return _===-1?-1:[...d.slice(0,_)].length}if(on(d,["array"]))return d.indexOf(s,g);throw new Mn(`Expected second argument to be of type array or string, but found ${nn(qn(d))} instead.`)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}}class Yr{constructor(r,s,d,g,_,x){this.inputType=r,this.type=s,this.input=d,this.cases=g,this.outputs=_,this.otherwise=x}static parse(r,s){if(r.length<5)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return s.error("Expected an even number of arguments.");let d,g;s.expectedType&&s.expectedType.kind!=="value"&&(g=s.expectedType);const _={},x=[];for(let R=2;R<r.length-1;R+=2){let L=r[R];const V=r[R+1];Array.isArray(L)||(L=[L]);const H=s.concat(R);if(L.length===0)return H.error("Expected at least one branch label.");for(const J of L){if(typeof J!="number"&&typeof J!="string")return H.error("Branch labels must be numbers or strings.");if(typeof J=="number"&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return H.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof J=="number"&&Math.floor(J)!==J)return H.error("Numeric branch labels must be integer values.");if(d){if(H.checkSubtype(d,qn(J)))return null}else d=qn(J);if(_[String(J)]!==void 0)return H.error("Branch labels must be unique.");_[String(J)]=x.length}const Z=s.parse(V,R,g);if(!Z)return null;g=g||Z.type,x.push(Z)}const C=s.parse(r[1],1,ir);if(!C)return null;const E=s.parse(r[r.length-1],r.length-1,g);return E?C.type.kind!=="value"&&s.concat(1).checkSubtype(d,C.type)?null:new Yr(d,g,C,_,x,E):null}evaluate(r){const s=this.input.evaluate(r);return(qn(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}}class uu{constructor(r,s,d){this.type=r,this.branches=s,this.otherwise=d}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return s.error("Expected an odd number of arguments.");let d;s.expectedType&&s.expectedType.kind!=="value"&&(d=s.expectedType);const g=[];for(let x=1;x<r.length-1;x+=2){const C=s.parse(r[x],x,rt);if(!C)return null;const E=s.parse(r[x+1],x+1,d);if(!E)return null;g.push([C,E]),d=d||E.type}const _=s.parse(r[r.length-1],r.length-1,d);if(!_)return null;if(!d)throw new Error("Can't infer output type");return new uu(d,g,_)}evaluate(r){for(const[s,d]of this.branches)if(s.evaluate(r))return d.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[s,d]of this.branches)r(s),r(d);r(this.otherwise)}outputDefined(){return this.branches.every(([r,s])=>s.outputDefined())&&this.otherwise.outputDefined()}}class li{constructor(r,s,d,g){this.type=r,this.input=s,this.beginIndex=d,this.endIndex=g}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 2 or 3 arguments, but found ${r.length-1} instead.`);const d=s.parse(r[1],1,ir),g=s.parse(r[2],2,jt);if(!d||!g)return null;if(!Ei(d.type,[Yi(ir),ot,ir]))return s.error(`Expected first argument to be of type array or string, but found ${nn(d.type)} instead`);if(r.length===4){const _=s.parse(r[3],3,jt);return _?new li(d.type,d,g,_):null}return new li(d.type,d,g)}evaluate(r){const s=this.input.evaluate(r),d=this.beginIndex.evaluate(r);let g;if(this.endIndex&&(g=this.endIndex.evaluate(r)),on(s,["string"]))return[...s].slice(d,g).join("");if(on(s,["array"]))return s.slice(d,g);throw new Mn(`Expected first argument to be of type array or string, but found ${nn(qn(s))} instead.`)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}}function Os(l,r){const s=l.length-1;let d,g,_=0,x=s,C=0;for(;_<=x;)if(C=Math.floor((_+x)/2),d=l[C],g=l[C+1],d<=r){if(C===s||r<g)return C;_=C+1}else{if(!(d>r))throw new Mn("Input is not a number.");x=C-1}return 0}class ra{constructor(r,s,d){this.type=r,this.input=s,this.labels=[],this.outputs=[];for(const[g,_]of d)this.labels.push(g),this.outputs.push(_)}static parse(r,s){if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");const d=s.parse(r[1],1,jt);if(!d)return null;const g=[];let _=null;s.expectedType&&s.expectedType.kind!=="value"&&(_=s.expectedType);for(let x=1;x<r.length;x+=2){const C=x===1?-1/0:r[x],E=r[x+1],R=x,L=x+1;if(typeof C!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(g.length&&g[g.length-1][0]>=C)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',R);const V=s.parse(E,L,_);if(!V)return null;_=_||V.type,g.push([C,V])}return new ra(_,d,g)}evaluate(r){const s=this.labels,d=this.outputs;if(s.length===1)return d[0].evaluate(r);const g=this.input.evaluate(r);if(g<=s[0])return d[0].evaluate(r);const _=s.length;return g>=s[_-1]?d[_-1].evaluate(r):d[Os(s,g)].evaluate(r)}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function hu(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var mh,gh,$f=function(){if(gh)return mh;function l(r,s,d,g){this.cx=3*r,this.bx=3*(d-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(g-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=s,this.p2x=d,this.p2y=g}return gh=1,mh=l,l.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,s){if(s===void 0&&(s=1e-6),r<0)return 0;if(r>1)return 1;for(var d=r,g=0;g<8;g++){var _=this.sampleCurveX(d)-r;if(Math.abs(_)<s)return d;var x=this.sampleCurveDerivativeX(d);if(Math.abs(x)<1e-6)break;d-=_/x}var C=0,E=1;for(d=r,g=0;g<20&&(_=this.sampleCurveX(d),!(Math.abs(_-r)<s));g++)r>_?C=d:E=d,d=.5*(E-C)+C;return d},solve:function(r,s){return this.sampleCurveY(this.solveCurveX(r,s))}},mh}(),du=hu($f);class eo{constructor(r,s,d,g,_){this.type=r,this.operator=s,this.interpolation=d,this.input=g,this.labels=[],this.outputs=[];for(const[x,C]of _)this.labels.push(x),this.outputs.push(C)}static interpolationFactor(r,s,d,g){let _=0;if(r.name==="exponential")_=Ls(s,r.base,d,g);else if(r.name==="linear")_=Ls(s,1,d,g);else if(r.name==="cubic-bezier"){const x=r.controlPoints;_=new du(x[0],x[1],x[2],x[3]).solve(Ls(s,1,d,g))}return _}static parse(r,s){let[d,g,_,...x]=r;if(!Array.isArray(g)||g.length===0)return s.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const R=g[1];if(typeof R!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:R}}else{if(g[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const R=g.slice(1);if(R.length!==4||R.some(L=>typeof L!="number"||L<0||L>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:R}}}if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(_=s.parse(_,2,jt),!_)return null;const C=[];let E=null;d!=="interpolate-hcl"&&d!=="interpolate-lab"||s.expectedType==pl?s.expectedType&&s.expectedType.kind!=="value"&&(E=s.expectedType):E=Zt;for(let R=0;R<x.length;R+=2){const L=x[R],V=x[R+1],H=R+3,Z=R+4;if(typeof L!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',H);if(C.length&&C[C.length-1][0]>=L)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',H);const J=s.parse(V,Z,E);if(!J)return null;E=E||J.type,C.push([L,J])}return fi(E,jt)||fi(E,Tr)||fi(E,Zt)||fi(E,Ra)||fi(E,Gn)||fi(E,pl)||fi(E,Qs)||fi(E,Yi(jt))?new eo(E,d,g,_,C):s.error(`Type ${nn(E)} is not interpolatable.`)}evaluate(r){const s=this.labels,d=this.outputs;if(s.length===1)return d[0].evaluate(r);const g=this.input.evaluate(r);if(g<=s[0])return d[0].evaluate(r);const _=s.length;if(g>=s[_-1])return d[_-1].evaluate(r);const x=Os(s,g),C=eo.interpolationFactor(this.interpolation,g,s[x],s[x+1]),E=d[x].evaluate(r),R=d[x+1].evaluate(r);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return za(E,R,C);case"color":return Fr.interpolate(E,R,C);case"padding":return Oi.interpolate(E,R,C);case"colorArray":return Sr.interpolate(E,R,C);case"numberArray":return _n.interpolate(E,R,C);case"variableAnchorOffsetCollection":return Do.interpolate(E,R,C);case"array":return yl(E,R,C);case"projectionDefinition":return Qi.interpolate(E,R,C)}case"interpolate-hcl":switch(this.type.kind){case"color":return Fr.interpolate(E,R,C,"hcl");case"colorArray":return Sr.interpolate(E,R,C,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Fr.interpolate(E,R,C,"lab");case"colorArray":return Sr.interpolate(E,R,C,"lab")}}}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function Ls(l,r,s,d){const g=d-s,_=l-s;return g===0?0:r===1?_/g:(Math.pow(r,_)-1)/(Math.pow(r,g)-1)}const ti={color:Fr.interpolate,number:za,padding:Oi.interpolate,numberArray:_n.interpolate,colorArray:Sr.interpolate,variableAnchorOffsetCollection:Do.interpolate,array:yl};class lc{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");let d=null;const g=s.expectedType;g&&g.kind!=="value"&&(d=g);const _=[];for(const C of r.slice(1)){const E=s.parse(C,1+_.length,d,void 0,{typeAnnotation:"omit"});if(!E)return null;d=d||E.type,_.push(E)}if(!d)throw new Error("No output type");const x=g&&_.some(C=>Mr(g,C.type));return new lc(x?ir:d,_)}evaluate(r){let s,d=null,g=0;for(const _ of this.args)if(g++,d=_.evaluate(r),d&&d instanceof Go&&!d.available&&(s||(s=d.name),d=null,g===this.args.length&&(d=s)),d!==null)break;return d}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}function jf(l,r){return l==="=="||l==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function cc(l,r,s,d){return d.compare(r,s)===0}function pi(l,r,s){const d=l!=="=="&&l!=="!=";return class LA{constructor(_,x,C){this.type=rt,this.lhs=_,this.rhs=x,this.collator=C,this.hasUntypedArgument=_.type.kind==="value"||x.type.kind==="value"}static parse(_,x){if(_.length!==3&&_.length!==4)return x.error("Expected two or three arguments.");const C=_[0];let E=x.parse(_[1],1,ir);if(!E)return null;if(!jf(C,E.type))return x.concat(1).error(`"${C}" comparisons are not supported for type '${nn(E.type)}'.`);let R=x.parse(_[2],2,ir);if(!R)return null;if(!jf(C,R.type))return x.concat(2).error(`"${C}" comparisons are not supported for type '${nn(R.type)}'.`);if(E.type.kind!==R.type.kind&&E.type.kind!=="value"&&R.type.kind!=="value")return x.error(`Cannot compare types '${nn(E.type)}' and '${nn(R.type)}'.`);d&&(E.type.kind==="value"&&R.type.kind!=="value"?E=new qo(R.type,[E]):E.type.kind!=="value"&&R.type.kind==="value"&&(R=new qo(E.type,[R])));let L=null;if(_.length===4){if(E.type.kind!=="string"&&R.type.kind!=="string"&&E.type.kind!=="value"&&R.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(L=x.parse(_[3],3,An),!L)return null}return new LA(E,R,L)}evaluate(_){const x=this.lhs.evaluate(_),C=this.rhs.evaluate(_);if(d&&this.hasUntypedArgument){const E=qn(x),R=qn(C);if(E.kind!==R.kind||E.kind!=="string"&&E.kind!=="number")throw new Mn(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${E.kind}, ${R.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const E=qn(x),R=qn(C);if(E.kind!=="string"||R.kind!=="string")return r(_,x,C)}return this.collator?s(_,x,C,this.collator.evaluate(_)):r(_,x,C)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}const fm=pi("==",function(l,r,s){return r===s},cc),Nf=pi("!=",function(l,r,s){return r!==s},function(l,r,s,d){return!cc(0,r,s,d)}),pm=pi("<",function(l,r,s){return r<s},function(l,r,s,d){return d.compare(r,s)<0}),ny=pi(">",function(l,r,s){return r>s},function(l,r,s,d){return d.compare(r,s)>0}),uc=pi("<=",function(l,r,s){return r<=s},function(l,r,s,d){return d.compare(r,s)<=0}),fd=pi(">=",function(l,r,s){return r>=s},function(l,r,s,d){return d.compare(r,s)>=0});class fu{constructor(r,s,d){this.type=An,this.locale=d,this.caseSensitive=r,this.diacriticSensitive=s}static parse(r,s){if(r.length!==2)return s.error("Expected one argument.");const d=r[1];if(typeof d!="object"||Array.isArray(d))return s.error("Collator options argument must be an object.");const g=s.parse(d["case-sensitive"]!==void 0&&d["case-sensitive"],1,rt);if(!g)return null;const _=s.parse(d["diacritic-sensitive"]!==void 0&&d["diacritic-sensitive"],1,rt);if(!_)return null;let x=null;return d.locale&&(x=s.parse(d.locale,1,ot),!x)?null:new fu(g,_,x)}evaluate(r){return new ea(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}}class Vf{constructor(r,s,d,g,_){this.type=ot,this.number=r,this.locale=s,this.currency=d,this.minFractionDigits=g,this.maxFractionDigits=_}static parse(r,s){if(r.length!==3)return s.error("Expected two arguments.");const d=s.parse(r[1],1,jt);if(!d)return null;const g=r[2];if(typeof g!="object"||Array.isArray(g))return s.error("NumberFormat options argument must be an object.");let _=null;if(g.locale&&(_=s.parse(g.locale,1,ot),!_))return null;let x=null;if(g.currency&&(x=s.parse(g.currency,1,ot),!x))return null;let C=null;if(g["min-fraction-digits"]&&(C=s.parse(g["min-fraction-digits"],1,jt),!C))return null;let E=null;return g["max-fraction-digits"]&&(E=s.parse(g["max-fraction-digits"],1,jt),!E)?null:new Vf(d,_,x,C,E)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}}class yh{constructor(r){this.type=Gi,this.sections=r}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const d=r[1];if(!Array.isArray(d)&&typeof d=="object")return s.error("First argument must be an image or text section.");const g=[];let _=!1;for(let x=1;x<=r.length-1;++x){const C=r[x];if(_&&typeof C=="object"&&!Array.isArray(C)){_=!1;let E=null;if(C["font-scale"]&&(E=s.parse(C["font-scale"],1,jt),!E))return null;let R=null;if(C["text-font"]&&(R=s.parse(C["text-font"],1,Yi(ot)),!R))return null;let L=null;if(C["text-color"]&&(L=s.parse(C["text-color"],1,Zt),!L))return null;let V=null;if(C["vertical-align"]){if(typeof C["vertical-align"]=="string"&&!vl.includes(C["vertical-align"]))return s.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${C["vertical-align"]}' instead.`);if(V=s.parse(C["vertical-align"],1,ot),!V)return null}const H=g[g.length-1];H.scale=E,H.font=R,H.textColor=L,H.verticalAlign=V}else{const E=s.parse(r[x],1,ir);if(!E)return null;const R=E.type.kind;if(R!=="string"&&R!=="value"&&R!=="null"&&R!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,g.push({content:E,scale:null,font:null,textColor:null,verticalAlign:null})}}return new yh(g)}evaluate(r){return new Ji(this.sections.map(s=>{const d=s.content.evaluate(r);return qn(d)===ml?new ta("",d,null,null,null,s.verticalAlign?s.verticalAlign.evaluate(r):null):new ta(Ds(d),null,s.scale?s.scale.evaluate(r):null,s.font?s.font.evaluate(r).join(","):null,s.textColor?s.textColor.evaluate(r):null,s.verticalAlign?s.verticalAlign.evaluate(r):null)}))}eachChild(r){for(const s of this.sections)r(s.content),s.scale&&r(s.scale),s.font&&r(s.font),s.textColor&&r(s.textColor),s.verticalAlign&&r(s.verticalAlign)}outputDefined(){return!1}}class wl{constructor(r){this.type=ml,this.input=r}static parse(r,s){if(r.length!==2)return s.error("Expected two arguments.");const d=s.parse(r[1],1,ot);return d?new wl(d):s.error("No image name provided.")}evaluate(r){const s=this.input.evaluate(r),d=Go.fromString(s);return d&&r.availableImages&&(d.available=r.availableImages.indexOf(s)>-1),d}eachChild(r){r(this.input)}outputDefined(){return!1}}class pu{constructor(r){this.type=jt,this.input=r}static parse(r,s){if(r.length!==2)return s.error(`Expected 1 argument, but found ${r.length-1} instead.`);const d=s.parse(r[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${nn(d.type)} instead.`):new pu(d):null}evaluate(r){const s=this.input.evaluate(r);if(typeof s=="string")return[...s].length;if(Array.isArray(s))return s.length;throw new Mn(`Expected value to be of type string or array, but found ${nn(qn(s))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}}const Li=8192;function mm(l,r){const s=(180+l[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,g=Math.pow(2,r.z);return[Math.round(s*g*Li),Math.round(d*g*Li)]}function hc(l,r){const s=Math.pow(2,r.z);return[(g=(l[0]/Li+r.x)/s,360*g-180),(d=(l[1]/Li+r.y)/s,360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90)];var d,g}function vh(l,r){l[0]=Math.min(l[0],r[0]),l[1]=Math.min(l[1],r[1]),l[2]=Math.max(l[2],r[0]),l[3]=Math.max(l[3],r[1])}function dc(l,r){return!(l[0]<=r[0]||l[2]>=r[2]||l[1]<=r[1]||l[3]>=r[3])}function iy(l,r,s){const d=l[0]-r[0],g=l[1]-r[1],_=l[0]-s[0],x=l[1]-s[1];return d*x-_*g==0&&d*_<=0&&g*x<=0}function pd(l,r,s,d){return(g=[d[0]-s[0],d[1]-s[1]])[0]*(_=[r[0]-l[0],r[1]-l[1]])[1]-g[1]*_[0]!=0&&!(!Uf(l,r,s,d)||!Uf(s,d,l,r));var g,_}function oy(l,r,s){for(const d of s)for(let g=0;g<d.length-1;++g)if(pd(l,r,d[g],d[g+1]))return!0;return!1}function mu(l,r,s=!1){let d=!1;for(const C of r)for(let E=0;E<C.length-1;E++){if(iy(l,C[E],C[E+1]))return s;(_=C[E])[1]>(g=l)[1]!=(x=C[E+1])[1]>g[1]&&g[0]<(x[0]-_[0])*(g[1]-_[1])/(x[1]-_[1])+_[0]&&(d=!d)}var g,_,x;return d}function md(l,r){for(const s of r)if(mu(l,s))return!0;return!1}function gd(l,r){for(const s of l)if(!mu(s,r))return!1;for(let s=0;s<l.length-1;++s)if(oy(l[s],l[s+1],r))return!1;return!0}function gu(l,r){for(const s of r)if(gd(l,s))return!0;return!1}function Uf(l,r,s,d){const g=d[0]-s[0],_=d[1]-s[1],x=(l[0]-s[0])*_-g*(l[1]-s[1]),C=(r[0]-s[0])*_-g*(r[1]-s[1]);return x>0&&C<0||x<0&&C>0}function yd(l,r,s){const d=[];for(let g=0;g<l.length;g++){const _=[];for(let x=0;x<l[g].length;x++){const C=mm(l[g][x],s);vh(r,C),_.push(C)}d.push(_)}return d}function vd(l,r,s){const d=[];for(let g=0;g<l.length;g++){const _=yd(l[g],r,s);d.push(_)}return d}function Gf(l,r,s,d){if(l[0]<s[0]||l[0]>s[2]){const g=.5*d;let _=l[0]-s[0]>g?-d:s[0]-l[0]>g?d:0;_===0&&(_=l[0]-s[2]>g?-d:s[2]-l[0]>g?d:0),l[0]+=_}vh(r,l)}function qf(l,r,s,d){const g=Math.pow(2,d.z)*Li,_=[d.x*Li,d.y*Li],x=[];for(const C of l)for(const E of C){const R=[E.x+_[0],E.y+_[1]];Gf(R,r,s,g),x.push(R)}return x}function Hf(l,r,s,d){const g=Math.pow(2,d.z)*Li,_=[d.x*Li,d.y*Li],x=[];for(const E of l){const R=[];for(const L of E){const V=[L.x+_[0],L.y+_[1]];vh(r,V),R.push(V)}x.push(R)}if(r[2]-r[0]<=g/2){(C=r)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const E of x)for(const R of E)Gf(R,r,s,g)}var C;return x}class ms{constructor(r,s){this.type=rt,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(_l(r[1])){const d=r[1];if(d.type==="FeatureCollection"){const g=[];for(const _ of d.features){const{type:x,coordinates:C}=_.geometry;x==="Polygon"&&g.push(C),x==="MultiPolygon"&&g.push(...C)}if(g.length)return new ms(d,{type:"MultiPolygon",coordinates:g})}else if(d.type==="Feature"){const g=d.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new ms(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new ms(d,d)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(s,d){const g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=s.canonicalID();if(d.type==="Polygon"){const C=yd(d.coordinates,_,x),E=qf(s.geometry(),g,_,x);if(!dc(g,_))return!1;for(const R of E)if(!mu(R,C))return!1}if(d.type==="MultiPolygon"){const C=vd(d.coordinates,_,x),E=qf(s.geometry(),g,_,x);if(!dc(g,_))return!1;for(const R of E)if(!md(R,C))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(s,d){const g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=s.canonicalID();if(d.type==="Polygon"){const C=yd(d.coordinates,_,x),E=Hf(s.geometry(),g,_,x);if(!dc(g,_))return!1;for(const R of E)if(!gd(R,C))return!1}if(d.type==="MultiPolygon"){const C=vd(d.coordinates,_,x),E=Hf(s.geometry(),g,_,x);if(!dc(g,_))return!1;for(const R of E)if(!gu(R,C))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let gm=class{constructor(l=[],r=(s,d)=>s<d?-1:s>d?1:0){if(this.data=l,this.length=this.data.length,this.compare=r,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(l){this.data.push(l),this._up(this.length++)}pop(){if(this.length===0)return;const l=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:r,compare:s}=this,d=r[l];for(;l>0;){const g=l-1>>1,_=r[g];if(s(d,_)>=0)break;r[l]=_,l=g}r[l]=d}_down(l){const{data:r,compare:s}=this,d=this.length>>1,g=r[l];for(;l<d;){let _=1+(l<<1);const x=_+1;if(x<this.length&&s(r[x],r[_])<0&&(_=x),s(r[_],g)>=0)break;r[l]=r[_],l=_}r[l]=g}};function Wf(l,r,s=0,d=l.length-1,g=Zf){for(;d>s;){if(d-s>600){const E=d-s+1,R=r-s+1,L=Math.log(E),V=.5*Math.exp(2*L/3),H=.5*Math.sqrt(L*V*(E-V)/E)*(R-E/2<0?-1:1);Wf(l,r,Math.max(s,Math.floor(r-R*V/E+H)),Math.min(d,Math.floor(r+(E-R)*V/E+H)),g)}const _=l[r];let x=s,C=d;for(yu(l,s,r),g(l[d],_)>0&&yu(l,s,d);x<C;){for(yu(l,x,C),x++,C--;g(l[x],_)<0;)x++;for(;g(l[C],_)>0;)C--}g(l[s],_)===0?yu(l,s,C):(C++,yu(l,C,d)),C<=r&&(s=C+1),r<=C&&(d=C-1)}}function yu(l,r,s){const d=l[r];l[r]=l[s],l[s]=d}function Zf(l,r){return l<r?-1:l>r?1:0}function _h(l,r){if(l.length<=1)return[l];const s=[];let d,g;for(const _ of l){const x=bh(_);x!==0&&(_.area=Math.abs(x),g===void 0&&(g=x<0),g===x<0?(d&&s.push(d),d=[_]):d.push(_))}if(d&&s.push(d),r>1)for(let _=0;_<s.length;_++)s[_].length<=r||(Wf(s[_],r,1,s[_].length-1,xh),s[_]=s[_].slice(0,r));return s}function xh(l,r){return r.area-l.area}function bh(l){let r=0;for(let s,d,g=0,_=l.length,x=_-1;g<_;x=g++)s=l[g],d=l[x],r+=(d.x-s.x)*(s.y+d.y);return r}const ym=1/298.257223563,Sl=ym*(2-ym),vm=Math.PI/180;class _d{constructor(r){const s=6378.137*vm*1e3,d=Math.cos(r*vm),g=1/(1-Sl*(1-d*d)),_=Math.sqrt(g);this.kx=s*_*d,this.ky=s*_*g*(1-Sl)}distance(r,s){const d=this.wrap(r[0]-s[0])*this.kx,g=(r[1]-s[1])*this.ky;return Math.sqrt(d*d+g*g)}pointOnLine(r,s){let d,g,_,x,C=1/0;for(let E=0;E<r.length-1;E++){let R=r[E][0],L=r[E][1],V=this.wrap(r[E+1][0]-R)*this.kx,H=(r[E+1][1]-L)*this.ky,Z=0;V===0&&H===0||(Z=(this.wrap(s[0]-R)*this.kx*V+(s[1]-L)*this.ky*H)/(V*V+H*H),Z>1?(R=r[E+1][0],L=r[E+1][1]):Z>0&&(R+=V/this.kx*Z,L+=H/this.ky*Z)),V=this.wrap(s[0]-R)*this.kx,H=(s[1]-L)*this.ky;const J=V*V+H*H;J<C&&(C=J,d=R,g=L,_=E,x=Z)}return{point:[d,g],index:_,t:Math.max(0,Math.min(1,x))}}wrap(r){for(;r<-180;)r+=360;for(;r>180;)r-=360;return r}}function xd(l,r){return r[0]-l[0]}function vu(l){return l[1]-l[0]+1}function gs(l,r){return l[1]>=l[0]&&l[1]<r}function wh(l,r){if(l[0]>l[1])return[null,null];const s=vu(l);if(r){if(s===2)return[l,null];const g=Math.floor(s/2);return[[l[0],l[0]+g],[l[0]+g,l[1]]]}if(s===1)return[l,null];const d=Math.floor(s/2)-1;return[[l[0],l[0]+d],[l[0]+d+1,l[1]]]}function bd(l,r){if(!gs(r,l.length))return[1/0,1/0,-1/0,-1/0];const s=[1/0,1/0,-1/0,-1/0];for(let d=r[0];d<=r[1];++d)vh(s,l[d]);return s}function Xf(l){const r=[1/0,1/0,-1/0,-1/0];for(const s of l)for(const d of s)vh(r,d);return r}function Kf(l){return l[0]!==-1/0&&l[1]!==-1/0&&l[2]!==1/0&&l[3]!==1/0}function wd(l,r,s){if(!Kf(l)||!Kf(r))return NaN;let d=0,g=0;return l[2]<r[0]&&(d=r[0]-l[2]),l[0]>r[2]&&(d=l[0]-r[2]),l[1]>r[3]&&(g=l[1]-r[3]),l[3]<r[1]&&(g=r[1]-l[3]),s.distance([0,0],[d,g])}function fc(l,r,s){const d=s.pointOnLine(r,l);return s.distance(l,d.point)}function Yf(l,r,s,d,g){const _=Math.min(fc(l,[s,d],g),fc(r,[s,d],g)),x=Math.min(fc(s,[l,r],g),fc(d,[l,r],g));return Math.min(_,x)}function Fs(l,r,s,d,g){if(!gs(r,l.length)||!gs(d,s.length))return 1/0;let _=1/0;for(let x=r[0];x<r[1];++x){const C=l[x],E=l[x+1];for(let R=d[0];R<d[1];++R){const L=s[R],V=s[R+1];if(pd(C,E,L,V))return 0;_=Math.min(_,Yf(C,E,L,V,g))}}return _}function _u(l,r,s,d,g){if(!gs(r,l.length)||!gs(d,s.length))return NaN;let _=1/0;for(let x=r[0];x<=r[1];++x)for(let C=d[0];C<=d[1];++C)if(_=Math.min(_,g.distance(l[x],s[C])),_===0)return _;return _}function _m(l,r,s){if(mu(l,r,!0))return 0;let d=1/0;for(const g of r){const _=g[0],x=g[g.length-1];if(_!==x&&(d=Math.min(d,fc(l,[x,_],s)),d===0))return d;const C=s.pointOnLine(g,l);if(d=Math.min(d,s.distance(l,C.point)),d===0)return d}return d}function xm(l,r,s,d){if(!gs(r,l.length))return NaN;for(let _=r[0];_<=r[1];++_)if(mu(l[_],s,!0))return 0;let g=1/0;for(let _=r[0];_<r[1];++_){const x=l[_],C=l[_+1];for(const E of s)for(let R=0,L=E.length,V=L-1;R<L;V=R++){const H=E[V],Z=E[R];if(pd(x,C,H,Z))return 0;g=Math.min(g,Yf(x,C,H,Z,d))}}return g}function Jf(l,r){for(const s of l)for(const d of s)if(mu(d,r,!0))return!0;return!1}function bm(l,r,s,d=1/0){const g=Xf(l),_=Xf(r);if(d!==1/0&&wd(g,_,s)>=d)return d;if(dc(g,_)){if(Jf(l,r))return 0}else if(Jf(r,l))return 0;let x=1/0;for(const C of l)for(let E=0,R=C.length,L=R-1;E<R;L=E++){const V=C[L],H=C[E];for(const Z of r)for(let J=0,ee=Z.length,ne=ee-1;J<ee;ne=J++){const fe=Z[ne],Te=Z[J];if(pd(V,H,fe,Te))return 0;x=Math.min(x,Yf(V,H,fe,Te,s))}}return x}function an(l,r,s,d,g,_){if(!_)return;const x=wd(bd(d,_),g,s);x<r&&l.push([x,_,[0,0]])}function Sd(l,r,s,d,g,_,x){if(!_||!x)return;const C=wd(bd(d,_),bd(g,x),s);C<r&&l.push([C,_,x])}function Cd(l,r,s,d,g=1/0){let _=Math.min(d.distance(l[0],s[0][0]),g);if(_===0)return _;const x=new gm([[0,[0,l.length-1],[0,0]]],xd),C=Xf(s);for(;x.length>0;){const E=x.pop();if(E[0]>=_)continue;const R=E[1],L=r?50:100;if(vu(R)<=L){if(!gs(R,l.length))return NaN;if(r){const V=xm(l,R,s,d);if(isNaN(V)||V===0)return V;_=Math.min(_,V)}else for(let V=R[0];V<=R[1];++V){const H=_m(l[V],s,d);if(_=Math.min(_,H),_===0)return 0}}else{const V=wh(R,r);an(x,_,d,l,C,V[0]),an(x,_,d,l,C,V[1])}}return _}function La(l,r,s,d,g,_=1/0){let x=Math.min(_,g.distance(l[0],s[0]));if(x===0)return x;const C=new gm([[0,[0,l.length-1],[0,s.length-1]]],xd);for(;C.length>0;){const E=C.pop();if(E[0]>=x)continue;const R=E[1],L=E[2],V=r?50:100,H=d?50:100;if(vu(R)<=V&&vu(L)<=H){if(!gs(R,l.length)&&gs(L,s.length))return NaN;let Z;if(r&&d)Z=Fs(l,R,s,L,g),x=Math.min(x,Z);else if(r&&!d){const J=l.slice(R[0],R[1]+1);for(let ee=L[0];ee<=L[1];++ee)if(Z=fc(s[ee],J,g),x=Math.min(x,Z),x===0)return x}else if(!r&&d){const J=s.slice(L[0],L[1]+1);for(let ee=R[0];ee<=R[1];++ee)if(Z=fc(l[ee],J,g),x=Math.min(x,Z),x===0)return x}else Z=_u(l,R,s,L,g),x=Math.min(x,Z)}else{const Z=wh(R,r),J=wh(L,d);Sd(C,x,g,l,s,Z[0],J[0]),Sd(C,x,g,l,s,Z[0],J[1]),Sd(C,x,g,l,s,Z[1],J[0]),Sd(C,x,g,l,s,Z[1],J[1])}}return x}function Sh(l){return l.type==="MultiPolygon"?l.coordinates.map(r=>({type:"Polygon",coordinates:r})):l.type==="MultiLineString"?l.coordinates.map(r=>({type:"LineString",coordinates:r})):l.type==="MultiPoint"?l.coordinates.map(r=>({type:"Point",coordinates:r})):[l]}class Bs{constructor(r,s){this.type=jt,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'distance' expression requires exactly one argument, but found ${r.length-1} instead.`);if(_l(r[1])){const d=r[1];if(d.type==="FeatureCollection")return new Bs(d,d.features.map(g=>Sh(g.geometry)).flat());if(d.type==="Feature")return new Bs(d,Sh(d.geometry));if("type"in d&&"coordinates"in d)return new Bs(d,Sh(d))}return s.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(s,d){const g=s.geometry(),_=g.flat().map(E=>hc([E.x,E.y],s.canonical));if(g.length===0)return NaN;const x=new _d(_[0][1]);let C=1/0;for(const E of d){switch(E.type){case"Point":C=Math.min(C,La(_,!1,[E.coordinates],!1,x,C));break;case"LineString":C=Math.min(C,La(_,!1,E.coordinates,!0,x,C));break;case"Polygon":C=Math.min(C,Cd(_,!1,E.coordinates,x,C))}if(C===0)return C}return C}(r,this.geometries);if(r.geometryType()==="LineString")return function(s,d){const g=s.geometry(),_=g.flat().map(E=>hc([E.x,E.y],s.canonical));if(g.length===0)return NaN;const x=new _d(_[0][1]);let C=1/0;for(const E of d){switch(E.type){case"Point":C=Math.min(C,La(_,!0,[E.coordinates],!1,x,C));break;case"LineString":C=Math.min(C,La(_,!0,E.coordinates,!0,x,C));break;case"Polygon":C=Math.min(C,Cd(_,!0,E.coordinates,x,C))}if(C===0)return C}return C}(r,this.geometries);if(r.geometryType()==="Polygon")return function(s,d){const g=s.geometry();if(g.length===0||g[0].length===0)return NaN;const _=_h(g,0).map(E=>E.map(R=>R.map(L=>hc([L.x,L.y],s.canonical)))),x=new _d(_[0][0][0][1]);let C=1/0;for(const E of d)for(const R of _){switch(E.type){case"Point":C=Math.min(C,Cd([E.coordinates],!1,R,x,C));break;case"LineString":C=Math.min(C,Cd(E.coordinates,!0,R,x,C));break;case"Polygon":C=Math.min(C,bm(R,E.coordinates,x,C))}if(C===0)return C}return C}(r,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class pc{constructor(r){this.type=ir,this.key=r}static parse(r,s){if(r.length!==2)return s.error(`Expected 1 argument, but found ${r.length-1} instead.`);const d=r[1];return d==null?s.error("Global state property must be defined."):typeof d!="string"?s.error(`Global state property must be string, but found ${typeof r[1]} instead.`):new pc(d)}evaluate(r){var s;const d=(s=r.globals)===null||s===void 0?void 0:s.globalState;return d&&Object.keys(d).length!==0?fn(d,this.key):null}eachChild(){}outputDefined(){return!1}}const mc={"==":fm,"!=":Nf,">":ny,"<":pm,">=":fd,"<=":uc,array:qo,at:Zr,boolean:qo,case:uu,coalesce:lc,collator:fu,format:yh,image:wl,in:Br,"index-of":Oa,interpolate:eo,"interpolate-hcl":eo,"interpolate-lab":eo,length:pu,let:sn,literal:zo,match:Yr,number:qo,"number-format":Vf,object:qo,slice:li,step:ra,string:qo,"to-boolean":zs,"to-color":zs,"to-number":zs,"to-string":zs,var:bl,within:ms,distance:Bs,"global-state":pc};class Oo{constructor(r,s,d,g){this.name=r,this.type=s,this._evaluate=d,this.args=g}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}static parse(r,s){const d=r[0],g=Oo.definitions[d];if(!g)return s.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(g)?g[0]:g.type,x=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,C=x.filter(([R])=>!Array.isArray(R)||R.length===r.length-1);let E=null;for(const[R,L]of C){E=new xl(s.registry,Ch,s.path,null,s.scope);const V=[];let H=!1;for(let Z=1;Z<r.length;Z++){const J=r[Z],ee=Array.isArray(R)?R[Z-1]:R.type,ne=E.parse(J,1+V.length,ee);if(!ne){H=!0;break}V.push(ne)}if(!H)if(Array.isArray(R)&&R.length!==V.length)E.error(`Expected ${R.length} arguments, but found ${V.length} instead.`);else{for(let Z=0;Z<V.length;Z++){const J=Array.isArray(R)?R[Z]:R.type,ee=V[Z];E.concat(Z+1).checkSubtype(J,ee.type)}if(E.errors.length===0)return new Oo(d,_,L,V)}}if(C.length===1)s.errors.push(...E.errors);else{const R=(C.length?C:x).map(([V])=>{return H=V,Array.isArray(H)?`(${H.map(nn).join(", ")})`:`(${nn(H.type)}...)`;var H}).join(" | "),L=[];for(let V=1;V<r.length;V++){const H=s.parse(r[V],1+L.length);if(!H)return null;L.push(nn(H.type))}s.error(`Expected arguments of type ${R}, but found (${L.join(", ")}) instead.`)}return null}static register(r,s){Oo.definitions=s;for(const d in s)r[d]=Oo}}function gc(l,[r,s,d,g]){r=r.evaluate(l),s=s.evaluate(l),d=d.evaluate(l);const _=g?g.evaluate(l):1,x=oc(r,s,d,_);if(x)throw new Mn(x);return new Fr(r/255,s/255,d/255,_,!1)}function Td(l,r){return l in r}function Md(l,r){const s=r[l];return s===void 0?null:s}function na(l){return{type:l}}function Ch(l){if(l instanceof bl)return Ch(l.boundExpression);if(l instanceof Oo&&l.name==="error"||l instanceof fu||l instanceof ms||l instanceof Bs||l instanceof pc)return!1;const r=l instanceof zs||l instanceof qo;let s=!0;return l.eachChild(d=>{s=r?s&&Ch(d):s&&d instanceof zo}),!!s&&Th(l)&&Mh(l,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Th(l){if(l instanceof Oo&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof ms||l instanceof Bs)return!1;let r=!0;return l.eachChild(s=>{r&&!Th(s)&&(r=!1)}),r}function xu(l){if(l instanceof Oo&&l.name==="feature-state")return!1;let r=!0;return l.eachChild(s=>{r&&!xu(s)&&(r=!1)}),r}function Mh(l,r){if(l instanceof Oo&&r.indexOf(l.name)>=0)return!1;let s=!0;return l.eachChild(d=>{s&&!Mh(d,r)&&(s=!1)}),s}function Qf(l){return{result:"success",value:l}}function yc(l){return{result:"error",value:l}}function ss(l){return l["property-type"]==="data-driven"||l["property-type"]==="cross-faded-data-driven"}function Pd(l){return!!l.expression&&l.expression.parameters.indexOf("zoom")>-1}function Ph(l){return!!l.expression&&l.expression.interpolated}function qr(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}function Ed(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)&&qn(l)===Nr}function Eh(l){return l}function wm(l,r){const s=l.stops&&typeof l.stops[0][0]=="object",d=s||!(s||l.property!==void 0),g=l.type||(Ph(r)?"exponential":"interval"),_=function(L){switch(L.type){case"color":return Fr.parse;case"padding":return Oi.parse;case"numberArray":return _n.parse;case"colorArray":return Sr.parse;default:return null}}(r);if(_&&((l=vn({},l)).stops&&(l.stops=l.stops.map(L=>[L[0],_(L[1])])),l.default=_(l.default?l.default:r.default)),l.colorSpace&&(x=l.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${l.colorSpace}"`);var x;const C=function(L){switch(L){case"exponential":return Id;case"interval":return ri;case"categorical":return Sm;case"identity":return kd;default:throw new Error(`Unknown function type "${L}"`)}}(g);let E,R;if(g==="categorical"){E=Object.create(null);for(const L of l.stops)E[L[0]]=L[1];R=typeof l.stops[0][0]}if(s){const L={},V=[];for(let J=0;J<l.stops.length;J++){const ee=l.stops[J],ne=ee[0].zoom;L[ne]===void 0&&(L[ne]={zoom:ne,type:l.type,property:l.property,default:l.default,stops:[]},V.push(ne)),L[ne].stops.push([ee[0].value,ee[1]])}const H=[];for(const J of V)H.push([L[J].zoom,wm(L[J],r)]);const Z={name:"linear"};return{kind:"composite",interpolationType:Z,interpolationFactor:eo.interpolationFactor.bind(void 0,Z),zoomStops:H.map(J=>J[0]),evaluate:({zoom:J},ee)=>Id({stops:H,base:l.base},r,J).evaluate(J,ee)}}if(d){const L=g==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:L,interpolationFactor:eo.interpolationFactor.bind(void 0,L),zoomStops:l.stops.map(V=>V[0]),evaluate:({zoom:V})=>C(l,r,V,E,R)}}return{kind:"source",evaluate(L,V){const H=V&&V.properties?V.properties[l.property]:void 0;return H===void 0?bu(l.default,r.default):C(l,r,H,E,R)}}}function bu(l,r,s){return l!==void 0?l:r!==void 0?r:s!==void 0?s:void 0}function Sm(l,r,s,d,g){return bu(typeof s===g?d[s]:void 0,l.default,r.default)}function ri(l,r,s){if(qr(s)!=="number")return bu(l.default,r.default);const d=l.stops.length;if(d===1||s<=l.stops[0][0])return l.stops[0][1];if(s>=l.stops[d-1][0])return l.stops[d-1][1];const g=Os(l.stops.map(_=>_[0]),s);return l.stops[g][1]}function Id(l,r,s){const d=l.base!==void 0?l.base:1;if(qr(s)!=="number")return bu(l.default,r.default);const g=l.stops.length;if(g===1||s<=l.stops[0][0])return l.stops[0][1];if(s>=l.stops[g-1][0])return l.stops[g-1][1];const _=Os(l.stops.map(L=>L[0]),s),x=function(L,V,H,Z){const J=Z-H,ee=L-H;return J===0?0:V===1?ee/J:(Math.pow(V,ee)-1)/(Math.pow(V,J)-1)}(s,d,l.stops[_][0],l.stops[_+1][0]),C=l.stops[_][1],E=l.stops[_+1][1],R=ti[r.type]||Eh;return typeof C.evaluate=="function"?{evaluate(...L){const V=C.evaluate.apply(void 0,L),H=E.evaluate.apply(void 0,L);if(V!==void 0&&H!==void 0)return R(V,H,x,l.colorSpace)}}:R(C,E,x,l.colorSpace)}function kd(l,r,s){switch(r.type){case"color":s=Fr.parse(s);break;case"formatted":s=Ji.fromString(s.toString());break;case"resolvedImage":s=Go.fromString(s.toString());break;case"padding":s=Oi.parse(s);break;case"colorArray":s=Sr.parse(s);break;case"numberArray":s=_n.parse(s);break;default:qr(s)===r.type||r.type==="enum"&&r.values[s]||(s=void 0)}return bu(s,l.default,r.default)}Oo.register(mc,{error:[{kind:"error"},[ot],(l,[r])=>{throw new Mn(r.evaluate(l))}],typeof:[ot,[ir],(l,[r])=>nn(qn(r.evaluate(l)))],"to-rgba":[Yi(jt,4),[Zt],(l,[r])=>{const[s,d,g,_]=r.evaluate(l).rgb;return[255*s,255*d,255*g,_]}],rgb:[Zt,[jt,jt,jt],gc],rgba:[Zt,[jt,jt,jt,jt],gc],has:{type:rt,overloads:[[[ot],(l,[r])=>Td(r.evaluate(l),l.properties())],[[ot,Nr],(l,[r,s])=>Td(r.evaluate(l),s.evaluate(l))]]},get:{type:ir,overloads:[[[ot],(l,[r])=>Md(r.evaluate(l),l.properties())],[[ot,Nr],(l,[r,s])=>Md(r.evaluate(l),s.evaluate(l))]]},"feature-state":[ir,[ot],(l,[r])=>Md(r.evaluate(l),l.featureState||{})],properties:[Nr,[],l=>l.properties()],"geometry-type":[ot,[],l=>l.geometryType()],id:[ir,[],l=>l.id()],zoom:[jt,[],l=>l.globals.zoom],"heatmap-density":[jt,[],l=>l.globals.heatmapDensity||0],elevation:[jt,[],l=>l.globals.elevation||0],"line-progress":[jt,[],l=>l.globals.lineProgress||0],accumulated:[ir,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[jt,na(jt),(l,r)=>{let s=0;for(const d of r)s+=d.evaluate(l);return s}],"*":[jt,na(jt),(l,r)=>{let s=1;for(const d of r)s*=d.evaluate(l);return s}],"-":{type:jt,overloads:[[[jt,jt],(l,[r,s])=>r.evaluate(l)-s.evaluate(l)],[[jt],(l,[r])=>-r.evaluate(l)]]},"/":[jt,[jt,jt],(l,[r,s])=>r.evaluate(l)/s.evaluate(l)],"%":[jt,[jt,jt],(l,[r,s])=>r.evaluate(l)%s.evaluate(l)],ln2:[jt,[],()=>Math.LN2],pi:[jt,[],()=>Math.PI],e:[jt,[],()=>Math.E],"^":[jt,[jt,jt],(l,[r,s])=>Math.pow(r.evaluate(l),s.evaluate(l))],sqrt:[jt,[jt],(l,[r])=>Math.sqrt(r.evaluate(l))],log10:[jt,[jt],(l,[r])=>Math.log(r.evaluate(l))/Math.LN10],ln:[jt,[jt],(l,[r])=>Math.log(r.evaluate(l))],log2:[jt,[jt],(l,[r])=>Math.log(r.evaluate(l))/Math.LN2],sin:[jt,[jt],(l,[r])=>Math.sin(r.evaluate(l))],cos:[jt,[jt],(l,[r])=>Math.cos(r.evaluate(l))],tan:[jt,[jt],(l,[r])=>Math.tan(r.evaluate(l))],asin:[jt,[jt],(l,[r])=>Math.asin(r.evaluate(l))],acos:[jt,[jt],(l,[r])=>Math.acos(r.evaluate(l))],atan:[jt,[jt],(l,[r])=>Math.atan(r.evaluate(l))],min:[jt,na(jt),(l,r)=>Math.min(...r.map(s=>s.evaluate(l)))],max:[jt,na(jt),(l,r)=>Math.max(...r.map(s=>s.evaluate(l)))],abs:[jt,[jt],(l,[r])=>Math.abs(r.evaluate(l))],round:[jt,[jt],(l,[r])=>{const s=r.evaluate(l);return s<0?-Math.round(-s):Math.round(s)}],floor:[jt,[jt],(l,[r])=>Math.floor(r.evaluate(l))],ceil:[jt,[jt],(l,[r])=>Math.ceil(r.evaluate(l))],"filter-==":[rt,[ot,ir],(l,[r,s])=>l.properties()[r.value]===s.value],"filter-id-==":[rt,[ir],(l,[r])=>l.id()===r.value],"filter-type-==":[rt,[ot],(l,[r])=>l.geometryType()===r.value],"filter-<":[rt,[ot,ir],(l,[r,s])=>{const d=l.properties()[r.value],g=s.value;return typeof d==typeof g&&d<g}],"filter-id-<":[rt,[ir],(l,[r])=>{const s=l.id(),d=r.value;return typeof s==typeof d&&s<d}],"filter->":[rt,[ot,ir],(l,[r,s])=>{const d=l.properties()[r.value],g=s.value;return typeof d==typeof g&&d>g}],"filter-id->":[rt,[ir],(l,[r])=>{const s=l.id(),d=r.value;return typeof s==typeof d&&s>d}],"filter-<=":[rt,[ot,ir],(l,[r,s])=>{const d=l.properties()[r.value],g=s.value;return typeof d==typeof g&&d<=g}],"filter-id-<=":[rt,[ir],(l,[r])=>{const s=l.id(),d=r.value;return typeof s==typeof d&&s<=d}],"filter->=":[rt,[ot,ir],(l,[r,s])=>{const d=l.properties()[r.value],g=s.value;return typeof d==typeof g&&d>=g}],"filter-id->=":[rt,[ir],(l,[r])=>{const s=l.id(),d=r.value;return typeof s==typeof d&&s>=d}],"filter-has":[rt,[ir],(l,[r])=>r.value in l.properties()],"filter-has-id":[rt,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[rt,[Yi(ot)],(l,[r])=>r.value.indexOf(l.geometryType())>=0],"filter-id-in":[rt,[Yi(ir)],(l,[r])=>r.value.indexOf(l.id())>=0],"filter-in-small":[rt,[ot,Yi(ir)],(l,[r,s])=>s.value.indexOf(l.properties()[r.value])>=0],"filter-in-large":[rt,[ot,Yi(ir)],(l,[r,s])=>function(d,g,_,x){for(;_<=x;){const C=_+x>>1;if(g[C]===d)return!0;g[C]>d?x=C-1:_=C+1}return!1}(l.properties()[r.value],s.value,0,s.value.length-1)],all:{type:rt,overloads:[[[rt,rt],(l,[r,s])=>r.evaluate(l)&&s.evaluate(l)],[na(rt),(l,r)=>{for(const s of r)if(!s.evaluate(l))return!1;return!0}]]},any:{type:rt,overloads:[[[rt,rt],(l,[r,s])=>r.evaluate(l)||s.evaluate(l)],[na(rt),(l,r)=>{for(const s of r)if(s.evaluate(l))return!0;return!1}]]},"!":[rt,[rt],(l,[r])=>!r.evaluate(l)],"is-supported-script":[rt,[ot],(l,[r])=>{const s=l.globals&&l.globals.isSupportedScript;return!s||s(r.evaluate(l))}],upcase:[ot,[ot],(l,[r])=>r.evaluate(l).toUpperCase()],downcase:[ot,[ot],(l,[r])=>r.evaluate(l).toLowerCase()],concat:[ot,na(ir),(l,r)=>r.map(s=>Ds(s.evaluate(l))).join("")],"resolved-locale":[ot,[An],(l,[r])=>r.evaluate(l).resolvedLocale()]});class vc{constructor(r,s,d){this.expression=r,this._warningHistory={},this._evaluator=new ph,this._defaultValue=s?function(g){if(g.type==="color"&&Ed(g.default))return new Fr(0,0,0,0);switch(g.type){case"color":return Fr.parse(g.default)||null;case"padding":return Oi.parse(g.default)||null;case"numberArray":return _n.parse(g.default)||null;case"colorArray":return Sr.parse(g.default)||null;case"variableAnchorOffsetCollection":return Do.parse(g.default)||null;case"projectionDefinition":return Qi.parse(g.default)||null;default:return g.default===void 0?null:g.default}}(s):null,this._enumValues=s&&s.type==="enum"?s.values:null,this._globalState=d}evaluateWithoutErrorHandling(r,s,d,g,_,x){return this._globalState&&(r=Pl(r,this._globalState)),this._evaluator.globals=r,this._evaluator.feature=s,this._evaluator.featureState=d,this._evaluator.canonical=g,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(r,s,d,g,_,x){this._globalState&&(r=Pl(r,this._globalState)),this._evaluator.globals=r,this._evaluator.feature=s||null,this._evaluator.featureState=d||null,this._evaluator.canonical=g,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x||null;try{const C=this.expression.evaluate(this._evaluator);if(C==null||typeof C=="number"&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new Mn(`Expected value to be one of ${Object.keys(this._enumValues).map(E=>JSON.stringify(E)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function _c(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in mc}function xc(l,r,s){const d=new xl(mc,Ch,[],r?function(_){const x={color:Zt,string:ot,number:jt,enum:ot,boolean:rt,formatted:Gi,padding:Ra,numberArray:Gn,colorArray:pl,projectionDefinition:Tr,resolvedImage:ml,variableAnchorOffsetCollection:Qs};return _.type==="array"?Yi(x[_.value]||ir,_.length):x[_.type]}(r):void 0),g=d.parse(l,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return g?Qf(new vc(g,r,s)):yc(d.errors)}class Cl{constructor(r,s,d){this.kind=r,this._styleExpression=s,this.isStateDependent=r!=="constant"&&!xu(s.expression),this.globalStateRefs=Ml(s.expression),this._globalState=d}evaluateWithoutErrorHandling(r,s,d,g,_,x){return this._globalState&&(r=Pl(r,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(r,s,d,g,_,x)}evaluate(r,s,d,g,_,x){return this._globalState&&(r=Pl(r,this._globalState)),this._styleExpression.evaluate(r,s,d,g,_,x)}}class wu{constructor(r,s,d,g,_){this.kind=r,this.zoomStops=d,this._styleExpression=s,this.isStateDependent=r!=="camera"&&!xu(s.expression),this.globalStateRefs=Ml(s.expression),this.interpolationType=g,this._globalState=_}evaluateWithoutErrorHandling(r,s,d,g,_,x){return this._globalState&&(r=Pl(r,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(r,s,d,g,_,x)}evaluate(r,s,d,g,_,x){return this._globalState&&(r=Pl(r,this._globalState)),this._styleExpression.evaluate(r,s,d,g,_,x)}interpolationFactor(r,s,d){return this.interpolationType?eo.interpolationFactor(this.interpolationType,r,s,d):0}}function Tl(l,r,s){const d=xc(l,r,s);if(d.result==="error")return d;const g=d.value.expression,_=Th(g);if(!_&&!ss(r))return yc([new zn("","data expressions not supported")]);const x=Mh(g,["zoom"]);if(!x&&!Pd(r))return yc([new zn("","zoom expressions not supported")]);const C=Ad(g);return C||x?C instanceof zn?yc([C]):C instanceof eo&&!Ph(r)?yc([new zn("",'"interpolate" expressions cannot be used with this property')]):Qf(C?new wu(_?"camera":"composite",d.value,C.labels,C instanceof eo?C.interpolation:void 0,s):new Cl(_?"constant":"source",d.value,s)):yc([new zn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ih{constructor(r,s){this._parameters=r,this._specification=s,vn(this,wm(this._parameters,this._specification))}static deserialize(r){return new Ih(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function Ad(l){let r=null;if(l instanceof sn)r=Ad(l.result);else if(l instanceof lc){for(const s of l.args)if(r=Ad(s),r)break}else(l instanceof ra||l instanceof eo)&&l.input instanceof Oo&&l.input.name==="zoom"&&(r=l);return r instanceof zn||l.eachChild(s=>{const d=Ad(s);d instanceof zn?r=d:!r&&d?r=new zn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&d&&r!==d&&(r=new zn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}function Ml(l,r=new Set){return l instanceof pc&&r.add(l.key),l.eachChild(s=>{Ml(s,r)}),r}function Pl(l,r){const{zoom:s,heatmapDensity:d,elevation:g,lineProgress:_,isSupportedScript:x,accumulated:C}=l??{};return{zoom:s,heatmapDensity:d,elevation:g,lineProgress:_,isSupportedScript:x,accumulated:C,globalState:r}}function Su(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const r of l.slice(1))if(!Su(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}const Rd={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function bc(l,r){if(l==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Su(l)||(l=wc(l));const s=xc(l,Rd,r);if(s.result==="error")throw new Error(s.value.map(d=>`${d.key}: ${d.message}`).join(", "));return{filter:(d,g,_)=>s.value.evaluate(d,g,{},_),needGeometry:Dd(l),getGlobalStateRefs:()=>Ml(s.value.expression)}}function ep(l,r){return l<r?-1:l>r?1:0}function Dd(l){if(!Array.isArray(l))return!1;if(l[0]==="within"||l[0]==="distance")return!0;for(let r=1;r<l.length;r++)if(Dd(l[r]))return!0;return!1}function wc(l){if(!l)return!0;const r=l[0];return l.length<=1?r!=="any":r==="=="?zd(l[1],l[2],"=="):r==="!="?kh(zd(l[1],l[2],"==")):r==="<"||r===">"||r==="<="||r===">="?zd(l[1],l[2],r):r==="any"?(s=l.slice(1),["any"].concat(s.map(wc))):r==="all"?["all"].concat(l.slice(1).map(wc)):r==="none"?["all"].concat(l.slice(1).map(wc).map(kh)):r==="in"?tp(l[1],l.slice(2)):r==="!in"?kh(tp(l[1],l.slice(2))):r==="has"?Cm(l[1]):r!=="!has"||kh(Cm(l[1]));var s}function zd(l,r,s){switch(l){case"$type":return[`filter-type-${s}`,r];case"$id":return[`filter-id-${s}`,r];default:return[`filter-${s}`,l,r]}}function tp(l,r){if(r.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(s=>typeof s!=typeof r[0])?["filter-in-large",l,["literal",r.sort(ep)]]:["filter-in-small",l,["literal",r]]}}function Cm(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function kh(l){return["!",l]}function Cu(l){const r=typeof l;if(r==="number"||r==="boolean"||r==="string"||l==null)return JSON.stringify(l);if(Array.isArray(l)){let g="[";for(const _ of l)g+=`${Cu(_)},`;return`${g}]`}const s=Object.keys(l).sort();let d="{";for(let g=0;g<s.length;g++)d+=`${JSON.stringify(s[g])}:${Cu(l[s[g]])},`;return`${d}}`}function Fa(l){let r="";for(const s of Lr)r+=`/${Cu(l[s])}`;return r}function rp(l){const r=l.value;return r?[new Et(l.key,r,"constants have been deprecated as of v8")]:[]}function On(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function wo(l){if(Array.isArray(l))return l.map(wo);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const r={};for(const s in l)r[s]=wo(l[s]);return r}return On(l)}function po(l){const r=l.key,s=l.value,d=l.valueSpec||{},g=l.objectElementValidators||{},_=l.style,x=l.styleSpec,C=l.validateSpec;let E=[];const R=qr(s);if(R!=="object")return[new Et(r,s,`object expected, ${R} found`)];for(const L in s){const V=L.split(".")[0],H=fn(d,V)||d["*"];let Z;if(fn(g,V))Z=g[V];else if(fn(d,V)){if(s[L]===void 0)continue;Z=C}else if(g["*"])Z=g["*"];else{if(!d["*"]){E.push(new Et(r,s[L],`unknown property "${L}"`));continue}Z=C}E=E.concat(Z({key:(r&&`${r}.`)+L,value:s[L],valueSpec:H,style:_,styleSpec:x,object:s,objectKey:L,validateSpec:C},s))}for(const L in d)g[L]||d[L].required&&d[L].default===void 0&&s[L]===void 0&&E.push(new Et(r,s,`missing required property "${L}"`));return E}function ys(l){const r=l.value,s=l.valueSpec,d=l.style,g=l.styleSpec,_=l.key,x=l.arrayElementValidator||l.validateSpec;if(qr(r)!=="array")return[new Et(_,r,`array expected, ${qr(r)} found`)];if(s.length&&r.length!==s.length)return[new Et(_,r,`array length ${s.length} expected, length ${r.length} found`)];let C={type:s.value,values:s.values};g.$version<7&&(C.function=s.function),qr(s.value)==="object"&&(C=s.value);let E=[];for(let R=0;R<r.length;R++)E=E.concat(x({array:r,arrayIndex:R,value:r[R],valueSpec:C,validateSpec:l.validateSpec,style:d,styleSpec:g,key:`${_}[${R}]`}));return E}function Sc(l){const r=l.key,s=l.value,d=l.valueSpec;let g=qr(s);return g==="number"&&s!=s&&(g="NaN"),g!=="number"?[new Et(r,s,`number expected, ${g} found`)]:"minimum"in d&&s<d.minimum?[new Et(r,s,`${s} is less than the minimum value ${d.minimum}`)]:"maximum"in d&&s>d.maximum?[new Et(r,s,`${s} is greater than the maximum value ${d.maximum}`)]:[]}function Od(l){const r=l.valueSpec,s=On(l.value.type);let d,g,_,x={};const C=s!=="categorical"&&l.value.property===void 0,E=!C,R=qr(l.value.stops)==="array"&&qr(l.value.stops[0])==="array"&&qr(l.value.stops[0][0])==="object",L=po({key:l.key,value:l.value,valueSpec:l.styleSpec.function,validateSpec:l.validateSpec,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{stops:function(Z){if(s==="identity")return[new Et(Z.key,Z.value,'identity function may not have a "stops" property')];let J=[];const ee=Z.value;return J=J.concat(ys({key:Z.key,value:ee,valueSpec:Z.valueSpec,validateSpec:Z.validateSpec,style:Z.style,styleSpec:Z.styleSpec,arrayElementValidator:V})),qr(ee)==="array"&&ee.length===0&&J.push(new Et(Z.key,ee,"array must have at least one stop")),J},default:function(Z){return Z.validateSpec({key:Z.key,value:Z.value,valueSpec:r,validateSpec:Z.validateSpec,style:Z.style,styleSpec:Z.styleSpec})}}});return s==="identity"&&C&&L.push(new Et(l.key,l.value,'missing required property "property"')),s==="identity"||l.value.stops||L.push(new Et(l.key,l.value,'missing required property "stops"')),s==="exponential"&&l.valueSpec.expression&&!Ph(l.valueSpec)&&L.push(new Et(l.key,l.value,"exponential functions not supported")),l.styleSpec.$version>=8&&(E&&!ss(l.valueSpec)?L.push(new Et(l.key,l.value,"property functions not supported")):C&&!Pd(l.valueSpec)&&L.push(new Et(l.key,l.value,"zoom functions not supported"))),s!=="categorical"&&!R||l.value.property!==void 0||L.push(new Et(l.key,l.value,'"property" property is required')),L;function V(Z){let J=[];const ee=Z.value,ne=Z.key;if(qr(ee)!=="array")return[new Et(ne,ee,`array expected, ${qr(ee)} found`)];if(ee.length!==2)return[new Et(ne,ee,`array length 2 expected, length ${ee.length} found`)];if(R){if(qr(ee[0])!=="object")return[new Et(ne,ee,`object expected, ${qr(ee[0])} found`)];if(ee[0].zoom===void 0)return[new Et(ne,ee,"object stop key must have zoom")];if(ee[0].value===void 0)return[new Et(ne,ee,"object stop key must have value")];if(_&&_>On(ee[0].zoom))return[new Et(ne,ee[0].zoom,"stop zoom values must appear in ascending order")];On(ee[0].zoom)!==_&&(_=On(ee[0].zoom),g=void 0,x={}),J=J.concat(po({key:`${ne}[0]`,value:ee[0],valueSpec:{zoom:{}},validateSpec:Z.validateSpec,style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{zoom:Sc,value:H}}))}else J=J.concat(H({key:`${ne}[0]`,value:ee[0],validateSpec:Z.validateSpec,style:Z.style,styleSpec:Z.styleSpec},ee));return _c(wo(ee[1]))?J.concat([new Et(`${ne}[1]`,ee[1],"expressions are not allowed in function stops.")]):J.concat(Z.validateSpec({key:`${ne}[1]`,value:ee[1],valueSpec:r,validateSpec:Z.validateSpec,style:Z.style,styleSpec:Z.styleSpec}))}function H(Z,J){const ee=qr(Z.value),ne=On(Z.value),fe=Z.value!==null?Z.value:J;if(d){if(ee!==d)return[new Et(Z.key,fe,`${ee} stop domain type must match previous stop domain type ${d}`)]}else d=ee;if(ee!=="number"&&ee!=="string"&&ee!=="boolean")return[new Et(Z.key,fe,"stop domain value must be a number, string, or boolean")];if(ee!=="number"&&s!=="categorical"){let Te=`number expected, ${ee} found`;return ss(r)&&s===void 0&&(Te+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Et(Z.key,fe,Te)]}return s!=="categorical"||ee!=="number"||isFinite(ne)&&Math.floor(ne)===ne?s!=="categorical"&&ee==="number"&&g!==void 0&&ne<g?[new Et(Z.key,fe,"stop domain values must appear in ascending order")]:(g=ne,s==="categorical"&&ne in x?[new Et(Z.key,fe,"stop domain values must be unique")]:(x[ne]=!0,[])):[new Et(Z.key,fe,`integer expected, found ${ne}`)]}}function El(l){const r=(l.expressionContext==="property"?Tl:xc)(wo(l.value),l.valueSpec);if(r.result==="error")return r.value.map(d=>new Et(`${l.key}${d.key}`,l.value,d.message));const s=r.value.expression||r.value._styleExpression.expression;if(l.expressionContext==="property"&&l.propertyKey==="text-font"&&!s.outputDefined())return[new Et(l.key,l.value,`Invalid data expression for "${l.propertyKey}". Output values must be contained as literals within the expression.`)];if(l.expressionContext==="property"&&l.propertyType==="layout"&&!xu(s))return[new Et(l.key,l.value,'"feature-state" data expressions are not supported with layout properties.')];if(l.expressionContext==="filter"&&!xu(s))return[new Et(l.key,l.value,'"feature-state" data expressions are not supported with filters.')];if(l.expressionContext&&l.expressionContext.indexOf("cluster")===0){if(!Mh(s,["zoom","feature-state"]))return[new Et(l.key,l.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(l.expressionContext==="cluster-initial"&&!Th(s))return[new Et(l.key,l.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function $s(l){const r=l.key,s=l.value,d=qr(s);return d!=="string"?[new Et(r,s,`color expected, ${d} found`)]:Fr.parse(String(s))?[]:[new Et(r,s,`color expected, "${s}" found`)]}function js(l){const r=l.key,s=l.value,d=l.valueSpec,g=[];return Array.isArray(d.values)?d.values.indexOf(On(s))===-1&&g.push(new Et(r,s,`expected one of [${d.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(d.values).indexOf(On(s))===-1&&g.push(new Et(r,s,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(s)} found`)),g}function Ns(l){return Su(wo(l.value))?El(vn({},l,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ah(l)}function Ah(l){const r=l.value,s=l.key;if(qr(r)!=="array")return[new Et(s,r,`array expected, ${qr(r)} found`)];const d=l.styleSpec;let g,_=[];if(r.length<1)return[new Et(s,r,"filter array must have at least 1 element")];switch(_=_.concat(js({key:`${s}[0]`,value:r[0],valueSpec:d.filter_operator,style:l.style,styleSpec:l.styleSpec})),On(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&On(r[1])==="$type"&&_.push(new Et(s,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&_.push(new Et(s,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(g=qr(r[1]),g!=="string"&&_.push(new Et(`${s}[1]`,r[1],`string expected, ${g} found`)));for(let x=2;x<r.length;x++)g=qr(r[x]),On(r[1])==="$type"?_=_.concat(js({key:`${s}[${x}]`,value:r[x],valueSpec:d.geometry_type,style:l.style,styleSpec:l.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&_.push(new Et(`${s}[${x}]`,r[x],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let x=1;x<r.length;x++)_=_.concat(Ah({key:`${s}[${x}]`,value:r[x],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":g=qr(r[1]),r.length!==2?_.push(new Et(s,r,`filter array for "${r[0]}" operator must have 2 elements`)):g!=="string"&&_.push(new Et(`${s}[1]`,r[1],`string expected, ${g} found`))}return _}function Ld(l,r){const s=l.key,d=l.validateSpec,g=l.style,_=l.styleSpec,x=l.value,C=l.objectKey,E=_[`${r}_${l.layerType}`];if(!E)return[];const R=C.match(/^(.*)-transition$/);if(r==="paint"&&R&&E[R[1]]&&E[R[1]].transition)return d({key:s,value:x,valueSpec:_.transition,style:g,styleSpec:_});const L=l.valueSpec||E[C];if(!L)return[new Et(s,x,`unknown property "${C}"`)];let V;if(qr(x)==="string"&&ss(L)&&!L.tokens&&(V=/^{([^}]+)}$/.exec(x)))return[new Et(s,x,`"${C}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(V[1])} }\`.`)];const H=[];return l.layerType==="symbol"&&C==="text-font"&&Ed(wo(x))&&On(x.type)==="identity"&&H.push(new Et(s,x,'"text-font" does not support identity functions')),H.concat(d({key:l.key,value:x,valueSpec:L,style:g,styleSpec:_,expressionContext:"property",propertyType:r,propertyKey:C}))}function Cc(l){return Ld(l,"paint")}function Ba(l){return Ld(l,"layout")}function Hn(l){let r=[];const s=l.value,d=l.key,g=l.style,_=l.styleSpec;if(qr(s)!=="object")return[new Et(d,s,`object expected, ${qr(s)} found`)];s.type||s.ref||r.push(new Et(d,s,'either "type" or "ref" is required'));let x=On(s.type);const C=On(s.ref);if(s.id){const E=On(s.id);for(let R=0;R<l.arrayIndex;R++){const L=g.layers[R];On(L.id)===E&&r.push(new Et(d,s.id,`duplicate layer id "${s.id}", previously used at line ${L.id.__line__}`))}}if("ref"in s){let E;["type","source","source-layer","filter","layout"].forEach(R=>{R in s&&r.push(new Et(d,s[R],`"${R}" is prohibited for ref layers`))}),g.layers.forEach(R=>{On(R.id)===C&&(E=R)}),E?E.ref?r.push(new Et(d,s.ref,"ref cannot reference another ref layer")):x=On(E.type):r.push(new Et(d,s.ref,`ref layer "${C}" not found`))}else if(x!=="background")if(s.source){const E=g.sources&&g.sources[s.source],R=E&&On(E.type);E?R==="vector"&&x==="raster"?r.push(new Et(d,s.source,`layer "${s.id}" requires a raster source`)):R!=="raster-dem"&&x==="hillshade"||R!=="raster-dem"&&x==="color-relief"?r.push(new Et(d,s.source,`layer "${s.id}" requires a raster-dem source`)):R==="raster"&&x!=="raster"?r.push(new Et(d,s.source,`layer "${s.id}" requires a vector source`)):R!=="vector"||s["source-layer"]?R==="raster-dem"&&x!=="hillshade"&&x!=="color-relief"?r.push(new Et(d,s.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):x!=="line"||!s.paint||!s.paint["line-gradient"]||R==="geojson"&&E.lineMetrics||r.push(new Et(d,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new Et(d,s,`layer "${s.id}" must specify a "source-layer"`)):r.push(new Et(d,s.source,`source "${s.source}" not found`))}else r.push(new Et(d,s,'missing required property "source"'));return r=r.concat(po({key:d,value:s,valueSpec:_.layer,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*":()=>[],type:()=>l.validateSpec({key:`${d}.type`,value:s.type,valueSpec:_.layer.type,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,object:s,objectKey:"type"}),filter:Ns,layout:E=>po({layer:s,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":R=>Ba(vn({layerType:x},R))}}),paint:E=>po({layer:s,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":R=>Cc(vn({layerType:x},R))}})}})),r}function pn(l){const r=l.value,s=l.key,d=qr(r);return d!=="string"?[new Et(s,r,`string expected, ${d} found`)]:[]}const ia={promoteId:function({key:l,value:r}){if(qr(r)==="string")return pn({key:l,value:r});{const s=[];for(const d in r)s.push(...pn({key:`${l}.${d}`,value:r[d]}));return s}}};function to(l){const r=l.value,s=l.key,d=l.styleSpec,g=l.style,_=l.validateSpec;if(!r.type)return[new Et(s,r,'"type" is required')];const x=On(r.type);let C;switch(x){case"vector":case"raster":return C=po({key:s,value:r,valueSpec:d[`source_${x.replace("-","_")}`],style:l.style,styleSpec:d,objectElementValidators:ia,validateSpec:_}),C;case"raster-dem":return C=function(E){var R;const L=(R=E.sourceName)!==null&&R!==void 0?R:"",V=E.value,H=E.styleSpec,Z=H.source_raster_dem,J=E.style;let ee=[];const ne=qr(V);if(V===void 0)return ee;if(ne!=="object")return ee.push(new Et("source_raster_dem",V,`object expected, ${ne} found`)),ee;const fe=On(V.encoding)==="custom",Te=["redFactor","greenFactor","blueFactor","baseShift"],pe=E.value.encoding?`"${E.value.encoding}"`:"Default";for(const me in V)!fe&&Te.includes(me)?ee.push(new Et(me,V[me],`In "${L}": "${me}" is only valid when "encoding" is set to "custom". ${pe} encoding found`)):Z[me]?ee=ee.concat(E.validateSpec({key:me,value:V[me],valueSpec:Z[me],validateSpec:E.validateSpec,style:J,styleSpec:H})):ee.push(new Et(me,V[me],`unknown property "${me}"`));return ee}({sourceName:s,value:r,style:l.style,styleSpec:d,validateSpec:_}),C;case"geojson":if(C=po({key:s,value:r,valueSpec:d.source_geojson,style:g,styleSpec:d,validateSpec:_,objectElementValidators:ia}),r.cluster)for(const E in r.clusterProperties){const[R,L]=r.clusterProperties[E],V=typeof R=="string"?[R,["accumulated"],["get",E]]:R;C.push(...El({key:`${s}.${E}.map`,value:L,expressionContext:"cluster-map"})),C.push(...El({key:`${s}.${E}.reduce`,value:V,expressionContext:"cluster-reduce"}))}return C;case"video":return po({key:s,value:r,valueSpec:d.source_video,style:g,validateSpec:_,styleSpec:d});case"image":return po({key:s,value:r,valueSpec:d.source_image,style:g,validateSpec:_,styleSpec:d});case"canvas":return[new Et(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return js({key:`${s}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function ro(l){const r=l.value,s=l.styleSpec,d=s.light,g=l.style;let _=[];const x=qr(r);if(r===void 0)return _;if(x!=="object")return _=_.concat([new Et("light",r,`object expected, ${x} found`)]),_;for(const C in r){const E=C.match(/^(.*)-transition$/);_=_.concat(E&&d[E[1]]&&d[E[1]].transition?l.validateSpec({key:C,value:r[C],valueSpec:s.transition,validateSpec:l.validateSpec,style:g,styleSpec:s}):d[C]?l.validateSpec({key:C,value:r[C],valueSpec:d[C],validateSpec:l.validateSpec,style:g,styleSpec:s}):[new Et(C,r[C],`unknown property "${C}"`)])}return _}function Il(l){const r=l.value,s=l.styleSpec,d=s.sky,g=l.style,_=qr(r);if(r===void 0)return[];if(_!=="object")return[new Et("sky",r,`object expected, ${_} found`)];let x=[];for(const C in r)x=x.concat(d[C]?l.validateSpec({key:C,value:r[C],valueSpec:d[C],style:g,styleSpec:s}):[new Et(C,r[C],`unknown property "${C}"`)]);return x}function kl(l){const r=l.value,s=l.styleSpec,d=s.terrain,g=l.style;let _=[];const x=qr(r);if(r===void 0)return _;if(x!=="object")return _=_.concat([new Et("terrain",r,`object expected, ${x} found`)]),_;for(const C in r)_=_.concat(d[C]?l.validateSpec({key:C,value:r[C],valueSpec:d[C],validateSpec:l.validateSpec,style:g,styleSpec:s}):[new Et(C,r[C],`unknown property "${C}"`)]);return _}function So(l){let r=[];const s=l.value,d=l.key;if(Array.isArray(s)){const g=[],_=[];for(const x in s)s[x].id&&g.includes(s[x].id)&&r.push(new Et(d,s,`all the sprites' ids must be unique, but ${s[x].id} is duplicated`)),g.push(s[x].id),s[x].url&&_.includes(s[x].url)&&r.push(new Et(d,s,`all the sprites' URLs must be unique, but ${s[x].url} is duplicated`)),_.push(s[x].url),r=r.concat(po({key:`${d}[${x}]`,value:s[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:l.validateSpec}));return r}return pn({key:d,value:s})}function Rh(l){return!!l&&l.constructor===Object}function Fd(l){return Rh(l.value)?[]:[new Et(l.key,l.value,`object expected, ${qr(l.value)} found`)]}const Bd={"*":()=>[],array:ys,boolean:function(l){const r=l.value,s=l.key,d=qr(r);return d!=="boolean"?[new Et(s,r,`boolean expected, ${d} found`)]:[]},number:Sc,color:$s,constants:rp,enum:js,filter:Ns,function:Od,layer:Hn,object:po,source:to,light:ro,sky:Il,terrain:kl,projection:function(l){const r=l.value,s=l.styleSpec,d=s.projection,g=l.style,_=qr(r);if(r===void 0)return[];if(_!=="object")return[new Et("projection",r,`object expected, ${_} found`)];let x=[];for(const C in r)x=x.concat(d[C]?l.validateSpec({key:C,value:r[C],valueSpec:d[C],style:g,styleSpec:s}):[new Et(C,r[C],`unknown property "${C}"`)]);return x},projectionDefinition:function(l){const r=l.key;let s=l.value;s=s instanceof String?s.valueOf():s;const d=qr(s);return d!=="array"||function(g){return Array.isArray(g)&&g.length===3&&typeof g[0]=="string"&&typeof g[1]=="string"&&typeof g[2]=="number"}(s)||function(g){return!!["interpolate","step","literal"].includes(g[0])}(s)?["array","string"].includes(d)?[]:[new Et(r,s,`projection expected, invalid type "${d}" found`)]:[new Et(r,s,`projection expected, invalid array ${JSON.stringify(s)} found`)]},string:pn,formatted:function(l){return pn(l).length===0?[]:El(l)},resolvedImage:function(l){return pn(l).length===0?[]:El(l)},padding:function(l){const r=l.key,s=l.value;if(qr(s)==="array"){if(s.length<1||s.length>4)return[new Et(r,s,`padding requires 1 to 4 values; ${s.length} values found`)];const d={type:"number"};let g=[];for(let _=0;_<s.length;_++)g=g.concat(l.validateSpec({key:`${r}[${_}]`,value:s[_],validateSpec:l.validateSpec,valueSpec:d}));return g}return Sc({key:r,value:s,valueSpec:{}})},numberArray:function(l){const r=l.key,s=l.value;if(qr(s)==="array"){const d={type:"number"};if(s.length<1)return[new Et(r,s,"array length at least 1 expected, length 0 found")];let g=[];for(let _=0;_<s.length;_++)g=g.concat(l.validateSpec({key:`${r}[${_}]`,value:s[_],validateSpec:l.validateSpec,valueSpec:d}));return g}return Sc({key:r,value:s,valueSpec:{}})},colorArray:function(l){const r=l.key,s=l.value;if(qr(s)==="array"){if(s.length<1)return[new Et(r,s,"array length at least 1 expected, length 0 found")];let d=[];for(let g=0;g<s.length;g++)d=d.concat($s({key:`${r}[${g}]`,value:s[g]}));return d}return $s({key:r,value:s})},variableAnchorOffsetCollection:function(l){const r=l.key,s=l.value,d=qr(s),g=l.styleSpec;if(d!=="array"||s.length<1||s.length%2!=0)return[new Et(r,s,"variableAnchorOffsetCollection requires a non-empty array of even length")];let _=[];for(let x=0;x<s.length;x+=2)_=_.concat(js({key:`${r}[${x}]`,value:s[x],valueSpec:g.layout_symbol["text-anchor"]})),_=_.concat(ys({key:`${r}[${x+1}]`,value:s[x+1],valueSpec:{length:2,value:"number"},validateSpec:l.validateSpec,style:l.style,styleSpec:g}));return _},sprite:So,state:Fd,fontFaces:function(l){const r=l.key,s=l.value,d=l.validateSpec,g=l.styleSpec,_=l.style;if(!Rh(s))return[new Et(r,s,`object expected, ${qr(s)} found`)];const x=[];for(const C in s){const E=s[C],R=qr(E);if(R==="string")x.push(...pn({key:`${r}.${C}`,value:E}));else if(R==="array"){const L={url:{type:"string",required:!0},"unicode-range":{type:"array",value:"string"}};for(const[V,H]of E.entries())x.push(...po({key:`${r}.${C}[${V}]`,value:H,valueSpec:L,styleSpec:g,style:_,validateSpec:d}))}else x.push(new Et(`${r}.${C}`,E,`string or array expected, ${R} found`))}return x}};function Vs(l){const r=l.value,s=l.valueSpec,d=l.styleSpec;return l.validateSpec=Vs,s.expression&&Ed(On(r))?Od(l):s.expression&&_c(wo(r))?El(l):s.type&&Bd[s.type]?Bd[s.type](l):po(vn({},l,{valueSpec:s.type?d[s.type]:s}))}function np(l){const r=l.value,s=l.key,d=pn(l);return d.length||(r.indexOf("{fontstack}")===-1&&d.push(new Et(s,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&d.push(new Et(s,r,'"glyphs" url must include a "{range}" token'))),d}function Fi(l,r=Ze){let s=[];return s=s.concat(Vs({key:"",value:l,valueSpec:r.$root,styleSpec:r,style:l,validateSpec:Vs,objectElementValidators:{glyphs:np,"*":()=>[]}})),l.constants&&(s=s.concat(rp({key:"constants",value:l.constants}))),$d(s)}function Ho(l){return function(r){return l(Object.assign({},r,{validateSpec:Vs}))}}function $d(l){return[].concat(l).sort((r,s)=>r.line-s.line)}function vs(l){return function(...r){return $d(l.apply(this,r))}}Fi.source=vs(Ho(to)),Fi.sprite=vs(Ho(So)),Fi.glyphs=vs(Ho(np)),Fi.light=vs(Ho(ro)),Fi.sky=vs(Ho(Il)),Fi.terrain=vs(Ho(kl)),Fi.state=vs(Ho(Fd)),Fi.layer=vs(Ho(Hn)),Fi.filter=vs(Ho(Ns)),Fi.paintProperty=vs(Ho(Cc)),Fi.layoutProperty=vs(Ho(Ba));const sy={type:"enum","property-type":"data-constant",expression:{interpolated:!1,parameters:["global-state"]},values:{visible:{},none:{}},transition:!1,default:"visible"};class _s{constructor(r,s){this._globalState=s,this.setValue(r)}evaluate(){var r;return(r=this._literalValue)!==null&&r!==void 0?r:this._compiledValue.evaluate({})}setValue(r){if(r==null||r==="visible"||r==="none")return this._literalValue=r==="none"?"none":"visible",this._compiledValue=void 0,void(this._globalStateRefs=new Set);const s=xc(r,sy,this._globalState);if(s.result==="error")throw this._literalValue="visible",this._compiledValue=void 0,new Error(s.value.map(d=>`${d.key}: ${d.message}`).join(", "));this._literalValue=void 0,this._compiledValue=s.value,this._globalStateRefs=Ml(s.value.expression)}getGlobalStateRefs(){return this._globalStateRefs}}const oa=Ze,mi=Fi,Al=mi.light,Dh=mi.sky,xs=mi.paintProperty,bs=mi.layoutProperty;function ws(l,r){let s=!1;if(r&&r.length)for(const d of r)l.fire(new br(new Error(d.message))),s=!0;return s}class Wo{constructor(r,s,d){const g=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;const x=new Int32Array(this.arrayBuffer);r=x[0],this.d=(s=x[1])+2*(d=x[2]);for(let E=0;E<this.d*this.d;E++){const R=x[3+E],L=x[3+E+1];g.push(R===L?null:x.subarray(R,L))}const C=x[3+g.length+1];this.keys=x.subarray(x[3+g.length],C),this.bboxes=x.subarray(C),this.insert=this._insertReadonly}else{this.d=s+2*d;for(let x=0;x<this.d*this.d;x++)g.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=r,this.padding=d,this.scale=s/r,this.uid=0;const _=d/s*r;this.min=-_,this.max=r+_}insert(r,s,d,g,_){this._forEachCell(s,d,g,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(r),this.bboxes.push(s),this.bboxes.push(d),this.bboxes.push(g),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(r,s,d,g,_,x){this.cells[_].push(x)}query(r,s,d,g,_){const x=this.min,C=this.max;if(r<=x&&s<=x&&C<=d&&C<=g&&!_)return Array.prototype.slice.call(this.keys);{const E=[];return this._forEachCell(r,s,d,g,this._queryCell,E,{},_),E}}_queryCell(r,s,d,g,_,x,C,E){const R=this.cells[_];if(R!==null){const L=this.keys,V=this.bboxes;for(let H=0;H<R.length;H++){const Z=R[H];if(C[Z]===void 0){const J=4*Z;(E?E(V[J+0],V[J+1],V[J+2],V[J+3]):r<=V[J+2]&&s<=V[J+3]&&d>=V[J+0]&&g>=V[J+1])?(C[Z]=!0,x.push(L[Z])):C[Z]=!1}}}}_forEachCell(r,s,d,g,_,x,C,E){const R=this._convertToCellCoord(r),L=this._convertToCellCoord(s),V=this._convertToCellCoord(d),H=this._convertToCellCoord(g);for(let Z=R;Z<=V;Z++)for(let J=L;J<=H;J++){const ee=this.d*J+Z;if((!E||E(this._convertFromCellCoord(Z),this._convertFromCellCoord(J),this._convertFromCellCoord(Z+1),this._convertFromCellCoord(J+1)))&&_.call(this,r,s,d,g,ee,x,C,E))return}}_convertFromCellCoord(r){return(r-this.padding)/this.scale}_convertToCellCoord(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const r=this.cells,s=3+this.cells.length+1+1;let d=0;for(let x=0;x<this.cells.length;x++)d+=this.cells[x].length;const g=new Int32Array(s+d+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let _=s;for(let x=0;x<r.length;x++){const C=r[x];g[3+x]=_,g.set(C,_),_+=C.length}return g[3+r.length]=_,g.set(this.keys,_),_+=this.keys.length,g[3+r.length+1]=_,g.set(this.bboxes,_),_+=this.bboxes.length,g.buffer}static serialize(r,s){const d=r.toArrayBuffer();return s&&s.push(d),{buffer:d}}static deserialize(r){return new Wo(r.buffer)}}const qi={};function Ut(l,r,s={}){if(qi[l])throw new Error(`${l} is already registered.`);Object.defineProperty(r,"_classRegistryKey",{value:l,writeable:!1}),qi[l]={klass:r,omit:s.omit||[],shallow:s.shallow||[]}}Ut("Object",Object),Ut("Set",Set),Ut("TransferableGridIndex",Wo),Ut("Color",Fr),Ut("Error",Error),Ut("AJAXError",$e),Ut("ResolvedImage",Go),Ut("StylePropertyFunction",Ih),Ut("StyleExpression",vc,{omit:["_evaluator"]}),Ut("ZoomDependentExpression",wu),Ut("ZoomConstantExpression",Cl),Ut("CompoundExpression",Oo,{omit:["_evaluate"]});for(const l in mc)mc[l]._classRegistryKey||Ut(`Expression_${l}`,mc[l]);function zh(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function Oh(l){return l.$name||l.constructor._classRegistryKey}function Rl(l){return!function(r){if(r===null||typeof r!="object")return!1;const s=Oh(r);return!(!s||s==="Object")}(l)&&(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||l instanceof Blob||l instanceof Error||zh(l)||Yt(l)||ArrayBuffer.isView(l)||l instanceof ImageData)}function mo(l,r){if(Rl(l))return(zh(l)||Yt(l))&&r&&r.push(l),ArrayBuffer.isView(l)&&r&&r.push(l.buffer),l instanceof ImageData&&r&&r.push(l.data.buffer),l;if(Array.isArray(l)){const _=[];for(const x of l)_.push(mo(x,r));return _}if(typeof l!="object")throw new Error("can't serialize object of type "+typeof l);const s=Oh(l);if(!s)throw new Error(`can't serialize object of unregistered class ${l.constructor.name}`);if(!qi[s])throw new Error(`${s} is not registered.`);const{klass:d}=qi[s],g=d.serialize?d.serialize(l,r):{};if(d.serialize){if(r&&g===r[r.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const _ in l){if(!l.hasOwnProperty(_)||qi[s].omit.indexOf(_)>=0)continue;const x=l[_];g[_]=qi[s].shallow.indexOf(_)>=0?x:mo(x,r)}l instanceof Error&&(g.message=l.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(g.$name=s),g}function go(l){if(Rl(l))return l;if(Array.isArray(l))return l.map(go);if(typeof l!="object")throw new Error("can't deserialize object of type "+typeof l);const r=Oh(l)||"Object";if(!qi[r])throw new Error(`can't deserialize unregistered class ${r}`);const{klass:s}=qi[r];if(!s)throw new Error(`can't deserialize unregistered class ${r}`);if(s.deserialize)return s.deserialize(l);const d=Object.create(s.prototype);for(const g of Object.keys(l)){if(g==="$name")continue;const _=l[g];d[g]=qi[r].shallow.indexOf(g)>=0?_:go(_)}return d}class Wn{constructor(){this.first=!0}update(r,s){const d=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=d,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=d,!0):(this.lastFloorZoom>d?(this.lastIntegerZoom=d+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<d&&(this.lastIntegerZoom=d,this.lastIntegerZoomTime=s),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=d,!0))}}function Lo(l){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(l))}function jd(l){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(l))}function ip(l){return/\s/u.test(String.fromCodePoint(l))}function Dl(l){for(const r of l)if(jd(r.codePointAt(0)))return!0;return!1}function op(l){for(const r of l)if(!sp(r.codePointAt(0)))return!1;return!0}function Lh(l){const r=l.map(s=>{try{return new RegExp(`\\p{sc=${s}}`,"u").source}catch{return null}}).filter(s=>s);return new RegExp(r.join("|"),"u")}const Tc=Lh(["Arab","Dupl","Mong","Ougr","Syrc"]);function sp(l){return!Tc.test(String.fromCodePoint(l))}function zl(l){return!(jd(l)||(r=l,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(r))));var r}const Nd=Lh(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function ap(l){return Nd.test(String.fromCodePoint(l))}function Mc(l,r){return!(!r&&ap(l)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(l)))}function Fh(l){for(const r of l)if(ap(r.codePointAt(0)))return!0;return!1}const $a=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(l){this.pluginStatus=l.pluginStatus,this.pluginURL=l.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(l){if($a.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=l.applyArabicShaping,this.processBidirectionalText=l.processBidirectionalText,this.processStyledBidirectionalText=l.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(l,r){return o(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(l.pluginStatus!=="loading")return this.setState(l),l;const s=l.pluginURL,d=new Promise(_=>{this.loadScriptResolve=_});r(s);const g=new Promise(_=>setTimeout(()=>_(),this.TIMEOUT));if(yield Promise.race([d,g]),this.isParsed()){const _={pluginStatus:"loaded",pluginURL:s};return this.setState(_),_}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${s}`)})}};class Sn{constructor(r,s){this.isSupportedScript=Tu,this.zoom=r,s?(this.now=s.now||0,this.fadeDuration=s.fadeDuration||0,this.zoomHistory=s.zoomHistory||new Wn,this.transition=s.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Wn,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const r=this.zoom,s=r-Math.floor(r),d=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*d}:{fromScale:.5,toScale:1,t:1-(1-d)*s}}}function Tu(l){return function(r,s){for(const d of r)if(!Mc(d.codePointAt(0),s))return!1;return!0}(l,$a.getRTLTextPluginStatus()==="loaded")}const Mu="-transition";class Pc{constructor(r,s,d){this.property=r,this.value=s,this.expression=function(g,_,x){if(Ed(g))return new Ih(g,_);if(_c(g)){const C=Tl(g,_,x);if(C.result==="error")throw new Error(C.value.map(E=>`${E.key}: ${E.message}`).join(", "));return C.value}{let C=g;return _.type==="color"&&typeof g=="string"?C=Fr.parse(g):_.type!=="padding"||typeof g!="number"&&!Array.isArray(g)?_.type!=="numberArray"||typeof g!="number"&&!Array.isArray(g)?_.type!=="colorArray"||typeof g!="string"&&!Array.isArray(g)?_.type==="variableAnchorOffsetCollection"&&Array.isArray(g)?C=Do.parse(g):_.type==="projectionDefinition"&&typeof g=="string"&&(C=Qi.parse(g)):C=Sr.parse(g):C=_n.parse(g):C=Oi.parse(g),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>C}}}(s===void 0?r.specification.default:s,r.specification,d)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(r,s,d){return this.property.possiblyEvaluate(this,r,s,d)}}class Ec{constructor(r,s){this.property=r,this.value=new Pc(r,void 0,s)}transitioned(r,s){return new Vd(this.property,this.value,s,tt({},r.transition,this.transition),r.now)}untransitioned(){return new Vd(this.property,this.value,null,{},0)}}class Ol{constructor(r,s){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues),this._globalState=s}getValue(r){return ur(this._values[r].value.value)}setValue(r,s){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new Ec(this._values[r].property,this._globalState)),this._values[r].value=new Pc(this._values[r].property,s===null?void 0:ur(s),this._globalState)}getTransition(r){return ur(this._values[r].transition)}setTransition(r,s){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new Ec(this._values[r].property,this._globalState)),this._values[r].transition=ur(s)||void 0}serialize(){const r={};for(const s of Object.keys(this._values)){const d=this.getValue(s);d!==void 0&&(r[s]=d);const g=this.getTransition(s);g!==void 0&&(r[`${s}${Mu}`]=g)}return r}transitioned(r,s){const d=new Ud(this._properties);for(const g of Object.keys(this._values))d._values[g]=this._values[g].transitioned(r,s._values[g]);return d}untransitioned(){const r=new Ud(this._properties);for(const s of Object.keys(this._values))r._values[s]=this._values[s].untransitioned();return r}}class Vd{constructor(r,s,d,g,_){this.property=r,this.value=s,this.begin=_+g.delay||0,this.end=this.begin+g.duration||0,r.specification.transition&&(g.delay||g.duration)&&(this.prior=d)}possiblyEvaluate(r,s,d){const g=r.now||0,_=this.value.possiblyEvaluate(r,s,d),x=this.prior;if(x){if(g>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(g<this.begin)return x.possiblyEvaluate(r,s,d);{const C=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(r,s,d),_,ft(C))}}return _}}class Ud{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,s,d){const g=new sa(this._properties);for(const _ of Object.keys(this._values))g._values[_]=this._values[_].possiblyEvaluate(r,s,d);return g}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class Gd{constructor(r,s){this._properties=r,this._values=Object.create(r.defaultPropertyValues),this._globalState=s}hasValue(r){return this._values[r].value!==void 0}getValue(r){return ur(this._values[r].value)}setValue(r,s){this._values[r]=new Pc(this._values[r].property,s===null?void 0:ur(s),this._globalState)}serialize(){const r={};for(const s of Object.keys(this._values)){const d=this.getValue(s);d!==void 0&&(r[s]=d)}return r}possiblyEvaluate(r,s,d){const g=new sa(this._properties);for(const _ of Object.keys(this._values))g._values[_]=this._values[_].possiblyEvaluate(r,s,d);return g}}class as{constructor(r,s,d){this.property=r,this.value=s,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,s,d,g){return this.property.evaluate(this.value,this.parameters,r,s,d,g)}}class sa{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class Xt{constructor(r){this.specification=r}possiblyEvaluate(r,s){if(r.isDataDriven())throw new Error("Value should not be data driven");return r.expression.evaluate(s)}interpolate(r,s,d){const g=ti[this.specification.type];return g?g(r,s,d):r}}class cr{constructor(r,s){this.specification=r,this.overrides=s}possiblyEvaluate(r,s,d,g){return new as(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(s,null,{},d,g)}:r.expression,s)}interpolate(r,s,d){if(r.value.kind!=="constant"||s.value.kind!=="constant")return r;if(r.value.value===void 0||s.value.value===void 0)return new as(this,{kind:"constant",value:void 0},r.parameters);const g=ti[this.specification.type];if(g){const _=g(r.value.value,s.value.value,d);return new as(this,{kind:"constant",value:_},r.parameters)}return r}evaluate(r,s,d,g,_,x){return r.kind==="constant"?r.value:r.evaluate(s,d,g,_,x)}}class Ic extends cr{possiblyEvaluate(r,s,d,g){if(r.value===void 0)return new as(this,{kind:"constant",value:void 0},s);if(r.expression.kind==="constant"){const _=r.expression.evaluate(s,null,{},d,g),x=r.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,C=this._calculate(x,x,x,s);return new as(this,{kind:"constant",value:C},s)}if(r.expression.kind==="camera"){const _=this._calculate(r.expression.evaluate({zoom:s.zoom-1}),r.expression.evaluate({zoom:s.zoom}),r.expression.evaluate({zoom:s.zoom+1}),s);return new as(this,{kind:"constant",value:_},s)}return new as(this,r.expression,s)}evaluate(r,s,d,g,_,x){if(r.kind==="source"){const C=r.evaluate(s,d,g,_,x);return this._calculate(C,C,C,s)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(s.zoom)-1},d,g),r.evaluate({zoom:Math.floor(s.zoom)},d,g),r.evaluate({zoom:Math.floor(s.zoom)+1},d,g),s):r.value}_calculate(r,s,d,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:r,to:s}:{from:d,to:s}}interpolate(r){return r}}class Bh{constructor(r){this.specification=r}possiblyEvaluate(r,s,d,g){if(r.value!==void 0){if(r.expression.kind==="constant"){const _=r.expression.evaluate(s,null,{},d,g);return this._calculate(_,_,_,s)}return this._calculate(r.expression.evaluate(new Sn(Math.floor(s.zoom-1),s)),r.expression.evaluate(new Sn(Math.floor(s.zoom),s)),r.expression.evaluate(new Sn(Math.floor(s.zoom+1),s)),s)}}_calculate(r,s,d,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:r,to:s}:{from:d,to:s}}interpolate(r){return r}}class Ss{constructor(r){this.specification=r}possiblyEvaluate(r,s,d,g){return!!r.expression.evaluate(s,null,{},d,g)}interpolate(){return!1}}class Ti{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in r){const d=r[s];d.specification.overridable&&this.overridableProperties.push(s);const g=this.defaultPropertyValues[s]=new Pc(d,void 0,void 0),_=this.defaultTransitionablePropertyValues[s]=new Ec(d,void 0);this.defaultTransitioningPropertyValues[s]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=g.possiblyEvaluate({})}}}Ut("DataDrivenProperty",cr),Ut("DataConstantProperty",Xt),Ut("CrossFadedDataDrivenProperty",Ic),Ut("CrossFadedProperty",Bh),Ut("ColorRampProperty",Ss);class Zo extends tr{constructor(r,s,d){if(super(),this.id=r.id,this.type=r.type,this._globalState=d,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},this._visibilityExpression=function(g,_){return new _s(g,_)}(this.visibility,d),r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter,this._featureFilter=bc(r.filter,d)),s.layout&&(this._unevaluatedLayout=new Gd(s.layout,d)),s.paint)){this._transitionablePaint=new Ol(s.paint,d);for(const g in r.paint)this.setPaintProperty(g,r.paint[g],{validate:!1});for(const g in r.layout)this.setLayoutProperty(g,r.layout[g],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new sa(s.paint)}}setFilter(r){this.filter=r,this._featureFilter=bc(r,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}getLayoutAffectingGlobalStateRefs(){const r=new Set;for(const s of this._visibilityExpression.getGlobalStateRefs())r.add(s);if(this._unevaluatedLayout)for(const s in this._unevaluatedLayout._values){const d=this._unevaluatedLayout._values[s];for(const g of d.getGlobalStateRefs())r.add(g)}for(const s of this._featureFilter.getGlobalStateRefs())r.add(s);return r}getPaintAffectingGlobalStateRefs(){var r;const s=new globalThis.Map;if(this._transitionablePaint)for(const d in this._transitionablePaint._values){const g=this._transitionablePaint._values[d].value;for(const _ of g.getGlobalStateRefs()){const x=(r=s.get(_))!==null&&r!==void 0?r:[];x.push({name:d,value:g.value}),s.set(_,x)}}return s}getVisibilityAffectingGlobalStateRefs(){return this._visibilityExpression.getGlobalStateRefs()}setLayoutProperty(r,s,d={}){if(s==null||!this._validate(bs,`layers.${this.id}.layout.${r}`,r,s,d))return r==="visibility"?(this.visibility=s,this._visibilityExpression.setValue(s),void this.recalculateVisibility()):void this._unevaluatedLayout.setValue(r,s)}getPaintProperty(r){return r.endsWith(Mu)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,s,d={}){if(s!=null&&this._validate(xs,`layers.${this.id}.paint.${r}`,r,s,d))return!1;if(r.endsWith(Mu))return this._transitionablePaint.setTransition(r.slice(0,-11),s||void 0),!1;{const g=this._transitionablePaint._values[r],_=g.property.specification["property-type"]==="cross-faded-data-driven",x=g.value.isDataDriven(),C=g.value;this._transitionablePaint.setValue(r,s),this._handleSpecialPaintPropertyUpdate(r);const E=this._transitionablePaint._values[r].value;return E.isDataDriven()||x||_||this._handleOverridablePaintPropertyUpdate(r,C,E)}}_handleSpecialPaintPropertyUpdate(r){}_handleOverridablePaintPropertyUpdate(r,s,d){return!1}isHidden(r=this.minzoom,s=!1){return!!(this.minzoom&&r<(s?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&r>=this.maxzoom)||this._evaluatedVisibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculateVisibility(){this._evaluatedVisibility=this._visibilityExpression.evaluate()}recalculate(r,s){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,s)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),mr(r,(s,d)=>!(s===void 0||d==="layout"&&!Object.keys(s).length||d==="paint"&&!Object.keys(s).length))}_validate(r,s,d,g,_={}){return(!_||_.validate!==!1)&&ws(this,r.call(mi,{key:s,layerType:this.type,objectKey:d,value:g,styleSpec:Ze,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const s=this.paint.get(r);if(s instanceof as&&ss(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}}let qd;var aa={get paint(){return qd=qd||new Ti({"raster-opacity":new Xt(Ze.paint_raster["raster-opacity"]),"raster-hue-rotate":new Xt(Ze.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Xt(Ze.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Xt(Ze.paint_raster["raster-brightness-max"]),"raster-saturation":new Xt(Ze.paint_raster["raster-saturation"]),"raster-contrast":new Xt(Ze.paint_raster["raster-contrast"]),"raster-resampling":new Xt(Ze.paint_raster["raster-resampling"]),"raster-fade-duration":new Xt(Ze.paint_raster["raster-fade-duration"])})}};class Ll extends Zo{constructor(r,s){super(r,aa,s)}}const Hd={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Pu{constructor(r,s){this._structArray=r,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ln{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,s){return r._trim(),s&&(r.isTransferred=!0,s.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const s=Object.create(this.prototype);return s.arrayBuffer=r.arrayBuffer,s.length=r.length,s.capacity=r.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function gi(l,r=1){let s=0,d=0;return{members:l.map(g=>{const _=Hd[g.type].BYTES_PER_ELEMENT,x=s=Us(s,Math.max(r,_)),C=g.components||1;return d=Math.max(d,_),s+=_*C,{name:g.name,type:g.type,components:C,offset:x}}),size:Us(s,Math.max(d,r)),alignment:r}}function Us(l,r){return Math.ceil(l/r)*r}class Xo extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s){const d=this.length;return this.resize(d+1),this.emplace(d,r,s)}emplace(r,s,d){const g=2*r;return this.int16[g+0]=s,this.int16[g+1]=d,r}}Xo.prototype.bytesPerElement=4,Ut("StructArrayLayout2i4",Xo);class Fl extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,d){const g=this.length;return this.resize(g+1),this.emplace(g,r,s,d)}emplace(r,s,d,g){const _=3*r;return this.int16[_+0]=s,this.int16[_+1]=d,this.int16[_+2]=g,r}}Fl.prototype.bytesPerElement=6,Ut("StructArrayLayout3i6",Fl);class kc extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,d,g){const _=this.length;return this.resize(_+1),this.emplace(_,r,s,d,g)}emplace(r,s,d,g,_){const x=4*r;return this.int16[x+0]=s,this.int16[x+1]=d,this.int16[x+2]=g,this.int16[x+3]=_,r}}kc.prototype.bytesPerElement=8,Ut("StructArrayLayout4i8",kc);class la extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,d,g,_,x){const C=this.length;return this.resize(C+1),this.emplace(C,r,s,d,g,_,x)}emplace(r,s,d,g,_,x,C){const E=6*r;return this.int16[E+0]=s,this.int16[E+1]=d,this.int16[E+2]=g,this.int16[E+3]=_,this.int16[E+4]=x,this.int16[E+5]=C,r}}la.prototype.bytesPerElement=12,Ut("StructArrayLayout2i4i12",la);class $h extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,d,g,_,x){const C=this.length;return this.resize(C+1),this.emplace(C,r,s,d,g,_,x)}emplace(r,s,d,g,_,x,C){const E=4*r,R=8*r;return this.int16[E+0]=s,this.int16[E+1]=d,this.uint8[R+4]=g,this.uint8[R+5]=_,this.uint8[R+6]=x,this.uint8[R+7]=C,r}}$h.prototype.bytesPerElement=8,Ut("StructArrayLayout2i4ub8",$h);class ca extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s){const d=this.length;return this.resize(d+1),this.emplace(d,r,s)}emplace(r,s,d){const g=2*r;return this.float32[g+0]=s,this.float32[g+1]=d,r}}ca.prototype.bytesPerElement=8,Ut("StructArrayLayout2f8",ca);class ua extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,d,g,_,x,C,E,R,L){const V=this.length;return this.resize(V+1),this.emplace(V,r,s,d,g,_,x,C,E,R,L)}emplace(r,s,d,g,_,x,C,E,R,L,V){const H=10*r;return this.uint16[H+0]=s,this.uint16[H+1]=d,this.uint16[H+2]=g,this.uint16[H+3]=_,this.uint16[H+4]=x,this.uint16[H+5]=C,this.uint16[H+6]=E,this.uint16[H+7]=R,this.uint16[H+8]=L,this.uint16[H+9]=V,r}}ua.prototype.bytesPerElement=20,Ut("StructArrayLayout10ui20",ua);class Eu extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,d,g,_,x,C,E){const R=this.length;return this.resize(R+1),this.emplace(R,r,s,d,g,_,x,C,E)}emplace(r,s,d,g,_,x,C,E,R){const L=8*r;return this.uint16[L+0]=s,this.uint16[L+1]=d,this.uint16[L+2]=g,this.uint16[L+3]=_,this.uint16[L+4]=x,this.uint16[L+5]=C,this.uint16[L+6]=E,this.uint16[L+7]=R,r}}Eu.prototype.bytesPerElement=16,Ut("StructArrayLayout8ui16",Eu);class Fn extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,d,g,_,x,C,E,R,L,V,H){const Z=this.length;return this.resize(Z+1),this.emplace(Z,r,s,d,g,_,x,C,E,R,L,V,H)}emplace(r,s,d,g,_,x,C,E,R,L,V,H,Z){const J=12*r;return this.int16[J+0]=s,this.int16[J+1]=d,this.int16[J+2]=g,this.int16[J+3]=_,this.uint16[J+4]=x,this.uint16[J+5]=C,this.uint16[J+6]=E,this.uint16[J+7]=R,this.int16[J+8]=L,this.int16[J+9]=V,this.int16[J+10]=H,this.int16[J+11]=Z,r}}Fn.prototype.bytesPerElement=24,Ut("StructArrayLayout4i4ui4i24",Fn);class Ac extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,d){const g=this.length;return this.resize(g+1),this.emplace(g,r,s,d)}emplace(r,s,d,g){const _=3*r;return this.float32[_+0]=s,this.float32[_+1]=d,this.float32[_+2]=g,r}}Ac.prototype.bytesPerElement=12,Ut("StructArrayLayout3f12",Ac);class Rc extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint32[1*r+0]=s,r}}Rc.prototype.bytesPerElement=4,Ut("StructArrayLayout1ul4",Rc);class jh extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,d,g,_,x,C,E,R){const L=this.length;return this.resize(L+1),this.emplace(L,r,s,d,g,_,x,C,E,R)}emplace(r,s,d,g,_,x,C,E,R,L){const V=10*r,H=5*r;return this.int16[V+0]=s,this.int16[V+1]=d,this.int16[V+2]=g,this.int16[V+3]=_,this.int16[V+4]=x,this.int16[V+5]=C,this.uint32[H+3]=E,this.uint16[V+8]=R,this.uint16[V+9]=L,r}}jh.prototype.bytesPerElement=20,Ut("StructArrayLayout6i1ul2ui20",jh);class ja extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,d,g,_,x){const C=this.length;return this.resize(C+1),this.emplace(C,r,s,d,g,_,x)}emplace(r,s,d,g,_,x,C){const E=6*r;return this.int16[E+0]=s,this.int16[E+1]=d,this.int16[E+2]=g,this.int16[E+3]=_,this.int16[E+4]=x,this.int16[E+5]=C,r}}ja.prototype.bytesPerElement=12,Ut("StructArrayLayout2i2i2i12",ja);class Na extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,d,g,_){const x=this.length;return this.resize(x+1),this.emplace(x,r,s,d,g,_)}emplace(r,s,d,g,_,x){const C=4*r,E=8*r;return this.float32[C+0]=s,this.float32[C+1]=d,this.float32[C+2]=g,this.int16[E+6]=_,this.int16[E+7]=x,r}}Na.prototype.bytesPerElement=16,Ut("StructArrayLayout2f1f2i16",Na);class Va extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,d,g,_,x){const C=this.length;return this.resize(C+1),this.emplace(C,r,s,d,g,_,x)}emplace(r,s,d,g,_,x,C){const E=16*r,R=4*r,L=8*r;return this.uint8[E+0]=s,this.uint8[E+1]=d,this.float32[R+1]=g,this.float32[R+2]=_,this.int16[L+6]=x,this.int16[L+7]=C,r}}Va.prototype.bytesPerElement=16,Ut("StructArrayLayout2ub2f2i16",Va);class Bn extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,d){const g=this.length;return this.resize(g+1),this.emplace(g,r,s,d)}emplace(r,s,d,g){const _=3*r;return this.uint16[_+0]=s,this.uint16[_+1]=d,this.uint16[_+2]=g,r}}Bn.prototype.bytesPerElement=6,Ut("StructArrayLayout3ui6",Bn);class ni extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,d,g,_,x,C,E,R,L,V,H,Z,J,ee,ne,fe){const Te=this.length;return this.resize(Te+1),this.emplace(Te,r,s,d,g,_,x,C,E,R,L,V,H,Z,J,ee,ne,fe)}emplace(r,s,d,g,_,x,C,E,R,L,V,H,Z,J,ee,ne,fe,Te){const pe=24*r,me=12*r,Ie=48*r;return this.int16[pe+0]=s,this.int16[pe+1]=d,this.uint16[pe+2]=g,this.uint16[pe+3]=_,this.uint32[me+2]=x,this.uint32[me+3]=C,this.uint32[me+4]=E,this.uint16[pe+10]=R,this.uint16[pe+11]=L,this.uint16[pe+12]=V,this.float32[me+7]=H,this.float32[me+8]=Z,this.uint8[Ie+36]=J,this.uint8[Ie+37]=ee,this.uint8[Ie+38]=ne,this.uint32[me+10]=fe,this.int16[pe+22]=Te,r}}ni.prototype.bytesPerElement=48,Ut("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ni);class Bi extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,d,g,_,x,C,E,R,L,V,H,Z,J,ee,ne,fe,Te,pe,me,Ie,Fe,nt,bt,mt,Pt,Bt,kt){const vt=this.length;return this.resize(vt+1),this.emplace(vt,r,s,d,g,_,x,C,E,R,L,V,H,Z,J,ee,ne,fe,Te,pe,me,Ie,Fe,nt,bt,mt,Pt,Bt,kt)}emplace(r,s,d,g,_,x,C,E,R,L,V,H,Z,J,ee,ne,fe,Te,pe,me,Ie,Fe,nt,bt,mt,Pt,Bt,kt,vt){const ht=32*r,Kt=16*r;return this.int16[ht+0]=s,this.int16[ht+1]=d,this.int16[ht+2]=g,this.int16[ht+3]=_,this.int16[ht+4]=x,this.int16[ht+5]=C,this.int16[ht+6]=E,this.int16[ht+7]=R,this.uint16[ht+8]=L,this.uint16[ht+9]=V,this.uint16[ht+10]=H,this.uint16[ht+11]=Z,this.uint16[ht+12]=J,this.uint16[ht+13]=ee,this.uint16[ht+14]=ne,this.uint16[ht+15]=fe,this.uint16[ht+16]=Te,this.uint16[ht+17]=pe,this.uint16[ht+18]=me,this.uint16[ht+19]=Ie,this.uint16[ht+20]=Fe,this.uint16[ht+21]=nt,this.uint16[ht+22]=bt,this.uint32[Kt+12]=mt,this.float32[Kt+13]=Pt,this.float32[Kt+14]=Bt,this.uint16[ht+30]=kt,this.uint16[ht+31]=vt,r}}Bi.prototype.bytesPerElement=64,Ut("StructArrayLayout8i15ui1ul2f2ui64",Bi);class Dc extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.float32[1*r+0]=s,r}}Dc.prototype.bytesPerElement=4,Ut("StructArrayLayout1f4",Dc);class Bl extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,d){const g=this.length;return this.resize(g+1),this.emplace(g,r,s,d)}emplace(r,s,d,g){const _=3*r;return this.uint16[6*r+0]=s,this.float32[_+1]=d,this.float32[_+2]=g,r}}Bl.prototype.bytesPerElement=12,Ut("StructArrayLayout1ui2f12",Bl);class zc extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,d){const g=this.length;return this.resize(g+1),this.emplace(g,r,s,d)}emplace(r,s,d,g){const _=4*r;return this.uint32[2*r+0]=s,this.uint16[_+2]=d,this.uint16[_+3]=g,r}}zc.prototype.bytesPerElement=8,Ut("StructArrayLayout1ul2ui8",zc);class w extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s){const d=this.length;return this.resize(d+1),this.emplace(d,r,s)}emplace(r,s,d){const g=2*r;return this.uint16[g+0]=s,this.uint16[g+1]=d,r}}w.prototype.bytesPerElement=4,Ut("StructArrayLayout2ui4",w);class n extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint16[1*r+0]=s,r}}n.prototype.bytesPerElement=2,Ut("StructArrayLayout1ui2",n);class u extends Ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,d,g){const _=this.length;return this.resize(_+1),this.emplace(_,r,s,d,g)}emplace(r,s,d,g,_){const x=4*r;return this.float32[x+0]=s,this.float32[x+1]=d,this.float32[x+2]=g,this.float32[x+3]=_,r}}u.prototype.bytesPerElement=16,Ut("StructArrayLayout4f16",u);class m extends Pu{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new b(this.anchorPointX,this.anchorPointY)}}m.prototype.size=20;class v extends jh{get(r){return new m(this,r)}}Ut("CollisionBoxArray",v);class S extends Pu{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(r){this._structArray.uint8[this._pos1+37]=r}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(r){this._structArray.uint8[this._pos1+38]=r}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(r){this._structArray.uint32[this._pos4+10]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}S.prototype.size=48;class M extends ni{get(r){return new S(this,r)}}Ut("PlacedSymbolArray",M);class k extends Pu{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(r){this._structArray.uint32[this._pos4+12]=r}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}k.prototype.size=64;class O extends Bi{get(r){return new k(this,r)}}Ut("SymbolInstanceArray",O);class B extends Dc{getoffsetX(r){return this.float32[1*r+0]}}Ut("GlyphOffsetArray",B);class q extends Fl{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}Ut("SymbolLineVertexArray",q);class Y extends Pu{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Y.prototype.size=12;class X extends Bl{get(r){return new Y(this,r)}}Ut("TextAnchorOffsetArray",X);class te extends Pu{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}te.prototype.size=8;class ce extends zc{get(r){return new te(this,r)}}Ut("FeatureIndexArray",ce);class ge extends Xo{}class _e extends Xo{}class ve extends Xo{}class Se extends la{}class Oe extends $h{}class Ce extends ca{}class De extends ua{}class Be extends Eu{}class Ae extends Fn{}class Ue extends Ac{}class ut extends Rc{}class it extends ja{}class st extends Va{}class at extends Bn{}class Rt extends w{}const Dt=gi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Tt}=Dt;class Nt{constructor(r=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=r}prepareSegment(r,s,d,g){const _=this.segments[this.segments.length-1];return r>Nt.MAX_VERTEX_ARRAY_LENGTH&&wr(`Max vertices per segment is ${Nt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Nt.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!_||_.vertexLength+r>Nt.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==g?this.createNewSegment(s,d,g):_}createNewSegment(r,s,d){const g={vertexOffset:r.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0,vaos:{}};return d!==void 0&&(g.sortKey=d),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(g),g}getOrCreateLatestSegment(r,s,d){return this.prepareSegment(0,r,s,d)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const r of this.segments)for(const s in r.vaos)r.vaos[s].destroy()}static simpleSegment(r,s,d,g){return new Nt([{vertexOffset:r,primitiveOffset:s,vertexLength:d,primitiveLength:g,vaos:{},sortKey:0}])}}function kr(l,r){return 256*(l=_t(Math.floor(l),0,255))+_t(Math.floor(r),0,255)}Nt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ut("SegmentVector",Nt);const xn=gi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Zn=gi([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var Pn,Xn,En,Kn={exports:{}},ii={exports:{}},no={exports:{}},ki=function(){if(En)return Kn.exports;En=1;var l=(Pn||(Pn=1,ii.exports=function(s,d){var g,_,x,C,E,R,L,V;for(_=s.length-(g=3&s.length),x=d,E=3432918353,R=461845907,V=0;V<_;)L=255&s.charCodeAt(V)|(255&s.charCodeAt(++V))<<8|(255&s.charCodeAt(++V))<<16|(255&s.charCodeAt(++V))<<24,++V,x=27492+(65535&(C=5*(65535&(x=(x^=L=(65535&(L=(L=(65535&L)*E+(((L>>>16)*E&65535)<<16)&4294967295)<<15|L>>>17))*R+(((L>>>16)*R&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(L=0,g){case 3:L^=(255&s.charCodeAt(V+2))<<16;case 2:L^=(255&s.charCodeAt(V+1))<<8;case 1:x^=L=(65535&(L=(L=(65535&(L^=255&s.charCodeAt(V)))*E+(((L>>>16)*E&65535)<<16)&4294967295)<<15|L>>>17))*R+(((L>>>16)*R&65535)<<16)&4294967295}return x^=s.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}),ii.exports),r=(Xn||(Xn=1,no.exports=function(s,d){for(var g,_=s.length,x=d^_,C=0;_>=4;)g=1540483477*(65535&(g=255&s.charCodeAt(C)|(255&s.charCodeAt(++C))<<8|(255&s.charCodeAt(++C))<<16|(255&s.charCodeAt(++C))<<24))+((1540483477*(g>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),_-=4,++C;switch(_){case 3:x^=(255&s.charCodeAt(C+2))<<16;case 2:x^=(255&s.charCodeAt(C+1))<<8;case 1:x=1540483477*(65535&(x^=255&s.charCodeAt(C)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}),no.exports);return Kn.exports=l,Kn.exports.murmur3=l,Kn.exports.murmur2=r,Kn.exports}(),yn=P(ki);class Hi{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,s,d,g){this.ids.push(Gs(r)),this.positions.push(s,d,g)}getPositions(r){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const s=Gs(r);let d=0,g=this.ids.length-1;for(;d<g;){const x=d+g>>1;this.ids[x]>=s?g=x:d=x+1}const _=[];for(;this.ids[d]===s;)_.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return _}static serialize(r,s){const d=new Float64Array(r.ids),g=new Uint32Array(r.positions);return ha(d,g,0,d.length-1),s&&s.push(d.buffer,g.buffer),{ids:d,positions:g}}static deserialize(r){const s=new Hi;return s.ids=r.ids,s.positions=r.positions,s.indexed=!0,s}}function Gs(l){const r=+l;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:yn(String(l))}function ha(l,r,s,d){for(;s<d;){const g=l[s+d>>1];let _=s-1,x=d+1;for(;;){do _++;while(l[_]<g);do x--;while(l[x]>g);if(_>=x)break;qs(l,_,x),qs(r,3*_,3*x),qs(r,3*_+1,3*x+1),qs(r,3*_+2,3*x+2)}x-s<d-x?(ha(l,r,s,x),s=x+1):(ha(l,r,x+1,d),d=x)}}function qs(l,r,s){const d=l[r];l[r]=l[s],l[s]=d}Ut("FeaturePositionMap",Hi);class Fo{constructor(r,s){this.gl=r.gl,this.location=s}}class Ua extends Fo{constructor(r,s){super(r,s),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class da extends Fo{constructor(r,s){super(r,s),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class Ga extends Fo{constructor(r,s){super(r,s),this.current=Fr.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const Ko=new Float32Array(16);function fa(l){return[kr(255*l.r,255*l.g),kr(255*l.b,255*l.a)]}class Cs{constructor(r,s,d){this.value=r,this.uniformNames=s.map(g=>`u_${g}`),this.type=d}setUniform(r,s,d){r.set(d.constantOr(this.value))}getBinding(r,s,d){return this.type==="color"?new Ga(r,s):new Ua(r,s)}}class Ts{constructor(r,s){this.uniformNames=s.map(d=>`u_${d}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,s){this.pixelRatioFrom=s.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=s.tlbr,this.patternTo=r.tlbr}setConstantDashPositions(r,s){this.dashTo=[0,r.y,r.height,r.width],this.dashFrom=[0,s.y,s.height,s.width]}setUniform(r,s,d,g){let _=null;g==="u_pattern_to"?_=this.patternTo:g==="u_pattern_from"?_=this.patternFrom:g==="u_dasharray_to"?_=this.dashTo:g==="u_dasharray_from"?_=this.dashFrom:g==="u_pixel_ratio_to"?_=this.pixelRatioTo:g==="u_pixel_ratio_from"&&(_=this.pixelRatioFrom),_!==null&&r.set(_)}getBinding(r,s,d){return d.substr(0,9)==="u_pattern"||d.substr(0,12)==="u_dasharray_"?new da(r,s):new Ua(r,s)}}class Rn{constructor(r,s,d,g){this.expression=r,this.type=d,this.maxValue=0,this.paintVertexAttributes=s.map(_=>({name:`a_${_}`,type:"Float32",components:d==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(r,s,d){const g=this.paintVertexArray.length,_=this.expression.evaluate(new Sn(0,d),s,{},d.canonical,[],d.formattedSection);this.paintVertexArray.resize(r),this._setPaintValue(g,r,_)}updatePaintArray(r,s,d,g,_){const x=this.expression.evaluate(new Sn(0,_),d,g);this._setPaintValue(r,s,x)}_setPaintValue(r,s,d){if(this.type==="color"){const g=fa(d);for(let _=r;_<s;_++)this.paintVertexArray.emplace(_,g[0],g[1])}else{for(let g=r;g<s;g++)this.paintVertexArray.emplace(g,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class In{constructor(r,s,d,g,_,x){this.expression=r,this.uniformNames=s.map(C=>`u_${C}_t`),this.type=d,this.useIntegerZoom=g,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=s.map(C=>({name:`a_${C}`,type:"Float32",components:d==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(r,s,d){const g=this.expression.evaluate(new Sn(this.zoom,d),s,{},d.canonical,[],d.formattedSection),_=this.expression.evaluate(new Sn(this.zoom+1,d),s,{},d.canonical,[],d.formattedSection),x=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(x,r,g,_)}updatePaintArray(r,s,d,g,_){const x=this.expression.evaluate(new Sn(this.zoom,_),d,g),C=this.expression.evaluate(new Sn(this.zoom+1,_),d,g);this._setPaintValue(r,s,x,C)}_setPaintValue(r,s,d,g){if(this.type==="color"){const _=fa(d),x=fa(g);for(let C=r;C<s;C++)this.paintVertexArray.emplace(C,_[0],_[1],x[0],x[1])}else{for(let _=r;_<s;_++)this.paintVertexArray.emplace(_,d,g);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(g))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,s){const d=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,g=_t(this.expression.interpolationFactor(d,this.zoom,this.zoom+1),0,1);r.set(g)}getBinding(r,s,d){return new Ua(r,s)}}class $i{constructor(r,s,d,g,_,x){this.expression=r,this.type=s,this.useIntegerZoom=d,this.zoom=g,this.layerId=x,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(r,s,d){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(g,r,this.getPositionIds(s),d)}updatePaintArray(r,s,d,g,_){this._setPaintValues(r,s,this.getPositionIds(d),_)}_setPaintValues(r,s,d,g){const _=this.getPositions(g);if(!_||!d)return;const x=_[d.min],C=_[d.mid],E=_[d.max];if(x&&C&&E)for(let R=r;R<s;R++)this.emplace(this.zoomInPaintVertexArray,R,C,x),this.emplace(this.zoomOutPaintVertexArray,R,C,E)}upload(r){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const s=this.getVertexAttributes();this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,s,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,s,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Wi extends $i{getPositions(r){return r.imagePositions}getPositionIds(r){return r.patterns&&r.patterns[this.layerId]}getVertexAttributes(){return xn.members}emplace(r,s,d,g){r.emplace(s,d.tlbr[0],d.tlbr[1],d.tlbr[2],d.tlbr[3],g.tlbr[0],g.tlbr[1],g.tlbr[2],g.tlbr[3],d.pixelRatio,g.pixelRatio)}}class Bo extends $i{getPositions(r){return r.dashPositions}getPositionIds(r){return r.dashes&&r.dashes[this.layerId]}getVertexAttributes(){return Zn.members}emplace(r,s,d,g){r.emplace(s,0,d.y,d.height,d.width,0,g.y,g.height,g.width)}}class Co{constructor(r,s,d){this.binders={},this._buffers=[];const g=[];for(const _ in r.paint._values){if(!d(_))continue;const x=r.paint.get(_);if(!(x instanceof as&&ss(x.property.specification)))continue;const C=Tm(_,r.type),E=x.value,R=x.property.specification.type,L=x.property.useIntegerZoom,V=x.property.specification["property-type"],H=V==="cross-faded"||V==="cross-faded-data-driven";if(E.kind==="constant")this.binders[_]=H?new Ts(E.value,C):new Cs(E.value,C,R),g.push(`/u_${_}`);else if(E.kind==="source"||H){const Z=lp(_,R,"source");this.binders[_]=H?_==="line-dasharray"?new Bo(E,R,L,s,Z,r.id):new Wi(E,R,L,s,Z,r.id):new Rn(E,C,R,Z),g.push(`/a_${_}`)}else{const Z=lp(_,R,"composite");this.binders[_]=new In(E,C,R,L,s,Z),g.push(`/z_${_}`)}}this.cacheKey=g.sort().join("")}getMaxValue(r){const s=this.binders[r];return s instanceof Rn||s instanceof In?s.maxValue:0}populatePaintArrays(r,s,d){for(const g in this.binders){const _=this.binders[g];(_ instanceof Rn||_ instanceof In||_ instanceof $i)&&_.populatePaintArray(r,s,d)}}setConstantPatternPositions(r,s){for(const d in this.binders){const g=this.binders[d];g instanceof Ts&&g.setConstantPatternPositions(r,s)}}setConstantDashPositions(r,s){for(const d in this.binders){const g=this.binders[d];g instanceof Ts&&g.setConstantDashPositions(r,s)}}updatePaintArrays(r,s,d,g,_){let x=!1;for(const C in r){const E=s.getPositions(C);for(const R of E){const L=d.feature(R.index);for(const V in this.binders){const H=this.binders[V];if((H instanceof Rn||H instanceof In||H instanceof $i)&&H.expression.isStateDependent===!0){const Z=g.paint.get(V);H.expression=Z.value,H.updatePaintArray(R.start,R.end,L,r[C],_),x=!0}}}}return x}defines(){const r=[];for(const s in this.binders){const d=this.binders[s];(d instanceof Cs||d instanceof Ts)&&r.push(...d.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return r}getBinderAttributes(){const r=[];for(const s in this.binders){const d=this.binders[s];if(d instanceof Rn||d instanceof In)for(let g=0;g<d.paintVertexAttributes.length;g++)r.push(d.paintVertexAttributes[g].name);else if(d instanceof $i){const g=d.getVertexAttributes();for(const _ of g)r.push(_.name)}}return r}getBinderUniforms(){const r=[];for(const s in this.binders){const d=this.binders[s];if(d instanceof Cs||d instanceof Ts||d instanceof In)for(const g of d.uniformNames)r.push(g)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,s){const d=[];for(const g in this.binders){const _=this.binders[g];if(_ instanceof Cs||_ instanceof Ts||_ instanceof In){for(const x of _.uniformNames)if(s[x]){const C=_.getBinding(r,s[x],x);d.push({name:x,property:g,binding:C})}}}return d}setUniforms(r,s,d,g){for(const{name:_,property:x,binding:C}of s)this.binders[x].setUniform(C,g,d.get(x),_)}updatePaintBuffers(r){this._buffers=[];for(const s in this.binders){const d=this.binders[s];if(r&&d instanceof $i){const g=r.fromScale===2?d.zoomInPaintVertexBuffer:d.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(d instanceof Rn||d instanceof In)&&d.paintVertexBuffer&&this._buffers.push(d.paintVertexBuffer)}}upload(r){for(const s in this.binders){const d=this.binders[s];(d instanceof Rn||d instanceof In||d instanceof $i)&&d.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const s=this.binders[r];(s instanceof Rn||s instanceof In||s instanceof $i)&&s.destroy()}}}class $l{constructor(r,s,d=()=>!0){this.programConfigurations={};for(const g of r)this.programConfigurations[g.id]=new Co(g,s,d);this.needsUpload=!1,this._featureMap=new Hi,this._bufferOffset=0}populatePaintArrays(r,s,d,g){for(const _ in this.programConfigurations)this.programConfigurations[_].populatePaintArrays(r,s,g);s.id!==void 0&&this._featureMap.add(s.id,d,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,s,d,g){for(const _ of d)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(r,this._featureMap,s,_,g)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}function Tm(l,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[l]||[l.replace(`${r}-`,"").replace(/-/g,"_")]}function lp(l,r,s){const d={color:{source:ca,composite:u},number:{source:Dc,composite:ca}},g=function(_){return{"line-pattern":{source:De,composite:De},"fill-pattern":{source:De,composite:De},"fill-extrusion-pattern":{source:De,composite:De},"line-dasharray":{source:Be,composite:Be}}[_]}(l);return g&&g[s]||d[r][s]}Ut("ConstantBinder",Cs),Ut("CrossFadedConstantBinder",Ts),Ut("SourceExpressionBinder",Rn),Ut("CrossFadedPatternBinder",Wi),Ut("CrossFadedDasharrayBinder",Bo),Ut("CompositeExpressionBinder",In),Ut("ProgramConfiguration",Co,{omit:["_buffers"]}),Ut("ProgramConfigurationSet",$l);const Wd=Math.pow(2,14)-1,qa=-Wd-1;function pa(l){const r=je/l.extent,s=l.loadGeometry();for(let d=0;d<s.length;d++){const g=s[d];for(let _=0;_<g.length;_++){const x=g[_],C=Math.round(x.x*r),E=Math.round(x.y*r);x.x=_t(C,qa,Wd),x.y=_t(E,qa,Wd),(C<x.x||C>x.x+1||E<x.y||E>x.y+1)&&wr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return s}function Ha(l,r){return{type:l.type,id:l.id,properties:l.properties,geometry:r?pa(l):[]}}const Nh=-32768;function Zd(l,r,s,d,g){l.emplaceBack(Nh+8*r+d,Nh+8*s+g)}class Vh{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasDependencies=!1,this.layoutVertexArray=new _e,this.indexArray=new at,this.segments=new Nt,this.programConfigurations=new $l(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,d){const g=this.layers[0],_=[];let x=null,C=!1,E=g.type==="heatmap";if(g.type==="circle"){const L=g;x=L.layout.get("circle-sort-key"),C=!x.isConstant(),E=E||L.paint.get("circle-pitch-alignment")==="map"}const R=E?s.subdivisionGranularity.circle:1;for(const{feature:L,id:V,index:H,sourceLayerIndex:Z}of r){const J=this.layers[0]._featureFilter.needGeometry,ee=Ha(L,J);if(!this.layers[0]._featureFilter.filter(new Sn(this.zoom),ee,d))continue;const ne=C?x.evaluate(ee,{},d):void 0,fe={id:V,properties:L.properties,type:L.type,sourceLayerIndex:Z,index:H,geometry:J?ee.geometry:pa(L),patterns:{},sortKey:ne};_.push(fe)}C&&_.sort((L,V)=>L.sortKey-V.sortKey);for(const L of _){const{geometry:V,index:H,sourceLayerIndex:Z}=L,J=r[H].feature;this.addFeature(L,V,H,d,R),s.featureIndex.insert(J,V,H,Z,this.index)}}update(r,s,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,{imagePositions:d})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Tt),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,s,d,g,_=1){let x;switch(_){case 1:x=[0,7];break;case 3:x=[0,2,5,7];break;case 5:x=[0,1,3,4,6,7];break;case 7:x=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${_}; valid values are 1, 3, 5, 7.`)}const C=x.length;for(const E of s)for(const R of E){const L=R.x,V=R.y;if(L<0||L>=je||V<0||V>=je)continue;const H=this.segments.prepareSegment(C*C,this.layoutVertexArray,this.indexArray,r.sortKey),Z=H.vertexLength;for(let J=0;J<C;J++)for(let ee=0;ee<C;ee++)Zd(this.layoutVertexArray,L,V,x[ee],x[J]);for(let J=0;J<C-1;J++)for(let ee=0;ee<C-1;ee++){const ne=Z+J*C+ee,fe=Z+(J+1)*C+ee;this.indexArray.emplaceBack(ne,fe+1,ne+1),this.indexArray.emplaceBack(ne,fe,fe+1)}H.vertexLength+=C*C,H.primitiveLength+=(C-1)*(C-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,d,{imagePositions:{},canonical:g})}}function Iu(l,r){for(let s=0;s<l.length;s++)if(Oc(r,l[s]))return!0;for(let s=0;s<r.length;s++)if(Oc(l,r[s]))return!0;return!!Kd(l,r)}function Xd(l,r,s){return!!Oc(l,r)||!!Mm(r,l,s)}function ay(l,r){if(l.length===1)return cy(r,l[0]);for(let s=0;s<r.length;s++){const d=r[s];for(let g=0;g<d.length;g++)if(Oc(l,d[g]))return!0}for(let s=0;s<l.length;s++)if(cy(r,l[s]))return!0;for(let s=0;s<r.length;s++)if(Kd(l,r[s]))return!0;return!1}function ly(l,r,s){if(l.length>1){if(Kd(l,r))return!0;for(let d=0;d<r.length;d++)if(Mm(r[d],l,s))return!0}for(let d=0;d<l.length;d++)if(Mm(l[d],r,s))return!0;return!1}function Kd(l,r){if(l.length===0||r.length===0)return!1;for(let s=0;s<l.length-1;s++){const d=l[s],g=l[s+1];for(let _=0;_<r.length-1;_++)if(S1(d,g,r[_],r[_+1]))return!0}return!1}function S1(l,r,s,d){return sr(l,s,d)!==sr(r,s,d)&&sr(l,r,s)!==sr(l,r,d)}function Mm(l,r,s){const d=s*s;if(r.length===1)return l.distSqr(r[0])<d;for(let g=1;g<r.length;g++)if(Pm(l,r[g-1],r[g])<d)return!0;return!1}function Pm(l,r,s){const d=r.distSqr(s);if(d===0)return l.distSqr(r);const g=((l.x-r.x)*(s.x-r.x)+(l.y-r.y)*(s.y-r.y))/d;return l.distSqr(g<0?r:g>1?s:s.sub(r)._mult(g)._add(r))}function cy(l,r){let s,d,g,_=!1;for(let x=0;x<l.length;x++){s=l[x];for(let C=0,E=s.length-1;C<s.length;E=C++)d=s[C],g=s[E],d.y>r.y!=g.y>r.y&&r.x<(g.x-d.x)*(r.y-d.y)/(g.y-d.y)+d.x&&(_=!_)}return _}function Oc(l,r){let s=!1;for(let d=0,g=l.length-1;d<l.length;g=d++){const _=l[d],x=l[g];_.y>r.y!=x.y>r.y&&r.x<(x.x-_.x)*(r.y-_.y)/(x.y-_.y)+_.x&&(s=!s)}return s}function Lc(l,r,s){const d=s[0],g=s[2];if(l.x<d.x&&r.x<d.x||l.x>g.x&&r.x>g.x||l.y<d.y&&r.y<d.y||l.y>g.y&&r.y>g.y)return!1;const _=sr(l,r,s[0]);return _!==sr(l,r,s[1])||_!==sr(l,r,s[2])||_!==sr(l,r,s[3])}function Yd(l,r,s){const d=r.paint.get(l).value;return d.kind==="constant"?d.value:s.programConfigurations.get(r.id).getMaxValue(l)}function cp(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function Jd(l,r,s,d,g){if(!r[0]&&!r[1])return l;const _=b.convert(r)._mult(g);s==="viewport"&&_._rotate(-d);const x=[];for(let C=0;C<l.length;C++)x.push(l[C].sub(_));return x}function y0(l){const r=[];for(let s=0;s<l.length;s++){const d=l[s],g=r.at(-1);(s===0||g&&!d.equals(g))&&r.push(d)}return r}function v0({queryGeometry:l,size:r},s){return Xd(l,s,r)}function up({queryGeometry:l,size:r,transform:s,unwrappedTileID:d,getElevation:g},_){return Xd(l,_,r*(s.projectTileCoordinates(_.x,_.y,d,g).signedDistanceFromCamera/s.cameraToCenterDistance))}function Yo({queryGeometry:l,size:r,transform:s,unwrappedTileID:d,getElevation:g},_){const x=s.projectTileCoordinates(_.x,_.y,d,g).signedDistanceFromCamera,C=r*(s.cameraToCenterDistance/x);return Xd(l,Qd(_,s,d,g),C)}function C1({queryGeometry:l,size:r,transform:s,unwrappedTileID:d,getElevation:g},_){return Xd(l,Qd(_,s,d,g),r)}function _0({queryGeometry:l,size:r,transform:s,unwrappedTileID:d,getElevation:g,pitchAlignment:_="map",pitchScale:x="map"},C){const E=_==="map"?x==="map"?v0:up:x==="map"?Yo:C1,R={queryGeometry:l,size:r,transform:s,unwrappedTileID:d,getElevation:g};for(const L of C)for(const V of L)if(E(R,V))return!0;return!1}function Qd(l,r,s,d){const g=r.projectTileCoordinates(l.x,l.y,s,d).point;return new b((.5*g.x+.5)*r.width,(.5*-g.y+.5)*r.height)}let $o,x0;Ut("CircleBucket",Vh,{omit:["layers"]});var hr={get paint(){return x0=x0||new Ti({"circle-radius":new cr(Ze.paint_circle["circle-radius"]),"circle-color":new cr(Ze.paint_circle["circle-color"]),"circle-blur":new cr(Ze.paint_circle["circle-blur"]),"circle-opacity":new cr(Ze.paint_circle["circle-opacity"]),"circle-translate":new Xt(Ze.paint_circle["circle-translate"]),"circle-translate-anchor":new Xt(Ze.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Xt(Ze.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Xt(Ze.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new cr(Ze.paint_circle["circle-stroke-width"]),"circle-stroke-color":new cr(Ze.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new cr(Ze.paint_circle["circle-stroke-opacity"])})},get layout(){return $o=$o||new Ti({"circle-sort-key":new cr(Ze.layout_circle["circle-sort-key"])})}};class ef extends Zo{constructor(r,s){super(r,hr,s)}createBucket(r){return new Vh(r)}queryRadius(r){const s=r;return Yd("circle-radius",this,s)+Yd("circle-stroke-width",this,s)+cp(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:r,feature:s,featureState:d,geometry:g,transform:_,pixelsToTileUnits:x,unwrappedTileID:C,getElevation:E}){const R=Jd(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-_.bearingInRadians,x),L=this.paint.get("circle-radius").evaluate(s,d)+this.paint.get("circle-stroke-width").evaluate(s,d),V=this.paint.get("circle-pitch-scale"),H=this.paint.get("circle-pitch-alignment");let Z,J;return H==="map"?(Z=R,J=L*x):(Z=function(ee,ne,fe,Te){return ee.map(pe=>Qd(pe,ne,fe,Te))}(R,_,C,E),J=L),_0({queryGeometry:Z,size:J,transform:_,unwrappedTileID:C,getElevation:E,pitchAlignment:H,pitchScale:V},g)}}class Em extends Vh{}let uy;Ut("HeatmapBucket",Em,{omit:["layers"]});var T1={get paint(){return uy=uy||new Ti({"heatmap-radius":new cr(Ze.paint_heatmap["heatmap-radius"]),"heatmap-weight":new cr(Ze.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Xt(Ze.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ss(Ze.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Xt(Ze.paint_heatmap["heatmap-opacity"])})}};function Uh(l,{width:r,height:s},d,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==r*s*d)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${r*s*d}`)}else g=new Uint8Array(r*s*d);return l.width=r,l.height=s,l.data=g,l}function hp(l,{width:r,height:s},d){if(r===l.width&&s===l.height)return;const g=Uh({},{width:r,height:s},d);dp(l,g,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,r),height:Math.min(l.height,s)},d),l.width=r,l.height=s,l.data=g.data}function dp(l,r,s,d,g,_){if(g.width===0||g.height===0)return r;if(g.width>l.width||g.height>l.height||s.x>l.width-g.width||s.y>l.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>r.width||g.height>r.height||d.x>r.width-g.width||d.y>r.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const x=l.data,C=r.data;if(x===C)throw new Error("srcData equals dstData, so image is already copied");for(let E=0;E<g.height;E++){const R=((s.y+E)*l.width+s.x)*_,L=((d.y+E)*r.width+d.x)*_;for(let V=0;V<g.width*_;V++)C[L+V]=x[R+V]}return r}class tf{constructor(r,s){Uh(this,r,1,s)}resize(r){hp(this,r,1)}clone(){return new tf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,d,g,_){dp(r,s,d,g,_,1)}}class Jo{constructor(r,s){Uh(this,r,4,s)}resize(r){hp(this,r,4)}replace(r,s){s?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Jo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,d,g,_){dp(r,s,d,g,_,4)}setPixel(r,s,d){const g=4*(r*this.width+s);this.data[g+0]=Math.round(255*d.r/d.a),this.data[g+1]=Math.round(255*d.g/d.a),this.data[g+2]=Math.round(255*d.b/d.a),this.data[g+3]=Math.round(255*d.a)}}function hy(l){const r={},s=l.resolution||256,d=l.clips?l.clips.length:1,g=l.image||new Jo({width:s,height:d});if(Math.log(s)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${s}`);const _=(x,C,E)=>{r[l.evaluationKey]=E;const R=l.expression.evaluate(r);g.setPixel(x/4/s,C/4,R)};if(l.clips)for(let x=0,C=0;x<d;++x,C+=4*s)for(let E=0,R=0;E<s;E++,R+=4){const L=E/(s-1),{start:V,end:H}=l.clips[x];_(C,R,V*(1-L)+H*L)}else for(let x=0,C=0;x<s;x++,C+=4)_(0,C,x/(s-1));return g}Ut("AlphaImage",tf),Ut("RGBAImage",Jo);const fp="big-fb";class dy extends Zo{createBucket(r){return new Em(r)}constructor(r,s){super(r,T1,s),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=hy({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(fp)&&this.heatmapFbos.delete(fp)}queryRadius(r){return Yd("heatmap-radius",this,r)}queryIntersectsFeature({queryGeometry:r,feature:s,featureState:d,geometry:g,transform:_,pixelsToTileUnits:x,unwrappedTileID:C,getElevation:E}){return _0({queryGeometry:r,size:this.paint.get("heatmap-radius").evaluate(s,d)*x,transform:_,unwrappedTileID:C,getElevation:E},g)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&!this.isHidden()}}let To;var Wa={get paint(){return To=To||new Ti({"hillshade-illumination-direction":new Xt(Ze.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Xt(Ze.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Xt(Ze.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Xt(Ze.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Xt(Ze.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Xt(Ze.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Xt(Ze.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Xt(Ze.paint_hillshade["hillshade-method"])})}};class ku extends Zo{constructor(r,s){super(r,Wa,s),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let r=this.paint.get("hillshade-illumination-direction").values,s=this.paint.get("hillshade-illumination-altitude").values,d=this.paint.get("hillshade-highlight-color").values,g=this.paint.get("hillshade-shadow-color").values;const _=Math.max(r.length,s.length,d.length,g.length);r=r.concat(Array(_-r.length).fill(r.at(-1))),s=s.concat(Array(_-s.length).fill(s.at(-1))),d=d.concat(Array(_-d.length).fill(d.at(-1))),g=g.concat(Array(_-g.length).fill(g.at(-1)));const x=s.map(Un);return{directionRadians:r.map(Un),altitudeRadians:x,shadowColor:g,highlightColor:d}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&!this.isHidden()}}let fy;var b0={get paint(){return fy=fy||new Ti({"color-relief-opacity":new Xt(Ze["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Ss(Ze["paint_color-relief"]["color-relief-color"])})}};class Hs{constructor(r,s,d,g){this.context=r,this.format=d,this.texture=r.gl.createTexture(),this.update(s,g)}update(r,s,d){const{width:g,height:_}=r,x=!(this.size&&this.size[0]===g&&this.size[1]===_||d),{context:C}=this,{gl:E}=C;if(this.useMipmap=!!(s&&s.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!s||s.premultiply!==!1)),x)this.size=[g,_],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||Yt(r)?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,r):E.texImage2D(E.TEXTURE_2D,0,this.format,g,_,0,this.format,E.UNSIGNED_BYTE,r.data);else{const{x:R,y:L}=d||{x:0,y:0};r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||Yt(r)?E.texSubImage2D(E.TEXTURE_2D,0,R,L,E.RGBA,E.UNSIGNED_BYTE,r):E.texSubImage2D(E.TEXTURE_2D,0,R,L,g,_,E.RGBA,E.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D),C.pixelStoreUnpackFlipY.setDefault(),C.pixelStoreUnpack.setDefault(),C.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(r,s,d){const{context:g}=this,{gl:_}=g;_.bindTexture(_.TEXTURE_2D,this.texture),d!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(d=_.LINEAR),r!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,r),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,d||r),this.filter=r),s!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,s),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}class py{constructor(r,s,d,g=1,_=1,x=1,C=0){if(this.uid=r,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(d&&!["mapbox","terrarium","custom"].includes(d))return void wr(`"${d}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=s.height;const E=this.dim=s.height-2;switch(this.data=new Uint32Array(s.data.buffer),d){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=g,this.greenFactor=_,this.blueFactor=x,this.baseShift=C;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let R=0;R<E;R++)this.data[this._idx(-1,R)]=this.data[this._idx(0,R)],this.data[this._idx(E,R)]=this.data[this._idx(E-1,R)],this.data[this._idx(R,-1)]=this.data[this._idx(R,0)],this.data[this._idx(R,E)]=this.data[this._idx(R,E-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(E,-1)]=this.data[this._idx(E-1,0)],this.data[this._idx(-1,E)]=this.data[this._idx(0,E-1)],this.data[this._idx(E,E)]=this.data[this._idx(E-1,E-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let R=0;R<E;R++)for(let L=0;L<E;L++){const V=this.get(R,L);V>this.max&&(this.max=V),V<this.min&&(this.min=V)}}get(r,s){const d=new Uint8Array(this.data.buffer),g=4*this._idx(r,s);return this.unpack(d[g],d[g+1],d[g+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(r,s){if(r<-1||r>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError(`Out of range source coordinates for DEM data. x: ${r}, y: ${s}, dim: ${this.dim}`);return(s+1)*this.stride+(r+1)}unpack(r,s,d){return r*this.redFactor+s*this.greenFactor+d*this.blueFactor-this.baseShift}pack(r){return Za(r,this.getUnpackVector())}getPixels(){return new Jo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,s,d){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let g=s*this.dim,_=s*this.dim+this.dim,x=d*this.dim,C=d*this.dim+this.dim;switch(s){case-1:g=_-1;break;case 1:_=g+1}switch(d){case-1:x=C-1;break;case 1:C=x+1}const E=-s*this.dim,R=-d*this.dim;for(let L=x;L<C;L++)for(let V=g;V<_;V++)this.data[this._idx(V,L)]=r.data[this._idx(V+E,L+R)]}}function Za(l,r){const s=r[0],d=r[1],g=r[2],_=r[3],x=Math.min(s,d,g),C=Math.round((l+_)/x);return{r:Math.floor(C*x/s)%256,g:Math.floor(C*x/d)%256,b:Math.floor(C*x/g)%256}}Ut("DEMData",py);class M1 extends Zo{constructor(r,s){super(r,b0,s)}_createColorRamp(r){const s={elevationStops:[],colorStops:[]},d=this._transitionablePaint._values["color-relief-color"].value.expression;if(d instanceof Cl&&d._styleExpression.expression instanceof eo){this.colorRampExpression=d;const x=d._styleExpression.expression;s.elevationStops=x.labels,s.colorStops=[];for(const C of s.elevationStops)s.colorStops.push(x.evaluate({globals:{elevation:C}}))}if(s.elevationStops.length<1&&(s.elevationStops=[0],s.colorStops=[Fr.transparent]),s.elevationStops.length<2&&(s.elevationStops.push(s.elevationStops[0]+1),s.colorStops.push(s.colorStops[0])),s.elevationStops.length<=r)return s;const g={elevationStops:[],colorStops:[]},_=(s.elevationStops.length-1)/(r-1);for(let x=0;x<s.elevationStops.length-.5;x+=_)g.elevationStops.push(s.elevationStops[Math.round(x)]),g.colorStops.push(s.colorStops[Math.round(x)]);return wr(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${r}, provided: ${s.elevationStops.length}`),g}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(r,s,d){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const g=this._createColorRamp(s),_=new Jo({width:g.colorStops.length,height:1}),x=new Jo({width:g.colorStops.length,height:1});for(let C=0;C<g.elevationStops.length;C++){const E=Za(g.elevationStops[C],d);x.setPixel(0,C,new Fr(E.r/255,E.g/255,E.b/255,1)),_.setPixel(0,C,g.colorStops[C])}return this.colorRampTextures={elevationTexture:new Hs(r,x,r.gl.RGBA),colorTexture:new Hs(r,_,r.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return!this.isHidden()&&!!this.colorRampTextures}}const w0=gi([{name:"a_pos",components:2,type:"Int16"}],4),{members:S0}=w0;function pp(l,r,s){const d=s.patternDependencies;let g=!1;for(const _ of r){const x=_.paint.get(`${l}-pattern`);x.isConstant()||(g=!0);const C=x.constantOr(null);C&&(g=!0,d[C.to]=!0,d[C.from]=!0)}return g}function Im(l,r,s,d,g){const{zoom:_}=d,x=g.patternDependencies;for(const C of r){const E=C.paint.get(`${l}-pattern`).value;if(E.kind!=="constant"){let R=E.evaluate({zoom:_-1},s,{},g.availableImages),L=E.evaluate({zoom:_},s,{},g.availableImages),V=E.evaluate({zoom:_+1},s,{},g.availableImages);R=R&&R.name?R.name:R,L=L&&L.name?L.name:L,V=V&&V.name?V.name:V,x[R]=!0,x[L]=!0,x[V]=!0,s.patterns[C.id]={min:R,mid:L,max:V}}}return s}function C0(l,r,s,d,g){let _;if(g===function(x,C,E,R){let L=0;for(let V=C,H=E-R;V<E;V+=R)L+=(x[H]-x[V])*(x[V+1]+x[H+1]),H=V;return L}(l,r,s,d)>0)for(let x=r;x<s;x+=d)_=Bc(x/d|0,l[x],l[x+1],_);else for(let x=s-d;x>=r;x-=d)_=Bc(x/d|0,l[x],l[x+1],_);return _&&yo(_,_.next)&&(zu(_),_=_.next),_}function jl(l,r){if(!l)return l;r||(r=l);let s,d=l;do if(s=!1,d.steiner||!yo(d,d.next)&&oi(d.prev,d,d.next)!==0)d=d.next;else{if(zu(d),d=r=d.prev,d===d.next)break;s=!0}while(s||d!==r);return r}function Gh(l,r,s,d,g,_,x){if(!l)return;!x&&_&&function(E,R,L,V){let H=E;do H.z===0&&(H.z=Zi(H.x,H.y,R,L,V)),H.prevZ=H.prev,H.nextZ=H.next,H=H.next;while(H!==E);H.prevZ.nextZ=null,H.prevZ=null,function(Z){let J,ee=1;do{let ne,fe=Z;Z=null;let Te=null;for(J=0;fe;){J++;let pe=fe,me=0;for(let Fe=0;Fe<ee&&(me++,pe=pe.nextZ,pe);Fe++);let Ie=ee;for(;me>0||Ie>0&&pe;)me!==0&&(Ie===0||!pe||fe.z<=pe.z)?(ne=fe,fe=fe.nextZ,me--):(ne=pe,pe=pe.nextZ,Ie--),Te?Te.nextZ=ne:Z=ne,ne.prevZ=Te,Te=ne;fe=pe}Te.nextZ=null,ee*=2}while(J>1)}(H)}(l,d,g,_);let C=l;for(;l.prev!==l.next;){const E=l.prev,R=l.next;if(_?bn(l,d,g,_):ma(l))r.push(E.i,l.i,R.i),zu(l),l=R.next,C=R.next;else if((l=R)===C){x?x===1?Gh(l=Mo(jl(l),r),r,s,d,g,_,2):x===2&&io(l,r,s,d,g,_):Gh(jl(l),r,s,d,g,_,1);break}}}function ma(l){const r=l.prev,s=l,d=l.next;if(oi(r,s,d)>=0)return!1;const g=r.x,_=s.x,x=d.x,C=r.y,E=s.y,R=d.y,L=Math.min(g,_,x),V=Math.min(C,E,R),H=Math.max(g,_,x),Z=Math.max(C,E,R);let J=d.next;for(;J!==r;){if(J.x>=L&&J.x<=H&&J.y>=V&&J.y<=Z&&Ru(g,C,_,E,x,R,J.x,J.y)&&oi(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function bn(l,r,s,d){const g=l.prev,_=l,x=l.next;if(oi(g,_,x)>=0)return!1;const C=g.x,E=_.x,R=x.x,L=g.y,V=_.y,H=x.y,Z=Math.min(C,E,R),J=Math.min(L,V,H),ee=Math.max(C,E,R),ne=Math.max(L,V,H),fe=Zi(Z,J,r,s,d),Te=Zi(ee,ne,r,s,d);let pe=l.prevZ,me=l.nextZ;for(;pe&&pe.z>=fe&&me&&me.z<=Te;){if(pe.x>=Z&&pe.x<=ee&&pe.y>=J&&pe.y<=ne&&pe!==g&&pe!==x&&Ru(C,L,E,V,R,H,pe.x,pe.y)&&oi(pe.prev,pe,pe.next)>=0||(pe=pe.prevZ,me.x>=Z&&me.x<=ee&&me.y>=J&&me.y<=ne&&me!==g&&me!==x&&Ru(C,L,E,V,R,H,me.x,me.y)&&oi(me.prev,me,me.next)>=0))return!1;me=me.nextZ}for(;pe&&pe.z>=fe;){if(pe.x>=Z&&pe.x<=ee&&pe.y>=J&&pe.y<=ne&&pe!==g&&pe!==x&&Ru(C,L,E,V,R,H,pe.x,pe.y)&&oi(pe.prev,pe,pe.next)>=0)return!1;pe=pe.prevZ}for(;me&&me.z<=Te;){if(me.x>=Z&&me.x<=ee&&me.y>=J&&me.y<=ne&&me!==g&&me!==x&&Ru(C,L,E,V,R,H,me.x,me.y)&&oi(me.prev,me,me.next)>=0)return!1;me=me.nextZ}return!0}function Mo(l,r){let s=l;do{const d=s.prev,g=s.next.next;!yo(d,g)&&km(d,s,s.next,g)&&Du(d,g)&&Du(g,d)&&(r.push(d.i,s.i,g.i),zu(s),zu(s.next),s=l=g),s=s.next}while(s!==l);return jl(s)}function io(l,r,s,d,g,_){let x=l;do{let C=x.next.next;for(;C!==x.prev;){if(x.i!==C.i&&my(x,C)){let E=Am(x,C);return x=jl(x,x.next),E=jl(E,E.next),Gh(x,r,s,d,g,_,0),void Gh(E,r,s,d,g,_,0)}C=C.next}x=x.next}while(x!==l)}function jo(l,r){let s=l.x-r.x;return s===0&&(s=l.y-r.y,s===0)&&(s=(l.next.y-l.y)/(l.next.x-l.x)-(r.next.y-r.y)/(r.next.x-r.x)),s}function Ws(l,r){const s=function(g,_){let x=_;const C=g.x,E=g.y;let R,L=-1/0;if(yo(g,x))return x;do{if(yo(g,x.next))return x.next;if(E<=x.y&&E>=x.next.y&&x.next.y!==x.y){const ee=x.x+(E-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(ee<=C&&ee>L&&(L=ee,R=x.x<x.next.x?x:x.next,ee===C))return R}x=x.next}while(x!==_);if(!R)return null;const V=R,H=R.x,Z=R.y;let J=1/0;x=R;do{if(C>=x.x&&x.x>=H&&C!==x.x&&Au(E<Z?C:L,E,H,Z,E<Z?L:C,E,x.x,x.y)){const ee=Math.abs(E-x.y)/(C-x.x);Du(x,g)&&(ee<J||ee===J&&(x.x>R.x||x.x===R.x&&rf(R,x)))&&(R=x,J=ee)}x=x.next}while(x!==V);return R}(l,r);if(!s)return r;const d=Am(s,l);return jl(d,d.next),jl(s,s.next)}function rf(l,r){return oi(l.prev,l,r.prev)<0&&oi(r.next,l,l.next)<0}function Zi(l,r,s,d,g){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-s)*g|0)|l<<8))|l<<4))|l<<2))|l<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-d)*g|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function mp(l){let r=l,s=l;do(r.x<s.x||r.x===s.x&&r.y<s.y)&&(s=r),r=r.next;while(r!==l);return s}function Au(l,r,s,d,g,_,x,C){return(g-x)*(r-C)>=(l-x)*(_-C)&&(l-x)*(d-C)>=(s-x)*(r-C)&&(s-x)*(_-C)>=(g-x)*(d-C)}function Ru(l,r,s,d,g,_,x,C){return!(l===x&&r===C)&&Au(l,r,s,d,g,_,x,C)}function my(l,r){return l.next.i!==r.i&&l.prev.i!==r.i&&!function(s,d){let g=s;do{if(g.i!==s.i&&g.next.i!==s.i&&g.i!==d.i&&g.next.i!==d.i&&km(g,g.next,s,d))return!0;g=g.next}while(g!==s);return!1}(l,r)&&(Du(l,r)&&Du(r,l)&&function(s,d){let g=s,_=!1;const x=(s.x+d.x)/2,C=(s.y+d.y)/2;do g.y>C!=g.next.y>C&&g.next.y!==g.y&&x<(g.next.x-g.x)*(C-g.y)/(g.next.y-g.y)+g.x&&(_=!_),g=g.next;while(g!==s);return _}(l,r)&&(oi(l.prev,l,r.prev)||oi(l,r.prev,r))||yo(l,r)&&oi(l.prev,l,l.next)>0&&oi(r.prev,r,r.next)>0)}function oi(l,r,s){return(r.y-l.y)*(s.x-r.x)-(r.x-l.x)*(s.y-r.y)}function yo(l,r){return l.x===r.x&&l.y===r.y}function km(l,r,s,d){const g=ga(oi(l,r,s)),_=ga(oi(l,r,d)),x=ga(oi(s,d,l)),C=ga(oi(s,d,r));return g!==_&&x!==C||!(g!==0||!Fc(l,s,r))||!(_!==0||!Fc(l,d,r))||!(x!==0||!Fc(s,l,d))||!(C!==0||!Fc(s,r,d))}function Fc(l,r,s){return r.x<=Math.max(l.x,s.x)&&r.x>=Math.min(l.x,s.x)&&r.y<=Math.max(l.y,s.y)&&r.y>=Math.min(l.y,s.y)}function ga(l){return l>0?1:l<0?-1:0}function Du(l,r){return oi(l.prev,l,l.next)<0?oi(l,r,l.next)>=0&&oi(l,l.prev,r)>=0:oi(l,r,l.prev)<0||oi(l,l.next,r)<0}function Am(l,r){const s=Nl(l.i,l.x,l.y),d=Nl(r.i,r.x,r.y),g=l.next,_=r.prev;return l.next=r,r.prev=l,s.next=g,g.prev=s,d.next=s,s.prev=d,_.next=d,d.prev=_,d}function Bc(l,r,s,d){const g=Nl(l,r,s);return d?(g.next=d.next,g.prev=d,d.next.prev=g,d.next=g):(g.prev=g,g.next=g),g}function zu(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function Nl(l,r,s){return{i:l,x:r,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class $c{constructor(r,s){if(s>r)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=r,this._minGranularity=s}getGranularityForZoomLevel(r){return Math.max(Math.floor(this._baseZoomGranularity/(1<<r)),this._minGranularity,1)}}class Ou{constructor(r){this.fill=r.fill,this.line=r.line,this.tile=r.tile,this.stencil=r.stencil,this.circle=r.circle}}Ou.noSubdivision=new Ou({fill:new $c(0,0),line:new $c(0,0),tile:new $c(0,0),stencil:new $c(0,0),circle:1}),Ut("SubdivisionGranularityExpression",$c),Ut("SubdivisionGranularitySetting",Ou);const Lu=-32768,Fu=32767;class Rm{constructor(r,s){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=r,this._granularityCellSize=je/r,this._canonical=s}_getKey(r,s){return(r+=32768)<<16|s+32768}_vertexToIndex(r,s){if(r<-32768||s<-32768||r>32767||s>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const d=0|Math.round(r),g=0|Math.round(s),_=this._getKey(d,g);if(this._vertexDictionary.has(_))return this._vertexDictionary.get(_);const x=this._vertexBuffer.length/2;return this._vertexDictionary.set(_,x),this._vertexBuffer.push(d,g),x}_subdivideTrianglesScanline(r){if(this._granularity<2)return function(g,_){const x=[];for(let C=0;C<_.length;C+=3){const E=_[C],R=_[C+1],L=_[C+2],V=g[2*E],H=g[2*E+1];(g[2*R]-V)*(g[2*L+1]-H)-(g[2*R+1]-H)*(g[2*L]-V)>0?(x.push(E),x.push(L),x.push(R)):(x.push(E),x.push(R),x.push(L))}return x}(this._vertexBuffer,r);const s=[],d=r.length;for(let g=0;g<d;g+=3){const _=[r[g+0],r[g+1],r[g+2]],x=[this._vertexBuffer[2*r[g+0]+0],this._vertexBuffer[2*r[g+0]+1],this._vertexBuffer[2*r[g+1]+0],this._vertexBuffer[2*r[g+1]+1],this._vertexBuffer[2*r[g+2]+0],this._vertexBuffer[2*r[g+2]+1]];let C=1/0,E=1/0,R=-1/0,L=-1/0;for(let ee=0;ee<3;ee++){const ne=x[2*ee],fe=x[2*ee+1];C=Math.min(C,ne),R=Math.max(R,ne),E=Math.min(E,fe),L=Math.max(L,fe)}if(C===R||E===L)continue;const V=Math.floor(C/this._granularityCellSize),H=Math.ceil(R/this._granularityCellSize),Z=Math.floor(E/this._granularityCellSize),J=Math.ceil(L/this._granularityCellSize);if(V!==H||Z!==J)for(let ee=Z;ee<J;ee++){const ne=this._scanlineGenerateVertexRingForCellRow(ee,x,_);Xa(this._vertexBuffer,ne,s)}else s.push(..._)}return s}_scanlineGenerateVertexRingForCellRow(r,s,d){const g=r*this._granularityCellSize,_=g+this._granularityCellSize,x=[];for(let C=0;C<3;C++){const E=s[2*C],R=s[2*C+1],L=s[2*(C+1)%6],V=s[(2*(C+1)+1)%6],H=s[2*(C+2)%6],Z=s[(2*(C+2)+1)%6],J=L-E,ee=V-R,ne=J===0,fe=ee===0,Te=(g-R)/ee,pe=(_-R)/ee,me=Math.min(Te,pe),Ie=Math.max(Te,pe);if(!fe&&(me>=1||Ie<=0)||fe&&(R<g||R>_)){V>=g&&V<=_&&x.push(d[(C+1)%3]);continue}!fe&&me>0&&x.push(this._vertexToIndex(E+J*me,R+ee*me));const Fe=E+J*Math.max(me,0),nt=E+J*Math.min(Ie,1);ne||this._generateIntraEdgeVertices(x,E,R,L,V,Fe,nt),!fe&&Ie<1&&x.push(this._vertexToIndex(E+J*Ie,R+ee*Ie)),(fe||V>=g&&V<=_)&&x.push(d[(C+1)%3]),!fe&&(V<=g||V>=_)&&this._generateInterEdgeVertices(x,E,R,L,V,H,Z,nt,g,_)}return x}_generateIntraEdgeVertices(r,s,d,g,_,x,C){const E=g-s,R=_-d,L=R===0,V=L?Math.min(s,g):Math.min(x,C),H=L?Math.max(s,g):Math.max(x,C),Z=Math.floor(V/this._granularityCellSize)+1,J=Math.ceil(H/this._granularityCellSize)-1;if(L?s<g:x<C)for(let ee=Z;ee<=J;ee++){const ne=ee*this._granularityCellSize;r.push(this._vertexToIndex(ne,d+R*(ne-s)/E))}else for(let ee=J;ee>=Z;ee--){const ne=ee*this._granularityCellSize;r.push(this._vertexToIndex(ne,d+R*(ne-s)/E))}}_generateInterEdgeVertices(r,s,d,g,_,x,C,E,R,L){const V=_-d,H=x-g,Z=C-_,J=(R-_)/Z,ee=(L-_)/Z,ne=Math.min(J,ee),fe=Math.max(J,ee),Te=g+H*ne;let pe=Math.floor(Math.min(Te,E)/this._granularityCellSize)+1,me=Math.ceil(Math.max(Te,E)/this._granularityCellSize)-1,Ie=E<Te;const Fe=Z===0;if(Fe&&(C===R||C===L))return;if(Fe||ne>=1||fe<=0){const bt=d-C,mt=x+(s-x)*Math.min((R-C)/bt,(L-C)/bt);pe=Math.floor(Math.min(mt,E)/this._granularityCellSize)+1,me=Math.ceil(Math.max(mt,E)/this._granularityCellSize)-1,Ie=E<mt}const nt=V>0?L:R;if(Ie)for(let bt=pe;bt<=me;bt++)r.push(this._vertexToIndex(bt*this._granularityCellSize,nt));else for(let bt=me;bt>=pe;bt--)r.push(this._vertexToIndex(bt*this._granularityCellSize,nt))}_generateOutline(r){const s=[];for(const d of r){const g=Ms(d,this._granularity,!0),_=this._pointArrayToIndices(g),x=[];for(let C=1;C<_.length;C++)x.push(_[C-1]),x.push(_[C]);s.push(x)}return s}_handlePoles(r){let s=!1,d=!1;this._canonical&&(this._canonical.y===0&&(s=!0),this._canonical.y===(1<<this._canonical.z)-1&&(d=!0)),(s||d)&&this._fillPoles(r,s,d)}_ensureNoPoleVertices(){const r=this._vertexBuffer;for(let s=0;s<r.length;s+=2){const d=r[s+1];d===Lu&&(r[s+1]=-32767),d===Fu&&(r[s+1]=32766)}}_generatePoleQuad(r,s,d,g,_,x){g>_!=(x===Lu)?(r.push(s),r.push(d),r.push(this._vertexToIndex(g,x)),r.push(d),r.push(this._vertexToIndex(_,x)),r.push(this._vertexToIndex(g,x))):(r.push(d),r.push(s),r.push(this._vertexToIndex(g,x)),r.push(this._vertexToIndex(_,x)),r.push(d),r.push(this._vertexToIndex(g,x)))}_fillPoles(r,s,d){const g=this._vertexBuffer,_=je,x=r.length;for(let C=2;C<x;C+=3){const E=r[C-2],R=r[C-1],L=r[C],V=g[2*E],H=g[2*E+1],Z=g[2*R],J=g[2*R+1],ee=g[2*L],ne=g[2*L+1];s&&(H===0&&J===0&&this._generatePoleQuad(r,E,R,V,Z,Lu),J===0&&ne===0&&this._generatePoleQuad(r,R,L,Z,ee,Lu),ne===0&&H===0&&this._generatePoleQuad(r,L,E,ee,V,Lu)),d&&(H===_&&J===_&&this._generatePoleQuad(r,E,R,V,Z,Fu),J===_&&ne===_&&this._generatePoleQuad(r,R,L,Z,ee,Fu),ne===_&&H===_&&this._generatePoleQuad(r,L,E,ee,V,Fu))}}_initializeVertices(r){for(let s=0;s<r.length;s+=2)this._vertexToIndex(r[s],r[s+1])}subdividePolygonInternal(r,s){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:d,holeIndices:g}=function(C){const E=[],R=[];for(const L of C)if(L.length!==0){L!==C[0]&&E.push(R.length/2);for(let V=0;V<L.length;V++)R.push(L[V].x),R.push(L[V].y)}return{flattened:R,holeIndices:E}}(r);let _;this._initializeVertices(d);try{const C=function(R,L,V=2){const H=L&&L.length,Z=H?L[0]*V:R.length;let J=C0(R,0,Z,V,!0);const ee=[];if(!J||J.next===J.prev)return ee;let ne,fe,Te;if(H&&(J=function(pe,me,Ie,Fe){const nt=[];for(let bt=0,mt=me.length;bt<mt;bt++){const Pt=C0(pe,me[bt]*Fe,bt<mt-1?me[bt+1]*Fe:pe.length,Fe,!1);Pt===Pt.next&&(Pt.steiner=!0),nt.push(mp(Pt))}nt.sort(jo);for(let bt=0;bt<nt.length;bt++)Ie=Ws(nt[bt],Ie);return Ie}(R,L,J,V)),R.length>80*V){ne=R[0],fe=R[1];let pe=ne,me=fe;for(let Ie=V;Ie<Z;Ie+=V){const Fe=R[Ie],nt=R[Ie+1];Fe<ne&&(ne=Fe),nt<fe&&(fe=nt),Fe>pe&&(pe=Fe),nt>me&&(me=nt)}Te=Math.max(pe-ne,me-fe),Te=Te!==0?32767/Te:0}return Gh(J,ee,V,ne,fe,Te,0),ee}(d,g),E=this._convertIndices(d,C);_=this._subdivideTrianglesScanline(E)}catch(C){console.error(C)}let x=[];return s&&(x=this._generateOutline(r)),this._ensureNoPoleVertices(),this._handlePoles(_),{verticesFlattened:this._vertexBuffer,indicesTriangles:_,indicesLineList:x}}_convertIndices(r,s){const d=[];for(let g=0;g<s.length;g++)d.push(this._vertexToIndex(r[2*s[g]],r[2*s[g]+1]));return d}_pointArrayToIndices(r){const s=[];for(let d=0;d<r.length;d++){const g=r[d];s.push(this._vertexToIndex(g.x,g.y))}return s}}function Qo(l,r,s,d=!0){return new Rm(s,r).subdividePolygonInternal(l,d)}function Ms(l,r,s=!1){if(!l||l.length<1)return[];if(l.length<2)return[];const d=l[0],g=l[l.length-1],_=s&&(d.x!==g.x||d.y!==g.y);if(r<2)return _?[...l,l[0]]:[...l];const x=Math.floor(je/r),C=[];C.push(new b(l[0].x,l[0].y));const E=l.length,R=_?E:E-1;for(let L=0;L<R;L++){const V=l[L],H=L<E-1?l[L+1]:l[0],Z=V.x,J=V.y,ee=H.x,ne=H.y,fe=Z!==ee,Te=J!==ne;if(!fe&&!Te)continue;const pe=ee-Z,me=ne-J,Ie=Math.abs(pe),Fe=Math.abs(me);let nt=Z,bt=J;for(;;){const Pt=pe>0?(Math.floor(nt/x)+1)*x:(Math.ceil(nt/x)-1)*x,Bt=me>0?(Math.floor(bt/x)+1)*x:(Math.ceil(bt/x)-1)*x,kt=Math.abs(nt-Pt),vt=Math.abs(bt-Bt),ht=Math.abs(nt-ee),Kt=Math.abs(bt-ne),Ht=fe?kt/Ie:Number.POSITIVE_INFINITY,Jt=Te?vt/Fe:Number.POSITIVE_INFINITY;if((ht<=kt||!fe)&&(Kt<=vt||!Te))break;if(Ht<Jt&&fe||!Te){nt=Pt,bt+=me*Ht;const Gt=new b(nt,Math.round(bt));C[C.length-1].x===Gt.x&&C[C.length-1].y===Gt.y||C.push(Gt)}else{nt+=pe*Jt,bt=Bt;const Gt=new b(Math.round(nt),bt);C[C.length-1].x===Gt.x&&C[C.length-1].y===Gt.y||C.push(Gt)}}const mt=new b(ee,ne);C[C.length-1].x===mt.x&&C[C.length-1].y===mt.y||C.push(mt)}return C}function Xa(l,r,s){if(r.length===0)throw new Error("Subdivision vertex ring is empty.");let d=0,g=l[2*r[0]];for(let E=1;E<r.length;E++){const R=l[2*r[E]];R<g&&(g=R,d=E)}const _=r.length;let x=d,C=(x+1)%_;for(;;){const E=x-1>=0?x-1:_-1,R=(C+1)%_,L=l[2*r[E]],V=l[2*r[R]],H=l[2*r[x]],Z=l[2*r[x]+1],J=l[2*r[C]+1];let ee=!1;if(L<V)ee=!0;else if(L>V)ee=!1;else{const ne=J-Z,fe=-(l[2*r[C]]-H),Te=Z<J?1:-1;((L-H)*ne+(l[2*r[E]+1]-Z)*fe)*Te>((V-H)*ne+(l[2*r[R]+1]-Z)*fe)*Te&&(ee=!0)}if(ee){const ne=r[E],fe=r[x],Te=r[C];ne!==fe&&ne!==Te&&fe!==Te&&s.push(Te,fe,ne),x--,x<0&&(x=_-1)}else{const ne=r[R],fe=r[x],Te=r[C];ne!==fe&&ne!==Te&&fe!==Te&&s.push(Te,fe,ne),C++,C>=_&&(C=0)}if(E===R)break}}function ls(l,r,s,d,g,_,x,C,E){const R=g.length/2,L=x&&C&&E;if(R<Nt.MAX_VERTEX_ARRAY_LENGTH){const V=r.prepareSegment(R,s,d),H=V.vertexLength;for(let ee=0;ee<_.length;ee+=3)d.emplaceBack(H+_[ee],H+_[ee+1],H+_[ee+2]);let Z,J;V.vertexLength+=R,V.primitiveLength+=_.length/3,L&&(J=x.prepareSegment(R,s,C),Z=J.vertexLength,J.vertexLength+=R);for(let ee=0;ee<g.length;ee+=2)l(g[ee],g[ee+1]);if(L)for(let ee=0;ee<E.length;ee++){const ne=E[ee];for(let fe=1;fe<ne.length;fe+=2)C.emplaceBack(Z+ne[fe-1],Z+ne[fe]);J.primitiveLength+=ne.length/2}}else(function(V,H,Z,J,ee,ne){const fe=[];for(let Fe=0;Fe<J.length/2;Fe++)fe.push(-1);const Te={count:0};let pe=0,me=V.getOrCreateLatestSegment(H,Z),Ie=me.vertexLength;for(let Fe=2;Fe<ee.length;Fe+=3){const nt=ee[Fe-2],bt=ee[Fe-1],mt=ee[Fe];let Pt=fe[nt]<pe,Bt=fe[bt]<pe,kt=fe[mt]<pe;me.vertexLength+((Pt?1:0)+(Bt?1:0)+(kt?1:0))>Nt.MAX_VERTEX_ARRAY_LENGTH&&(me=V.createNewSegment(H,Z),pe=Te.count,Pt=!0,Bt=!0,kt=!0,Ie=0);const vt=nf(fe,J,ne,Te,nt,Pt,me),ht=nf(fe,J,ne,Te,bt,Bt,me),Kt=nf(fe,J,ne,Te,mt,kt,me);Z.emplaceBack(Ie+vt-pe,Ie+ht-pe,Ie+Kt-pe),me.primitiveLength++}})(r,s,d,g,_,l),L&&function(V,H,Z,J,ee,ne){const fe=[];for(let Fe=0;Fe<J.length/2;Fe++)fe.push(-1);const Te={count:0};let pe=0,me=V.getOrCreateLatestSegment(H,Z),Ie=me.vertexLength;for(let Fe=0;Fe<ee.length;Fe++){const nt=ee[Fe];for(let bt=1;bt<ee[Fe].length;bt+=2){const mt=nt[bt-1],Pt=nt[bt];let Bt=fe[mt]<pe,kt=fe[Pt]<pe;me.vertexLength+((Bt?1:0)+(kt?1:0))>Nt.MAX_VERTEX_ARRAY_LENGTH&&(me=V.createNewSegment(H,Z),pe=Te.count,Bt=!0,kt=!0,Ie=0);const vt=nf(fe,J,ne,Te,mt,Bt,me),ht=nf(fe,J,ne,Te,Pt,kt,me);Z.emplaceBack(Ie+vt-pe,Ie+ht-pe),me.primitiveLength++}}}(x,s,C,g,E,l),r.forceNewSegmentOnNextPrepare(),x?.forceNewSegmentOnNextPrepare()}function nf(l,r,s,d,g,_,x){if(_){const C=d.count;return s(r[2*g],r[2*g+1]),l[g]=d.count,d.count++,x.vertexLength++,C}return l[g]}class gp{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new ve,this.indexArray=new at,this.indexArray2=new Rt,this.programConfigurations=new $l(r.layers,r.zoom),this.segments=new Nt,this.segments2=new Nt,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,d){this.hasDependencies=pp("fill",this.layers,s);const g=this.layers[0].layout.get("fill-sort-key"),_=!g.isConstant(),x=[];for(const{feature:C,id:E,index:R,sourceLayerIndex:L}of r){const V=this.layers[0]._featureFilter.needGeometry,H=Ha(C,V);if(!this.layers[0]._featureFilter.filter(new Sn(this.zoom),H,d))continue;const Z=_?g.evaluate(H,{},d,s.availableImages):void 0,J={id:E,properties:C.properties,type:C.type,sourceLayerIndex:L,index:R,geometry:V?H.geometry:pa(C),patterns:{},sortKey:Z};x.push(J)}_&&x.sort((C,E)=>C.sortKey-E.sortKey);for(const C of x){const{geometry:E,index:R,sourceLayerIndex:L}=C;if(this.hasDependencies){const V=Im("fill",this.layers,C,{zoom:this.zoom},s);this.patternFeatures.push(V)}else this.addFeature(C,E,R,d,{},s.subdivisionGranularity);s.featureIndex.insert(r[R].feature,E,R,L,this.index)}}update(r,s,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,{imagePositions:d})}addFeatures(r,s,d){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,s,d,r.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,S0),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,s,d,g,_,x){for(const C of _h(s,500)){const E=Qo(C,g,x.fill.getGranularityForZoomLevel(g.z)),R=this.layoutVertexArray;ls((L,V)=>{R.emplaceBack(L,V)},this.segments,this.layoutVertexArray,this.indexArray,E.verticesFlattened,E.indicesTriangles,this.segments2,this.indexArray2,E.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,d,{imagePositions:_,canonical:g})}}let Dm,T0;Ut("FillBucket",gp,{omit:["layers","patternFeatures"]});var Bu={get paint(){return T0=T0||new Ti({"fill-antialias":new Xt(Ze.paint_fill["fill-antialias"]),"fill-opacity":new cr(Ze.paint_fill["fill-opacity"]),"fill-color":new cr(Ze.paint_fill["fill-color"]),"fill-outline-color":new cr(Ze.paint_fill["fill-outline-color"]),"fill-translate":new Xt(Ze.paint_fill["fill-translate"]),"fill-translate-anchor":new Xt(Ze.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ic(Ze.paint_fill["fill-pattern"])})},get layout(){return Dm=Dm||new Ti({"fill-sort-key":new cr(Ze.layout_fill["fill-sort-key"])})}};class M0 extends Zo{constructor(r,s){super(r,Bu,s)}recalculate(r,s){super.recalculate(r,s);const d=this.paint._values["fill-outline-color"];d.value.kind==="constant"&&d.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new gp(r)}queryRadius(){return cp(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:r,geometry:s,transform:d,pixelsToTileUnits:g}){return ay(Jd(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-d.bearingInRadians,g),s)}isTileClipped(){return!0}}const gy=gi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),qh=gi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:yy}=gy;class Ka{constructor(r,s,d,g,_){this.properties={},this.extent=d,this.type=0,this.id=void 0,this._pbf=r,this._geometry=-1,this._keys=g,this._values=_,r.readFields(P0,this,s)}loadGeometry(){const r=this._pbf;r.pos=this._geometry;const s=r.readVarint()+r.pos,d=[];let g,_=1,x=0,C=0,E=0;for(;r.pos<s;){if(x<=0){const R=r.readVarint();_=7&R,x=R>>3}if(x--,_===1||_===2)C+=r.readSVarint(),E+=r.readSVarint(),_===1&&(g&&d.push(g),g=[]),g&&g.push(new b(C,E));else{if(_!==7)throw new Error(`unknown command ${_}`);g&&g.push(g[0].clone())}}return g&&d.push(g),d}bbox(){const r=this._pbf;r.pos=this._geometry;const s=r.readVarint()+r.pos;let d=1,g=0,_=0,x=0,C=1/0,E=-1/0,R=1/0,L=-1/0;for(;r.pos<s;){if(g<=0){const V=r.readVarint();d=7&V,g=V>>3}if(g--,d===1||d===2)_+=r.readSVarint(),x+=r.readSVarint(),_<C&&(C=_),_>E&&(E=_),x<R&&(R=x),x>L&&(L=x);else if(d!==7)throw new Error(`unknown command ${d}`)}return[C,R,E,L]}toGeoJSON(r,s,d){const g=this.extent*Math.pow(2,d),_=this.extent*r,x=this.extent*s,C=this.loadGeometry();function E(H){return[360*(H.x+_)/g-180,360/Math.PI*Math.atan(Math.exp((1-2*(H.y+x)/g)*Math.PI))-90]}function R(H){return H.map(E)}let L;if(this.type===1){const H=[];for(const J of C)H.push(J[0]);const Z=R(H);L=H.length===1?{type:"Point",coordinates:Z[0]}:{type:"MultiPoint",coordinates:Z}}else if(this.type===2){const H=C.map(R);L=H.length===1?{type:"LineString",coordinates:H[0]}:{type:"MultiLineString",coordinates:H}}else{if(this.type!==3)throw new Error("unknown feature type");{const H=vy(C),Z=[];for(const J of H)Z.push(J.map(R));L=Z.length===1?{type:"Polygon",coordinates:Z[0]}:{type:"MultiPolygon",coordinates:Z}}}const V={type:"Feature",geometry:L,properties:this.properties};return this.id!=null&&(V.id=this.id),V}}function P0(l,r,s){l===1?r.id=s.readVarint():l===2?function(d,g){const _=d.readVarint()+d.pos;for(;d.pos<_;){const x=g._keys[d.readVarint()],C=g._values[d.readVarint()];g.properties[x]=C}}(s,r):l===3?r.type=s.readVarint():l===4&&(r._geometry=s.pos)}function vy(l){const r=l.length;if(r<=1)return[l];const s=[];let d,g;for(let _=0;_<r;_++){const x=_y(l[_]);x!==0&&(g===void 0&&(g=x<0),g===x<0?(d&&s.push(d),d=[l[_]]):d&&d.push(l[_]))}return d&&s.push(d),s}function _y(l){let r=0;for(let s,d,g=0,_=l.length,x=_-1;g<_;x=g++)s=l[g],d=l[x],r+=(d.x-s.x)*(s.y+d.y);return r}Ka.types=["Unknown","Point","LineString","Polygon"];class zm{constructor(r,s){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(P1,this,s),this.length=this._features.length}feature(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];const s=this._pbf.readVarint()+this._pbf.pos;return new Ka(this._pbf,s,this.extent,this._keys,this._values)}}function P1(l,r,s){l===15?r.version=s.readVarint():l===1?r.name=s.readString():l===5?r.extent=s.readVarint():l===2?r._features.push(s.pos):l===3?r._keys.push(s.readString()):l===4&&r._values.push(function(d){let g=null;const _=d.readVarint()+d.pos;for(;d.pos<_;){const x=d.readVarint()>>3;g=x===1?d.readString():x===2?d.readFloat():x===3?d.readDouble():x===4?d.readVarint64():x===5?d.readVarint():x===6?d.readSVarint():x===7?d.readBoolean():null}if(g==null)throw new Error("unknown feature value");return g}(s))}class E0{constructor(r,s){this.layers=r.readFields(I0,{},s)}}function I0(l,r,s){if(l===3){const d=new zm(s,s.readVarint()+s.pos);d.length&&(r[d.name]=d)}}const Om=Math.pow(2,13);function Ya(l,r,s,d,g,_,x,C){l.emplaceBack(r,s,2*Math.floor(d*Om)+x,g*Om*2,_*Om*2,Math.round(C))}class xy{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasDependencies=!1,this.layoutVertexArray=new Se,this.centroidVertexArray=new ge,this.indexArray=new at,this.programConfigurations=new $l(r.layers,r.zoom),this.segments=new Nt,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,d){this.features=[],this.hasDependencies=pp("fill-extrusion",this.layers,s);for(const{feature:g,id:_,index:x,sourceLayerIndex:C}of r){const E=this.layers[0]._featureFilter.needGeometry,R=Ha(g,E);if(!this.layers[0]._featureFilter.filter(new Sn(this.zoom),R,d))continue;const L={id:_,sourceLayerIndex:C,index:x,geometry:E?R.geometry:pa(g),properties:g.properties,type:g.type,patterns:{}};this.hasDependencies?this.features.push(Im("fill-extrusion",this.layers,L,{zoom:this.zoom},s)):this.addFeature(L,L.geometry,x,d,{},s.subdivisionGranularity),s.featureIndex.insert(g,L.geometry,x,C,this.index,!0)}}addFeatures(r,s,d){for(const g of this.features){const{geometry:_}=g;this.addFeature(g,_,g.index,s,d,r.subdivisionGranularity)}}update(r,s,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,{imagePositions:d})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,yy),this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,qh.members,!0),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(r,s,d,g,_,x){for(const C of _h(s,500)){const E={x:0,y:0,sampleCount:0},R=this.layoutVertexArray.length;this.processPolygon(E,g,r,C,x);const L=this.layoutVertexArray.length-R,V=Math.floor(E.x/E.sampleCount),H=Math.floor(E.y/E.sampleCount);for(let Z=0;Z<L;Z++)this.centroidVertexArray.emplaceBack(V,H)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,d,{imagePositions:_,canonical:g})}processPolygon(r,s,d,g,_){if(g.length<1||Ai(g[0]))return;for(const V of g)V.length!==0&&of(r,V);const x={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},C=_.fill.getGranularityForZoomLevel(s.z),E=Ka.types[d.type]==="Polygon";for(const V of g){if(V.length===0||Ai(V))continue;const H=Ms(V,C,E);this._generateSideFaces(H,x)}if(!E)return;const R=Qo(g,s,C,!1),L=this.layoutVertexArray;ls((V,H)=>{Ya(L,V,H,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,R.verticesFlattened,R.indicesTriangles)}_generateSideFaces(r,s){let d=0;for(let g=1;g<r.length;g++){const _=r[g],x=r[g-1];if(k0(_,x))continue;s.segment.vertexLength+4>Nt.MAX_VERTEX_ARRAY_LENGTH&&(s.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const C=_.sub(x)._perp()._unit(),E=x.dist(_);d+E>32768&&(d=0),Ya(this.layoutVertexArray,_.x,_.y,C.x,C.y,0,0,d),Ya(this.layoutVertexArray,_.x,_.y,C.x,C.y,0,1,d),d+=E,Ya(this.layoutVertexArray,x.x,x.y,C.x,C.y,0,0,d),Ya(this.layoutVertexArray,x.x,x.y,C.x,C.y,0,1,d);const R=s.segment.vertexLength;this.indexArray.emplaceBack(R,R+2,R+1),this.indexArray.emplaceBack(R+1,R+2,R+3),s.segment.vertexLength+=4,s.segment.primitiveLength+=2}}}function of(l,r){for(let s=0;s<r.length;s++){const d=r[s];s===r.length-1&&r[0].x===d.x&&r[0].y===d.y||(l.x+=d.x,l.y+=d.y,l.sampleCount++)}}function k0(l,r){return l.x===r.x&&(l.x<0||l.x>je)||l.y===r.y&&(l.y<0||l.y>je)}function Ai(l){return l.every(r=>r.x<0)||l.every(r=>r.x>je)||l.every(r=>r.y<0)||l.every(r=>r.y>je)}let A0;Ut("FillExtrusionBucket",xy,{omit:["layers","features"]});var R0={get paint(){return A0=A0||new Ti({"fill-extrusion-opacity":new Xt(Ze["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new cr(Ze["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Xt(Ze["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Xt(Ze["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ic(Ze["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new cr(Ze["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new cr(Ze["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Xt(Ze["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class E1 extends Zo{constructor(r,s){super(r,R0,s)}createBucket(r){return new xy(r)}queryRadius(){return cp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:r,feature:s,featureState:d,geometry:g,transform:_,pixelsToTileUnits:x,pixelPosMatrix:C}){const E=Jd(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-_.bearingInRadians,x),R=this.paint.get("fill-extrusion-height").evaluate(s,d),L=this.paint.get("fill-extrusion-base").evaluate(s,d),V=function(Z,J){const ee=[];for(const ne of Z){const fe=[ne.x,ne.y,0,1];gt(fe,fe,J),ee.push(new b(fe[0]/fe[3],fe[1]/fe[3]))}return ee}(E,C),H=function(Z,J,ee,ne){const fe=[],Te=[],pe=ne[8]*J,me=ne[9]*J,Ie=ne[10]*J,Fe=ne[11]*J,nt=ne[8]*ee,bt=ne[9]*ee,mt=ne[10]*ee,Pt=ne[11]*ee;for(const Bt of Z){const kt=[],vt=[];for(const ht of Bt){const Kt=ht.x,Ht=ht.y,Jt=ne[0]*Kt+ne[4]*Ht+ne[12],Gt=ne[1]*Kt+ne[5]*Ht+ne[13],dr=ne[2]*Kt+ne[6]*Ht+ne[14],cn=ne[3]*Kt+ne[7]*Ht+ne[15],Jr=dr+Ie,yi=cn+Fe,rs=Jt+nt,so=Gt+bt,vi=dr+mt,ci=cn+Pt,Tn=new b((Jt+pe)/yi,(Gt+me)/yi);Tn.z=Jr/yi,kt.push(Tn);const Di=new b(rs/ci,so/ci);Di.z=vi/ci,vt.push(Di)}fe.push(kt),Te.push(vt)}return[fe,Te]}(g,L,R,C);return function(Z,J,ee){let ne=1/0;ay(ee,J)&&(ne=by(ee,J[0]));for(let fe=0;fe<J.length;fe++){const Te=J[fe],pe=Z[fe];for(let me=0;me<Te.length-1;me++){const Ie=Te[me],Fe=[Ie,Te[me+1],pe[me+1],pe[me],Ie];Iu(ee,Fe)&&(ne=Math.min(ne,by(ee,Fe)))}}return ne!==1/0&&ne}(H[0],H[1],V)}}function yp(l,r){return l.x*r.x+l.y*r.y}function by(l,r){if(l.length===1){let s=0;const d=r[s++];let g;for(;!g||d.equals(g);)if(g=r[s++],!g)return 1/0;for(;s<r.length;s++){const _=r[s],x=l[0],C=g.sub(d),E=_.sub(d),R=x.sub(d),L=yp(C,C),V=yp(C,E),H=yp(E,E),Z=yp(R,C),J=yp(R,E),ee=L*H-V*V,ne=(H*Z-V*J)/ee,fe=(L*J-V*Z)/ee,Te=d.z*(1-ne-fe)+g.z*ne+_.z*fe;if(isFinite(Te))return Te}return 1/0}{let s=1/0;for(const d of r)s=Math.min(s,d.z);return s}}const D0=gi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:I1}=D0,ya=gi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:wy}=ya,k1=Math.cos(Math.PI/180*37.5),jc=Math.pow(2,14)/.5;class sf{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new Oe,this.layoutVertexArray2=new Ce,this.indexArray=new at,this.programConfigurations=new $l(r.layers,r.zoom),this.segments=new Nt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,d){this.hasDependencies=pp("line",this.layers,s)||this.hasLineDasharray(this.layers);const g=this.layers[0].layout.get("line-sort-key"),_=!g.isConstant(),x=[];for(const{feature:C,id:E,index:R,sourceLayerIndex:L}of r){const V=this.layers[0]._featureFilter.needGeometry,H=Ha(C,V);if(!this.layers[0]._featureFilter.filter(new Sn(this.zoom),H,d))continue;const Z=_?g.evaluate(H,{},d):void 0,J={id:E,properties:C.properties,type:C.type,sourceLayerIndex:L,index:R,geometry:V?H.geometry:pa(C),patterns:{},dashes:{},sortKey:Z};x.push(J)}_&&x.sort((C,E)=>C.sortKey-E.sortKey);for(const C of x){const{geometry:E,index:R,sourceLayerIndex:L}=C;this.hasDependencies?(pp("line",this.layers,s)?Im("line",this.layers,C,{zoom:this.zoom},s):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,C,this.zoom,s),this.patternFeatures.push(C)):this.addFeature(C,E,R,d,{},{},s.subdivisionGranularity),s.featureIndex.insert(r[R].feature,E,R,L,this.index)}}update(r,s,d,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,{imagePositions:d,dashPositions:g})}addFeatures(r,s,d,g){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,s,d,g,r.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,wy)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,I1),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,s,d,g,_,x,C){const E=this.layers[0].layout,R=E.get("line-join").evaluate(r,{}),L=E.get("line-cap"),V=E.get("line-miter-limit"),H=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const Z of s)this.addLine(Z,r,R,L,V,H,g,C);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,d,{imagePositions:_,dashPositions:x,canonical:g})}addLine(r,s,d,g,_,x,C,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,r=Ms(r,C?E.line.getGranularityForZoomLevel(C.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let pe=0;pe<r.length-1;pe++)this.totalDistance+=r[pe].dist(r[pe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const R=Ka.types[s.type]==="Polygon";let L=r.length;for(;L>=2&&r[L-1].equals(r[L-2]);)L--;let V=0;for(;V<L-1&&r[V].equals(r[V+1]);)V++;if(L<(R?3:2))return;d==="bevel"&&(_=1.05);const H=this.overscaling<=16?122880/(512*this.overscaling):0,Z=this.segments.prepareSegment(10*L,this.layoutVertexArray,this.indexArray);let J,ee,ne,fe,Te;this.e1=this.e2=-1,R&&(J=r[L-2],Te=r[V].sub(J)._unit()._perp());for(let pe=V;pe<L;pe++){if(ne=pe===L-1?R?r[V+1]:void 0:r[pe+1],ne&&r[pe].equals(ne))continue;Te&&(fe=Te),J&&(ee=J),J=r[pe],Te=ne?ne.sub(J)._unit()._perp():fe,fe=fe||Te;let me=fe.add(Te);me.x===0&&me.y===0||me._unit();const Ie=fe.x*Te.x+fe.y*Te.y,Fe=me.x*Te.x+me.y*Te.y,nt=Fe!==0?1/Fe:1/0,bt=2*Math.sqrt(2-2*Fe),mt=Fe<k1&&ee&&ne,Pt=fe.x*Te.y-fe.y*Te.x>0;if(mt&&pe>V){const vt=J.dist(ee);if(vt>2*H){const ht=J.sub(J.sub(ee)._mult(H/vt)._round());this.updateDistance(ee,ht),this.addCurrentVertex(ht,fe,0,0,Z),ee=ht}}const Bt=ee&&ne;let kt=Bt?d:R?"butt":g;if(Bt&&kt==="round"&&(nt<x?kt="miter":nt<=2&&(kt="fakeround")),kt==="miter"&&nt>_&&(kt="bevel"),kt==="bevel"&&(nt>2&&(kt="flipbevel"),nt<_&&(kt="miter")),ee&&this.updateDistance(ee,J),kt==="miter")me._mult(nt),this.addCurrentVertex(J,me,0,0,Z);else if(kt==="flipbevel"){if(nt>100)me=Te.mult(-1);else{const vt=nt*fe.add(Te).mag()/fe.sub(Te).mag();me._perp()._mult(vt*(Pt?-1:1))}this.addCurrentVertex(J,me,0,0,Z),this.addCurrentVertex(J,me.mult(-1),0,0,Z)}else if(kt==="bevel"||kt==="fakeround"){const vt=-Math.sqrt(nt*nt-1),ht=Pt?vt:0,Kt=Pt?0:vt;if(ee&&this.addCurrentVertex(J,fe,ht,Kt,Z),kt==="fakeround"){const Ht=Math.round(180*bt/Math.PI/20);for(let Jt=1;Jt<Ht;Jt++){let Gt=Jt/Ht;if(Gt!==.5){const cn=Gt-.5;Gt+=Gt*cn*(Gt-1)*((1.0904+Ie*(Ie*(3.55645-1.43519*Ie)-3.2452))*cn*cn+(.848013+Ie*(.215638*Ie-1.06021)))}const dr=Te.sub(fe)._mult(Gt)._add(fe)._unit()._mult(Pt?-1:1);this.addHalfVertex(J,dr.x,dr.y,!1,Pt,0,Z)}}ne&&this.addCurrentVertex(J,Te,-ht,-Kt,Z)}else if(kt==="butt")this.addCurrentVertex(J,me,0,0,Z);else if(kt==="square"){const vt=ee?1:-1;this.addCurrentVertex(J,me,vt,vt,Z)}else kt==="round"&&(ee&&(this.addCurrentVertex(J,fe,0,0,Z),this.addCurrentVertex(J,fe,1,1,Z,!0)),ne&&(this.addCurrentVertex(J,Te,-1,-1,Z,!0),this.addCurrentVertex(J,Te,0,0,Z)));if(mt&&pe<L-1){const vt=J.dist(ne);if(vt>2*H){const ht=J.add(ne.sub(J)._mult(H/vt)._round());this.updateDistance(J,ht),this.addCurrentVertex(ht,Te,0,0,Z),J=ht}}}}addCurrentVertex(r,s,d,g,_,x=!1){const C=s.y*g-s.x,E=-s.y-s.x*g;this.addHalfVertex(r,s.x+s.y*d,s.y-s.x*d,x,!1,d,_),this.addHalfVertex(r,C,E,x,!0,-g,_),this.distance>jc/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(r,s,d,g,_,x))}addHalfVertex({x:r,y:s},d,g,_,x,C,E){const R=.5*(this.lineClips?this.scaledDistance*(jc-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r<<1)+(_?1:0),(s<<1)+(x?1:0),Math.round(63*d)+128,Math.round(63*g)+128,1+(C===0?0:C<0?-1:1)|(63&R)<<2,R>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const L=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,L,this.e2),E.primitiveLength++),x?this.e2=L:this.e1=L}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(r,s){this.distance+=r.dist(s),this.updateScaledDistance()}hasLineDasharray(r){for(const s of r){const d=s.paint.get("line-dasharray");if(d&&!d.isConstant())return!0}return!1}addLineDashDependencies(r,s,d,g){for(const _ of r){const x=_.paint.get("line-dasharray");if(!x||x.value.kind==="constant")continue;const C=_.layout.get("line-cap")==="round",E={dasharray:x.value.evaluate({zoom:d-1},s,{}),round:C},R={dasharray:x.value.evaluate({zoom:d},s,{}),round:C},L={dasharray:x.value.evaluate({zoom:d+1},s,{}),round:C},V=`${E.dasharray.join(",")},${E.round}`,H=`${R.dasharray.join(",")},${R.round}`,Z=`${L.dasharray.join(",")},${L.round}`;g.dashDependencies[V]=E,g.dashDependencies[H]=R,g.dashDependencies[Z]=L,s.dashes[_.id]={min:V,mid:H,max:Z}}}}let $u,vp;Ut("LineBucket",sf,{omit:["layers","patternFeatures"]});var Lm={get paint(){return vp=vp||new Ti({"line-opacity":new cr(Ze.paint_line["line-opacity"]),"line-color":new cr(Ze.paint_line["line-color"]),"line-translate":new Xt(Ze.paint_line["line-translate"]),"line-translate-anchor":new Xt(Ze.paint_line["line-translate-anchor"]),"line-width":new cr(Ze.paint_line["line-width"]),"line-gap-width":new cr(Ze.paint_line["line-gap-width"]),"line-offset":new cr(Ze.paint_line["line-offset"]),"line-blur":new cr(Ze.paint_line["line-blur"]),"line-dasharray":new Ic(Ze.paint_line["line-dasharray"]),"line-pattern":new Ic(Ze.paint_line["line-pattern"]),"line-gradient":new Ss(Ze.paint_line["line-gradient"])})},get layout(){return $u=$u||new Ti({"line-cap":new Xt(Ze.layout_line["line-cap"]),"line-join":new cr(Ze.layout_line["line-join"]),"line-miter-limit":new Xt(Ze.layout_line["line-miter-limit"]),"line-round-limit":new Xt(Ze.layout_line["line-round-limit"]),"line-sort-key":new cr(Ze.layout_line["line-sort-key"])})}};class Sy extends cr{possiblyEvaluate(r,s){return s=new Sn(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),super.possiblyEvaluate(r,s)}evaluate(r,s,d,g){return s=tt({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(r,s,d,g)}}let Fm;class Cy extends Zo{constructor(r,s){super(r,Lm,s),this.gradientVersion=0,Fm||(Fm=new Sy(Lm.paint.properties["line-width"].specification),Fm.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const s=this.gradientExpression();this.stepInterpolant=!!function(d){return d._styleExpression!==void 0}(s)&&s._styleExpression.expression instanceof ra,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,s){super.recalculate(r,s),this.paint._values["line-floorwidth"]=Fm.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new sf(r)}queryRadius(r){const s=r,d=z0(Yd("line-width",this,s),Yd("line-gap-width",this,s)),g=Yd("line-offset",this,s);return d/2+Math.abs(g)+cp(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:r,feature:s,featureState:d,geometry:g,transform:_,pixelsToTileUnits:x}){const C=Jd(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-_.bearingInRadians,x),E=x/2*z0(this.paint.get("line-width").evaluate(s,d),this.paint.get("line-gap-width").evaluate(s,d)),R=this.paint.get("line-offset").evaluate(s,d);return R&&(g=function(L,V){const H=[];for(let Z=0;Z<L.length;Z++){const J=y0(L[Z]),ee=[];for(let ne=0;ne<J.length;ne++){const fe=J[ne],Te=J[ne-1],pe=J[ne+1],me=ne===0?new b(0,0):fe.sub(Te)._unit()._perp(),Ie=ne===J.length-1?new b(0,0):pe.sub(fe)._unit()._perp(),Fe=me._add(Ie)._unit(),nt=Fe.x*Ie.x+Fe.y*Ie.y;nt!==0&&Fe._mult(1/nt),ee.push(Fe._mult(V)._add(fe))}H.push(ee)}return H}(g,R*x)),function(L,V,H){for(let Z=0;Z<V.length;Z++){const J=V[Z];if(L.length>=3){for(let ee=0;ee<J.length;ee++)if(Oc(L,J[ee]))return!0}if(ly(L,J,H))return!0}return!1}(C,g,E)}isTileClipped(){return!0}}function z0(l,r){return r>0?r+2*l:l}const O0=gi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),L0=gi([{name:"a_projected_pos",components:3,type:"Float32"}],4);gi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Bm=gi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);gi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const _p=gi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),F0=gi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Ty(l,r,s){return l.sections.forEach(d=>{d.text=function(g,_,x){const C=_.layout.get("text-transform").evaluate(x,{});return C==="uppercase"?g=g.toLocaleUpperCase():C==="lowercase"&&(g=g.toLocaleLowerCase()),$a.applyArabicShaping&&(g=$a.applyArabicShaping(g)),g}(d.text,r,s)}),l}gi([{name:"triangle",components:3,type:"Uint16"}]),gi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),gi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),gi([{type:"Float32",name:"offsetX"}]),gi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),gi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var oo=24;const af={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},My={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},$m={40:!0};function jm(l,r,s,d,g,_){if("fontStack"in r){const x=s[r.fontStack],C=x&&x[l];return C?C.metrics.advance*r.scale+g:0}{const x=d[r.imageName];return x?x.displaySize[0]*r.scale*oo/_+g:0}}function xp(l,r,s,d){const g=Math.pow(l-r,2);return d?l<r?g/2:2*g:g+Math.abs(s)*s}function B0(l,r,s){let d=0;return l===10&&(d-=1e4),s&&(d+=150),l!==40&&l!==65288||(d+=50),r!==41&&r!==65289||(d+=50),d}function $0(l,r,s,d,g,_){let x=null,C=xp(r,s,g,_);for(const E of d){const R=xp(r-E.x,s,g,_)+E.badness;R<=C&&(x=E,C=R)}return{index:l,x:r,priorBreak:x,badness:C}}function bp(l){return l?bp(l.priorBreak).concat(l.index):[]}class lf{constructor(r="",s=[],d=[]){this.text=r,this.sections=s,this.sectionIndex=d,this.imageSectionID=null}static fromFeature(r,s){const d=new lf;for(let g=0;g<r.sections.length;g++){const _=r.sections[g];_.image?d.addImageSection(_):d.addTextSection(_,s)}return d}length(){return[...this.text].length}getSection(r){return this.sections[this.sectionIndex[r]]}getSectionIndex(r){return this.sectionIndex[r]}verticalizePunctuation(){this.text=function(r){let s="",d={premature:!0,value:void 0};const g=r[Symbol.iterator]();let _=g.next();const x=r[Symbol.iterator]();x.next();let C=x.next();for(;!_.done;)s+=!C.done&&zl(C.value.codePointAt(0))&&!af[C.value]||!d.premature&&zl(d.value.codePointAt(0))&&!af[d.value]||!af[_.value]?_.value:af[_.value],d={value:_.value,premature:!1},_=g.next(),C=x.next();return s}(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const r=this.text.match(/^\s*/),s=r?r[0].length:0,d=this.text.match(/\S\s*$/),g=d?d[0].length-1:0;this.text=this.text.substring(s,this.text.length-g),this.sectionIndex=this.sectionIndex.slice(s,this.sectionIndex.length-g)}substring(r,s){const d=[...this.text].slice(r,s).join(""),g=this.sectionIndex.slice(r,s);return new lf(d,this.sections,g)}toCodeUnitIndex(r){return[...this.text].slice(0,r).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,s)=>Math.max(r,this.sections[s].scale),0)}getMaxImageSize(r){let s=0,d=0;for(let g=0;g<this.length();g++){const _=this.getSection(g);if("imageName"in _){const x=r[_.imageName];if(!x)continue;const C=x.displaySize;s=Math.max(s,C[0]),d=Math.max(d,C[1])}}return{maxImageWidth:s,maxImageHeight:d}}addTextSection(r,s){this.text+=r.text,this.sections.push({scale:r.scale||1,verticalAlign:r.verticalAlign||"bottom",fontStack:r.fontStack||s});const d=this.sections.length-1;this.sectionIndex.push(...[...r.text].map(()=>d))}addImageSection(r){const s=r.image?r.image.name:"";if(s.length===0)return void wr("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push({scale:1,verticalAlign:r.verticalAlign||"bottom",imageName:s}),this.sectionIndex.push(this.sections.length-1)):wr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(r,s,d,g,_){const x=[],C=this.determineAverageLineWidth(r,s,d,g,_),E=this.hasZeroWidthSpaces();let R=0,L=0;const V=this.text[Symbol.iterator]();let H=V.next();const Z=this.text[Symbol.iterator]();Z.next();let J=Z.next();const ee=this.text[Symbol.iterator]();ee.next(),ee.next();let ne=ee.next();for(;!H.done;){const fe=this.getSection(L),Te=H.value.codePointAt(0);if(ip(Te)||(R+=jm(Te,fe,d,g,r,_)),!J.done){const pe=Lo(Te),me=J.value.codePointAt(0);(My[Te]||pe||"imageName"in fe||!ne.done&&$m[me])&&x.push($0(L+1,R,C,x,B0(Te,me,pe&&E),!1))}L++,H=V.next(),J=Z.next(),ne=ee.next()}return bp($0(this.length(),R,C,x,0,!0))}determineAverageLineWidth(r,s,d,g,_){let x=0,C=0;for(const E of this.text){const R=this.getSection(C);x+=jm(E.codePointAt(0),R,d,g,r,_),C++}return x/Math.max(1,Math.ceil(x/s))}}const Hh=4294967296,j0=1/Hh,wp=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class p{constructor(r=new Uint8Array(16)){this.buf=ArrayBuffer.isView(r)?r:new Uint8Array(r),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(r,s,d=this.length){for(;this.pos<d;){const g=this.readVarint(),_=g>>3,x=this.pos;this.type=7&g,r(_,s,this),this.pos===x&&this.skip(g)}return s}readMessage(r,s){return this.readFields(r,s,this.readVarint()+this.pos)}readFixed32(){const r=this.dataView.getUint32(this.pos,!0);return this.pos+=4,r}readSFixed32(){const r=this.dataView.getInt32(this.pos,!0);return this.pos+=4,r}readFixed64(){const r=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Hh;return this.pos+=8,r}readSFixed64(){const r=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Hh;return this.pos+=8,r}readFloat(){const r=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,r}readDouble(){const r=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,r}readVarint(r){const s=this.buf;let d,g;return g=s[this.pos++],d=127&g,g<128?d:(g=s[this.pos++],d|=(127&g)<<7,g<128?d:(g=s[this.pos++],d|=(127&g)<<14,g<128?d:(g=s[this.pos++],d|=(127&g)<<21,g<128?d:(g=s[this.pos],d|=(15&g)<<28,function(_,x,C){const E=C.buf;let R,L;if(L=E[C.pos++],R=(112&L)>>4,L<128||(L=E[C.pos++],R|=(127&L)<<3,L<128)||(L=E[C.pos++],R|=(127&L)<<10,L<128)||(L=E[C.pos++],R|=(127&L)<<17,L<128)||(L=E[C.pos++],R|=(127&L)<<24,L<128)||(L=E[C.pos++],R|=(1&L)<<31,L<128))return y(_,R,x);throw new Error("Expected varint not more than 10 bytes")}(d,r,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const r=this.readVarint();return r%2==1?(r+1)/-2:r/2}readBoolean(){return!!this.readVarint()}readString(){const r=this.readVarint()+this.pos,s=this.pos;return this.pos=r,r-s>=12&&wp?wp.decode(this.buf.subarray(s,r)):function(d,g,_){let x="",C=g;for(;C<_;){const E=d[C];let R,L,V,H=null,Z=E>239?4:E>223?3:E>191?2:1;if(C+Z>_)break;Z===1?E<128&&(H=E):Z===2?(R=d[C+1],(192&R)==128&&(H=(31&E)<<6|63&R,H<=127&&(H=null))):Z===3?(R=d[C+1],L=d[C+2],(192&R)==128&&(192&L)==128&&(H=(15&E)<<12|(63&R)<<6|63&L,(H<=2047||H>=55296&&H<=57343)&&(H=null))):Z===4&&(R=d[C+1],L=d[C+2],V=d[C+3],(192&R)==128&&(192&L)==128&&(192&V)==128&&(H=(15&E)<<18|(63&R)<<12|(63&L)<<6|63&V,(H<=65535||H>=1114112)&&(H=null))),H===null?(H=65533,Z=1):H>65535&&(H-=65536,x+=String.fromCharCode(H>>>10&1023|55296),H=56320|1023&H),x+=String.fromCharCode(H),C+=Z}return x}(this.buf,s,r)}readBytes(){const r=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,r);return this.pos=r,s}readPackedVarint(r=[],s){const d=this.readPackedEnd();for(;this.pos<d;)r.push(this.readVarint(s));return r}readPackedSVarint(r=[]){const s=this.readPackedEnd();for(;this.pos<s;)r.push(this.readSVarint());return r}readPackedBoolean(r=[]){const s=this.readPackedEnd();for(;this.pos<s;)r.push(this.readBoolean());return r}readPackedFloat(r=[]){const s=this.readPackedEnd();for(;this.pos<s;)r.push(this.readFloat());return r}readPackedDouble(r=[]){const s=this.readPackedEnd();for(;this.pos<s;)r.push(this.readDouble());return r}readPackedFixed32(r=[]){const s=this.readPackedEnd();for(;this.pos<s;)r.push(this.readFixed32());return r}readPackedSFixed32(r=[]){const s=this.readPackedEnd();for(;this.pos<s;)r.push(this.readSFixed32());return r}readPackedFixed64(r=[]){const s=this.readPackedEnd();for(;this.pos<s;)r.push(this.readFixed64());return r}readPackedSFixed64(r=[]){const s=this.readPackedEnd();for(;this.pos<s;)r.push(this.readSFixed64());return r}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(r){const s=7&r;if(s===0)for(;this.buf[this.pos++]>127;);else if(s===2)this.pos=this.readVarint()+this.pos;else if(s===5)this.pos+=4;else{if(s!==1)throw new Error(`Unimplemented type: ${s}`);this.pos+=8}}writeTag(r,s){this.writeVarint(r<<3|s)}realloc(r){let s=this.length||16;for(;s<this.pos+r;)s*=2;if(s!==this.length){const d=new Uint8Array(s);d.set(this.buf),this.buf=d,this.dataView=new DataView(d.buffer),this.length=s}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(r){this.realloc(4),this.dataView.setInt32(this.pos,r,!0),this.pos+=4}writeSFixed32(r){this.realloc(4),this.dataView.setInt32(this.pos,r,!0),this.pos+=4}writeFixed64(r){this.realloc(8),this.dataView.setInt32(this.pos,-1&r,!0),this.dataView.setInt32(this.pos+4,Math.floor(r*j0),!0),this.pos+=8}writeSFixed64(r){this.realloc(8),this.dataView.setInt32(this.pos,-1&r,!0),this.dataView.setInt32(this.pos+4,Math.floor(r*j0),!0),this.pos+=8}writeVarint(r){(r=+r||0)>268435455||r<0?function(s,d){let g,_;if(s>=0?(g=s%4294967296|0,_=s/4294967296|0):(g=~(-s%4294967296),_=~(-s/4294967296),4294967295^g?g=g+1|0:(g=0,_=_+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");d.realloc(10),function(x,C,E){E.buf[E.pos++]=127&x|128,x>>>=7,E.buf[E.pos++]=127&x|128,x>>>=7,E.buf[E.pos++]=127&x|128,x>>>=7,E.buf[E.pos++]=127&x|128,E.buf[E.pos]=127&(x>>>=7)}(g,0,d),function(x,C){const E=(7&x)<<4;C.buf[C.pos++]|=E|((x>>>=3)?128:0),x&&(C.buf[C.pos++]=127&x|((x>>>=7)?128:0),x&&(C.buf[C.pos++]=127&x|((x>>>=7)?128:0),x&&(C.buf[C.pos++]=127&x|((x>>>=7)?128:0),x&&(C.buf[C.pos++]=127&x|((x>>>=7)?128:0),x&&(C.buf[C.pos++]=127&x)))))}(_,d)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))}writeSVarint(r){this.writeVarint(r<0?2*-r-1:2*r)}writeBoolean(r){this.writeVarint(+r)}writeString(r){r=String(r),this.realloc(4*r.length),this.pos++;const s=this.pos;this.pos=function(g,_,x){for(let C,E,R=0;R<_.length;R++){if(C=_.charCodeAt(R),C>55295&&C<57344){if(!E){C>56319||R+1===_.length?(g[x++]=239,g[x++]=191,g[x++]=189):E=C;continue}if(C<56320){g[x++]=239,g[x++]=191,g[x++]=189,E=C;continue}C=E-55296<<10|C-56320|65536,E=null}else E&&(g[x++]=239,g[x++]=191,g[x++]=189,E=null);C<128?g[x++]=C:(C<2048?g[x++]=C>>6|192:(C<65536?g[x++]=C>>12|224:(g[x++]=C>>18|240,g[x++]=C>>12&63|128),g[x++]=C>>6&63|128),g[x++]=63&C|128)}return x}(this.buf,r,this.pos);const d=this.pos-s;d>=128&&T(s,d,this),this.pos=s-1,this.writeVarint(d),this.pos+=d}writeFloat(r){this.realloc(4),this.dataView.setFloat32(this.pos,r,!0),this.pos+=4}writeDouble(r){this.realloc(8),this.dataView.setFloat64(this.pos,r,!0),this.pos+=8}writeBytes(r){const s=r.length;this.writeVarint(s),this.realloc(s);for(let d=0;d<s;d++)this.buf[this.pos++]=r[d]}writeRawMessage(r,s){this.pos++;const d=this.pos;r(s,this);const g=this.pos-d;g>=128&&T(d,g,this),this.pos=d-1,this.writeVarint(g),this.pos+=g}writeMessage(r,s,d){this.writeTag(r,2),this.writeRawMessage(s,d)}writePackedVarint(r,s){s.length&&this.writeMessage(r,A,s)}writePackedSVarint(r,s){s.length&&this.writeMessage(r,N,s)}writePackedBoolean(r,s){s.length&&this.writeMessage(r,Le,s)}writePackedFloat(r,s){s.length&&this.writeMessage(r,W,s)}writePackedDouble(r,s){s.length&&this.writeMessage(r,he,s)}writePackedFixed32(r,s){s.length&&this.writeMessage(r,Ne,s)}writePackedSFixed32(r,s){s.length&&this.writeMessage(r,pt,s)}writePackedFixed64(r,s){s.length&&this.writeMessage(r,Ot,s)}writePackedSFixed64(r,s){s.length&&this.writeMessage(r,Lt,s)}writeBytesField(r,s){this.writeTag(r,2),this.writeBytes(s)}writeFixed32Field(r,s){this.writeTag(r,5),this.writeFixed32(s)}writeSFixed32Field(r,s){this.writeTag(r,5),this.writeSFixed32(s)}writeFixed64Field(r,s){this.writeTag(r,1),this.writeFixed64(s)}writeSFixed64Field(r,s){this.writeTag(r,1),this.writeSFixed64(s)}writeVarintField(r,s){this.writeTag(r,0),this.writeVarint(s)}writeSVarintField(r,s){this.writeTag(r,0),this.writeSVarint(s)}writeStringField(r,s){this.writeTag(r,2),this.writeString(s)}writeFloatField(r,s){this.writeTag(r,5),this.writeFloat(s)}writeDoubleField(r,s){this.writeTag(r,1),this.writeDouble(s)}writeBooleanField(r,s){this.writeVarintField(r,+s)}}function y(l,r,s){return s?4294967296*r+(l>>>0):4294967296*(r>>>0)+(l>>>0)}function T(l,r,s){const d=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));s.realloc(d);for(let g=s.pos-1;g>=l;g--)s.buf[g+d]=s.buf[g]}function A(l,r){for(let s=0;s<l.length;s++)r.writeVarint(l[s])}function N(l,r){for(let s=0;s<l.length;s++)r.writeSVarint(l[s])}function W(l,r){for(let s=0;s<l.length;s++)r.writeFloat(l[s])}function he(l,r){for(let s=0;s<l.length;s++)r.writeDouble(l[s])}function Le(l,r){for(let s=0;s<l.length;s++)r.writeBoolean(l[s])}function Ne(l,r){for(let s=0;s<l.length;s++)r.writeFixed32(l[s])}function pt(l,r){for(let s=0;s<l.length;s++)r.writeSFixed32(l[s])}function Ot(l,r){for(let s=0;s<l.length;s++)r.writeFixed64(l[s])}function Lt(l,r){for(let s=0;s<l.length;s++)r.writeSFixed64(l[s])}function zt(l,r,s){l===1&&s.readMessage(lr,r)}function lr(l,r,s){if(l===3){const{id:d,bitmap:g,width:_,height:x,left:C,top:E,advance:R}=s.readMessage(pr,{});r.push({id:d,bitmap:new tf({width:_+6,height:x+6},g),metrics:{width:_,height:x,left:C,top:E,advance:R}})}}function pr(l,r,s){l===1?r.id=s.readVarint():l===2?r.bitmap=s.readBytes():l===3?r.width=s.readVarint():l===4?r.height=s.readVarint():l===5?r.left=s.readSVarint():l===6?r.top=s.readSVarint():l===7&&(r.advance=s.readVarint())}function gr(l){let r=0,s=0;for(const x of l)r+=x.w*x.h,s=Math.max(s,x.w);l.sort((x,C)=>C.h-x.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),s),h:1/0}];let g=0,_=0;for(const x of l)for(let C=d.length-1;C>=0;C--){const E=d[C];if(!(x.w>E.w||x.h>E.h)){if(x.x=E.x,x.y=E.y,_=Math.max(_,x.y+x.h),g=Math.max(g,x.x+x.w),x.w===E.w&&x.h===E.h){const R=d.pop();R&&C<d.length&&(d[C]=R)}else x.h===E.h?(E.x+=x.w,E.w-=x.w):x.w===E.w?(E.y+=x.h,E.h-=x.h):(d.push({x:E.x+x.w,y:E.y,w:E.w-x.w,h:x.h}),E.y+=x.h,E.h-=x.h);break}}return{w:g,h:_,fill:r/(g*_)||0}}class Ri{constructor(r,{pixelRatio:s,version:d,stretchX:g,stretchY:_,content:x,textFitWidth:C,textFitHeight:E}){this.paddedRect=r,this.pixelRatio=s,this.stretchX=g,this.stretchY=_,this.content=x,this.version=d,this.textFitWidth=C,this.textFitHeight=E}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class lt{constructor(r,s){const d={},g={};this.haveRenderCallbacks=[];const _=[];this.addImages(r,d,_),this.addImages(s,g,_);const{w:x,h:C}=gr(_),E=new Jo({width:x||1,height:C||1});for(const R in r){const L=r[R],V=d[R].paddedRect;Jo.copy(L.data,E,{x:0,y:0},{x:V.x+1,y:V.y+1},L.data)}for(const R in s){const L=s[R],V=g[R].paddedRect,H=V.x+1,Z=V.y+1,J=L.data.width,ee=L.data.height;Jo.copy(L.data,E,{x:0,y:0},{x:H,y:Z},L.data),Jo.copy(L.data,E,{x:0,y:ee-1},{x:H,y:Z-1},{width:J,height:1}),Jo.copy(L.data,E,{x:0,y:0},{x:H,y:Z+ee},{width:J,height:1}),Jo.copy(L.data,E,{x:J-1,y:0},{x:H-1,y:Z},{width:1,height:ee}),Jo.copy(L.data,E,{x:0,y:0},{x:H+J,y:Z},{width:1,height:ee})}this.image=E,this.iconPositions=d,this.patternPositions=g}addImages(r,s,d){for(const g in r){const _=r[g],x={x:0,y:0,w:_.data.width+2,h:_.data.height+2};d.push(x),s[g]=new Ri(x,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(r,s){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in r.updatedImages)this.patchUpdatedImage(this.iconPositions[d],r.getImage(d),s),this.patchUpdatedImage(this.patternPositions[d],r.getImage(d),s)}patchUpdatedImage(r,s,d){if(!r||!s||r.version===s.version)return;r.version=s.version;const[g,_]=r.tl;d.update(s.data,void 0,{x:g,y:_})}}var We;function dt(l,r,s,d,g,_,x,C,E,R,L,V,H,Z,J){const ee=lf.fromFeature(l,g);let ne;V===f.az.vertical&&ee.verticalizePunctuation();let fe=ee.determineLineBreaks(R,_,r,d,Z);const{processBidirectionalText:Te,processStyledBidirectionalText:pe}=$a;if(Te&&ee.sections.length===1){ne=[],fe=fe.map(nt=>ee.toCodeUnitIndex(nt));const Fe=Te(ee.toString(),fe);for(const nt of Fe){const bt=[...nt].map(()=>0);ne.push(new lf(nt,ee.sections,bt))}}else if(pe){ne=[],fe=fe.map(mt=>ee.toCodeUnitIndex(mt));let Fe=0;const nt=[];for(const mt of ee.text)nt.push(...Array(mt.length).fill(ee.sectionIndex[Fe])),Fe++;const bt=pe(ee.text,nt,fe);for(const mt of bt){const Pt=[];let Bt="";for(const kt of mt[0])Pt.push(mt[1][Bt.length]),Bt+=kt;ne.push(new lf(mt[0],ee.sections,Pt))}}else ne=function(Fe,nt){const bt=[];let mt=0;for(const Pt of nt)bt.push(Fe.substring(mt,Pt)),mt=Pt;return mt<Fe.length()&&bt.push(Fe.substring(mt,Fe.length())),bt}(ee,fe);const me=[],Ie={positionedLines:me,text:ee.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:V,iconsInText:!1,verticalizable:!1};return function(Fe,nt,bt,mt,Pt,Bt,kt,vt,ht,Kt,Ht,Jt){let Gt=0,dr=0,cn=0,Jr=0;const yi=vt==="right"?1:vt==="left"?0:.5,rs=oo/Jt;let so=0;for(const Tn of Pt){Tn.trim();const Di=Tn.getMaxScale(),ji={positionedGlyphs:[],lineOffset:0};Fe.positionedLines[so]=ji;const si=ji.positionedGlyphs;let Zs=0;if(!Tn.length()){dr+=Bt,++so;continue}const ns=vr(mt,Tn,rs);let Xs=0;for(const ko of Tn.text){const Mi=Tn.getSection(Xs),ao=ko.codePointAt(0),zi=Ar(ht,Ht,ao),Ao={glyph:ao,imageName:null,x:Gt,y:dr+-17,vertical:zi,scale:1,fontStack:"",sectionIndex:Tn.getSectionIndex(Xs),metrics:null,rect:null};let Xh;if("fontStack"in Mi){if(Xh=$r(Mi,ao,zi,ns,nt,bt),!Xh)continue;Ao.fontStack=Mi.fontStack}else{if(Fe.iconsInText=!0,Mi.scale*=rs,Xh=Po(Mi,zi,Di,ns,mt),!Xh)continue;Zs=Math.max(Zs,Xh.imageOffset),Ao.imageName=Mi.imageName}const{rect:Uc,metrics:Dy,baselineOffset:ff}=Xh;Ao.y+=ff,Ao.scale=Mi.scale,Ao.metrics=Dy,Ao.rect=Uc,si.push(Ao),zi?(Fe.verticalizable=!0,Gt+=("imageName"in Mi?Dy.advance:oo)*Mi.scale+Kt):Gt+=Dy.advance*Mi.scale+Kt,Xs++}si.length!==0&&(cn=Math.max(Gt-Kt,cn),Cn(si,0,si.length-1,yi)),Gt=0,ji.lineOffset=Math.max(Zs,(Di-1)*oo);const Vl=Bt*Di+Zs;dr+=Vl,Jr=Math.max(Vl,Jr),++so}const{horizontalAlign:vi,verticalAlign:ci}=Vt(kt);(function(Tn,Di,ji,si,Zs,ns,Xs,Vl,ko){const Mi=(Di-ji)*Zs;let ao=0;ao=ns!==Xs?-Vl*si- -17:-si*ko*Xs+.5*Xs;for(const zi of Tn)for(const Ao of zi.positionedGlyphs)Ao.x+=Mi,Ao.y+=ao})(Fe.positionedLines,yi,vi,ci,cn,Jr,Bt,dr,Pt.length),Fe.top+=-ci*dr,Fe.bottom=Fe.top+dr,Fe.left+=-vi*cn,Fe.right=Fe.left+cn}(Ie,r,s,d,ne,x,C,E,V,R,H,J),!function(Fe){for(const nt of Fe)if(nt.positionedGlyphs.length!==0)return!1;return!0}(me)&&Ie}function Vt(l){let r=.5,s=.5;switch(l){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:r,verticalAlign:s}}function vr(l,r,s){const d=r.getMaxScale()*oo,{maxImageWidth:g,maxImageHeight:_}=r.getMaxImageSize(l),x=Math.max(d,_*s);return{verticalLineContentWidth:Math.max(d,g*s),horizontalLineContentHeight:x}}function Er(l){switch(l){case"top":return 0;case"center":return .5;default:return 1}}function Ar(l,r,s){return!(l===f.az.horizontal||!r&&!jd(s)||r&&(ip(s)||(d=s,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(d)))));var d}function $r(l,r,s,d,g,_){const x=_[l.fontStack],C=function(R,L,V,H){if(R&&R.rect)return R;const Z=L[V.fontStack],J=Z&&Z[H];return J?{rect:null,metrics:J.metrics}:null}(x&&x[r],g,l,r);if(C===null)return null;let E;if(s)E=d.verticalLineContentWidth-l.scale*oo;else{const R=Er(l.verticalAlign);E=(d.horizontalLineContentHeight-l.scale*oo)*R}return{rect:C.rect,metrics:C.metrics,baselineOffset:E}}function Po(l,r,s,d,g){const _=g[l.imageName];if(!_)return null;const x=_.paddedRect,C=_.displaySize,E={width:C[0],height:C[1],left:1,top:-3,advance:r?C[1]:C[0]};let R;if(r)R=d.verticalLineContentWidth-C[1]*l.scale;else{const L=Er(l.verticalAlign);R=(d.horizontalLineContentHeight-C[1]*l.scale)*L}return{rect:x,metrics:E,baselineOffset:R,imageOffset:(r?C[0]:C[1])*l.scale-oo*s}}function Cn(l,r,s,d){if(d===0)return;const g=l[s],_=(l[s].x+g.metrics.advance*g.scale)*d;for(let x=r;x<=s;x++)l[x].x-=_}function ju(l,r,s){const{horizontalAlign:d,verticalAlign:g}=Vt(s),_=r[0]-l.displaySize[0]*d,x=r[1]-l.displaySize[1]*g;return{image:l,top:x,bottom:x+l.displaySize[1],left:_,right:_+l.displaySize[0]}}function N0(l){var r,s;let d=l.left,g=l.top,_=l.right-d,x=l.bottom-g;const C=(r=l.image.textFitWidth)!==null&&r!==void 0?r:"stretchOrShrink",E=(s=l.image.textFitHeight)!==null&&s!==void 0?s:"stretchOrShrink",R=(l.image.content[2]-l.image.content[0])/(l.image.content[3]-l.image.content[1]);if(E==="proportional"){if(C==="stretchOnly"&&_/x<R||C==="proportional"){const L=Math.ceil(x*R);d*=L/_,_=L}}else if(C==="proportional"&&E==="stretchOnly"&&R!==0&&_/x>R){const L=Math.ceil(_/R);g*=L/x,x=L}return{x1:d,y1:g,x2:d+_,y2:g+x}}function DS(l,r,s,d,g,_){const x=l.image;let C;if(x.content){const ne=x.content,fe=x.pixelRatio||1;C=[ne[0]/fe,ne[1]/fe,x.displaySize[0]-ne[2]/fe,x.displaySize[1]-ne[3]/fe]}const E=r.left*_,R=r.right*_;let L,V,H,Z;s==="width"||s==="both"?(Z=g[0]+E-d[3],V=g[0]+R+d[1]):(Z=g[0]+(E+R-x.displaySize[0])/2,V=Z+x.displaySize[0]);const J=r.top*_,ee=r.bottom*_;return s==="height"||s==="both"?(L=g[1]+J-d[0],H=g[1]+ee+d[2]):(L=g[1]+(J+ee-x.displaySize[1])/2,H=L+x.displaySize[1]),{image:x,top:L,right:V,bottom:H,left:Z,collisionPadding:C}}Ut("ImagePosition",Ri),Ut("ImageAtlas",lt),f.az=void 0,(We=f.az||(f.az={}))[We.none=0]="none",We[We.horizontal=1]="horizontal",We[We.vertical=2]="vertical",We[We.horizontalOnly=3]="horizontalOnly";const Wh=128,cf=32640;function zS(l,r){const{expression:s}=r;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new Sn(l+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:d,interpolationType:g}=s;let _=0;for(;_<d.length&&d[_]<=l;)_++;_=Math.max(0,_-1);let x=_;for(;x<d.length&&d[x]<l+1;)x++;x=Math.min(d.length-1,x);const C=d[_],E=d[x];return s.kind==="composite"?{kind:"composite",minZoom:C,maxZoom:E,interpolationType:g}:{kind:"camera",minZoom:C,maxZoom:E,minSize:s.evaluate(new Sn(C)),maxSize:s.evaluate(new Sn(E)),interpolationType:g}}}function A1(l,r,s){let d="never";const g=l.get(r);return g?d=g:l.get(s)&&(d="always"),d}const g5=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function V0(l,r,s,d,g,_,x,C,E,R,L,V,H){const Z=C?Math.min(cf,Math.round(C[0])):0,J=C?Math.min(cf,Math.round(C[1])):0;l.emplaceBack(r,s,Math.round(32*d),Math.round(32*g),_,x,(Z<<1)+(E?1:0),J,16*R,16*L,256*V,256*H)}function R1(l,r,s){l.emplaceBack(r.x,r.y,s),l.emplaceBack(r.x,r.y,s),l.emplaceBack(r.x,r.y,s),l.emplaceBack(r.x,r.y,s)}function y5(l){for(const r of l.sections)if(Fh(r.text))return!0;return!1}class D1{constructor(r){this.layoutVertexArray=new Ae,this.indexArray=new at,this.programConfigurations=r,this.segments=new Nt,this.dynamicLayoutVertexArray=new Ue,this.opacityVertexArray=new ut,this.hasVisibleVertices=!1,this.placedSymbolArray=new M}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,s,d,g){this.isEmpty()||(d&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,O0.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,L0.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,g5,!0),this.opacityVertexBuffer.itemSize=1),(d||g)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ut("SymbolBuffers",D1);class z1{constructor(r,s,d){this.layoutVertexArray=new r,this.layoutAttributes=s,this.indexArray=new d,this.segments=new Nt,this.collisionVertexArray=new st}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,Bm.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ut("CollisionBuffers",z1);class Nm{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(x=>x.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=zS(this.zoom,s["text-size"]),this.iconSizeData=zS(this.zoom,s["icon-size"]);const d=this.layers[0].layout,g=d.get("symbol-sort-key"),_=d.get("symbol-z-order");this.canOverlap=A1(d,"text-overlap","text-allow-overlap")!=="never"||A1(d,"icon-overlap","icon-allow-overlap")!=="never"||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,d.get("symbol-placement")==="point"&&(this.writingModes=d.get("text-writing-mode").map(x=>f.az[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=r.sourceID}createArrays(){this.text=new D1(new $l(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new D1(new $l(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new B,this.lineVertexArray=new q,this.symbolInstances=new O,this.textAnchorOffsets=new X}calculateGlyphDependencies(r,s,d,g,_){for(const x of r)if(s[x.codePointAt(0)]=!0,(d||g)&&_){const C=af[x];C&&(s[C.codePointAt(0)]=!0)}}populate(r,s,d){const g=this.layers[0],_=g.layout,x=_.get("text-font"),C=_.get("text-field"),E=_.get("icon-image"),R=(C.value.kind!=="constant"||C.value.value instanceof Ji&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),L=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,V=_.get("symbol-sort-key");if(this.features=[],!R&&!L)return;const H=s.iconDependencies,Z=s.glyphDependencies,J=s.availableImages,ee=new Sn(this.zoom);for(const{feature:ne,id:fe,index:Te,sourceLayerIndex:pe}of r){const me=g._featureFilter.needGeometry,Ie=Ha(ne,me);if(!g._featureFilter.filter(ee,Ie,d))continue;let Fe,nt;if(me||(Ie.geometry=pa(ne)),R){const mt=g.getValueAndResolveTokens("text-field",Ie,d,J),Pt=Ji.factory(mt),Bt=this.hasRTLText=this.hasRTLText||y5(Pt);(!Bt||$a.getRTLTextPluginStatus()==="unavailable"||Bt&&$a.isParsed())&&(Fe=Ty(Pt,g,Ie))}if(L){const mt=g.getValueAndResolveTokens("icon-image",Ie,d,J);nt=mt instanceof Go?mt:Go.fromString(mt)}if(!Fe&&!nt)continue;const bt=this.sortFeaturesByKey?V.evaluate(Ie,{},d):void 0;if(this.features.push({id:fe,text:Fe,icon:nt,index:Te,sourceLayerIndex:pe,geometry:Ie.geometry,properties:ne.properties,type:Ka.types[ne.type],sortKey:bt}),nt&&(H[nt.name]=!0),Fe){const mt=x.evaluate(Ie,{},d).join(","),Pt=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(f.az.vertical)>=0;for(const Bt of Fe.sections)if(Bt.image)H[Bt.image.name]=!0;else{const kt=Dl(Fe.toString()),vt=Bt.fontStack||mt,ht=Z[vt]=Z[vt]||{};this.calculateGlyphDependencies(Bt.text,ht,Pt,this.allowVerticalPlacement,kt)}}}_.get("symbol-placement")==="line"&&(this.features=function(ne){const fe={},Te={},pe=[];let me=0;function Ie(mt){pe.push(ne[mt]),me++}function Fe(mt,Pt,Bt){const kt=Te[mt];return delete Te[mt],Te[Pt]=kt,pe[kt].geometry[0].pop(),pe[kt].geometry[0]=pe[kt].geometry[0].concat(Bt[0]),kt}function nt(mt,Pt,Bt){const kt=fe[Pt];return delete fe[Pt],fe[mt]=kt,pe[kt].geometry[0].shift(),pe[kt].geometry[0]=Bt[0].concat(pe[kt].geometry[0]),kt}function bt(mt,Pt,Bt){const kt=Bt?Pt[0][Pt[0].length-1]:Pt[0][0];return`${mt}:${kt.x}:${kt.y}`}for(let mt=0;mt<ne.length;mt++){const Pt=ne[mt],Bt=Pt.geometry,kt=Pt.text?Pt.text.toString():null;if(!kt){Ie(mt);continue}const vt=bt(kt,Bt),ht=bt(kt,Bt,!0);if(vt in Te&&ht in fe&&Te[vt]!==fe[ht]){const Kt=nt(vt,ht,Bt),Ht=Fe(vt,ht,pe[Kt].geometry);delete fe[vt],delete Te[ht],Te[bt(kt,pe[Ht].geometry,!0)]=Ht,pe[Kt].geometry=null}else vt in Te?Fe(vt,ht,Bt):ht in fe?nt(vt,ht,Bt):(Ie(mt),fe[vt]=me-1,Te[ht]=me-1)}return pe.filter(mt=>mt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ne,fe)=>ne.sortKey-fe.sortKey)}update(r,s,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,s,this.layers,{imagePositions:d}),this.icon.programConfigurations.updatePaintArrays(r,s,this.layers,{imagePositions:d}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,s){const d=this.lineVertexArray.length;if(r.segment!==void 0){let g=r.dist(s[r.segment+1]),_=r.dist(s[r.segment]);const x={};for(let C=r.segment+1;C<s.length;C++)x[C]={x:s[C].x,y:s[C].y,tileUnitDistanceFromAnchor:g},C<s.length-1&&(g+=s[C+1].dist(s[C]));for(let C=r.segment||0;C>=0;C--)x[C]={x:s[C].x,y:s[C].y,tileUnitDistanceFromAnchor:_},C>0&&(_+=s[C-1].dist(s[C]));for(let C=0;C<s.length;C++){const E=x[C];this.lineVertexArray.emplaceBack(E.x,E.y,E.tileUnitDistanceFromAnchor)}}return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(r,s,d,g,_,x,C,E,R,L,V,H){const Z=r.indexArray,J=r.layoutVertexArray,ee=r.segments.prepareSegment(4*s.length,J,Z,this.canOverlap?x.sortKey:void 0),ne=this.glyphOffsetArray.length,fe=ee.vertexLength,Te=this.allowVerticalPlacement&&C===f.az.vertical?Math.PI/2:0,pe=x.text&&x.text.sections;for(let me=0;me<s.length;me++){const{tl:Ie,tr:Fe,bl:nt,br:bt,tex:mt,pixelOffsetTL:Pt,pixelOffsetBR:Bt,minFontScaleX:kt,minFontScaleY:vt,glyphOffset:ht,isSDF:Kt,sectionIndex:Ht}=s[me],Jt=ee.vertexLength,Gt=ht[1];V0(J,E.x,E.y,Ie.x,Gt+Ie.y,mt.x,mt.y,d,Kt,Pt.x,Pt.y,kt,vt),V0(J,E.x,E.y,Fe.x,Gt+Fe.y,mt.x+mt.w,mt.y,d,Kt,Bt.x,Pt.y,kt,vt),V0(J,E.x,E.y,nt.x,Gt+nt.y,mt.x,mt.y+mt.h,d,Kt,Pt.x,Bt.y,kt,vt),V0(J,E.x,E.y,bt.x,Gt+bt.y,mt.x+mt.w,mt.y+mt.h,d,Kt,Bt.x,Bt.y,kt,vt),R1(r.dynamicLayoutVertexArray,E,Te),Z.emplaceBack(Jt,Jt+2,Jt+1),Z.emplaceBack(Jt+1,Jt+2,Jt+3),ee.vertexLength+=4,ee.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ht[0]),me!==s.length-1&&Ht===s[me+1].sectionIndex||r.programConfigurations.populatePaintArrays(J.length,x,x.index,{imagePositions:{},canonical:H,formattedSection:pe&&pe[Ht]})}r.placedSymbolArray.emplaceBack(E.x,E.y,ne,this.glyphOffsetArray.length-ne,fe,R,L,E.segment,d?d[0]:0,d?d[1]:0,g[0],g[1],C,0,!1,0,V)}_addCollisionDebugVertex(r,s,d,g,_,x){return s.emplaceBack(0,0),r.emplaceBack(d.x,d.y,g,_,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(r,s,d,g,_,x,C){const E=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),R=E.vertexLength,L=_.layoutVertexArray,V=_.collisionVertexArray,H=C.anchorX,Z=C.anchorY;this._addCollisionDebugVertex(L,V,x,H,Z,new b(r,s)),this._addCollisionDebugVertex(L,V,x,H,Z,new b(d,s)),this._addCollisionDebugVertex(L,V,x,H,Z,new b(d,g)),this._addCollisionDebugVertex(L,V,x,H,Z,new b(r,g)),E.vertexLength+=4;const J=_.indexArray;J.emplaceBack(R,R+1),J.emplaceBack(R+1,R+2),J.emplaceBack(R+2,R+3),J.emplaceBack(R+3,R),E.primitiveLength+=4}addDebugCollisionBoxes(r,s,d,g){for(let _=r;_<s;_++){const x=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,g?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,d)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new z1(it,_p.members,Rt),this.iconCollisionBox=new z1(it,_p.members,Rt);for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this.addDebugCollisionBoxes(s.textBoxStartIndex,s.textBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.iconBoxStartIndex,s.iconBoxEndIndex,s,!1),this.addDebugCollisionBoxes(s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s,!1)}}_deserializeCollisionBoxesForSymbol(r,s,d,g,_,x,C,E,R){const L={};for(let V=s;V<d;V++){const H=r.get(V);L.textBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},L.textFeatureIndex=H.featureIndex;break}for(let V=g;V<_;V++){const H=r.get(V);L.verticalTextBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},L.verticalTextFeatureIndex=H.featureIndex;break}for(let V=x;V<C;V++){const H=r.get(V);L.iconBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},L.iconFeatureIndex=H.featureIndex;break}for(let V=E;V<R;V++){const H=r.get(V);L.verticalIconBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},L.verticalIconFeatureIndex=H.featureIndex;break}return L}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const d=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,s){const d=r.placedSymbolArray.get(s),g=d.vertexStartIndex+4*d.numGlyphs;for(let _=d.vertexStartIndex;_<g;_+=4)r.indexArray.emplaceBack(_,_+2,_+1),r.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(r),d=Math.cos(r),g=[],_=[],x=[];for(let C=0;C<this.symbolInstances.length;++C){x.push(C);const E=this.symbolInstances.get(C);g.push(0|Math.round(s*E.anchorX+d*E.anchorY)),_.push(E.featureIndex)}return x.sort((C,E)=>g[C]-g[E]||_[E]-_[C]),x}addToSortKeyRanges(r,s){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===s?d.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const d=this.symbolInstances.get(s);this.featureSortOrder.push(d.featureIndex),[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach((g,_,x)=>{g>=0&&x.indexOf(g)===_&&this.addIndicesForPlacedSymbol(this.text,g)}),d.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,d.verticalPlacedTextSymbolIndex),d.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.placedIconSymbolIndex),d.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let OS,LS;Ut("SymbolBucket",Nm,{omit:["layers","collisionBoxArray","features","compareText"]}),Nm.MAX_GLYPHS=65535,Nm.addDynamicAttributes=R1;var O1={get paint(){return LS=LS||new Ti({"icon-opacity":new cr(Ze.paint_symbol["icon-opacity"]),"icon-color":new cr(Ze.paint_symbol["icon-color"]),"icon-halo-color":new cr(Ze.paint_symbol["icon-halo-color"]),"icon-halo-width":new cr(Ze.paint_symbol["icon-halo-width"]),"icon-halo-blur":new cr(Ze.paint_symbol["icon-halo-blur"]),"icon-translate":new Xt(Ze.paint_symbol["icon-translate"]),"icon-translate-anchor":new Xt(Ze.paint_symbol["icon-translate-anchor"]),"text-opacity":new cr(Ze.paint_symbol["text-opacity"]),"text-color":new cr(Ze.paint_symbol["text-color"],{runtimeType:Zt,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new cr(Ze.paint_symbol["text-halo-color"]),"text-halo-width":new cr(Ze.paint_symbol["text-halo-width"]),"text-halo-blur":new cr(Ze.paint_symbol["text-halo-blur"]),"text-translate":new Xt(Ze.paint_symbol["text-translate"]),"text-translate-anchor":new Xt(Ze.paint_symbol["text-translate-anchor"])})},get layout(){return OS=OS||new Ti({"symbol-placement":new Xt(Ze.layout_symbol["symbol-placement"]),"symbol-spacing":new Xt(Ze.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Xt(Ze.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new cr(Ze.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Xt(Ze.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Xt(Ze.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Xt(Ze.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Xt(Ze.layout_symbol["icon-ignore-placement"]),"icon-optional":new Xt(Ze.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Xt(Ze.layout_symbol["icon-rotation-alignment"]),"icon-size":new cr(Ze.layout_symbol["icon-size"]),"icon-text-fit":new Xt(Ze.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Xt(Ze.layout_symbol["icon-text-fit-padding"]),"icon-image":new cr(Ze.layout_symbol["icon-image"]),"icon-rotate":new cr(Ze.layout_symbol["icon-rotate"]),"icon-padding":new cr(Ze.layout_symbol["icon-padding"]),"icon-keep-upright":new Xt(Ze.layout_symbol["icon-keep-upright"]),"icon-offset":new cr(Ze.layout_symbol["icon-offset"]),"icon-anchor":new cr(Ze.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Xt(Ze.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Xt(Ze.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Xt(Ze.layout_symbol["text-rotation-alignment"]),"text-field":new cr(Ze.layout_symbol["text-field"]),"text-font":new cr(Ze.layout_symbol["text-font"]),"text-size":new cr(Ze.layout_symbol["text-size"]),"text-max-width":new cr(Ze.layout_symbol["text-max-width"]),"text-line-height":new Xt(Ze.layout_symbol["text-line-height"]),"text-letter-spacing":new cr(Ze.layout_symbol["text-letter-spacing"]),"text-justify":new cr(Ze.layout_symbol["text-justify"]),"text-radial-offset":new cr(Ze.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Xt(Ze.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new cr(Ze.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new cr(Ze.layout_symbol["text-anchor"]),"text-max-angle":new Xt(Ze.layout_symbol["text-max-angle"]),"text-writing-mode":new Xt(Ze.layout_symbol["text-writing-mode"]),"text-rotate":new cr(Ze.layout_symbol["text-rotate"]),"text-padding":new Xt(Ze.layout_symbol["text-padding"]),"text-keep-upright":new Xt(Ze.layout_symbol["text-keep-upright"]),"text-transform":new cr(Ze.layout_symbol["text-transform"]),"text-offset":new cr(Ze.layout_symbol["text-offset"]),"text-allow-overlap":new Xt(Ze.layout_symbol["text-allow-overlap"]),"text-overlap":new Xt(Ze.layout_symbol["text-overlap"]),"text-ignore-placement":new Xt(Ze.layout_symbol["text-ignore-placement"]),"text-optional":new Xt(Ze.layout_symbol["text-optional"])})}};class FS{constructor(r){if(r.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=r.property.overrides?r.property.overrides.runtimeType:Ki,this.defaultValue=r}evaluate(r){if(r.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(r.formattedSection))return s.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ut("FormatSectionOverride",FS,{omit:["defaultValue"]});class U0 extends Zo{constructor(r,s){super(r,O1,s)}recalculate(r,s){if(super.recalculate(r,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const d=this.layout.get("text-writing-mode");if(d){const g=[];for(const _ of d)g.indexOf(_)<0&&g.push(_);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(r,s,d,g){const _=this.layout.get(r).evaluate(s,{},d,g),x=this._unevaluatedLayout._values[r];return x.isDataDriven()||_c(x.value)||!_?_:function(C,E){return E.replace(/{([^{}]+)}/g,(R,L)=>C&&L in C?String(C[L]):"")}(s.properties,_)}createBucket(r){return new Nm(r)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const r of O1.paint.overridableProperties){if(!U0.hasPaintOverride(this.layout,r))continue;const s=this.paint.get(r),d=new FS(s),g=new vc(d,s.property.specification);let _=null;_=s.value.kind==="constant"||s.value.kind==="source"?new Cl("source",g):new wu("composite",g,s.value.zoomStops),this.paint._values[r]=new as(s.property,_,s.parameters)}}_handleOverridablePaintPropertyUpdate(r,s,d){return!(!this.layout||s.isDataDriven()||d.isDataDriven())&&U0.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,s){const d=r.get("text-field"),g=O1.paint.properties[s];let _=!1;const x=C=>{for(const E of C)if(g.overrides&&g.overrides.hasOverride(E))return void(_=!0)};if(d.value.kind==="constant"&&d.value.value instanceof Ji)x(d.value.value.sections);else if(d.value.kind==="source"||d.value.kind==="composite"){const C=R=>{_||(R instanceof zo&&qn(R.value)===Gi?x(R.value.sections):R instanceof yh?x(R.sections):R.eachChild(C))},E=d.value;E._styleExpression&&C(E._styleExpression.expression)}return _}}let BS;var v5={get paint(){return BS=BS||new Ti({"background-color":new Xt(Ze.paint_background["background-color"]),"background-pattern":new Bh(Ze.paint_background["background-pattern"]),"background-opacity":new Xt(Ze.paint_background["background-opacity"])})}};class _5 extends Zo{constructor(r,s){super(r,v5,s)}}class x5 extends Zo{constructor(r,s){super(r,{},s),this.onAdd=d=>{this.implementation.onAdd&&this.implementation.onAdd(d,d.painter.context.gl)},this.onRemove=d=>{this.implementation.onRemove&&this.implementation.onRemove(d,d.painter.context.gl)},this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class b5{constructor(r){this._methodToThrottle=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const w5={once:!0},L1=63710088e-1;class uf{constructor(r,s){if(isNaN(r)||isNaN(s))throw new Error(`Invalid LngLat object: (${r}, ${s})`);if(this.lng=+r,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new uf(St(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const s=Math.PI/180,d=this.lat*s,g=r.lat*s,_=Math.sin(d)*Math.sin(g)+Math.cos(d)*Math.cos(g)*Math.cos((r.lng-this.lng)*s);return L1*Math.acos(Math.min(_,1))}static convert(r){if(r instanceof uf)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new uf(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new uf(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const $S=2*Math.PI*L1;function jS(l){return $S*Math.cos(l*Math.PI/180)}function NS(l){return(180+l)/360}function VS(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function US(l,r){return l/jS(r)}function GS(l){return 360*l-180}function G0(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function qS(l,r){return l*jS(G0(r))}class Py{constructor(r,s,d=0){this.x=+r,this.y=+s,this.z=+d}static fromLngLat(r,s=0){const d=uf.convert(r);return new Py(NS(d.lng),VS(d.lat),US(s,d.lat))}toLngLat(){return new uf(GS(this.x),G0(this.y))}toAltitude(){return qS(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/$S*(r=G0(this.y),1/Math.cos(r*Math.PI/180));var r}}function HS(l,r,s){var d=2*Math.PI*6378137/256/Math.pow(2,s);return[l*d-2*Math.PI*6378137/2,r*d-2*Math.PI*6378137/2]}class F1{constructor(r,s,d){if(!function(g,_,x){return!(g<0||g>25||x<0||x>=Math.pow(2,g)||_<0||_>=Math.pow(2,g))}(r,s,d))throw new Error(`x=${s}, y=${d}, z=${r} outside of bounds. 0<=x<${Math.pow(2,r)}, 0<=y<${Math.pow(2,r)} 0<=z<=25 `);this.z=r,this.x=s,this.y=d,this.key=Vm(0,r,r,s,d)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,s,d){const g=function(x,C,E){var R=HS(256*x,256*(C=Math.pow(2,E)-C-1),E),L=HS(256*(x+1),256*(C+1),E);return R[0]+","+R[1]+","+L[0]+","+L[1]}(this.x,this.y,this.z),_=function(x,C,E){let R,L="";for(let V=x;V>0;V--)R=1<<V-1,L+=(C&R?1:0)+(E&R?2:0);return L}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,s>1?"@2x":"").replace(/{quadkey}/g,_).replace(/{bbox-epsg-3857}/g,g)}isChildOf(r){const s=this.z-r.z;return s>0&&r.x===this.x>>s&&r.y===this.y>>s}getTilePoint(r){const s=Math.pow(2,this.z);return new b((r.x*s-this.x)*je,(r.y*s-this.y)*je)}toString(){return`${this.z}/${this.x}/${this.y}`}}class WS{constructor(r,s){this.wrap=r,this.canonical=s,this.key=Vm(r,s.z,s.z,s.x,s.y)}}class Ja{constructor(r,s,d,g,_){if(this.terrainRttPosMatrix32f=null,r<d)throw new Error(`overscaledZ should be >= z; overscaledZ = ${r}; z = ${d}`);this.overscaledZ=r,this.wrap=s,this.canonical=new F1(d,+g,+_),this.key=Vm(s,r,d,g,_)}clone(){return new Ja(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-r;return r>this.canonical.z?new Ja(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ja(r,this.wrap,r,this.canonical.x>>s,this.canonical.y>>s)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(r,s){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const d=this.canonical.z-r;return r>this.canonical.z?Vm(this.wrap*+s,r,this.canonical.z,this.canonical.x,this.canonical.y):Vm(this.wrap*+s,r,r,this.canonical.x>>d,this.canonical.y>>d)}isChildOf(r){if(r.wrap!==this.wrap||this.overscaledZ-r.overscaledZ<=0)return!1;if(r.overscaledZ===0)return this.overscaledZ>0;const s=this.canonical.z-r.canonical.z;return!(s<0)&&r.canonical.x===this.canonical.x>>s&&r.canonical.y===this.canonical.y>>s}children(r){if(this.overscaledZ>=r)return[new Ja(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,d=2*this.canonical.x,g=2*this.canonical.y;return[new Ja(s,this.wrap,s,d,g),new Ja(s,this.wrap,s,d+1,g),new Ja(s,this.wrap,s,d,g+1),new Ja(s,this.wrap,s,d+1,g+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Ja(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Ja(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new WS(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(r){return this.canonical.getTilePoint(new Py(r.x-this.wrap,r.y))}}function Vm(l,r,s,d,g){(l*=2)<0&&(l=-1*l-1);const _=1<<s;return(_*_*l+_*g+d).toString(36)+s.toString(36)+r.toString(36)}function B1(l,r){return r?l.properties[r]:l.id}function S5(l,r){const s={id:l.id};if(r.removeAllProperties&&(delete l.removeProperties,delete l.addOrUpdateProperties,delete r.removeProperties),r.removeProperties)for(const d of r.removeProperties){const g=l.addOrUpdateProperties.findIndex(_=>_.key===d);g>-1&&l.addOrUpdateProperties.splice(g,1)}return(l.removeAllProperties||r.removeAllProperties)&&(s.removeAllProperties=!0),(l.removeProperties||r.removeProperties)&&(s.removeProperties=[...l.removeProperties||[],...r.removeProperties||[]]),(l.addOrUpdateProperties||r.addOrUpdateProperties)&&(s.addOrUpdateProperties=[...l.addOrUpdateProperties||[],...r.addOrUpdateProperties||[]]),(l.newGeometry||r.newGeometry)&&(s.newGeometry=r.newGeometry||l.newGeometry),s}function ZS(l){var r,s;if(!l)return{};const d={};return d.removeAll=l.removeAll,d.remove=new Set(l.remove||[]),d.add=new Map((r=l.add)===null||r===void 0?void 0:r.map(g=>[g.id,g])),d.update=new Map((s=l.update)===null||s===void 0?void 0:s.map(g=>[g.id,g])),d}Ut("CanonicalTileID",F1),Ut("OverscaledTileID",Ja,{omit:["terrainRttPosMatrix32f"]});class Sp{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(r){return this.minX=Math.min(this.minX,r.x),this.minY=Math.min(this.minY,r.y),this.maxX=Math.max(this.maxX,r.x),this.maxY=Math.max(this.maxY,r.y),this}expandBy(r){return this.minX-=r,this.minY-=r,this.maxX+=r,this.maxY+=r,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(r){return this.expandBy(-r)}map(r){const s=new Sp;return s.extend(r(new b(this.minX,this.minY))),s.extend(r(new b(this.maxX,this.minY))),s.extend(r(new b(this.minX,this.maxY))),s.extend(r(new b(this.maxX,this.maxY))),s}static fromPoints(r){const s=new Sp;for(const d of r)s.extend(d);return s}contains(r){return r.x>=this.minX&&r.x<=this.maxX&&r.y>=this.minY&&r.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(r){return!this.empty()&&!r.empty()&&r.minX>=this.minX&&r.maxX<=this.maxX&&r.minY>=this.minY&&r.maxY<=this.maxY}intersects(r){return!this.empty()&&!r.empty()&&r.minX<=this.maxX&&r.maxX>=this.minX&&r.minY<=this.maxY&&r.maxY>=this.minY}}class XS{constructor(r){this._stringToNumber={},this._numberToString=[];for(let s=0;s<r.length;s++){const d=r[s];this._stringToNumber[d]=s,this._numberToString[s]=d}}encode(r){return this._stringToNumber[r]}decode(r){if(r>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${r} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[r]}}class KS{constructor(r,s,d,g,_){this.type="Feature",this._vectorTileFeature=r,this._x=d,this._y=g,this._z=s,this.properties=r.properties,this.id=_}projectPoint(r,s,d,g){return[360*(r.x+s)/g-180,360/Math.PI*Math.atan(Math.exp((1-2*(r.y+d)/g)*Math.PI))-90]}projectLine(r,s,d,g){return r.map(_=>this.projectPoint(_,s,d,g))}get geometry(){if(this._geometry)return this._geometry;const r=this._vectorTileFeature,s=r.extent*Math.pow(2,this._z),d=r.extent*this._x,g=r.extent*this._y,_=r.loadGeometry();switch(r.type){case 1:{const x=[];for(const E of _)x.push(E[0]);const C=this.projectLine(x,d,g,s);this._geometry=x.length===1?{type:"Point",coordinates:C[0]}:{type:"MultiPoint",coordinates:C};break}case 2:{const x=_.map(C=>this.projectLine(C,d,g,s));this._geometry=x.length===1?{type:"LineString",coordinates:x[0]}:{type:"MultiLineString",coordinates:x};break}case 3:{const x=vy(_),C=[];for(const E of x)C.push(E.map(R=>this.projectLine(R,d,g,s)));this._geometry=C.length===1?{type:"Polygon",coordinates:C[0]}:{type:"MultiPolygon",coordinates:C};break}default:throw new Error(`unknown feature type: ${r.type}`)}return this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={geometry:this.geometry};for(const s in this)s!=="_geometry"&&s!=="_vectorTileFeature"&&s!=="_x"&&s!=="_y"&&s!=="_z"&&(r[s]=this[s]);return r}}class Um{_name;dataBuffer;nullabilityBuffer;_size;constructor(r,s,d){this._name=r,this.dataBuffer=s,typeof d=="number"?this._size=d:(this.nullabilityBuffer=d,this._size=d.size())}getValue(r){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(r)?null:this.getValueFromBuffer(r)}has(r){return this.nullabilityBuffer&&this.nullabilityBuffer.get(r)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class q0 extends Um{}class $1 extends q0{getValueFromBuffer(r){return this.dataBuffer[r]}}class j1 extends q0{getValueFromBuffer(r){return this.dataBuffer[r]}}class YS extends Um{delta;constructor(r,s,d,g){super(r,s,g),this.delta=d}}class N1 extends YS{constructor(r,s,d,g){super(r,Int32Array.of(s),d,g)}getValueFromBuffer(r){return this.dataBuffer[0]+r*this.delta}}class V1 extends Um{constructor(r,s,d){super(r,Int32Array.of(s),d)}getValueFromBuffer(r){return this.dataBuffer[0]}}class C5{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(r,s,d,g,_=4096){this._name=r,this._geometryVector=s,this._idVector=d,this._propertyVectors=g,this._extent=_}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(r){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map(s=>[s.name,s]))),this.propertyVectorsMap.get(r)}*[Symbol.iterator](){const r=this.geometryVector[Symbol.iterator]();let s=0;for(;s<this.numFeatures;){let d;this.idVector&&(d=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(s)):this.idVector.getValue(s));const g=r?.next().value,_={};for(const x of this.propertyVectors){if(!x)continue;const C=x.name,E=x.getValue(s);E!==null&&(_[C]=E)}s++,yield{id:d,geometry:g,properties:_}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const r=[],s=this.geometryVector.getGeometries();for(let d=0;d<this.numFeatures;d++){let g;this.idVector&&(g=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(d)):this.idVector.getValue(d));const _={coordinates:s[d],type:this.geometryVector.geometryType(d)},x={};for(const C of this.propertyVectors){if(!C)continue;const E=C.name,R=C.getValue(d);R!==null&&(x[E]=R)}r.push({id:g,geometry:_,properties:x})}return r}containsMaxSaveIntegerValues(r){return r instanceof $1||r instanceof V1&&r instanceof N1||r instanceof j1}}class T5{value;constructor(r){this.value=r}get(){return this.value}set(r){this.value=r}increment(){return this.value++}add(r){this.value+=r}}var en,Zh,es,Nc,Cp,va,Eo,Io,JS,Qa;function No(l,r,s){const d=new Int32Array(s);let g=0,_=r.get();for(let x=0;x<d.length;x++){let C=l[_++],E=127&C;C<128||(C=l[_++],E|=(127&C)<<7,C<128||(C=l[_++],E|=(127&C)<<14,C<128||(C=l[_++],E|=(127&C)<<21,C<128||(C=l[_++],E|=(15&C)<<28)))),d[g++]=E}return r.set(_),d}function H0(l,r,s){const d=new BigInt64Array(s);for(let g=0;g<d.length;g++)d[g]=P5(l,r);return d}function M5(l,r){let s,d;return d=l[r.get()],r.increment(),s=127&d,d<128?s:(d=l[r.get()],r.increment(),s|=(127&d)<<7,d<128?s:(d=l[r.get()],r.increment(),s|=(127&d)<<14,d<128?s:(d=l[r.get()],r.increment(),s|=(127&d)<<21,d<128?s:(d=l[r.get()],s|=(15&d)<<28,function(g,_,x){let C,E;if(E=_[x.get()],x.increment(),C=(112&E)>>4,E<128||(E=_[x.get()],x.increment(),C|=(127&E)<<3,E<128)||(E=_[x.get()],x.increment(),C|=(127&E)<<10,E<128)||(E=_[x.get()],x.increment(),C|=(127&E)<<17,E<128)||(E=_[x.get()],x.increment(),C|=(127&E)<<24,E<128)||(E=_[x.get()],x.increment(),C|=(1&E)<<31,E<128))return 4294967296*C+(g>>>0);throw new Error("Expected varint not more than 10 bytes")}(s,l,r)))))}function QS(l,r,s,d){throw new Error("FastPFor is not implemented yet.")}function Tp(l){return l>>>1^-(1&l)}function Gm(l){return l>>1n^-(1n&l)}function P5(l,r){let s=0n,d=0,g=r.get();for(;g<l.length;){const _=l[g++];if(s|=BigInt(127&_)<<BigInt(d),!(128&_))break;if(d+=7,d>=64)throw new Error("Varint too long")}return r.set(g),s}function eC(l,r,s){const d=new Int32Array(s);let g=0;for(let _=0;_<r;_++){const x=l[_];d.fill(l[_+r],g,g+x),g+=x}return d}function tC(l,r,s){const d=new BigInt64Array(s);let g=0;for(let _=0;_<r;_++){const x=Number(l[_]);d.fill(l[_+r],g,g+x),g+=x}return d}function rC(l,r,s){const d=new Float64Array(s);let g=0;for(let _=0;_<r;_++){const x=l[_];d.fill(l[_+r],g,g+x),g+=x}return d}function U1(l){const r=l.length/4*4;let s=1;if(r>=4)for(let d=l[0];s<r-4;s+=4)d=l[s]+=d,d=l[s+1]+=d,d=l[s+2]+=d,d=l[s+3]+=d;for(;s!=l.length;)l[s]+=l[s-1],++s}function nC(l){l[0]=l[0]>>>1^-(1&l[0]),l[1]=l[1]>>>1^-(1&l[1]);const r=l.length/4*4;let s=2;if(r>=4)for(;s<r-4;s+=4){const d=l[s],g=l[s+1],_=l[s+2],x=l[s+3];l[s]=(d>>>1^-(1&d))+l[s-2],l[s+1]=(g>>>1^-(1&g))+l[s-1],l[s+2]=(_>>>1^-(1&_))+l[s],l[s+3]=(x>>>1^-(1&x))+l[s+1]}for(;s!=l.length;s+=2)l[s]=(l[s]>>>1^-(1&l[s]))+l[s-2],l[s+1]=(l[s+1]>>>1^-(1&l[s+1]))+l[s-1]}(function(l){l.NONE="NONE",l.DELTA="DELTA",l.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",l.RLE="RLE",l.MORTON="MORTON",l.PDE="PDE"})(en||(en={})),function(l){l.NONE="NONE",l.FAST_PFOR="FAST_PFOR",l.VARINT="VARINT",l.ALP="ALP"}(Zh||(Zh={})),function(l){l.PRESENT="PRESENT",l.DATA="DATA",l.OFFSET="OFFSET",l.LENGTH="LENGTH"}(es||(es={}));class G1{_dictionaryType;_offsetType;_lengthType;constructor(r,s,d){this._dictionaryType=r,this._offsetType=s,this._lengthType=d}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function Ps(l,r){const s=function(d,g){const _=d[g.get()],x=Object.values(es)[_>>4];let C=null;switch(x){case es.DATA:C=new G1(Object.values(Nc)[15&_]);break;case es.OFFSET:C=new G1(null,Object.values(Cp)[15&_]);break;case es.LENGTH:C=new G1(null,null,Object.values(va)[15&_])}g.increment();const E=d[g.get()],R=Object.values(en)[E>>5],L=Object.values(en)[E>>2&7],V=Object.values(Zh)[3&E];g.increment();const H=No(d,g,2),Z=H[0];return{physicalStreamType:x,logicalStreamType:C,logicalLevelTechnique1:R,logicalLevelTechnique2:L,physicalLevelTechnique:V,numValues:Z,byteLength:H[1],decompressedCount:Z}}(l,r);return s.logicalLevelTechnique1===en.MORTON?function(d,g,_){const x=No(g,_,2);return{physicalStreamType:d.physicalStreamType,logicalStreamType:d.logicalStreamType,logicalLevelTechnique1:d.logicalLevelTechnique1,logicalLevelTechnique2:d.logicalLevelTechnique2,physicalLevelTechnique:d.physicalLevelTechnique,numValues:d.numValues,byteLength:d.byteLength,decompressedCount:d.decompressedCount,numBits:x[0],coordinateShift:x[1]}}(s,l,r):en.RLE!==s.logicalLevelTechnique1&&en.RLE!==s.logicalLevelTechnique2||Zh.NONE===s.physicalLevelTechnique?s:function(d,g,_){const x=No(g,_,2);return{physicalStreamType:d.physicalStreamType,logicalStreamType:d.logicalStreamType,logicalLevelTechnique1:d.logicalLevelTechnique1,logicalLevelTechnique2:d.logicalLevelTechnique2,physicalLevelTechnique:d.physicalLevelTechnique,numValues:d.numValues,byteLength:d.byteLength,decompressedCount:x[1],runs:x[0],numRleValues:x[1]}}(s,l,r)}(function(l){l.NONE="NONE",l.SINGLE="SINGLE",l.SHARED="SHARED",l.VERTEX="VERTEX",l.MORTON="MORTON",l.FSST="FSST"})(Nc||(Nc={})),function(l){l.VERTEX="VERTEX",l.INDEX="INDEX",l.STRING="STRING",l.KEY="KEY"}(Cp||(Cp={})),function(l){l.VAR_BINARY="VAR_BINARY",l.GEOMETRIES="GEOMETRIES",l.PARTS="PARTS",l.RINGS="RINGS",l.TRIANGLES="TRIANGLES",l.SYMBOL="SYMBOL",l.DICTIONARY="DICTIONARY"}(va||(va={})),function(l){l[l.FLAT=0]="FLAT",l[l.CONST=1]="CONST",l[l.SEQUENCE=2]="SEQUENCE",l[l.DICTIONARY=3]="DICTIONARY",l[l.FSST_DICTIONARY=4]="FSST_DICTIONARY"}(Eo||(Eo={}));class Vc{values;_size;constructor(r,s){this.values=r,this._size=s}get(r){const s=Math.floor(r/8);return(this.values[s]>>r%8&1)==1}set(r,s){const d=Math.floor(r/8);this.values[d]=this.values[d]|(s?1:0)<<r%8}getInt(r){const s=Math.floor(r/8);return this.values[s]>>r%8&1}size(){return this._size}getBuffer(){return this.values}}function Es(l,r,s,d,g){return function(_,x,C){switch(x.logicalLevelTechnique1){case en.DELTA:return x.logicalLevelTechnique2===en.RLE?function(E,R,L){const V=new Int32Array(L);let H=0,Z=0;for(let J=0;J<R;J++){const ee=E[J],ne=Tp(E[J+R]);for(let fe=0;fe<ee;fe++)Z+=ne,V[H++]=Z}return V}(_,x.runs,x.numRleValues):(function(E){E[0]=E[0]>>>1^-(1&E[0]);const R=E.length/4*4;let L=1;if(R>=4)for(;L<R-4;L+=4){const V=E[L],H=E[L+1],Z=E[L+2],J=E[L+3];E[L]=(V>>>1^-(1&V))+E[L-1],E[L+1]=(H>>>1^-(1&H))+E[L],E[L+2]=(Z>>>1^-(1&Z))+E[L+1],E[L+3]=(J>>>1^-(1&J))+E[L+2]}for(;L!=E.length;++L)E[L]=(E[L]>>>1^-(1&E[L]))+E[L-1]}(_),_);case en.RLE:return function(E,R,L){return L?function(V,H,Z){const J=new Int32Array(Z);let ee=0;for(let ne=0;ne<H;ne++){const fe=V[ne];let Te=V[ne+H];Te=Te>>>1^-(1&Te),J.fill(Te,ee,ee+fe),ee+=fe}return J}(E,R.runs,R.numRleValues):eC(E,R.runs,R.numRleValues)}(_,x,C);case en.MORTON:return U1(_),_;case en.COMPONENTWISE_DELTA:return nC(_),_;case en.NONE:return C&&function(E){for(let R=0;R<E.length;R++){const L=E[R];E[R]=L>>>1^-(1&L)}}(_),_;default:throw new Error(`The specified Logical level technique is not supported: ${x.logicalLevelTechnique1}`)}}(W0(l,r,s),s,d)}function hf(l,r,s){return function(d,g){if(g.logicalLevelTechnique1===en.DELTA&&g.logicalLevelTechnique2===en.NONE)return function(x){const C=new Int32Array(x.length+1);C[0]=0,C[1]=Tp(x[0]);let E=C[1],R=2;for(;R!=C.length;++R){const L=x[R-1];E+=L>>>1^-(1&L),C[R]=C[R-1]+E}return C}(d);if(g.logicalLevelTechnique1===en.RLE&&g.logicalLevelTechnique2===en.NONE)return function(x,C,E){const R=new Int32Array(E+1);R[0]=0;let L=1,V=R[0];for(let H=0;H<C;H++){const Z=x[H],J=x[H+C];for(let ee=L;ee<L+Z;ee++)R[ee]=J+V,V=R[ee];L+=Z}return R}(d,g.runs,g.numRleValues);if(g.logicalLevelTechnique1===en.NONE&&g.logicalLevelTechnique2===en.NONE){(function(x){let C=0;for(let E=0;E<x.length;E++)x[E]+=C,C=x[E]})(d);const _=new Int32Array(g.numValues+1);return _[0]=0,_.set(d,1),_}if(g.logicalLevelTechnique1===en.DELTA&&g.logicalLevelTechnique2===en.RLE){const _=function(x,C,E){const R=new Int32Array(E+1);R[0]=0;let L=1,V=R[0];for(let H=0;H<C;H++){const Z=x[H];let J=x[H+C];J=J>>>1^-(1&J);for(let ee=L;ee<L+Z;ee++)R[ee]=J+V,V=R[ee];L+=Z}return R}(d,g.runs,g.numRleValues);return U1(_),_}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")}(W0(l,r,s),s)}function W0(l,r,s){const d=s.physicalLevelTechnique;if(d===Zh.FAST_PFOR)return QS();if(d===Zh.VARINT)return No(l,r,s.numValues);if(d===Zh.NONE){const g=r.get();r.add(s.byteLength);const _=l.subarray(g,r.get());return new Int32Array(_)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}function q1(l,r,s,d){const g=W0(l,r,s);if(g.length===1){const _=g[0];return d?Tp(_):_}return d?function(_){return Tp(_[1])}(g):function(_){return _[1]}(g)}function iC(l,r,s){return function(d){if(d.length==2){const g=Tp(d[1]);return[g,g]}return[Tp(d[2]),Tp(d[3])]}(W0(l,r,s))}function oC(l,r,s){return function(d){if(d.length==2){const g=Gm(d[1]);return[g,g]}return[Gm(d[2]),Gm(d[3])]}(H0(l,r,s.numValues))}function sC(l,r,s,d){return function(g,_,x){switch(_.logicalLevelTechnique1){case en.DELTA:return _.logicalLevelTechnique2===en.RLE?function(C,E,R){const L=new BigInt64Array(R);let V=0,H=0n;for(let Z=0;Z<E;Z++){const J=Number(C[Z]),ee=Gm(C[Z+E]);for(let ne=0;ne<J;ne++)H+=ee,L[V++]=H}return L}(g,_.runs,_.numRleValues):(function(C){C[0]=C[0]>>1n^-(1n&C[0]);const E=C.length/4*4;let R=1;if(E>=4)for(;R<E-4;R+=4){const L=C[R],V=C[R+1],H=C[R+2],Z=C[R+3];C[R]=(L>>1n^-(1n&L))+C[R-1],C[R+1]=(V>>1n^-(1n&V))+C[R],C[R+2]=(H>>1n^-(1n&H))+C[R+1],C[R+3]=(Z>>1n^-(1n&Z))+C[R+2]}for(;R!=C.length;++R)C[R]=(C[R]>>1n^-(1n&C[R]))+C[R-1]}(g),g);case en.RLE:return function(C,E,R){return R?function(L,V,H){const Z=new BigInt64Array(H);let J=0;for(let ee=0;ee<V;ee++){const ne=Number(L[ee]);let fe=L[ee+V];fe=fe>>1n^-(1n&fe),Z.fill(fe,J,J+ne),J+=ne}return Z}(C,E.runs,E.numRleValues):tC(C,E.runs,E.numRleValues)}(g,_,x);case en.NONE:return x&&function(C){for(let E=0;E<C.length;E++){const R=C[E];C[E]=R>>1n^-(1n&R)}}(g),g;default:throw new Error(`The specified Logical level technique is not supported: ${_.logicalLevelTechnique1}`)}}(H0(l,r,s.numValues),s,d)}function aC(l,r,s,d){const g=H0(l,r,s.numValues);if(g.length===1){const _=g[0];return d?Gm(_):_}return d?function(_){return Gm(_[1])}(g):function(_){return _[1]}(g)}function H1(l,r,s,d,g){return function(_,x,C,E){switch(x.logicalLevelTechnique1){case en.DELTA:return x.logicalLevelTechnique2===en.RLE&&(_=eC(_,x.runs,x.numRleValues)),function(R,L){const V=new Int32Array(R.size());let H=0;R.get(0)?(V[0]=R.get(0)?L[0]>>>1^-(1&L[0]):0,H=1):V[0]=0;let Z=1;for(;Z!=V.length;++Z)V[Z]=R.get(Z)?V[Z-1]+(L[H]>>>1^-(1&L[H++])):V[Z-1];return V}(E,_);case en.RLE:return function(R,L,V,H){const Z=L;return V?function(J,ee,ne){const fe=new Int32Array(J.size());let Te=0;for(let pe=0;pe<ne;pe++){const me=ee[pe];let Ie=ee[pe+ne];Ie=Ie>>>1^-(1&Ie);for(let Fe=Te;Fe<Te+me;Fe++)J.get(Fe)?fe[Fe]=Ie:(fe[Fe]=0,Te++);Te+=me}return fe}(H,R,Z.runs):function(J,ee,ne){const fe=new Int32Array(J.size());let Te=0;for(let pe=0;pe<ne;pe++){const me=ee[pe],Ie=ee[pe+ne];for(let Fe=Te;Fe<Te+me;Fe++)J.get(Fe)?fe[Fe]=Ie:(fe[Fe]=0,Te++);Te+=me}return fe}(H,R,Z.runs)}(_,x,C,E);case en.MORTON:return U1(_),_;case en.COMPONENTWISE_DELTA:return nC(_),_;case en.NONE:return _=C?function(R,L){const V=new Int32Array(R.size());let H=0,Z=0;for(;Z!=V.length;++Z)if(R.get(Z)){const J=L[H++];V[Z]=J>>>1^-(1&J)}else V[Z]=0;return V}(E,_):function(R,L){const V=new Int32Array(R.size());let H=0,Z=0;for(;Z!=V.length;++Z)V[Z]=R.get(Z)?L[H++]:0;return V}(E,_),_;default:throw new Error("The specified Logical level technique is not supported")}}(s.physicalLevelTechnique===Zh.FAST_PFOR?QS():No(l,r,s.numValues),s,d,g)}function Z0(l,r,s,d){const g=l.logicalLevelTechnique1;if(g===en.RLE)return l.runs===1?Eo.CONST:Eo.FLAT;const _=r instanceof Vc?r.size():r;if(g===en.DELTA&&l.logicalLevelTechnique2===en.RLE){const x=l.runs,C=2;if(l.numRleValues!==_)return Eo.FLAT;if(x===1)return Eo.SEQUENCE;if(x===2){const E=d.get();let R;if(l.physicalLevelTechnique===Zh.VARINT)R=No(s,d,4);else{const L=d.get();R=new Int32Array(s.buffer,s.byteOffset+L,4)}if(d.set(E),R[2]===C&&R[3]===C)return Eo.SEQUENCE}}return l.numValues===1?Eo.CONST:Eo.FLAT}class lC extends q0{getValueFromBuffer(r){return this.dataBuffer[r]}}class cC extends YS{constructor(r,s,d,g){super(r,BigInt64Array.of(s),d,g)}getValueFromBuffer(r){return this.dataBuffer[0]+BigInt(r)*this.delta}}class qm{_geometryOffsets;_partOffsets;_ringOffsets;constructor(r,s,d){this._geometryOffsets=r,this._partOffsets=s,this._ringOffsets=d}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}function W1(l,r,s){return{x:uC(l,r)-s,y:uC(l>>1,r)-s}}function uC(l,r){let s=0;for(let d=0;d<r;d++)s|=(l&1<<2*d)>>d;return s}(function(l){l[l.POINT=0]="POINT",l[l.LINESTRING=1]="LINESTRING",l[l.POLYGON=2]="POLYGON",l[l.MULTIPOINT=3]="MULTIPOINT",l[l.MULTILINESTRING=4]="MULTILINESTRING",l[l.MULTIPOLYGON=5]="MULTIPOLYGON"})(Io||(Io={})),function(l){l[l.POINT=0]="POINT",l[l.LINESTRING=1]="LINESTRING",l[l.POLYGON=2]="POLYGON"}(JS||(JS={})),function(l){l[l.MORTON=0]="MORTON",l[l.VEC_2=1]="VEC_2",l[l.VEC_3=2]="VEC_3"}(Qa||(Qa={}));class E5{createPoint(r){return[[r]]}createMultiPoint(r){return r.map(s=>[s])}createLineString(r){return[r]}createMultiLineString(r){return r}createPolygon(r,s){return[r].concat(s)}createMultiPolygon(r){return r.flat()}}function hC(l){const r=new Array(l.numGeometries);let s=1,d=1,g=1,_=0;const x=new E5;let C=0,E=0;const R=l.mortonSettings,L=l.topologyVector,V=L.geometryOffsets,H=L.partOffsets,Z=L.ringOffsets,J=l.vertexOffsets,ee=l.containsPolygonGeometry(),ne=l.vertexBuffer;for(let fe=0;fe<l.numGeometries;fe++){const Te=l.geometryType(fe);if(Te===Io.POINT){if(J&&J.length!==0)if(l.vertexBufferType===Qa.VEC_2){const pe=2*J[E++],me=new b(ne[pe],ne[pe+1]);r[_++]=x.createPoint(me)}else{const pe=W1(ne[J[E++]],R.numBits,R.coordinateShift),me=new b(pe.x,pe.y);r[_++]=x.createPoint(me)}else{const pe=new b(ne[C++],ne[C++]);r[_++]=x.createPoint(pe)}V&&g++,H&&s++,Z&&d++}else if(Te===Io.MULTIPOINT){const pe=V[g]-V[g-1];g++;const me=new Array(pe);if(J&&J.length!==0){for(let Ie=0;Ie<pe;Ie++){const Fe=2*J[E++];me[Ie]=new b(ne[Fe],ne[Fe+1])}r[_++]=x.createMultiPoint(me)}else{for(let Ie=0;Ie<pe;Ie++){const Fe=ne[C++],nt=ne[C++];me[Ie]=new b(Fe,nt)}r[_++]=x.createMultiPoint(me)}}else if(Te===Io.LINESTRING){let pe,me=0;ee?(me=Z[d]-Z[d-1],d++):me=H[s]-H[s-1],s++,J&&J.length!==0?(pe=l.vertexBufferType===Qa.VEC_2?X1(ne,J,E,me,!1):K1(ne,J,E,me,!1,R),E+=me):(pe=Z1(ne,C,me,!1),C+=2*me),r[_++]=x.createLineString(pe),V&&g++}else if(Te===Io.POLYGON){const pe=H[s]-H[s-1];s++;const me=new Array(pe-1);let Ie=Z[d]-Z[d-1];if(d++,J&&J.length!==0){const Fe=l.vertexBufferType===Qa.VEC_2?K0(ne,J,E,Ie):Y0(ne,J,E,Ie,0,R);E+=Ie;for(let nt=0;nt<me.length;nt++)Ie=Z[d]-Z[d-1],d++,me[nt]=l.vertexBufferType===Qa.VEC_2?K0(ne,J,E,Ie):Y0(ne,J,E,Ie,0,R),E+=Ie;r[_++]=x.createPolygon(Fe,me)}else{const Fe=X0(ne,C,Ie);C+=2*Ie;for(let nt=0;nt<me.length;nt++)Ie=Z[d]-Z[d-1],d++,me[nt]=X0(ne,C,Ie),C+=2*Ie;r[_++]=x.createPolygon(Fe,me)}V&&g++}else if(Te===Io.MULTILINESTRING){const pe=V[g]-V[g-1];g++;const me=new Array(pe);if(J&&J.length!==0){for(let Ie=0;Ie<pe;Ie++){let Fe=0;ee?(Fe=Z[d]-Z[d-1],d++):Fe=H[s]-H[s-1],s++;const nt=l.vertexBufferType===Qa.VEC_2?X1(ne,J,E,Fe,!1):K1(ne,J,E,Fe,!1,R);me[Ie]=nt,E+=Fe}r[_++]=x.createMultiLineString(me)}else{for(let Ie=0;Ie<pe;Ie++){let Fe=0;ee?(Fe=Z[d]-Z[d-1],d++):Fe=H[s]-H[s-1],s++,me[Ie]=Z1(ne,C,Fe,!1),C+=2*Fe}r[_++]=x.createMultiLineString(me)}}else{if(Te!==Io.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const pe=V[g]-V[g-1];g++;const me=new Array(pe);let Ie=0;if(J&&J.length!==0){for(let Fe=0;Fe<pe;Fe++){const nt=H[s]-H[s-1];s++;const bt=new Array(nt-1);Ie=Z[d]-Z[d-1],d++;const mt=l.vertexBufferType===Qa.VEC_2?K0(ne,J,E,Ie):Y0(ne,J,E,Ie,0,R);E+=Ie;for(let Pt=0;Pt<bt.length;Pt++)Ie=Z[d]-Z[d-1],d++,bt[Pt]=l.vertexBufferType===Qa.VEC_2?K0(ne,J,E,Ie):Y0(ne,J,E,Ie,0,R),E+=Ie;me[Fe]=x.createPolygon(mt,bt)}r[_++]=x.createMultiPolygon(me)}else{for(let Fe=0;Fe<pe;Fe++){const nt=H[s]-H[s-1];s++;const bt=new Array(nt-1);Ie=Z[d]-Z[d-1],d++;const mt=X0(ne,C,Ie);C+=2*Ie;for(let Pt=0;Pt<bt.length;Pt++){const Bt=Z[d]-Z[d-1];d++,bt[Pt]=X0(ne,C,Bt),C+=2*Bt}me[Fe]=x.createPolygon(mt,bt)}r[_++]=x.createMultiPolygon(me)}}}}return r}function X0(l,r,s){return Z1(l,r,s,!0)}function K0(l,r,s,d){return X1(l,r,s,d,!0)}function Y0(l,r,s,d,g,_){return K1(l,r,s,d,!0,_)}function Z1(l,r,s,d){const g=new Array(d?s+1:s);for(let _=0;_<2*s;_+=2)g[_/2]=new b(l[r+_],l[r+_+1]);return d&&(g[g.length-1]=g[0]),g}function X1(l,r,s,d,g){const _=new Array(g?d+1:d);for(let x=0;x<2*d;x+=2){const C=2*r[s+x/2];_[x/2]=new b(l[C],l[C+1])}return g&&(_[_.length-1]=_[0]),_}function K1(l,r,s,d,g,_){const x=new Array(g?d+1:d);for(let C=0;C<d;C++){const E=W1(l[r[s+C]],_.numBits,_.coordinateShift);x[C]=new b(E.x,E.y)}return g&&(x[x.length-1]=x[0]),x}class dC{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(r,s,d,g,_){this._vertexBufferType=r,this._topologyVector=s,this._vertexOffsets=d,this._vertexBuffer=g,this._mortonSettings=_}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const r=hC(this);let s=0;for(;s<this.numGeometries;)yield{coordinates:r[s],type:this.geometryType(s)},s++}getSimpleEncodedVertex(r){const s=this.vertexOffsets?2*this.vertexOffsets[r]:2*r;return[this.vertexBuffer[s],this.vertexBuffer[s+1]]}getVertex(r){if(this.vertexOffsets&&this.mortonSettings){const d=W1(this.vertexBuffer[this.vertexOffsets[r]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[d.x,d.y]}const s=this.vertexOffsets?2*this.vertexOffsets[r]:2*r;return[this.vertexBuffer[s],this.vertexBuffer[s+1]]}getGeometries(){return hC(this)}get mortonSettings(){return this._mortonSettings}}class fC extends dC{_numGeometries;_geometryType;constructor(r,s,d,g,_,x,C){super(d,g,_,x,C),this._numGeometries=r,this._geometryType=s}geometryType(r){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===Io.POLYGON||this._geometryType===Io.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class pC extends dC{_geometryTypes;constructor(r,s,d,g,_,x){super(r,d,g,_,x),this._geometryTypes=s}geometryType(r){return this._geometryTypes[r]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let r=0;r<this.numGeometries;r++)if(this.geometryType(r)===Io.POLYGON||this.geometryType(r)===Io.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class mC{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(r,s,d,g){this._triangleOffsets=r,this._indexBuffer=s,this._vertexBuffer=d,this._topologyVector=g}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const r=new Array(this.numGeometries),s=this._topologyVector,d=s.partOffsets,g=s.ringOffsets,_=s.geometryOffsets;let x=0,C=1,E=1,R=1;for(let L=0;L<this.numGeometries;L++)switch(this.geometryType(L)){case Io.POLYGON:{const V=d[C]-d[C-1];C++;const H=[];for(let Z=0;Z<V;Z++){const J=g[E]-g[E-1];E++;const ee=[];for(let ne=0;ne<J;ne++){const fe=this._vertexBuffer[x++],Te=this._vertexBuffer[x++];ee.push(new b(fe,Te))}ee.length>0&&ee.push(ee[0]),H.push(ee)}r[L]=H,_&&R++}break;case Io.MULTIPOLYGON:{const V=_[R]-_[R-1];R++;const H=[];for(let Z=0;Z<V;Z++){const J=d[C]-d[C-1];C++;for(let ee=0;ee<J;ee++){const ne=g[E]-g[E-1];E++;const fe=[];for(let Te=0;Te<ne;Te++){const pe=this._vertexBuffer[x++],me=this._vertexBuffer[x++];fe.push(new b(pe,me))}fe.length>0&&fe.push(fe[0]),H.push(fe)}}r[L]=H}}return r}[Symbol.iterator](){return null}}function gC(l,r,s,d,g,_){return new I5(l,r,s,d,g,_)}class I5 extends mC{_numGeometries;_geometryType;constructor(r,s,d,g,_,x){super(d,g,_,x),this._numGeometries=r,this._geometryType=s}geometryType(r){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}function yC(l,r,s,d,g){return new k5(l,r,s,d,g)}class k5 extends mC{_geometryTypes;constructor(r,s,d,g,_){super(s,d,g,_),this._geometryTypes=r}geometryType(r){return this._geometryTypes[r]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function A5(l,r,s,d,g){const _=Ps(l,s);let x=null,C=null,E=null,R=null,L=null,V=null,H=null,Z=null;if(Z0(_,d,l,s)===Eo.CONST){const ee=q1(l,s,_,!1);for(let ne=0;ne<r-1;ne++){const fe=Ps(l,s);switch(fe.physicalStreamType){case es.LENGTH:switch(fe.logicalStreamType.lengthType){case va.GEOMETRIES:x=hf(l,s,fe);break;case va.PARTS:C=hf(l,s,fe);break;case va.RINGS:E=hf(l,s,fe);break;case va.TRIANGLES:H=hf(l,s,fe)}break;case es.OFFSET:switch(fe.logicalStreamType.offsetType){case Cp.VERTEX:R=Es(l,s,fe,!1);break;case Cp.INDEX:Z=Es(l,s,fe,!1)}break;case es.DATA:Nc.VERTEX===fe.logicalStreamType.dictionaryType?L=Es(l,s,fe,!0):(V={numBits:fe.numBits,coordinateShift:fe.coordinateShift},L=Es(l,s,fe,!1))}}return Z!==null?x!=null||C!=null?gC(d,ee,H,Z,L,new qm(x,C,E)):gC(d,ee,H,Z,L):V===null?function(ne,fe,Te,pe,me){return new fC(ne,fe,Qa.VEC_2,Te,pe,me)}(d,ee,new qm(x,C,E),R,L):function(ne,fe,Te,pe,me,Ie){return new fC(ne,fe,Qa.MORTON,Te,pe,me,Ie)}(d,ee,new qm(x,C,E),R,L,V)}const J=Es(l,s,_,!1);for(let ee=0;ee<r-1;ee++){const ne=Ps(l,s);switch(ne.physicalStreamType){case es.LENGTH:switch(ne.logicalStreamType.lengthType){case va.GEOMETRIES:x=Es(l,s,ne,!1);break;case va.PARTS:C=Es(l,s,ne,!1);break;case va.RINGS:E=Es(l,s,ne,!1);break;case va.TRIANGLES:H=hf(l,s,ne)}break;case es.OFFSET:switch(ne.logicalStreamType.offsetType){case Cp.VERTEX:R=Es(l,s,ne,!1);break;case Cp.INDEX:Z=Es(l,s,ne,!1)}break;case es.DATA:Nc.VERTEX===ne.logicalStreamType.dictionaryType?L=Es(l,s,ne,!0):(V={numBits:ne.numBits,coordinateShift:ne.coordinateShift},L=Es(l,s,ne,!1))}}return Z!==null&&C===null?yC(J,H,Z,L):(x!==null?(x=Y1(J,x,2),C!==null&&E!==null?(C=vC(J,x,C,!1),E=function(ee,ne,fe,Te){const pe=new Int32Array(fe[fe.length-1]+1);let me=0;pe[0]=me;let Ie=1,Fe=1,nt=0;for(let bt=0;bt<ee.length;bt++){const mt=ee[bt],Pt=ne[bt+1]-ne[bt];if(mt!==0&&mt!==3)for(let Bt=0;Bt<Pt;Bt++){const kt=fe[Ie]-fe[Ie-1];Ie++;for(let vt=0;vt<kt;vt++)me=pe[Fe++]=me+Te[nt++]}else for(let Bt=0;Bt<Pt;Bt++)pe[Fe++]=++me,Ie++}return pe}(J,x,C,E)):C!==null&&(C=function(ee,ne,fe){const Te=new Int32Array(ne[ne.length-1]+1);let pe=0;Te[0]=pe;let me=1,Ie=0;for(let Fe=0;Fe<ee.length;Fe++){const nt=ee[Fe],bt=ne[Fe+1]-ne[Fe];if(nt===4||nt===1)for(let mt=0;mt<bt;mt++)pe=Te[me++]=pe+fe[Ie++];else for(let mt=0;mt<bt;mt++)Te[me++]=++pe}return Te}(J,x,C))):C!==null&&E!==null?(C=Y1(J,C,1),E=vC(J,C,E,!0)):C!==null&&(C=Y1(J,C,0)),Z!==null?yC(J,H,Z,L,new qm(x,C,E)):V===null?function(ee,ne,fe,Te){return new pC(Qa.VEC_2,ee,ne,fe,Te)}(J,new qm(x,C,E),R,L):function(ee,ne,fe,Te,pe){return new pC(Qa.MORTON,ee,ne,fe,Te,pe)}(J,new qm(x,C,E),R,L,V))}function Y1(l,r,s){const d=new Int32Array(l.length+1);let g=0;d[0]=g;let _=0;for(let x=0;x<l.length;x++)g=d[x+1]=g+(l[x]>s?r[_++]:1);return d}function vC(l,r,s,d){const g=new Int32Array(r[r.length-1]+1);let _=0;g[0]=_;let x=1,C=0;for(let E=0;E<l.length;E++){const R=l[E],L=r[E+1]-r[E];if(R===5||R===2||d&&(R===4||R===1))for(let V=0;V<L;V++)_=g[x++]=_+s[C++];else for(let V=0;V<L;V++)g[x++]=++_}return g}class R5 extends Um{dataVector;constructor(r,s,d){super(r,s.getBuffer(),d),this.dataVector=s}getValueFromBuffer(r){return this.dataVector.get(r)}}class D5 extends q0{getValueFromBuffer(r){return this.dataBuffer[r]}}class _C extends Um{constructor(r,s,d){super(r,BigInt64Array.of(s),d)}getValueFromBuffer(r){return this.dataBuffer[0]}}function Ey(l,r,s){return xC(l,Math.ceil(r/8),s)}function xC(l,r,s){const d=new Uint8Array(r);let g=0;for(;g<r;){const _=l[s.increment()];if(_<=127){const x=_+3,C=l[s.increment()],E=g+x;d.fill(C,g,E),g=E}else{const x=256-_;for(let C=0;C<x;C++)d[g++]=l[s.increment()]}}return d}const z5=new TextDecoder;function J1(l,r,s){return s-r>=12?z5.decode(l.subarray(r,s)):function(d,g,_){let x="",C=g;for(;C<_;){const E=d[C];let R,L,V,H=null,Z=E>239?4:E>223?3:E>191?2:1;if(C+Z>_)break;Z===1?E<128&&(H=E):Z===2?(R=d[C+1],(192&R)==128&&(H=(31&E)<<6|63&R,H<=127&&(H=null))):Z===3?(R=d[C+1],L=d[C+2],(192&R)==128&&(192&L)==128&&(H=(15&E)<<12|(63&R)<<6|63&L,(H<=2047||H>=55296&&H<=57343)&&(H=null))):Z===4&&(R=d[C+1],L=d[C+2],V=d[C+3],(192&R)==128&&(192&L)==128&&(192&V)==128&&(H=(15&E)<<18|(63&R)<<12|(63&L)<<6|63&V,(H<=65535||H>=1114112)&&(H=null))),H===null?(H=65533,Z=1):H>65535&&(H-=65536,x+=String.fromCharCode(H>>>10&1023|55296),H=56320|1023&H),x+=String.fromCharCode(H),C+=Z}return x}(l,r,s)}class Q1 extends Um{offsetBuffer;constructor(r,s,d,g){super(r,d,g),this.offsetBuffer=s}}class bC extends Q1{textEncoder;constructor(r,s,d,g){super(r,s,d,g??s.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(r){return J1(this.dataBuffer,this.offsetBuffer[r],this.offsetBuffer[r+1])}}class Hm extends Q1{indexBuffer;textEncoder;constructor(r,s,d,g,_){super(r,d,g,_??s.length),this.indexBuffer=s,this.indexBuffer=s,this.textEncoder=new TextEncoder}getValueFromBuffer(r){const s=this.indexBuffer[r];return J1(this.dataBuffer,this.offsetBuffer[s],this.offsetBuffer[s+1])}}class wC extends Q1{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(r,s,d,g,_,x,C){super(r,d,g,C),this.indexBuffer=s,this.symbolOffsetBuffer=_,this.symbolTableBuffer=x,this.textEncoder=new TextEncoder}getValueFromBuffer(r){this.decodedDictionary==null&&(this.symbolLengthBuffer==null&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=function(d,g,_){const x=[],C=new Array(g.length).fill(0);for(let E=1;E<g.length;E++)C[E]=C[E-1]+g[E-1];for(let E=0;E<_.length;E++)if(_[E]===255)x.push(_[++E]);else{const R=g[_[E]],L=C[_[E]];for(let V=0;V<R;V++)x.push(d[L+V])}return new Uint8Array(x)}(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const s=this.indexBuffer[r];return J1(this.decodedDictionary,this.offsetBuffer[s],this.offsetBuffer[s+1])}offsetToLengthBuffer(r){const s=new Uint32Array(r.length-1);let d=r[0];for(let g=1;g<r.length;g++){const _=r[g];s[g-1]=_-d,d=_}return s}}function O5(l,r,s,d,g,_){return s.type==="scalarType"?function(x,C,E,R,L,V){let H=null,Z=0;if(x===0)return null;if(V.nullable){const ee=Ps(C,E);Z=ee.numValues;const ne=E.get(),fe=Ey(C,Z,E);E.set(ne+ee.byteLength),H=new Vc(fe,ee.numValues)}const J=H??R;switch(L.physicalType){case 4:case 3:return function(ee,ne,fe,Te,pe){const me=Ps(ee,ne),Ie=Z0(me,pe,ee,ne),Fe=Te.physicalType===3;if(Ie===Eo.FLAT){const nt=Iy(pe)?H1(ee,ne,me,Fe,pe):Es(ee,ne,me,Fe);return new $1(fe.name,nt,pe)}if(Ie===Eo.SEQUENCE){const nt=iC(ee,ne,me);return new N1(fe.name,nt[0],nt[1],me.numRleValues)}{const nt=q1(ee,ne,me,Fe);return new V1(fe.name,nt,pe)}}(C,E,V,L,J);case 9:return function(ee,ne,fe,Te,pe){let me=null,Ie=null,Fe=null,nt=null,bt=null,mt=null,Pt=null,Bt=null;for(let kt=0;kt<Te;kt++){const vt=Ps(ne,fe);if(vt.byteLength!==0)switch(vt.physicalStreamType){case es.PRESENT:{const ht=Ey(ne,vt.numValues,fe);mt=new Vc(ht,vt.numValues);break}case es.OFFSET:Ie=pe!=null||mt!=null?H1(ne,fe,vt,!1,pe??mt):Es(ne,fe,vt,!1);break;case es.LENGTH:{const ht=hf(ne,fe,vt);va.DICTIONARY===vt.logicalStreamType.lengthType?me=ht:va.SYMBOL===vt.logicalStreamType.lengthType?nt=ht:Pt=ht;break}case es.DATA:{const ht=ne.subarray(fe.get(),fe.get()+vt.byteLength);fe.add(vt.byteLength);const Kt=vt.logicalStreamType.dictionaryType;Nc.FSST===Kt?bt=ht:Nc.SINGLE===Kt||Nc.SHARED===Kt?Fe=ht:Nc.NONE===Kt&&(Bt=ht);break}}}return function(kt,vt,ht,Kt,Ht,Jt,Gt){return vt?new wC(kt,ht,Kt,Ht,Jt,vt,Gt):null}(ee,bt,Ie,me,Fe,nt,pe??mt)??function(kt,vt,ht,Kt,Ht){return vt?Ht?new Hm(kt,ht,Kt,vt,Ht):new Hm(kt,ht,Kt,vt):null}(ee,Fe,Ie,me,pe??mt)??function(kt,vt,ht,Kt,Ht){if(!vt||!ht)return null;if(Kt)return Ht?new Hm(kt,Kt,vt,ht,Ht):new Hm(kt,Kt,vt,ht);if(Ht&&Ht.size()!==vt.length-1){const Jt=new Int32Array(Ht.size());let Gt=0;for(let dr=0;dr<Ht.size();dr++)Jt[dr]=Ht.get(dr)?Gt++:0;return new Hm(kt,Jt,vt,ht,Ht)}return Ht?new bC(kt,vt,ht,Ht):new bC(kt,vt,ht)}(ee,Pt,Bt,Ie,pe??mt)}(V.name,C,E,V.nullable?x-1:x,H);case 0:return function(ee,ne,fe,Te,pe){const me=Ps(ee,ne),Ie=me.numValues,Fe=ne.get(),nt=Iy(pe)?function(mt,Pt,Bt,kt){const vt=xC(mt,Math.ceil(Pt/8),Bt),ht=new Vc(vt,Pt),Kt=kt.size(),Ht=new Vc(new Uint8Array(Kt),Kt);let Jt=0;for(let Gt=0;Gt<kt.size();Gt++){const dr=!!kt.get(Gt)&&ht.get(Jt++);Ht.set(Gt,dr)}return Ht.getBuffer()}(ee,Ie,ne,pe):Ey(ee,Ie,ne);ne.set(Fe+me.byteLength);const bt=new Vc(nt,Ie);return new R5(fe.name,bt,pe)}(C,E,V,0,J);case 6:case 5:return function(ee,ne,fe,Te,pe){const me=Ps(ee,ne),Ie=Z0(me,Te,ee,ne),Fe=pe.physicalType===5;if(Ie===Eo.FLAT){const nt=Iy(Te)?function(bt,mt,Pt,Bt,kt){return function(vt,ht,Kt,Ht){switch(ht.logicalLevelTechnique1){case en.DELTA:return ht.logicalLevelTechnique2===en.RLE&&(vt=tC(vt,ht.runs,ht.numRleValues)),function(Jt,Gt){const dr=new BigInt64Array(Jt.size());let cn=0;Jt.get(0)?(dr[0]=Jt.get(0)?Gt[0]>>1n^-(1n&Gt[0]):0n,cn=1):dr[0]=0n;let Jr=1;for(;Jr!=dr.length;++Jr)dr[Jr]=Jt.get(Jr)?dr[Jr-1]+(Gt[cn]>>1n^-(1n&Gt[cn++])):dr[Jr-1];return dr}(Ht,vt);case en.RLE:return function(Jt,Gt,dr,cn){const Jr=Gt;return dr?function(yi,rs,so){const vi=new BigInt64Array(yi.size());let ci=0;for(let Tn=0;Tn<so;Tn++){const Di=Number(rs[Tn]);let ji=rs[Tn+so];ji=ji>>1n^-(1n&ji);for(let si=ci;si<ci+Di;si++)yi.get(si)?vi[si]=ji:(vi[si]=0n,ci++);ci+=Di}return vi}(cn,Jt,Jr.runs):function(yi,rs,so){const vi=new BigInt64Array(yi.size());let ci=0;for(let Tn=0;Tn<so;Tn++){const Di=Number(rs[Tn]),ji=rs[Tn+so];for(let si=ci;si<ci+Di;si++)yi.get(si)?vi[si]=ji:(vi[si]=0n,ci++);ci+=Di}return vi}(cn,Jt,Jr.runs)}(vt,ht,Kt,Ht);case en.NONE:return vt=Kt?function(Jt,Gt){const dr=new BigInt64Array(Jt.size());let cn=0,Jr=0;for(;Jr!=dr.length;++Jr)if(Jt.get(Jr)){const yi=Gt[cn++];dr[Jr]=yi>>1n^-(1n&yi)}else dr[Jr]=0n;return dr}(Ht,vt):function(Jt,Gt){const dr=new BigInt64Array(Jt.size());let cn=0,Jr=0;for(;Jr!=dr.length;++Jr)dr[Jr]=Jt.get(Jr)?Gt[cn++]:0n;return dr}(Ht,vt),vt;default:throw new Error("The specified Logical level technique is not supported")}}(H0(bt,mt,Pt.numValues),Pt,Bt,kt)}(ee,ne,me,Fe,Te):sC(ee,ne,me,Fe);return new lC(fe.name,nt,Te)}if(Ie===Eo.SEQUENCE){const nt=oC(ee,ne,me);return new cC(fe.name,nt[0],nt[1],me.numRleValues)}{const nt=aC(ee,ne,me,Fe);return new _C(fe.name,nt,Te)}}(C,E,V,J,L);case 7:return function(ee,ne,fe,Te){const pe=Ps(ee,ne),me=Iy(Te)?function(Ie,Fe,nt,bt){const mt=Fe.get(),Pt=mt+bt*Float32Array.BYTES_PER_ELEMENT,Bt=new Uint8Array(Ie.subarray(mt,Pt)).buffer,kt=new Float32Array(Bt);Fe.set(Pt);const vt=nt.size(),ht=new Float32Array(vt);let Kt=0;for(let Ht=0;Ht<vt;Ht++)ht[Ht]=nt.get(Ht)?kt[Kt++]:0;return ht}(ee,ne,Te,pe.numValues):function(Ie,Fe,nt){const bt=Fe.get(),mt=bt+nt*Float32Array.BYTES_PER_ELEMENT,Pt=new Uint8Array(Ie.subarray(bt,mt)).buffer,Bt=new Float32Array(Pt);return Fe.set(mt),Bt}(ee,ne,pe.numValues);return new D5(fe.name,me,Te)}(C,E,V,J);case 8:return function(ee,ne,fe,Te){const pe=Ps(ee,ne),me=Iy(Te)?function(Ie,Fe,nt,bt){const mt=Fe.get(),Pt=mt+bt*Float64Array.BYTES_PER_ELEMENT,Bt=new Uint8Array(Ie.subarray(mt,Pt)).buffer,kt=new Float64Array(Bt);Fe.set(Pt);const vt=nt.size(),ht=new Float64Array(vt);let Kt=0;for(let Ht=0;Ht<vt;Ht++)ht[Ht]=nt.get(Ht)?kt[Kt++]:0;return ht}(ee,ne,Te,pe.numValues):function(Ie,Fe,nt){const bt=Fe.get(),mt=bt+nt*Float64Array.BYTES_PER_ELEMENT,Pt=new Uint8Array(Ie.subarray(bt,mt)).buffer,Bt=new Float64Array(Pt);return Fe.set(mt),Bt}(ee,ne,pe.numValues);return new j1(fe.name,me,Te)}(C,E,V,J);default:throw new Error(`The specified data type for the field is currently not supported: ${L}`)}}(d,l,r,g,s.scalarType,s):d!=1?null:function(x,C,E,R){let L=null,V=null,H=null,Z=null,J=!1;for(;!J;){const Te=Ps(x,C);switch(Te.physicalStreamType){case es.LENGTH:va.DICTIONARY===Te.logicalStreamType.lengthType?L=hf(x,C,Te):H=hf(x,C,Te);break;case es.DATA:Nc.SINGLE===Te.logicalStreamType.dictionaryType||Nc.SHARED===Te.logicalStreamType.dictionaryType?(V=x.subarray(C.get(),C.get()+Te.byteLength),J=!0):Z=x.subarray(C.get(),C.get()+Te.byteLength),C.add(Te.byteLength)}}const ee=E.complexType.children,ne=[];let fe=0;for(const Te of ee){const pe=No(x,C,1)[0];if(pe==0)continue;const me=`${E.name}${Te.name==="default"?"":":"+Te.name}`;if(pe!==2||Te.type!=="scalarField"||Te.scalarField.physicalType!==9)throw new Error("Currently only optional string fields are implemented for a struct.");const Ie=Ps(x,C),Fe=Ey(x,Ie.numValues,C),nt=Ps(x,C),bt=nt.decompressedCount!==R?H1(x,C,nt,!1,new Vc(Fe,Ie.numValues)):Es(x,C,nt,!1);ne[fe++]=Z?new wC(me,bt,L,V,H,Z,new Vc(Fe,Ie.numValues)):new Hm(me,bt,L,V,new Vc(Fe,Ie.numValues))}return ne}(l,r,s,g)}function Iy(l){return l instanceof Vc}function L5(l){if(l.name==="id")return!1;if(l.type==="scalarType"){const r=l.scalarType;if(r.type==="physicalType")switch(r.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if(r.type==="logicalType")return!1}else if(l.type==="complexType"){const r=l.complexType;if(r.type==="physicalType")switch(r.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn("Unexpected column type in hasStreamCount",l),!1}const F5=new TextDecoder;function SC(l,r){const s=No(l,r,1)[0];if(s===0)return"";const d=r.get(),g=l.subarray(d,d+s);return r.add(s),F5.decode(g)}function CC(l,r){const s=No(l,r,1)[0]>>>0,d=!!(4&s),g=!!(2&s),_=No(l,r,1)[0]>>>0,x={};if(1&s&&(x.nullable=!0),g){const C={};if(d?(C.type="logicalType",C.logicalType=_):(C.type="physicalType",C.physicalType=_),8&s){const E=No(l,r,1)[0]>>>0;C.children=new Array(E);for(let R=0;R<E;R++)C.children[R]=CC(l,r)}x.type="complexField",x.complexField=C}else{const C={};d?(C.type="logicalType",C.logicalType=_):(C.type="physicalType",C.physicalType=_),x.type="scalarField",x.scalarField=C}return x}function B5(l,r){const s=No(l,r,1)[0]>>>0,d=function(g){switch(g){case 0:case 1:case 2:case 3:{const _={};_.nullable=!!(1&g),_.columnScope=0;const x={};return x.physicalType=g>1?6:4,x.type="physicalType",_.scalarType=x,_.type="scalarType",_}case 4:{const _={nullable:!1,columnScope:0},x={type:"physicalType",physicalType:0};return _.type="complexType",_.complexType=x,_}case 30:{const _={nullable:!1,columnScope:0},x={type:"physicalType",physicalType:1};return _.type="complexType",_.complexType=x,_}default:return function(_){let x=null;switch(_){case 10:case 11:x=0;break;case 12:case 13:x=1;break;case 14:case 15:x=2;break;case 16:case 17:x=3;break;case 18:case 19:x=4;break;case 20:case 21:x=5;break;case 22:case 23:x=6;break;case 24:case 25:x=7;break;case 26:case 27:x=8;break;case 28:case 29:x=9;break;default:return null}const C={};C.nullable=!!(1&_),C.columnScope=0;const E={type:"physicalType"};return E.physicalType=x,C.type="scalarType",C.scalarType=E,C}(g)}}(s);if(!d)throw new Error(`Unsupported column type code: ${s}`);if(function(g){return g>=10}(s)?d.name=SC(l,r):s>=0&&s<=3?d.name="id":s===4&&(d.name="geometry"),function(g){return g===30}(s)){const g=No(l,r,1)[0]>>>0,_=d.complexType;_.children=new Array(g);for(let x=0;x<g;x++)_.children[x]=CC(l,r)}return d}function $5(l,r){const s={featureTables:[]},d={};d.name=SC(l,r);const g=No(l,r,1)[0]>>>0,_=No(l,r,1)[0]>>>0;d.columns=new Array(_);for(let x=0;x<_;x++)d.columns[x]=B5(l,r);return s.featureTables.push(d),[s,g]}function j5(l,r,s,d,g,_,x=!1){const C=r.scalarType.physicalType,E=Z0(g,_,l,s);if(C===4)switch(E){case Eo.FLAT:{const R=Es(l,s,g,!1);return new $1(d,R,_)}case Eo.SEQUENCE:{const R=iC(l,s,g);return new N1(d,R[0],R[1],g.numRleValues)}case Eo.CONST:{const R=q1(l,s,g,!1);return new V1(d,R,_)}}else switch(E){case Eo.FLAT:{if(x){const L=function(V,H,Z,J){const ee=function(ne,fe,Te){const pe=new Float64Array(fe);for(let me=0;me<fe;me++)pe[me]=M5(ne,Te);return pe}(V,Z.numValues,H);return function(ne,fe,Te){switch(fe.logicalLevelTechnique1){case en.DELTA:return fe.logicalLevelTechnique2===en.RLE&&(ne=rC(ne,fe.runs,fe.numRleValues)),function(pe){pe[0]=pe[0]%2==1?(pe[0]+1)/-2:pe[0]/2;const me=pe.length/4*4;let Ie=1;if(me>=4)for(;Ie<me-4;Ie+=4){const Fe=pe[Ie],nt=pe[Ie+1],bt=pe[Ie+2],mt=pe[Ie+3];pe[Ie]=(Fe%2==1?(Fe+1)/-2:Fe/2)+pe[Ie-1],pe[Ie+1]=(nt%2==1?(nt+1)/-2:nt/2)+pe[Ie],pe[Ie+2]=(bt%2==1?(bt+1)/-2:bt/2)+pe[Ie+1],pe[Ie+3]=(mt%2==1?(mt+1)/-2:mt/2)+pe[Ie+2]}for(;Ie!=pe.length;++Ie)pe[Ie]=(pe[Ie]%2==1?(pe[Ie]+1)/-2:pe[Ie]/2)+pe[Ie-1]}(ne),ne;case en.RLE:return function(pe,me,Ie){return rC(pe,me.runs,me.numRleValues)}(ne,fe);case en.NONE:return ne;default:throw new Error(`The specified Logical level technique is not supported: ${fe.logicalLevelTechnique1}`)}}(ee,Z)}(l,s,g);return new j1(d,L,_)}const R=sC(l,s,g,!1);return new lC(d,R,_)}case Eo.SEQUENCE:{const R=oC(l,s,g);return new cC(d,R[0],R[1],g.numRleValues)}case Eo.CONST:{const R=aC(l,s,g,!1);return new _C(d,R,_)}}throw new Error("Vector type not supported for id column.")}class N5{constructor(r,s){var d;switch(this._featureData=r,this.properties=this._featureData.properties||{},(d=this._featureData.geometry)===null||d===void 0?void 0:d.type){case Io.POINT:case Io.MULTIPOINT:this.type=1;break;case Io.LINESTRING:case Io.MULTILINESTRING:this.type=2;break;case Io.POLYGON:case Io.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=s,this.id=Number(this._featureData.id)}loadGeometry(){const r=[];for(const s of this._featureData.geometry.coordinates){const d=[];for(const g of s)d.push(new b(g.x,g.y));r.push(d)}return r}}class V5{constructor(r){this.features=[],this.featureTable=r,this.name=r.name,this.extent=r.extent,this.version=2,this.features=r.getFeatures(),this.length=this.features.length}feature(r){return new N5(this.features[r],this.extent)}}class TC{constructor(r){this.layers={};const s=function(d,g,_=!0){const x=new T5(0),C=[];for(;x.get()<d.length;){const E=No(d,x,1)[0]>>>0,R=x.get()+E;if(R>d.length)throw new Error(`Block overruns tile: ${R} > ${d.length}`);if(No(d,x,1)[0]>>>0!=1){x.set(R);continue}const L=$5(d,x),V=L[1],H=L[0].featureTables[0];let Z=null,J=null;const ee=[];let ne=0;for(const Te of H.columns){const pe=Te.name;if(pe==="id"){let me=null;if(Te.nullable){const Fe=Ps(d,x),nt=x.get(),bt=Ey(d,Fe.numValues,x);x.set(nt+Fe.byteLength),me=new Vc(bt,Fe.numValues)}const Ie=Ps(d,x);ne=Ie.decompressedCount,Z=j5(d,Te,x,pe,Ie,me??ne,_)}else if(pe==="geometry"){const me=No(d,x,1)[0];if(ne===0){const Ie=x.get();ne=Ps(d,x).decompressedCount,x.set(Ie)}J=A5(d,me,x,ne)}else{const me=L5(Te)?No(d,x,1)[0]:1;if(me===0&&Te.type==="scalarType")continue;const Ie=O5(d,x,Te,me,ne);if(Ie)if(Array.isArray(Ie))for(const Fe of Ie)ee.push(Fe);else ee.push(Ie)}}const fe=new C5(H.name,J,Z,ee,V);C.push(fe),x.set(R)}return C}(new Uint8Array(r));this.layers=s.reduce((d,g)=>Object.assign(Object.assign({},d),{[g.name]:new V5(g)}),{})}}class U5{constructor(r,s){this.feature=r,this.type=r.type,this.properties=r.tags?r.tags:{},this.extent=s,"id"in r&&(typeof r.id=="string"?this.id=parseInt(r.id,10):typeof r.id!="number"||isNaN(r.id)||(this.id=r.id))}loadGeometry(){const r=[],s=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const d of s){const g=[];for(const _ of d)g.push(new b(_[0],_[1]));r.push(g)}return r}}const ky="_geojsonTileLayer";function G5(l,r){r.writeVarintField(15,l.version||1),r.writeStringField(1,l.name||""),r.writeVarintField(5,l.extent||4096);const s={keys:[],values:[],keycache:{},valuecache:{}};for(let _=0;_<l.length;_++)s.feature=l.feature(_),r.writeMessage(2,q5,s);const d=s.keys;for(const _ of d)r.writeStringField(3,_);const g=s.values;for(const _ of g)r.writeMessage(4,Z5,_)}function q5(l,r){if(!l.feature)return;const s=l.feature;s.id!==void 0&&r.writeVarintField(1,s.id),r.writeMessage(2,H5,l),r.writeVarintField(3,s.type),r.writeMessage(4,W5,s)}function H5(l,r){for(const s in l.feature?.properties){let d=l.feature.properties[s],g=l.keycache[s];if(d==null)continue;g===void 0&&(l.keys.push(s),g=l.keys.length-1,l.keycache[s]=g),r.writeVarint(g),typeof d!="string"&&typeof d!="boolean"&&typeof d!="number"&&(d=JSON.stringify(d));const _=typeof d+":"+d;let x=l.valuecache[_];x===void 0&&(l.values.push(d),x=l.values.length-1,l.valuecache[_]=x),r.writeVarint(x)}}function eb(l,r){return(r<<3)+(7&l)}function MC(l){return l<<1^l>>31}function W5(l,r){const s=l.loadGeometry(),d=l.type;let g=0,_=0;for(const x of s){let C=1;d===1&&(C=x.length),r.writeVarint(eb(1,C));const E=d===3?x.length-1:x.length;for(let R=0;R<E;R++){R===1&&d!==1&&r.writeVarint(eb(2,E-1));const L=x[R].x-g,V=x[R].y-_;r.writeVarint(MC(L)),r.writeVarint(MC(V)),g+=L,_+=V}l.type===3&&r.writeVarint(eb(7,1))}}function Z5(l,r){const s=typeof l;s==="string"?r.writeStringField(1,l):s==="boolean"?r.writeBooleanField(7,l):s==="number"&&(l%1!=0?r.writeDoubleField(3,l):l<0?r.writeSVarintField(6,l):r.writeVarintField(5,l))}class PC{constructor(r,s){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new Wo(je,16,0),this.grid3D=new Wo(je,16,0),this.featureIndexArray=new ce,this.promoteId=s}insert(r,s,d,g,_,x){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,g,_);const E=x?this.grid3D:this.grid;for(let R=0;R<s.length;R++){const L=s[R],V=[1/0,1/0,-1/0,-1/0];for(let H=0;H<L.length;H++){const Z=L[H];V[0]=Math.min(V[0],Z.x),V[1]=Math.min(V[1],Z.y),V[2]=Math.max(V[2],Z.x),V[3]=Math.max(V[3],Z.y)}V[0]<je&&V[1]<je&&V[2]>=0&&V[3]>=0&&E.insert(C,V[0],V[1],V[2],V[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=this.encoding!=="mlt"?new E0(new p(this.rawTileData)).layers:new TC(this.rawTileData).layers,this.sourceLayerCoder=new XS(this.vtLayers?Object.keys(this.vtLayers).sort():[ky])),this.vtLayers}query(r,s,d,g){this.loadVTLayers();const _=r.params,x=je/r.tileSize/r.scale,C=bc(_.filter,_.globalState),E=r.queryGeometry,R=r.queryPadding*x,L=Sp.fromPoints(E),V=this.grid.query(L.minX-R,L.minY-R,L.maxX+R,L.maxY+R),H=Sp.fromPoints(r.cameraQueryGeometry).expandBy(R),Z=this.grid3D.query(H.minX,H.minY,H.maxX,H.maxY,(ne,fe,Te,pe)=>function(me,Ie,Fe,nt,bt){for(const Pt of me)if(Ie<=Pt.x&&Fe<=Pt.y&&nt>=Pt.x&&bt>=Pt.y)return!0;const mt=[new b(Ie,Fe),new b(Ie,bt),new b(nt,bt),new b(nt,Fe)];if(me.length>2){for(const Pt of mt)if(Oc(me,Pt))return!0}for(let Pt=0;Pt<me.length-1;Pt++)if(Lc(me[Pt],me[Pt+1],mt))return!0;return!1}(r.cameraQueryGeometry,ne-R,fe-R,Te+R,pe+R));for(const ne of Z)V.push(ne);V.sort(X5);const J={};let ee;for(let ne=0;ne<V.length;ne++){const fe=V[ne];if(fe===ee)continue;ee=fe;const Te=this.featureIndexArray.get(fe);let pe=null;this.loadMatchingFeature(J,Te.bucketIndex,Te.sourceLayerIndex,Te.featureIndex,C,_.layers,_.availableImages,s,d,g,(me,Ie,Fe)=>(pe||(pe=pa(me)),Ie.queryIntersectsFeature({queryGeometry:E,feature:me,featureState:Fe,geometry:pe,zoom:this.z,transform:r.transform,pixelsToTileUnits:x,pixelPosMatrix:r.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:r.getElevation})))}return J}loadMatchingFeature(r,s,d,g,_,x,C,E,R,L,V){const H=this.bucketLayerIDs[s];if(x&&!H.some(ne=>x.has(ne)))return;const Z=this.sourceLayerCoder.decode(d),J=this.vtLayers[Z].feature(g);if(_.needGeometry){const ne=Ha(J,!0);if(!_.filter(new Sn(this.tileID.overscaledZ),ne,this.tileID.canonical))return}else if(!_.filter(new Sn(this.tileID.overscaledZ),J))return;const ee=this.getId(J,Z);for(let ne=0;ne<H.length;ne++){const fe=H[ne];if(x&&!x.has(fe))continue;const Te=E[fe];if(!Te)continue;let pe={};ee&&L&&(pe=L.getState(Te.sourceLayer||ky,ee));const me=tt({},R[fe]);me.paint=EC(me.paint,Te.paint,J,pe,C),me.layout=EC(me.layout,Te.layout,J,pe,C);const Ie=!V||V(J,Te,pe);if(!Ie)continue;const Fe=new KS(J,this.z,this.x,this.y,ee);Fe.layer=me;let nt=r[fe];nt===void 0&&(nt=r[fe]=[]),nt.push({featureIndex:g,feature:Fe,intersectionZ:Ie})}}lookupSymbolFeatures(r,s,d,g,_,x,C,E){const R={};this.loadVTLayers();const L=bc(_.filterSpec,_.globalState);for(const V of r)this.loadMatchingFeature(R,d,g,V,L,x,C,E,s);return R}hasLayer(r){for(const s of this.bucketLayerIDs)for(const d of s)if(r===d)return!0;return!1}getId(r,s){var d;let g=r.id;return this.promoteId&&(g=r.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[s]],typeof g=="boolean"&&(g=Number(g)),g===void 0&&(!((d=r.properties)===null||d===void 0)&&d.cluster)&&this.promoteId&&(g=Number(r.properties.cluster_id))),g}}function EC(l,r,s,d,g){return It(l,(_,x)=>{const C=r instanceof sa?r.get(x):null;return C&&C.evaluate?C.evaluate(s,d,g):C})}function X5(l,r){return r-l}function IC(l,r,s,d,g){const _=[];for(let x=0;x<l.length;x++){const C=l[x];let E;for(let R=0;R<C.length-1;R++){let L=C[R],V=C[R+1];L.x<r&&V.x<r||(L.x<r?L=new b(r,L.y+(r-L.x)/(V.x-L.x)*(V.y-L.y))._round():V.x<r&&(V=new b(r,L.y+(r-L.x)/(V.x-L.x)*(V.y-L.y))._round()),L.y<s&&V.y<s||(L.y<s?L=new b(L.x+(s-L.y)/(V.y-L.y)*(V.x-L.x),s)._round():V.y<s&&(V=new b(L.x+(s-L.y)/(V.y-L.y)*(V.x-L.x),s)._round()),L.x>=d&&V.x>=d||(L.x>=d?L=new b(d,L.y+(d-L.x)/(V.x-L.x)*(V.y-L.y))._round():V.x>=d&&(V=new b(d,L.y+(d-L.x)/(V.x-L.x)*(V.y-L.y))._round()),L.y>=g&&V.y>=g||(L.y>=g?L=new b(L.x+(g-L.y)/(V.y-L.y)*(V.x-L.x),g)._round():V.y>=g&&(V=new b(L.x+(g-L.y)/(V.y-L.y)*(V.x-L.x),g)._round()),E&&L.equals(E[E.length-1])||(E=[L],_.push(E)),E.push(V)))))}}return _}function kC(l,r,s,d,g){switch(r){case 1:return function(_,x,C,E){const R=[];for(const L of _)for(const V of L){const H=E===0?V.x:V.y;H>=x&&H<=C&&R.push([V])}return R}(l,s,d,g);case 2:return AC(l,s,d,g,!1);case 3:return AC(l,s,d,g,!0)}return[]}function K5(l,r,s,d,g){const _=d===0?Y5:J5;let x=[];const C=[];for(let L=0;L<l.length-1;L++){const V=l[L],H=l[L+1],Z=d===0?V.x:V.y,J=d===0?H.x:H.y;let ee=!1;Z<r?J>r&&x.push(_(V,H,r)):Z>s?J<s&&x.push(_(V,H,s)):x.push(V),J<r&&Z>=r&&(x.push(_(V,H,r)),ee=!0),J>s&&Z<=s&&(x.push(_(V,H,s)),ee=!0),!g&&ee&&(C.push(x),x=[])}const E=l.length-1,R=d===0?l[E].x:l[E].y;return R>=r&&R<=s&&x.push(l[E]),g&&x.length>0&&!x[0].equals(x[x.length-1])&&x.push(new b(x[0].x,x[0].y)),x.length>0&&C.push(x),C}function AC(l,r,s,d,g){const _=[];for(const x of l){const C=K5(x,r,s,d,g);C.length>0&&_.push(...C)}return _}function Y5(l,r,s){return new b(s,l.y+(s-l.x)/(r.x-l.x)*(r.y-l.y))}function J5(l,r,s){return new b(l.x+(s-l.y)/(r.y-l.y)*(r.x-l.x),s)}Ut("FeatureIndex",PC,{omit:["rawTileData","sourceLayerCoder"]});class df extends b{constructor(r,s,d,g){super(r,s),this.angle=d,g!==void 0&&(this.segment=g)}clone(){return new df(this.x,this.y,this.angle,this.segment)}}function RC(l,r,s,d,g){if(r.segment===void 0||s===0)return!0;let _=r,x=r.segment+1,C=0;for(;C>-s/2;){if(x--,x<0)return!1;C-=l[x].dist(_),_=l[x]}C+=l[x].dist(l[x+1]),x++;const E=[];let R=0;for(;C<s/2;){const L=l[x],V=l[x+1];if(!V)return!1;let H=l[x-1].angleTo(L)-L.angleTo(V);for(H=Math.abs((H+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:C,angleDelta:H}),R+=H;C-E[0].distance>d;)R-=E.shift().angleDelta;if(R>g)return!1;x++,C+=L.dist(V)}return!0}function DC(l){let r=0;for(let s=0;s<l.length-1;s++)r+=l[s].dist(l[s+1]);return r}function zC(l,r,s){return l?.6*r*s:0}function OC(l,r){return Math.max(l?l.right-l.left:0,r?r.right-r.left:0)}function Q5(l,r,s,d,g,_){const x=zC(s,g,_),C=OC(s,d)*_;let E=0;const R=DC(l)/2;for(let L=0;L<l.length-1;L++){const V=l[L],H=l[L+1],Z=V.dist(H);if(E+Z>R){const J=(R-E)/Z,ee=ti.number(V.x,H.x,J),ne=ti.number(V.y,H.y,J),fe=new df(ee,ne,H.angleTo(V),L);return fe._round(),!x||RC(l,fe,C,x,r)?fe:void 0}E+=Z}}function eD(l,r,s,d,g,_,x,C,E){const R=zC(d,_,x),L=OC(d,g),V=L*x,H=l[0].x===0||l[0].x===E||l[0].y===0||l[0].y===E;return r-V<r/4&&(r=V+r/4),LC(l,H?r/2*C%r:(L/2+2*_)*x*C%r,r,R,s,V,H,!1,E)}function LC(l,r,s,d,g,_,x,C,E){const R=_/2,L=DC(l);let V=0,H=r-s,Z=[];for(let J=0;J<l.length-1;J++){const ee=l[J],ne=l[J+1],fe=ee.dist(ne),Te=ne.angleTo(ee);for(;H+s<V+fe;){H+=s;const pe=(H-V)/fe,me=ti.number(ee.x,ne.x,pe),Ie=ti.number(ee.y,ne.y,pe);if(me>=0&&me<E&&Ie>=0&&Ie<E&&H-R>=0&&H+R<=L){const Fe=new df(me,Ie,Te,J);Fe._round(),d&&!RC(l,Fe,_,d,g)||Z.push(Fe)}}V+=fe}return C||Z.length||x||(Z=LC(l,V/2,s,d,g,_,x,!0,E)),Z}function FC(l,r,s,d){const g=[],_=l.image,x=_.pixelRatio,C=_.paddedRect.w-2,E=_.paddedRect.h-2;let R={x1:l.left,y1:l.top,x2:l.right,y2:l.bottom};const L=_.stretchX||[[0,C]],V=_.stretchY||[[0,E]],H=(ht,Kt)=>ht+Kt[1]-Kt[0],Z=L.reduce(H,0),J=V.reduce(H,0),ee=C-Z,ne=E-J;let fe=0,Te=Z,pe=0,me=J,Ie=0,Fe=ee,nt=0,bt=ne;if(_.content&&d){const ht=_.content,Kt=ht[2]-ht[0],Ht=ht[3]-ht[1];(_.textFitWidth||_.textFitHeight)&&(R=N0(l)),fe=J0(L,0,ht[0]),pe=J0(V,0,ht[1]),Te=J0(L,ht[0],ht[2]),me=J0(V,ht[1],ht[3]),Ie=ht[0]-fe,nt=ht[1]-pe,Fe=Kt-Te,bt=Ht-me}const mt=R.x1,Pt=R.y1,Bt=R.x2-mt,kt=R.y2-Pt,vt=(ht,Kt,Ht,Jt)=>{const Gt=Q0(ht.stretch-fe,Te,Bt,mt),dr=e_(ht.fixed-Ie,Fe,ht.stretch,Z),cn=Q0(Kt.stretch-pe,me,kt,Pt),Jr=e_(Kt.fixed-nt,bt,Kt.stretch,J),yi=Q0(Ht.stretch-fe,Te,Bt,mt),rs=e_(Ht.fixed-Ie,Fe,Ht.stretch,Z),so=Q0(Jt.stretch-pe,me,kt,Pt),vi=e_(Jt.fixed-nt,bt,Jt.stretch,J),ci=new b(Gt,cn),Tn=new b(yi,cn),Di=new b(yi,so),ji=new b(Gt,so),si=new b(dr/x,Jr/x),Zs=new b(rs/x,vi/x),ns=r*Math.PI/180;if(ns){const ko=Math.sin(ns),Mi=Math.cos(ns),ao=[Mi,-ko,ko,Mi];ci._matMult(ao),Tn._matMult(ao),ji._matMult(ao),Di._matMult(ao)}const Xs=ht.stretch+ht.fixed,Vl=Kt.stretch+Kt.fixed;return{tl:ci,tr:Tn,bl:ji,br:Di,tex:{x:_.paddedRect.x+1+Xs,y:_.paddedRect.y+1+Vl,w:Ht.stretch+Ht.fixed-Xs,h:Jt.stretch+Jt.fixed-Vl},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:si,pixelOffsetBR:Zs,minFontScaleX:Fe/x/Bt,minFontScaleY:bt/x/kt,isSDF:s}};if(d&&(_.stretchX||_.stretchY)){const ht=BC(L,ee,Z),Kt=BC(V,ne,J);for(let Ht=0;Ht<ht.length-1;Ht++){const Jt=ht[Ht],Gt=ht[Ht+1];for(let dr=0;dr<Kt.length-1;dr++)g.push(vt(Jt,Kt[dr],Gt,Kt[dr+1]))}}else g.push(vt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:E+1}));return g}function J0(l,r,s){let d=0;for(const g of l)d+=Math.max(r,Math.min(s,g[1]))-Math.max(r,Math.min(s,g[0]));return d}function BC(l,r,s){const d=[{fixed:-1,stretch:0}];for(const[g,_]of l){const x=d[d.length-1];d.push({fixed:g-x.stretch,stretch:x.stretch}),d.push({fixed:g-x.stretch,stretch:x.stretch+(_-g)})}return d.push({fixed:r+1,stretch:s}),d}function Q0(l,r,s,d){return l/r*s+d}function e_(l,r,s,d){return l-r*s/d}Ut("Anchor",df);class t_{constructor(r,s,d,g,_,x,C,E,R,L){var V;if(this.boxStartIndex=r.length,R){let H=x.top,Z=x.bottom;const J=x.collisionPadding;J&&(H-=J[1],Z+=J[3]);let ee=Z-H;ee>0&&(ee=Math.max(10,ee),this.circleDiameter=ee)}else{const H=!((V=x.image)===null||V===void 0)&&V.content&&(x.image.textFitWidth||x.image.textFitHeight)?N0(x):{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom};H.y1=H.y1*C-E[0],H.y2=H.y2*C+E[2],H.x1=H.x1*C-E[3],H.x2=H.x2*C+E[1];const Z=x.collisionPadding;if(Z&&(H.x1-=Z[0]*C,H.y1-=Z[1]*C,H.x2+=Z[2]*C,H.y2+=Z[3]*C),L){const J=new b(H.x1,H.y1),ee=new b(H.x2,H.y1),ne=new b(H.x1,H.y2),fe=new b(H.x2,H.y2),Te=L*Math.PI/180;J._rotate(Te),ee._rotate(Te),ne._rotate(Te),fe._rotate(Te),H.x1=Math.min(J.x,ee.x,ne.x,fe.x),H.x2=Math.max(J.x,ee.x,ne.x,fe.x),H.y1=Math.min(J.y,ee.y,ne.y,fe.y),H.y2=Math.max(J.y,ee.y,ne.y,fe.y)}r.emplaceBack(s.x,s.y,H.x1,H.y1,H.x2,H.y2,d,g,_)}this.boxEndIndex=r.length}}class tD{constructor(r=[],s=(d,g)=>d<g?-1:d>g?1:0){if(this.data=r,this.length=this.data.length,this.compare=s,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:s,compare:d}=this,g=s[r];for(;r>0;){const _=r-1>>1,x=s[_];if(d(g,x)>=0)break;s[r]=x,r=_}s[r]=g}_down(r){const{data:s,compare:d}=this,g=this.length>>1,_=s[r];for(;r<g;){let x=1+(r<<1);const C=x+1;if(C<this.length&&d(s[C],s[x])<0&&(x=C),d(s[x],_)>=0)break;s[r]=s[x],r=x}s[r]=_}}function rD(l,r=1,s=!1){const d=Sp.fromPoints(l[0]),g=Math.min(d.width(),d.height());let _=g/2;const x=new tD([],nD),{minX:C,minY:E,maxX:R,maxY:L}=d;if(g===0)return new b(C,E);for(let Z=C;Z<R;Z+=g)for(let J=E;J<L;J+=g)x.push(new Wm(Z+_,J+_,_,l));let V=function(Z){let J=0,ee=0,ne=0;const fe=Z[0];for(let Te=0,pe=fe.length,me=pe-1;Te<pe;me=Te++){const Ie=fe[Te],Fe=fe[me],nt=Ie.x*Fe.y-Fe.x*Ie.y;ee+=(Ie.x+Fe.x)*nt,ne+=(Ie.y+Fe.y)*nt,J+=3*nt}return new Wm(ee/J,ne/J,0,Z)}(l),H=x.length;for(;x.length;){const Z=x.pop();(Z.d>V.d||!V.d)&&(V=Z,s&&console.log("found best %d after %d probes",Math.round(1e4*Z.d)/1e4,H)),Z.max-V.d<=r||(_=Z.h/2,x.push(new Wm(Z.p.x-_,Z.p.y-_,_,l)),x.push(new Wm(Z.p.x+_,Z.p.y-_,_,l)),x.push(new Wm(Z.p.x-_,Z.p.y+_,_,l)),x.push(new Wm(Z.p.x+_,Z.p.y+_,_,l)),H+=4)}return s&&(console.log(`num probes: ${H}`),console.log(`best distance: ${V.d}`)),V.p}function nD(l,r){return r.max-l.max}function Wm(l,r,s,d){this.p=new b(l,r),this.h=s,this.d=function(g,_){let x=!1,C=1/0;for(let E=0;E<_.length;E++){const R=_[E];for(let L=0,V=R.length,H=V-1;L<V;H=L++){const Z=R[L],J=R[H];Z.y>g.y!=J.y>g.y&&g.x<(J.x-Z.x)*(g.y-Z.y)/(J.y-Z.y)+Z.x&&(x=!x),C=Math.min(C,Pm(g,Z,J))}}return(x?1:-1)*Math.sqrt(C)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}var ts;f.aP=void 0,(ts=f.aP||(f.aP={}))[ts.center=1]="center",ts[ts.left=2]="left",ts[ts.right=3]="right",ts[ts.top=4]="top",ts[ts.bottom=5]="bottom",ts[ts["top-left"]=6]="top-left",ts[ts["top-right"]=7]="top-right",ts[ts["bottom-left"]=8]="bottom-left",ts[ts["bottom-right"]=9]="bottom-right";const tb=Number.POSITIVE_INFINITY;function $C(l,r){return r[1]!==tb?function(s,d,g){let _=0,x=0;switch(d=Math.abs(d),g=Math.abs(g),s){case"top-right":case"top-left":case"top":x=g-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-g}switch(s){case"top-right":case"bottom-right":case"right":_=-d;break;case"top-left":case"bottom-left":case"left":_=d}return[_,x]}(l,r[0],r[1]):function(s,d){let g=0,_=0;d<0&&(d=0);const x=d/Math.SQRT2;switch(s){case"top-right":case"top-left":_=x-7;break;case"bottom-right":case"bottom-left":_=7-x;break;case"bottom":_=7-d;break;case"top":_=d-7}switch(s){case"top-right":case"bottom-right":g=-x;break;case"top-left":case"bottom-left":g=x;break;case"left":g=d;break;case"right":g=-d}return[g,_]}(l,r[0])}function jC(l,r,s){var d;const g=l.layout,_=(d=g.get("text-variable-anchor-offset"))===null||d===void 0?void 0:d.evaluate(r,{},s);if(_){const C=_.values,E=[];for(let R=0;R<C.length;R+=2){const L=E[R]=C[R],V=C[R+1].map(H=>H*oo);L.startsWith("top")?V[1]-=7:L.startsWith("bottom")&&(V[1]+=7),E[R+1]=V}return new Do(E)}const x=g.get("text-variable-anchor");if(x){let C;C=l._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[g.get("text-radial-offset").evaluate(r,{},s)*oo,tb]:g.get("text-offset").evaluate(r,{},s).map(R=>R*oo);const E=[];for(const R of x)E.push(R,$C(R,C));return new Do(E)}return null}function rb(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function iD(l,r,s,d,g,_,x,C,E,R,L,V){let H=_.textMaxSize.evaluate(r,{});H===void 0&&(H=x);const Z=l.layers[0].layout,J=Z.get("icon-offset").evaluate(r,{},L),ee=VC(s.horizontal),ne=x/24,fe=l.tilePixelRatio*ne,Te=l.tilePixelRatio*H/24,pe=l.tilePixelRatio*C,me=l.tilePixelRatio*Z.get("symbol-spacing"),Ie=Z.get("text-padding")*l.tilePixelRatio,Fe=function(Ht,Jt,Gt,dr=1){const cn=Ht.get("icon-padding").evaluate(Jt,{},Gt),Jr=cn&&cn.values;return[Jr[0]*dr,Jr[1]*dr,Jr[2]*dr,Jr[3]*dr]}(Z,r,L,l.tilePixelRatio),nt=Z.get("text-max-angle")/180*Math.PI,bt=Z.get("text-rotation-alignment")!=="viewport"&&Z.get("symbol-placement")!=="point",mt=Z.get("icon-rotation-alignment")==="map"&&Z.get("symbol-placement")!=="point",Pt=Z.get("symbol-placement"),Bt=me/2,kt=Z.get("icon-text-fit");let vt;d&&kt!=="none"&&(l.allowVerticalPlacement&&s.vertical&&(vt=DS(d,s.vertical,kt,Z.get("icon-text-fit-padding"),J,ne)),ee&&(d=DS(d,ee,kt,Z.get("icon-text-fit-padding"),J,ne)));const ht=L?V.line.getGranularityForZoomLevel(L.z):1,Kt=(Ht,Jt)=>{Jt.x<0||Jt.x>=je||Jt.y<0||Jt.y>=je||function(Gt,dr,cn,Jr,yi,rs,so,vi,ci,Tn,Di,ji,si,Zs,ns,Xs,Vl,ko,Mi,ao,zi,Ao,Xh,Uc,Dy){const ff=Gt.addToLineVertexArray(dr,cn);let Mp,Zm,Xm,Km,HC=0,WC=0,ZC=0,XC=0,ub=-1,hb=-1;const Kh={};let KC=yn("");if(Gt.allowVerticalPlacement&&Jr.vertical){const cs=vi.layout.get("text-rotate").evaluate(zi,{},Uc)+90;Xm=new t_(ci,dr,Tn,Di,ji,Jr.vertical,si,Zs,ns,cs),so&&(Km=new t_(ci,dr,Tn,Di,ji,so,Vl,ko,ns,cs))}if(yi){const cs=vi.layout.get("icon-rotate").evaluate(zi,{}),el=vi.layout.get("icon-text-fit")!=="none",Pp=FC(yi,cs,Xh,el),qc=so?FC(so,cs,Xh,el):void 0;Zm=new t_(ci,dr,Tn,Di,ji,yi,Vl,ko,!1,cs),HC=4*Pp.length;const Ep=Gt.iconSizeData;let Nu=null;Ep.kind==="source"?(Nu=[Wh*vi.layout.get("icon-size").evaluate(zi,{})],Nu[0]>cf&&wr(`${Gt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Ep.kind==="composite"&&(Nu=[Wh*Ao.compositeIconSizes[0].evaluate(zi,{},Uc),Wh*Ao.compositeIconSizes[1].evaluate(zi,{},Uc)],(Nu[0]>cf||Nu[1]>cf)&&wr(`${Gt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Gt.addSymbols(Gt.icon,Pp,Nu,ao,Mi,zi,f.az.none,dr,ff.lineStartIndex,ff.lineLength,-1,Uc),ub=Gt.icon.placedSymbolArray.length-1,qc&&(WC=4*qc.length,Gt.addSymbols(Gt.icon,qc,Nu,ao,Mi,zi,f.az.vertical,dr,ff.lineStartIndex,ff.lineLength,-1,Uc),hb=Gt.icon.placedSymbolArray.length-1)}const YC=Object.keys(Jr.horizontal);for(const cs of YC){const el=Jr.horizontal[cs];if(!Mp){KC=yn(el.text);const qc=vi.layout.get("text-rotate").evaluate(zi,{},Uc);Mp=new t_(ci,dr,Tn,Di,ji,el,si,Zs,ns,qc)}const Pp=el.positionedLines.length===1;if(ZC+=NC(Gt,dr,el,rs,vi,ns,zi,Xs,ff,Jr.vertical?f.az.horizontal:f.az.horizontalOnly,Pp?YC:[cs],Kh,ub,Ao,Uc),Pp)break}Jr.vertical&&(XC+=NC(Gt,dr,Jr.vertical,rs,vi,ns,zi,Xs,ff,f.az.vertical,["vertical"],Kh,hb,Ao,Uc));const aD=Mp?Mp.boxStartIndex:Gt.collisionBoxArray.length,lD=Mp?Mp.boxEndIndex:Gt.collisionBoxArray.length,cD=Xm?Xm.boxStartIndex:Gt.collisionBoxArray.length,uD=Xm?Xm.boxEndIndex:Gt.collisionBoxArray.length,hD=Zm?Zm.boxStartIndex:Gt.collisionBoxArray.length,dD=Zm?Zm.boxEndIndex:Gt.collisionBoxArray.length,fD=Km?Km.boxStartIndex:Gt.collisionBoxArray.length,pD=Km?Km.boxEndIndex:Gt.collisionBoxArray.length;let Gc=-1;const n_=(cs,el)=>cs&&cs.circleDiameter?Math.max(cs.circleDiameter,el):el;Gc=n_(Mp,Gc),Gc=n_(Xm,Gc),Gc=n_(Zm,Gc),Gc=n_(Km,Gc);const JC=Gc>-1?1:0;JC&&(Gc*=Dy/oo),Gt.glyphOffsetArray.length>=Nm.MAX_GLYPHS&&wr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),zi.sortKey!==void 0&&Gt.addToSortKeyRanges(Gt.symbolInstances.length,zi.sortKey);const mD=jC(vi,zi,Uc),[gD,yD]=function(cs,el){const Pp=cs.length,qc=el?.values;if(qc?.length>0)for(let Ep=0;Ep<qc.length;Ep+=2){const Nu=qc[Ep+1];cs.emplaceBack(f.aP[qc[Ep]],Nu[0],Nu[1])}return[Pp,cs.length]}(Gt.textAnchorOffsets,mD);Gt.symbolInstances.emplaceBack(dr.x,dr.y,Kh.right>=0?Kh.right:-1,Kh.center>=0?Kh.center:-1,Kh.left>=0?Kh.left:-1,Kh.vertical||-1,ub,hb,KC,aD,lD,cD,uD,hD,dD,fD,pD,Tn,ZC,XC,HC,WC,JC,0,si,Gc,gD,yD)}(l,Jt,Ht,s,d,g,vt,l.layers[0],l.collisionBoxArray,r.index,r.sourceLayerIndex,l.index,fe,[Ie,Ie,Ie,Ie],bt,E,pe,Fe,mt,J,r,_,R,L,x)};if(Pt==="line")for(const Ht of IC(r.geometry,0,0,je,je)){const Jt=Ms(Ht,ht),Gt=eD(Jt,me,nt,s.vertical||ee,d,24,Te,l.overscaling,je);for(const dr of Gt)ee&&oD(l,ee.text,Bt,dr)||Kt(Jt,dr)}else if(Pt==="line-center"){for(const Ht of r.geometry)if(Ht.length>1){const Jt=Ms(Ht,ht),Gt=Q5(Jt,nt,s.vertical||ee,d,24,Te);Gt&&Kt(Jt,Gt)}}else if(r.type==="Polygon")for(const Ht of _h(r.geometry,0)){const Jt=rD(Ht,16);Kt(Ms(Ht[0],ht,!0),new df(Jt.x,Jt.y,0))}else if(r.type==="LineString")for(const Ht of r.geometry){const Jt=Ms(Ht,ht);Kt(Jt,new df(Jt[0].x,Jt[0].y,0))}else if(r.type==="Point")for(const Ht of r.geometry)for(const Jt of Ht)Kt([Jt],new df(Jt.x,Jt.y,0))}function NC(l,r,s,d,g,_,x,C,E,R,L,V,H,Z,J){const ee=function(Te,pe,me,Ie,Fe,nt,bt,mt){const Pt=Ie.layout.get("text-rotate").evaluate(nt,{})*Math.PI/180,Bt=[];for(const kt of pe.positionedLines)for(const vt of kt.positionedGlyphs){if(!vt.rect)continue;const ht=vt.rect||{};let Kt=4,Ht=!0,Jt=1,Gt=0;const dr=(Fe||mt)&&vt.vertical,cn=vt.metrics.advance*vt.scale/2;if(mt&&pe.verticalizable&&(Gt=kt.lineOffset/2-(vt.imageName?-(oo-vt.metrics.width*vt.scale)/2:(vt.scale-1)*oo)),vt.imageName){const ko=bt[vt.imageName];Ht=ko.sdf,Jt=ko.pixelRatio,Kt=1/Jt}const Jr=Fe?[vt.x+cn,vt.y]:[0,0];let yi=Fe?[0,0]:[vt.x+cn+me[0],vt.y+me[1]-Gt],rs=[0,0];dr&&(rs=yi,yi=[0,0]);const so=vt.metrics.isDoubleResolution?2:1,vi=(vt.metrics.left-Kt)*vt.scale-cn+yi[0],ci=(-vt.metrics.top-Kt)*vt.scale+yi[1],Tn=vi+ht.w/so*vt.scale/Jt,Di=ci+ht.h/so*vt.scale/Jt,ji=new b(vi,ci),si=new b(Tn,ci),Zs=new b(vi,Di),ns=new b(Tn,Di);if(dr){const ko=new b(-cn,cn- -17),Mi=-Math.PI/2,ao=12-cn,zi=new b(22-ao,-(vt.imageName?ao:0)),Ao=new b(...rs);ji._rotateAround(Mi,ko)._add(zi)._add(Ao),si._rotateAround(Mi,ko)._add(zi)._add(Ao),Zs._rotateAround(Mi,ko)._add(zi)._add(Ao),ns._rotateAround(Mi,ko)._add(zi)._add(Ao)}if(Pt){const ko=Math.sin(Pt),Mi=Math.cos(Pt),ao=[Mi,-ko,ko,Mi];ji._matMult(ao),si._matMult(ao),Zs._matMult(ao),ns._matMult(ao)}const Xs=new b(0,0),Vl=new b(0,0);Bt.push({tl:ji,tr:si,bl:Zs,br:ns,tex:ht,writingMode:pe.writingMode,glyphOffset:Jr,sectionIndex:vt.sectionIndex,isSDF:Ht,pixelOffsetTL:Xs,pixelOffsetBR:Vl,minFontScaleX:0,minFontScaleY:0})}return Bt}(0,s,C,g,_,x,d,l.allowVerticalPlacement),ne=l.textSizeData;let fe=null;ne.kind==="source"?(fe=[Wh*g.layout.get("text-size").evaluate(x,{})],fe[0]>cf&&wr(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ne.kind==="composite"&&(fe=[Wh*Z.compositeTextSizes[0].evaluate(x,{},J),Wh*Z.compositeTextSizes[1].evaluate(x,{},J)],(fe[0]>cf||fe[1]>cf)&&wr(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),l.addSymbols(l.text,ee,fe,C,_,x,R,r,E.lineStartIndex,E.lineLength,H,J);for(const Te of L)V[Te]=l.text.placedSymbolArray.length-1;return 4*ee.length}function VC(l){for(const r in l)return l[r];return null}function oD(l,r,s,d){const g=l.compareText;if(r in g){const _=g[r];for(let x=_.length-1;x>=0;x--)if(d.dist(_[x])<s)return!0}else g[r]=[];return g[r].push(d),!1}const UC=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class nb{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,d]=new Uint8Array(r,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=d>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const _=UC[15&d];if(!_)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(r,2,1),[C]=new Uint32Array(r,4,1);return new nb(C,x,_,r)}constructor(r,s=64,d=Float64Array,g){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=d,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const _=UC.indexOf(this.ArrayType),x=2*r*this.ArrayType.BYTES_PER_ELEMENT,C=r*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-C%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${d}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+C+E,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+x+C+E),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+C+E,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=r)}add(r,s){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=r,this.coords[this._pos++]=s,d}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return ib(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,s,d,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:x,nodeSize:C}=this,E=[0,_.length-1,0],R=[];for(;E.length;){const L=E.pop()||0,V=E.pop()||0,H=E.pop()||0;if(V-H<=C){for(let ne=H;ne<=V;ne++){const fe=x[2*ne],Te=x[2*ne+1];fe>=r&&fe<=d&&Te>=s&&Te<=g&&R.push(_[ne])}continue}const Z=H+V>>1,J=x[2*Z],ee=x[2*Z+1];J>=r&&J<=d&&ee>=s&&ee<=g&&R.push(_[Z]),(L===0?r<=J:s<=ee)&&(E.push(H),E.push(Z-1),E.push(1-L)),(L===0?d>=J:g>=ee)&&(E.push(Z+1),E.push(V),E.push(1-L))}return R}within(r,s,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:_,nodeSize:x}=this,C=[0,g.length-1,0],E=[],R=d*d;for(;C.length;){const L=C.pop()||0,V=C.pop()||0,H=C.pop()||0;if(V-H<=x){for(let ne=H;ne<=V;ne++)qC(_[2*ne],_[2*ne+1],r,s)<=R&&E.push(g[ne]);continue}const Z=H+V>>1,J=_[2*Z],ee=_[2*Z+1];qC(J,ee,r,s)<=R&&E.push(g[Z]),(L===0?r-d<=J:s-d<=ee)&&(C.push(H),C.push(Z-1),C.push(1-L)),(L===0?r+d>=J:s+d>=ee)&&(C.push(Z+1),C.push(V),C.push(1-L))}return E}}function ib(l,r,s,d,g,_){if(g-d<=s)return;const x=d+g>>1;GC(l,r,x,d,g,_),ib(l,r,s,d,x-1,1-_),ib(l,r,s,x+1,g,1-_)}function GC(l,r,s,d,g,_){for(;g>d;){if(g-d>600){const R=g-d+1,L=s-d+1,V=Math.log(R),H=.5*Math.exp(2*V/3),Z=.5*Math.sqrt(V*H*(R-H)/R)*(L-R/2<0?-1:1);GC(l,r,s,Math.max(d,Math.floor(s-L*H/R+Z)),Math.min(g,Math.floor(s+(R-L)*H/R+Z)),_)}const x=r[2*s+_];let C=d,E=g;for(Ay(l,r,d,s),r[2*g+_]>x&&Ay(l,r,d,g);C<E;){for(Ay(l,r,C,E),C++,E--;r[2*C+_]<x;)C++;for(;r[2*E+_]>x;)E--}r[2*d+_]===x?Ay(l,r,d,E):(E++,Ay(l,r,E,g)),E<=s&&(d=E+1),s<=E&&(g=E-1)}}function Ay(l,r,s,d){ob(l,s,d),ob(r,2*s,2*d),ob(r,2*s+1,2*d+1)}function ob(l,r,s){const d=l[r];l[r]=l[s],l[s]=d}function qC(l,r,s,d){const g=l-s,_=r-d;return g*g+_*_}var sb;f.cH=void 0,(sb=f.cH||(f.cH={})).create="create",sb.load="load",sb.fullLoad="fullLoad";let r_=null,Ry=[];const ab=1e3/60,lb="loadTime",cb="fullLoadTime",sD={mark(l){performance.mark(l)},frame(l){const r=l;r_!=null&&Ry.push(r-r_),r_=r},clearMetrics(){r_=null,Ry=[],performance.clearMeasures(lb),performance.clearMeasures(cb);for(const l in f.cH)performance.clearMarks(f.cH[l])},getPerformanceMetrics(){performance.measure(lb,f.cH.create,f.cH.load),performance.measure(cb,f.cH.create,f.cH.fullLoad);const l=performance.getEntriesByName(lb)[0].duration,r=performance.getEntriesByName(cb)[0].duration,s=Ry.length,d=1/(Ry.reduce((_,x)=>_+x,0)/s/1e3),g=Ry.filter(_=>_>ab).reduce((_,x)=>_+(x-ab)/ab,0);return{loadTime:l,fullLoadTime:r,fps:d,percentDroppedFrames:g/(s+g)*100,totalFrames:s}}};f.$=j,f.A=Q,f.B=ws,f.C=mi,f.D=Xt,f.E=tr,f.F=function([l,r,s]){return r+=90,r*=Math.PI/180,s*=Math.PI/180,{x:l*Math.cos(r)*Math.sin(s),y:l*Math.sin(r)*Math.sin(s),z:l*Math.cos(s)}},f.G=ti,f.H=Sn,f.I=Ri,f.J=Dh,f.K=function(l){if(yr==null){const r=l.navigator?l.navigator.userAgent:null;yr=!!l.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return yr},f.L=class{constructor(l,r){this.target=l,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new b5(()=>this.process()),this.subscription=rn(this.target,"message",s=>this.receive(s),!1),this.globalScope=Wt(self)?l:window}registerMessageHandler(l,r){this.messageHandlers[l]=r}unregisterMessageHandler(l){delete this.messageHandlers[l]}sendAsync(l,r){return new Promise((s,d)=>{const g=Math.round(1e18*Math.random()).toString(36).substring(0,10),_=r?rn(r.signal,"abort",()=>{_?.unsubscribe(),delete this.resolveRejects[g];const E={id:g,type:"<cancel>",origin:location.origin,targetMapId:l.targetMapId,sourceMapId:this.mapId};this.target.postMessage(E)},w5):null;this.resolveRejects[g]={resolve:E=>{_?.unsubscribe(),s(E)},reject:E=>{_?.unsubscribe(),d(E)}};const x=[],C=Object.assign(Object.assign({},l),{id:g,sourceMapId:this.mapId,origin:location.origin,data:mo(l.data,x)});this.target.postMessage(C,{transfer:x})})}receive(l){const r=l.data,s=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!=="resource://android"&&location.origin!=="resource://android"&&r.origin!==location.origin||r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[s];const d=this.abortControllers[s];return delete this.abortControllers[s],void(d&&d.abort())}if(Wt(self)||r.mustQueue)return this.tasks[s]=r,this.taskQueue.push(s),void this.invoker.trigger();this.processTask(s,r)}}process(){if(this.taskQueue.length===0)return;const l=this.taskQueue.shift(),r=this.tasks[l];delete this.tasks[l],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(l,r)}processTask(l,r){return o(this,void 0,void 0,function*(){if(r.type==="<response>"){const g=this.resolveRejects[l];return delete this.resolveRejects[l],g?void(r.error?g.reject(go(r.error)):g.resolve(go(r.data))):void 0}if(!this.messageHandlers[r.type])return void this.completeTask(l,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const s=go(r.data),d=new AbortController;this.abortControllers[l]=d;try{const g=yield this.messageHandlers[r.type](r.sourceMapId,s,d);this.completeTask(l,null,g)}catch(g){this.completeTask(l,g)}})}completeTask(l,r,s){const d=[];delete this.abortControllers[l];const g={id:l,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?mo(r):null,data:mo(s,d)};this.target.postMessage(g,{transfer:d})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},f.M=Xe,f.N=function(){var l=new Q(16);return Q!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l},f.O=function(l,r,s){var d,g,_,x,C,E,R,L,V,H,Z,J,ee=s[0],ne=s[1],fe=s[2];return r===l?(l[12]=r[0]*ee+r[4]*ne+r[8]*fe+r[12],l[13]=r[1]*ee+r[5]*ne+r[9]*fe+r[13],l[14]=r[2]*ee+r[6]*ne+r[10]*fe+r[14],l[15]=r[3]*ee+r[7]*ne+r[11]*fe+r[15]):(g=r[1],_=r[2],x=r[3],C=r[4],E=r[5],R=r[6],L=r[7],V=r[8],H=r[9],Z=r[10],J=r[11],l[0]=d=r[0],l[1]=g,l[2]=_,l[3]=x,l[4]=C,l[5]=E,l[6]=R,l[7]=L,l[8]=V,l[9]=H,l[10]=Z,l[11]=J,l[12]=d*ee+C*ne+V*fe+r[12],l[13]=g*ee+E*ne+H*fe+r[13],l[14]=_*ee+R*ne+Z*fe+r[14],l[15]=x*ee+L*ne+J*fe+r[15]),l},f.P=b,f.Q=function(l,r,s){var d=s[0],g=s[1],_=s[2];return l[0]=r[0]*d,l[1]=r[1]*d,l[2]=r[2]*d,l[3]=r[3]*d,l[4]=r[4]*g,l[5]=r[5]*g,l[6]=r[6]*g,l[7]=r[7]*g,l[8]=r[8]*_,l[9]=r[9]*_,l[10]=r[10]*_,l[11]=r[11]*_,l[12]=r[12],l[13]=r[13],l[14]=r[14],l[15]=r[15],l},f.R=Jo,f.S=function(l,r,s){var d=r[0],g=r[1],_=r[2],x=r[3],C=r[4],E=r[5],R=r[6],L=r[7],V=r[8],H=r[9],Z=r[10],J=r[11],ee=r[12],ne=r[13],fe=r[14],Te=r[15],pe=s[0],me=s[1],Ie=s[2],Fe=s[3];return l[0]=pe*d+me*C+Ie*V+Fe*ee,l[1]=pe*g+me*E+Ie*H+Fe*ne,l[2]=pe*_+me*R+Ie*Z+Fe*fe,l[3]=pe*x+me*L+Ie*J+Fe*Te,l[4]=(pe=s[4])*d+(me=s[5])*C+(Ie=s[6])*V+(Fe=s[7])*ee,l[5]=pe*g+me*E+Ie*H+Fe*ne,l[6]=pe*_+me*R+Ie*Z+Fe*fe,l[7]=pe*x+me*L+Ie*J+Fe*Te,l[8]=(pe=s[8])*d+(me=s[9])*C+(Ie=s[10])*V+(Fe=s[11])*ee,l[9]=pe*g+me*E+Ie*H+Fe*ne,l[10]=pe*_+me*R+Ie*Z+Fe*fe,l[11]=pe*x+me*L+Ie*J+Fe*Te,l[12]=(pe=s[12])*d+(me=s[13])*C+(Ie=s[14])*V+(Fe=s[15])*ee,l[13]=pe*g+me*E+Ie*H+Fe*ne,l[14]=pe*_+me*R+Ie*Z+Fe*fe,l[15]=pe*x+me*L+Ie*J+Fe*Te,l},f.T=Hs,f.U=function(l,r){const s={};for(let d=0;d<r.length;d++){const g=r[d];g in l&&(s[g]=l[g])}return s},f.V=uf,f.W=St,f.X=VS,f.Y=NS,f.Z=Pe,f._=o,f.a=ue,f.a$=re,f.a0=ie,f.a1=Rr,f.a2=Ja,f.a3=GS,f.a4=G0,f.a5=je,f.a6=function(l,r,s){if(!l)return r||{};if(!r)return l||{};const d=ZS(l),g=ZS(r);(function(x,C){C.removeAll&&(x.add.clear(),x.update.clear(),x.remove.clear(),C.remove.clear());for(const E of C.remove)x.add.delete(E),x.update.delete(E);for(const[E,R]of C.update){const L=x.update.get(E);L&&(C.update.set(E,S5(L,R)),x.update.delete(E))}})(d,g);const _={};if((d.removeAll||g.removeAll)&&(_.removeAll=!0),_.remove=new Set([...d.remove,...g.remove]),_.add=new Map([...d.add,...g.add]),_.update=new Map([...d.update,...g.update]),_.remove.size&&_.add.size)for(const x of _.add.keys())_.remove.delete(x);return function(x){const C={};return x.removeAll&&(C.removeAll=x.removeAll),x.remove&&(C.remove=Array.from(x.remove)),x.add&&(C.add=Array.from(x.add.values())),x.update&&(C.update=Array.from(x.update.values())),C}(_)},f.a7=function(l,r){const s=new Map;if(l==null||l.type==null)return s;if(l.type==="Feature"){const d=B1(l,r);return d==null?void 0:(s.set(d,l),s)}if(l.type==="FeatureCollection"){const d=new Set;for(const g of l.features){const _=B1(g,r);if(_==null||d.has(_))return;d.add(_),s.set(_,g)}return s}},f.a8=function(l,r,s){var d,g;const _=[];if(r.removeAll)l.clear();else if(r.remove)for(const x of r.remove){const C=l.get(x);C&&(_.push(C.geometry),l.delete(x))}if(r.add)for(const x of r.add){const C=B1(x,s);if(C==null)continue;const E=l.get(C);E&&_.push(E.geometry),_.push(x.geometry),l.set(C,x)}if(r.update)for(const x of r.update){const C=l.get(x.id);if(!C)continue;const E=!!x.newGeometry,R=x.removeAllProperties||((d=x.removeProperties)===null||d===void 0?void 0:d.length)>0||((g=x.addOrUpdateProperties)===null||g===void 0?void 0:g.length)>0;if(!E&&!R)continue;_.push(C.geometry);const L=Object.assign({},C);if(l.set(x.id,L),E&&(_.push(x.newGeometry),L.geometry=x.newGeometry),R){if(L.properties=x.removeAllProperties?{}:Object.assign({},L.properties||{}),x.removeProperties)for(const V of x.removeProperties)delete L.properties[V];if(x.addOrUpdateProperties)for(const{key:V,value:H}of x.addOrUpdateProperties)L.properties[V]=H}}return _},f.a9=Py,f.aA=function(l,{uSize:r,uSizeT:s},{lowerSize:d,upperSize:g}){return l.kind==="source"?d/Wh:l.kind==="composite"?ti.number(d/Wh,g/Wh,s):r},f.aB=function(l,r){var s=r[0],d=r[1],g=r[2],_=r[3],x=r[4],C=r[5],E=r[6],R=r[7],L=r[8],V=r[9],H=r[10],Z=r[11],J=r[12],ee=r[13],ne=r[14],fe=r[15],Te=s*C-d*x,pe=s*E-g*x,me=s*R-_*x,Ie=d*E-g*C,Fe=d*R-_*C,nt=g*R-_*E,bt=L*ee-V*J,mt=L*ne-H*J,Pt=L*fe-Z*J,Bt=V*ne-H*ee,kt=V*fe-Z*ee,vt=H*fe-Z*ne,ht=Te*vt-pe*kt+me*Bt+Ie*Pt-Fe*mt+nt*bt;return ht?(l[0]=(C*vt-E*kt+R*Bt)*(ht=1/ht),l[1]=(g*kt-d*vt-_*Bt)*ht,l[2]=(ee*nt-ne*Fe+fe*Ie)*ht,l[3]=(H*Fe-V*nt-Z*Ie)*ht,l[4]=(E*Pt-x*vt-R*mt)*ht,l[5]=(s*vt-g*Pt+_*mt)*ht,l[6]=(ne*me-J*nt-fe*pe)*ht,l[7]=(L*nt-H*me+Z*pe)*ht,l[8]=(x*kt-C*Pt+R*bt)*ht,l[9]=(d*Pt-s*kt-_*bt)*ht,l[10]=(J*Fe-ee*me+fe*Te)*ht,l[11]=(V*me-L*Fe-Z*Te)*ht,l[12]=(C*mt-x*Bt-E*bt)*ht,l[13]=(s*Bt-d*mt+g*bt)*ht,l[14]=(ee*pe-J*Ie-ne*Te)*ht,l[15]=(L*Ie-V*pe+H*Te)*ht,l):null},f.aC=Qe,f.aD=function(l){var r=l[0],s=l[1];return Math.sqrt(r*r+s*s)},f.aE=function(l){return l[0]=0,l[1]=0,l},f.aF=function(l,r,s){return l[0]=r[0]*s,l[1]=r[1]*s,l},f.aG=R1,f.aH=gt,f.aI=function(l,r,s,d){const g=r.y-l.y,_=r.x-l.x,x=d.y-s.y,C=d.x-s.x,E=x*_-C*g;if(E===0)return null;const R=(C*(l.y-s.y)-x*(l.x-s.x))/E;return new b(l.x+R*_,l.y+R*g)},f.aJ=IC,f.aK=Iu,f.aL=function(l){let r=1/0,s=1/0,d=-1/0,g=-1/0;for(const _ of l)r=Math.min(r,_.x),s=Math.min(s,_.y),d=Math.max(d,_.x),g=Math.max(g,_.y);return[r,s,d,g]},f.aM=oo,f.aN=ct,f.aO=function(l,r,s,d,g=!1){if(!s[0]&&!s[1])return[0,0];const _=g?d==="map"?-l.bearingInRadians:0:d==="viewport"?l.bearingInRadians:0;if(_){const x=Math.sin(_),C=Math.cos(_);s=[s[0]*C-s[1]*x,s[0]*x+s[1]*C]}return[g?s[0]:ct(r,s[0],l.zoom),g?s[1]:ct(r,s[1],l.zoom)]},f.aQ=A1,f.aR=rb,f.aS=Vt,f.aT=nb,f.aU=gi,f.aV=Ou,f.aW=ge,f.aX=Nt,f.aY=at,f.aZ=wn,f.a_=qS,f.aa=Sp,f.ab=25,f.ac=F1,f.ad=l=>{const r=window.document.createElement("video");return r.muted=!0,new Promise(s=>{r.onloadstart=()=>{s(r)};for(const d of l){const g=window.document.createElement("source");yt(d)||(r.crossOrigin="Anonymous"),g.src=d,r.appendChild(g)}})},f.ae=Et,f.af=function(){return At++},f.ag=v,f.ah=Nm,f.ai=ky,f.aj=bc,f.ak=Ha,f.al=KS,f.am=function(l){const r={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,d,g,_)=>{const x=g||_;return r[d]=!x||x.toLowerCase(),""}),r["max-age"]){const s=parseInt(r["max-age"],10);isNaN(s)?delete r["max-age"]:r["max-age"]=s}return r},f.an=_t,f.ao=85.051129,f.ap=Un,f.aq=function(l){return Math.pow(2,l)},f.ar=oe,f.as=US,f.at=function(l){return Math.log(l)/Math.LN2},f.au=function(l){var r=l[0],s=l[1];return r*r+s*s},f.av=function(l){if(!l.length)return new Set;const r=Math.max(...l.map(E=>E.canonical.z));let s=1/0,d=-1/0,g=1/0,_=-1/0;const x=[];for(const E of l){const{x:R,y:L,z:V}=E.canonical,H=Math.pow(2,r-V),Z=R*H,J=L*H;x.push({id:E,x:Z,y:J}),Z<s&&(s=Z),Z>d&&(d=Z),J<g&&(g=J),J>_&&(_=J)}const C=new Set;for(const E of x)E.x!==s&&E.x!==d&&E.y!==g&&E.y!==_||C.add(E.id);return C},f.aw=function(l,r){const s=Math.abs(2*l.wrap)-+(l.wrap<0),d=Math.abs(2*r.wrap)-+(r.wrap<0);return l.overscaledZ-r.overscaledZ||d-s||r.canonical.y-l.canonical.y||r.canonical.x-l.canonical.x},f.ax=class{constructor(l,r){this.max=l,this.onRemove=r,this.reset()}reset(){for(const l in this.data)for(const r of this.data[l])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(l,r,s){const d=l.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const g={value:r,timeout:void 0};if(s!==void 0&&(g.timeout=setTimeout(()=>{this.remove(l,g)},s)),this.data[d].push(g),this.order.push(d),this.order.length>this.max){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const r=this.data[l].shift();return r.timeout&&clearTimeout(r.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),r.value}getByKey(l){const r=this.data[l];return r?r[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,r){if(!this.has(l))return this;const s=l.wrapped().key,d=r===void 0?0:this.data[s].indexOf(r),g=this.data[s][d];return this.data[s].splice(d,1),g.timeout&&clearTimeout(g.timeout),this.data[s].length===0&&delete this.data[s],this.onRemove(g.value),this.order.splice(this.order.indexOf(s),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(l){const r=[];for(const s in this.data)for(const d of this.data[s])l(d.value)||r.push(d);for(const s of r)this.remove(s.value.tileID,s)}},f.ay=function(l,r){let s=0,d=0;if(l.kind==="constant")d=l.layoutSize;else if(l.kind!=="source"){const{interpolationType:g,minZoom:_,maxZoom:x}=l,C=g?_t(eo.interpolationFactor(g,r,_,x),0,1):0;l.kind==="camera"?d=ti.number(l.minSize,l.maxSize,C):s=C}return{uSizeT:s,uSize:d}},f.b=Yt,f.b$=Ga,f.b0=Ee,f.b1=function(l){var r=new Q(3);return r[0]=l[0],r[1]=l[1],r[2]=l[2],r},f.b2=function(l,r,s){return l[0]=r[0]-s[0],l[1]=r[1]-s[1],l[2]=r[2]-s[2],l},f.b3=function(l,r){var s=r[0],d=r[1],g=r[2],_=s*s+d*d+g*g;return _>0&&(_=1/Math.sqrt(_)),l[0]=r[0]*_,l[1]=r[1]*_,l[2]=r[2]*_,l},f.b4=ke,f.b5=function(l,r){return l[0]*r[0]+l[1]*r[1]+l[2]*r[2]},f.b6=function(l,r,s){return l[0]=r[0]*s[0],l[1]=r[1]*s[1],l[2]=r[2]*s[2],l[3]=r[3]*s[3],l},f.b7=xe,f.b8=function(l,r,s){const d=r[0]*s[0]+r[1]*s[1]+r[2]*s[2];return d===0?null:(-(l[0]*s[0]+l[1]*s[1]+l[2]*s[2])-s[3])/d},f.b9=Ke,f.bA=function(l,r,s,d){return l[0]=r[0]+s[0]*d,l[1]=r[1]+s[1]*d,l[2]=r[2]+s[2]*d,l},f.bB=qe,f.bC=function(l,r,s){var d=s[0],g=s[1],_=s[2],x=s[3],C=r[0],E=r[1],R=r[2],L=g*R-_*E,V=_*C-d*R,H=d*E-g*C;return l[0]=C+x*(L+=L)+g*(H+=H)-_*(V+=V),l[1]=E+x*V+_*L-d*H,l[2]=R+x*H+d*V-g*L,l},f.bD=function(l,r,s){const d=function(E){var R=E[3],L=E[4],V=E[5],H=E[6],Z=E[7],J=E[8];return E[0]*(J*L-V*Z)+E[1]*(-J*R+V*H)+E[2]*(Z*R-L*H)}([l[0],l[1],l[2],r[0],r[1],r[2],s[0],s[1],s[2]]);if(d===0)return null;const g=ke([],[r[0],r[1],r[2]],[s[0],s[1],s[2]]),_=ke([],[s[0],s[1],s[2]],[l[0],l[1],l[2]]),x=ke([],[l[0],l[1],l[2]],[r[0],r[1],r[2]]),C=re([],g,-l[3]);return Ee(C,C,re([],_,-r[3])),Ee(C,C,re([],x,-s[3])),re(C,C,1/d),C},f.bE=L1,f.bF=function(){return new Float64Array(4)},f.bG=function(l,r,s,d){var g=[],_=[];return g[0]=r[0]-s[0],g[1]=r[1]-s[1],g[2]=r[2]-s[2],_[0]=g[0]*Math.cos(d)-g[1]*Math.sin(d),_[1]=g[0]*Math.sin(d)+g[1]*Math.cos(d),_[2]=g[2],l[0]=_[0]+s[0],l[1]=_[1]+s[1],l[2]=_[2]+s[2],l},f.bH=function(l,r,s,d){var g=[],_=[];return g[0]=r[0]-s[0],g[1]=r[1]-s[1],g[2]=r[2]-s[2],_[0]=g[0],_[1]=g[1]*Math.cos(d)-g[2]*Math.sin(d),_[2]=g[1]*Math.sin(d)+g[2]*Math.cos(d),l[0]=_[0]+s[0],l[1]=_[1]+s[1],l[2]=_[2]+s[2],l},f.bI=function(l,r,s,d){var g=[],_=[];return g[0]=r[0]-s[0],g[1]=r[1]-s[1],g[2]=r[2]-s[2],_[0]=g[2]*Math.sin(d)+g[0]*Math.cos(d),_[1]=g[1],_[2]=g[2]*Math.cos(d)-g[0]*Math.sin(d),l[0]=_[0]+s[0],l[1]=_[1]+s[1],l[2]=_[2]+s[2],l},f.bJ=function(l,r,s){var d=Math.sin(s),g=Math.cos(s),_=r[0],x=r[1],C=r[2],E=r[3],R=r[8],L=r[9],V=r[10],H=r[11];return r!==l&&(l[4]=r[4],l[5]=r[5],l[6]=r[6],l[7]=r[7],l[12]=r[12],l[13]=r[13],l[14]=r[14],l[15]=r[15]),l[0]=_*g-R*d,l[1]=x*g-L*d,l[2]=C*g-V*d,l[3]=E*g-H*d,l[8]=_*d+R*g,l[9]=x*d+L*g,l[10]=C*d+V*g,l[11]=E*d+H*g,l},f.bK=function(l,r){const s=ye(l,360),d=ye(r,360),g=d-s,_=d>s?g-360:g+360;return Math.abs(g)<Math.abs(_)?g:_},f.bL=function(l){return l[0]=0,l[1]=0,l[2]=0,l},f.bM=function(l,r,s,d){const g=Math.sqrt(l*l+r*r),_=Math.sqrt(s*s+d*d);l/=g,r/=g,s/=_,d/=_;const x=Math.acos(l*s+r*d);return-r*s+l*d>0?x:-x},f.bN=function(l,r){const s=ye(l,2*Math.PI),d=ye(r,2*Math.PI);return Math.min(Math.abs(s-d),Math.abs(s-d+2*Math.PI),Math.abs(s-d-2*Math.PI))},f.bO=function(){const l={},r=Ze.$version;for(const s in Ze.$root){const d=Ze.$root[s];if(d.required){let g=null;g=s==="version"?r:d.type==="array"?[]:{},g!=null&&(l[s]=g)}}return l},f.bP=Je,f.bQ=Wn,f.bR=function l(r,s){if(Array.isArray(r)){if(!Array.isArray(s)||r.length!==s.length)return!1;for(let d=0;d<r.length;d++)if(!l(r[d],s[d]))return!1;return!0}if(typeof r=="object"&&r!==null&&s!==null){if(typeof s!="object"||Object.keys(r).length!==Object.keys(s).length)return!1;for(const d in r)if(!l(r[d],s[d]))return!1;return!0}return r===s},f.bS=function(l){l=l.slice();const r=Object.create(null);for(let s=0;s<l.length;s++)r[l[s].id]=l[s];for(let s=0;s<l.length;s++)"ref"in l[s]&&(l[s]=mn(l[s],r[l[s].ref]));return l},f.bT=function(l,r){if(l.type==="custom")return new x5(l,r);switch(l.type){case"background":return new _5(l,r);case"circle":return new ef(l,r);case"color-relief":return new M1(l,r);case"fill":return new M0(l,r);case"fill-extrusion":return new E1(l,r);case"heatmap":return new dy(l,r);case"hillshade":return new ku(l,r);case"line":return new Cy(l,r);case"raster":return new Ll(l,r);case"symbol":return new U0(l,r)}},f.bU=l=>l.type==="raster",f.bV=ur,f.bW=function(l,r){if(!l)return[{command:"setStyle",args:[r]}];let s=[];try{if(!ar(l.version,r.version))return[{command:"setStyle",args:[r]}];ar(l.center,r.center)||s.push({command:"setCenter",args:[r.center]}),ar(l.state,r.state)||s.push({command:"setGlobalState",args:[r.state]}),ar(l.centerAltitude,r.centerAltitude)||s.push({command:"setCenterAltitude",args:[r.centerAltitude]}),ar(l.zoom,r.zoom)||s.push({command:"setZoom",args:[r.zoom]}),ar(l.bearing,r.bearing)||s.push({command:"setBearing",args:[r.bearing]}),ar(l.pitch,r.pitch)||s.push({command:"setPitch",args:[r.pitch]}),ar(l.roll,r.roll)||s.push({command:"setRoll",args:[r.roll]}),ar(l.sprite,r.sprite)||s.push({command:"setSprite",args:[r.sprite]}),ar(l.glyphs,r.glyphs)||s.push({command:"setGlyphs",args:[r.glyphs]}),ar(l.transition,r.transition)||s.push({command:"setTransition",args:[r.transition]}),ar(l.light,r.light)||s.push({command:"setLight",args:[r.light]}),ar(l.terrain,r.terrain)||s.push({command:"setTerrain",args:[r.terrain]}),ar(l.sky,r.sky)||s.push({command:"setSky",args:[r.sky]}),ar(l.projection,r.projection)||s.push({command:"setProjection",args:[r.projection]});const d={},g=[];(function(x,C,E,R){let L;for(L in C=C||{},x=x||{})Object.prototype.hasOwnProperty.call(x,L)&&(Object.prototype.hasOwnProperty.call(C,L)||Xr(L,E,R));for(L in C)Object.prototype.hasOwnProperty.call(C,L)&&(Object.prototype.hasOwnProperty.call(x,L)?ar(x[L],C[L])||(x[L].type==="geojson"&&C[L].type==="geojson"&&Vr(x,C,L)?Dr(E,{command:"setGeoJSONSourceData",args:[L,C[L].data]}):zr(L,C,E,R)):ln(L,C,E))})(l.sources,r.sources,g,d);const _=[];l.layers&&l.layers.forEach(x=>{"source"in x&&d[x.source]?s.push({command:"removeLayer",args:[x.id]}):_.push(x)}),s=s.concat(g),function(x,C,E){C=C||[];const R=(x=x||[]).map(Vi),L=C.map(Vi),V=x.reduce(Ui,{}),H=C.reduce(Ui,{}),Z=R.slice(),J=Object.create(null);let ee,ne,fe,Te,pe;for(let me=0,Ie=0;me<R.length;me++)ee=R[me],Object.prototype.hasOwnProperty.call(H,ee)?Ie++:(Dr(E,{command:"removeLayer",args:[ee]}),Z.splice(Z.indexOf(ee,Ie),1));for(let me=0,Ie=0;me<L.length;me++)ee=L[L.length-1-me],Z[Z.length-1-me]!==ee&&(Object.prototype.hasOwnProperty.call(V,ee)?(Dr(E,{command:"removeLayer",args:[ee]}),Z.splice(Z.lastIndexOf(ee,Z.length-Ie),1)):Ie++,Te=Z[Z.length-me],Dr(E,{command:"addLayer",args:[H[ee],Te]}),Z.splice(Z.length-me,0,ee),J[ee]=!0);for(let me=0;me<L.length;me++)if(ee=L[me],ne=V[ee],fe=H[ee],!J[ee]&&!ar(ne,fe))if(ar(ne.source,fe.source)&&ar(ne["source-layer"],fe["source-layer"])&&ar(ne.type,fe.type)){for(pe in Kr(ne.layout,fe.layout,E,ee,null,"setLayoutProperty"),Kr(ne.paint,fe.paint,E,ee,null,"setPaintProperty"),ar(ne.filter,fe.filter)||Dr(E,{command:"setFilter",args:[ee,fe.filter]}),ar(ne.minzoom,fe.minzoom)&&ar(ne.maxzoom,fe.maxzoom)||Dr(E,{command:"setLayerZoomRange",args:[ee,fe.minzoom,fe.maxzoom]}),ne)Object.prototype.hasOwnProperty.call(ne,pe)&&pe!=="layout"&&pe!=="paint"&&pe!=="filter"&&pe!=="metadata"&&pe!=="minzoom"&&pe!=="maxzoom"&&(pe.indexOf("paint.")===0?Kr(ne[pe],fe[pe],E,ee,pe.slice(6),"setPaintProperty"):ar(ne[pe],fe[pe])||Dr(E,{command:"setLayerProperty",args:[ee,pe,fe[pe]]}));for(pe in fe)Object.prototype.hasOwnProperty.call(fe,pe)&&!Object.prototype.hasOwnProperty.call(ne,pe)&&pe!=="layout"&&pe!=="paint"&&pe!=="filter"&&pe!=="metadata"&&pe!=="minzoom"&&pe!=="maxzoom"&&(pe.indexOf("paint.")===0?Kr(ne[pe],fe[pe],E,ee,pe.slice(6),"setPaintProperty"):ar(ne[pe],fe[pe])||Dr(E,{command:"setLayerProperty",args:[ee,pe,fe[pe]]}))}else Dr(E,{command:"removeLayer",args:[ee]}),Te=Z[Z.lastIndexOf(ee)+1],Dr(E,{command:"addLayer",args:[fe,Te]})}(_,r.layers,s)}catch(d){console.warn("Unable to compute style diff:",d),s=[{command:"setStyle",args:[r]}]}return s},f.bX=function(l){const r=[],s=l.id;return s===void 0&&r.push({message:`layers.${s}: missing required property "id"`}),l.render===void 0&&r.push({message:`layers.${s}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&r.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),r},f.bY=It,f.bZ=mr,f.b_=class extends Fo{constructor(l,r){super(l,r),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}},f.ba=function(l,r,s){return l[0]=r[0]*s,l[1]=r[1]*s,l[2]=r[2]*s,l[3]=r[3]*s,l},f.bb=function(l,r){return l[0]*r[0]+l[1]*r[1]+l[2]*r[2]+l[3]},f.bc=WS,f.bd=Vm,f.be=function(l,r,s,d,g){var _=1/Math.tan(r/2);if(l[0]=_/s,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=_,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,g!=null&&g!==1/0){var x=1/(d-g);l[10]=(g+d)*x,l[14]=2*g*d*x}else l[10]=-1,l[14]=-2*d;return l},f.bf=function(l){var r=new Q(16);return r[0]=l[0],r[1]=l[1],r[2]=l[2],r[3]=l[3],r[4]=l[4],r[5]=l[5],r[6]=l[6],r[7]=l[7],r[8]=l[8],r[9]=l[9],r[10]=l[10],r[11]=l[11],r[12]=l[12],r[13]=l[13],r[14]=l[14],r[15]=l[15],r},f.bg=function(l,r,s){var d=Math.sin(s),g=Math.cos(s),_=r[0],x=r[1],C=r[2],E=r[3],R=r[4],L=r[5],V=r[6],H=r[7];return r!==l&&(l[8]=r[8],l[9]=r[9],l[10]=r[10],l[11]=r[11],l[12]=r[12],l[13]=r[13],l[14]=r[14],l[15]=r[15]),l[0]=_*g+R*d,l[1]=x*g+L*d,l[2]=C*g+V*d,l[3]=E*g+H*d,l[4]=R*g-_*d,l[5]=L*g-x*d,l[6]=V*g-C*d,l[7]=H*g-E*d,l},f.bh=function(l,r,s){var d=Math.sin(s),g=Math.cos(s),_=r[4],x=r[5],C=r[6],E=r[7],R=r[8],L=r[9],V=r[10],H=r[11];return r!==l&&(l[0]=r[0],l[1]=r[1],l[2]=r[2],l[3]=r[3],l[12]=r[12],l[13]=r[13],l[14]=r[14],l[15]=r[15]),l[4]=_*g+R*d,l[5]=x*g+L*d,l[6]=C*g+V*d,l[7]=E*g+H*d,l[8]=R*g-_*d,l[9]=L*g-x*d,l[10]=V*g-C*d,l[11]=H*g-E*d,l},f.bi=function(){const l=new Float32Array(16);return oe(l),l},f.bj=function(){const l=new Float64Array(16);return oe(l),l},f.bk=function(){return new Float64Array(16)},f.bl=function(l,r,s){const d=new Float64Array(4);return qe(d,l,r-90,s),d},f.bm=function(l,r,s,d){var g,_,x,C,E,R=r[0],L=r[1],V=r[2],H=r[3],Z=s[0],J=s[1],ee=s[2],ne=s[3];return(_=R*Z+L*J+V*ee+H*ne)<0&&(_=-_,Z=-Z,J=-J,ee=-ee,ne=-ne),1-_>se?(g=Math.acos(_),x=Math.sin(g),C=Math.sin((1-d)*g)/x,E=Math.sin(d*g)/x):(C=1-d,E=d),l[0]=C*R+E*Z,l[1]=C*L+E*J,l[2]=C*V+E*ee,l[3]=C*H+E*ne,l},f.bn=function(l){const r=new Float64Array(9);(function(_,x){var C=x[0],E=x[1],R=x[2],L=x[3],V=C+C,H=E+E,Z=R+R,J=C*V,ee=E*V,ne=E*H,fe=R*V,Te=R*H,pe=R*Z,me=L*V,Ie=L*H,Fe=L*Z;_[0]=1-ne-pe,_[3]=ee-Fe,_[6]=fe+Ie,_[1]=ee+Fe,_[4]=1-J-pe,_[7]=Te-me,_[2]=fe-Ie,_[5]=Te+me,_[8]=1-J-ne})(r,l);const s=wn(-Math.asin(_t(r[2],-1,1)));let d,g;return Math.hypot(r[5],r[8])<.001?(d=0,g=-wn(Math.atan2(r[3],r[4]))):(d=wn(r[5]===0&&r[8]===0?0:Math.atan2(r[5],r[8])),g=wn(r[1]===0&&r[0]===0?0:Math.atan2(r[1],r[0]))),{roll:d,pitch:s+90,bearing:g}},f.bo=function(l,r){return l.roll==r.roll&&l.pitch==r.pitch&&l.bearing==r.bearing},f.bp=Fr,f.bq=Ua,f.br=Lu,f.bs=Fu,f.bt=$c,f.bu=ze,f.bv=ft,f.bw=Qi,f.bx=function(l,r,s,d,g){return ze(d,g,_t((l-r)/(s-r),0,1))},f.by=ye,f.bz=function(){return new Float64Array(3)},f.c=Re,f.c$=function(l,r,s,d,g){return o(this,void 0,void 0,function*(){if(ie())try{return yield Rr(l,r,s,d,g)}catch{}return function(_,x,C,E,R){const L=_.width,V=_.height;Or&&Gr||(Or=new OffscreenCanvas(L,V),Gr=Or.getContext("2d",{willReadFrequently:!0})),Or.width=L,Or.height=V,Gr.drawImage(_,0,0,L,V);const H=Gr.getImageData(x,C,E,R);return Gr.clearRect(0,0,L,V),H.data}(l,r,s,d,g)})},f.c0=class extends Fo{constructor(l,r){super(l,r),this.current=Ko}set(l){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let r=1;r<16;r++)if(l[r]!==this.current[r]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}},f.c1=da,f.c2=class extends Fo{constructor(l,r){super(l,r),this.current=[0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2]))}},f.c3=class extends Fo{constructor(l,r){super(l,r),this.current=[0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1]))}},f.c4=de,f.c5=function(l,r){var s=Math.sin(r),d=Math.cos(r);return l[0]=d,l[1]=s,l[2]=0,l[3]=-s,l[4]=d,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},f.c6=function(l,r,s){var d=r[0],g=r[1],_=r[2];return l[0]=d*s[0]+g*s[3]+_*s[6],l[1]=d*s[1]+g*s[4]+_*s[7],l[2]=d*s[2]+g*s[5]+_*s[8],l},f.c7=function(l,r,s,d,g,_,x){var C=1/(r-s),E=1/(d-g),R=1/(_-x);return l[0]=-2*C,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*E,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*R,l[11]=0,l[12]=(r+s)*C,l[13]=(g+d)*E,l[14]=(x+_)*R,l[15]=1,l},f.c8=class extends Fo{constructor(l,r){super(l,r),this.current=new Array}set(l){if(l!=this.current){this.current=l;const r=new Float32Array(4*l.length);for(let s=0;s<l.length;s++)r[4*s]=l[s].r,r[4*s+1]=l[s].g,r[4*s+2]=l[s].b,r[4*s+3]=l[s].a;this.gl.uniform4fv(this.location,r)}}},f.c9=class extends Fo{constructor(l,r){super(l,r),this.current=new Array}set(l){if(l!=this.current){this.current=l;const r=new Float32Array(l);this.gl.uniform1fv(this.location,r)}}},f.cA=function(l,r){return He[r]&&"touches"in l},f.cB=function(l){return He[l]||ae[l]},f.cC=function(l,r,s){var d=r[0],g=r[1];return l[0]=s[0]*d+s[4]*g+s[12],l[1]=s[1]*d+s[5]*g+s[13],l},f.cD=function(l,r){const{x:s,y:d}=Py.fromLngLat(r);return!(l<0||l>25||d<0||d>=1||s<0||s>=1)},f.cE=function(l,r){return l[0]=r[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=r[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=r[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l},f.cF=class extends Fl{},f.cG=sD,f.cI=$e,f.cJ=function(l,r){Re.REGISTERED_PROTOCOLS[l]=r},f.cK=function(l){delete Re.REGISTERED_PROTOCOLS[l]},f.cL=function(l,r){const s={};for(let g=0;g<l.length;g++){const _=r&&r[l[g].id]||Fa(l[g]);r&&(r[l[g].id]=_);let x=s[_];x||(x=s[_]=[]),x.push(l[g])}const d=[];for(const g in s)d.push(s[g]);return d},f.cM=Ut,f.cN=XS,f.cO=PC,f.cP=lt,f.cQ=function(l){l.bucket.createArrays(),l.bucket.tilePixelRatio=je/(512*l.bucket.overscaling),l.bucket.compareText={},l.bucket.iconsNeedLinear=!1;const r=l.bucket.layers[0],s=r.layout,d=r._unevaluatedLayout._values,g={layoutIconSize:d["icon-size"].possiblyEvaluate(new Sn(l.bucket.zoom+1),l.canonical),layoutTextSize:d["text-size"].possiblyEvaluate(new Sn(l.bucket.zoom+1),l.canonical),textMaxSize:d["text-size"].possiblyEvaluate(new Sn(18))};if(l.bucket.textSizeData.kind==="composite"){const{minZoom:R,maxZoom:L}=l.bucket.textSizeData;g.compositeTextSizes=[d["text-size"].possiblyEvaluate(new Sn(R),l.canonical),d["text-size"].possiblyEvaluate(new Sn(L),l.canonical)]}if(l.bucket.iconSizeData.kind==="composite"){const{minZoom:R,maxZoom:L}=l.bucket.iconSizeData;g.compositeIconSizes=[d["icon-size"].possiblyEvaluate(new Sn(R),l.canonical),d["icon-size"].possiblyEvaluate(new Sn(L),l.canonical)]}const _=s.get("text-line-height")*oo,x=s.get("text-rotation-alignment")!=="viewport"&&s.get("symbol-placement")!=="point",C=s.get("text-keep-upright"),E=s.get("text-size");for(const R of l.bucket.features){const L=s.get("text-font").evaluate(R,{},l.canonical).join(","),V=E.evaluate(R,{},l.canonical),H=g.layoutTextSize.evaluate(R,{},l.canonical),Z=g.layoutIconSize.evaluate(R,{},l.canonical),J={horizontal:{},vertical:void 0},ee=R.text;let ne,fe=[0,0];if(ee){const me=ee.toString(),Ie=s.get("text-letter-spacing").evaluate(R,{},l.canonical)*oo,Fe=op(me)?Ie:0,nt=s.get("text-anchor").evaluate(R,{},l.canonical),bt=jC(r,R,l.canonical);if(!bt){const kt=s.get("text-radial-offset").evaluate(R,{},l.canonical);fe=kt?$C(nt,[kt*oo,tb]):s.get("text-offset").evaluate(R,{},l.canonical).map(vt=>vt*oo)}let mt=x?"center":s.get("text-justify").evaluate(R,{},l.canonical);const Pt=s.get("symbol-placement")==="point"?s.get("text-max-width").evaluate(R,{},l.canonical)*oo:1/0,Bt=()=>{l.bucket.allowVerticalPlacement&&Dl(me)&&(J.vertical=dt(ee,l.glyphMap,l.glyphPositions,l.imagePositions,L,Pt,_,nt,"left",Fe,fe,f.az.vertical,!0,H,V))};if(!x&&bt){const kt=new Set;if(mt==="auto")for(let ht=0;ht<bt.values.length;ht+=2)kt.add(rb(bt.values[ht]));else kt.add(mt);let vt=!1;for(const ht of kt)if(!J.horizontal[ht])if(vt)J.horizontal[ht]=J.horizontal[0];else{const Kt=dt(ee,l.glyphMap,l.glyphPositions,l.imagePositions,L,Pt,_,"center",ht,Fe,fe,f.az.horizontal,!1,H,V);Kt&&(J.horizontal[ht]=Kt,vt=Kt.positionedLines.length===1)}Bt()}else{mt==="auto"&&(mt=rb(nt));const kt=dt(ee,l.glyphMap,l.glyphPositions,l.imagePositions,L,Pt,_,nt,mt,Fe,fe,f.az.horizontal,!1,H,V);kt&&(J.horizontal[mt]=kt),Bt(),Dl(me)&&x&&C&&(J.vertical=dt(ee,l.glyphMap,l.glyphPositions,l.imagePositions,L,Pt,_,nt,mt,Fe,fe,f.az.vertical,!1,H,V))}}let Te=!1;if(R.icon&&R.icon.name){const me=l.imageMap[R.icon.name];me&&(ne=ju(l.imagePositions[R.icon.name],s.get("icon-offset").evaluate(R,{},l.canonical),s.get("icon-anchor").evaluate(R,{},l.canonical)),Te=!!me.sdf,l.bucket.sdfIcons===void 0?l.bucket.sdfIcons=Te:l.bucket.sdfIcons!==Te&&wr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(me.pixelRatio!==l.bucket.pixelRatio||s.get("icon-rotate").constantOr(1)!==0)&&(l.bucket.iconsNeedLinear=!0))}const pe=VC(J.horizontal)||J.vertical;l.bucket.iconsInText=!!pe&&pe.iconsInText,(pe||ne)&&iD(l.bucket,R,J,ne,l.imageMap,g,H,Z,fe,Te,l.canonical,l.subdivisionGranularity)}l.showCollisionBoxes&&l.bucket.generateCollisionDebugBuffers()},f.cR=gp,f.cS=xy,f.cT=sf,f.cU=function(l){const r=new p;return function(s,d){for(const g in s.layers)d.writeMessage(3,G5,s.layers[g])}(l,r),r.finish()},f.cV=function(l,r,s,d,g,_){let x=kC(l,r,s,g,0);return x=kC(x,r,d,_,1),x},f.cW=class{constructor(l){this.maxEntries=l,this.map=new Map}get(l){const r=this.map.get(l);return r!==void 0&&(this.map.delete(l),this.map.set(l,r)),r}set(l,r){if(this.map.has(l))this.map.delete(l);else if(this.map.size>=this.maxEntries){const s=this.map.keys().next().value;this.map.delete(s)}this.map.set(l,r)}clear(){this.map.clear()}},f.cX=E0,f.cY=p,f.cZ=TC,f.c_=class{constructor(l){this._marks={start:[l.url,"start"].join("#"),end:[l.url,"end"].join("#"),measure:l.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let l=performance.getEntriesByName(this._marks.measure);return l.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),l=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),l}},f.ca=class extends Na{},f.cb=F0,f.cc=class extends Bn{},f.cd=fp,f.ce=function(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))},f.cf=hy,f.cg=function(l,r,s){var d=r[0],g=r[1],_=r[2],x=s[3]*d+s[7]*g+s[11]*_+s[15];return l[0]=(s[0]*d+s[4]*g+s[8]*_+s[12])/(x=x||1),l[1]=(s[1]*d+s[5]*g+s[9]*_+s[13])/x,l[2]=(s[2]*d+s[6]*g+s[10]*_+s[14])/x,l},f.ch=class extends kc{},f.ci=class extends n{},f.cj=function(l,r){return l[0]===r[0]&&l[1]===r[1]&&l[2]===r[2]&&l[3]===r[3]&&l[4]===r[4]&&l[5]===r[5]&&l[6]===r[6]&&l[7]===r[7]&&l[8]===r[8]&&l[9]===r[9]&&l[10]===r[10]&&l[11]===r[11]&&l[12]===r[12]&&l[13]===r[13]&&l[14]===r[14]&&l[15]===r[15]},f.ck=function(l,r){var s=l[0],d=l[1],g=l[2],_=l[3],x=l[4],C=l[5],E=l[6],R=l[7],L=l[8],V=l[9],H=l[10],Z=l[11],J=l[12],ee=l[13],ne=l[14],fe=l[15],Te=r[0],pe=r[1],me=r[2],Ie=r[3],Fe=r[4],nt=r[5],bt=r[6],mt=r[7],Pt=r[8],Bt=r[9],kt=r[10],vt=r[11],ht=r[12],Kt=r[13],Ht=r[14],Jt=r[15];return Math.abs(s-Te)<=se*Math.max(1,Math.abs(s),Math.abs(Te))&&Math.abs(d-pe)<=se*Math.max(1,Math.abs(d),Math.abs(pe))&&Math.abs(g-me)<=se*Math.max(1,Math.abs(g),Math.abs(me))&&Math.abs(_-Ie)<=se*Math.max(1,Math.abs(_),Math.abs(Ie))&&Math.abs(x-Fe)<=se*Math.max(1,Math.abs(x),Math.abs(Fe))&&Math.abs(C-nt)<=se*Math.max(1,Math.abs(C),Math.abs(nt))&&Math.abs(E-bt)<=se*Math.max(1,Math.abs(E),Math.abs(bt))&&Math.abs(R-mt)<=se*Math.max(1,Math.abs(R),Math.abs(mt))&&Math.abs(L-Pt)<=se*Math.max(1,Math.abs(L),Math.abs(Pt))&&Math.abs(V-Bt)<=se*Math.max(1,Math.abs(V),Math.abs(Bt))&&Math.abs(H-kt)<=se*Math.max(1,Math.abs(H),Math.abs(kt))&&Math.abs(Z-vt)<=se*Math.max(1,Math.abs(Z),Math.abs(vt))&&Math.abs(J-ht)<=se*Math.max(1,Math.abs(J),Math.abs(ht))&&Math.abs(ee-Kt)<=se*Math.max(1,Math.abs(ee),Math.abs(Kt))&&Math.abs(ne-Ht)<=se*Math.max(1,Math.abs(ne),Math.abs(Ht))&&Math.abs(fe-Jt)<=se*Math.max(1,Math.abs(fe),Math.abs(Jt))},f.cl=function(l,r){return l[0]=r[0],l[1]=r[1],l[2]=r[2],l[3]=r[3],l[4]=r[4],l[5]=r[5],l[6]=r[6],l[7]=r[7],l[8]=r[8],l[9]=r[9],l[10]=r[10],l[11]=r[11],l[12]=r[12],l[13]=r[13],l[14]=r[14],l[15]=r[15],l},f.cm=l=>l.type==="symbol",f.cn=l=>l.type==="circle",f.co=l=>l.type==="heatmap",f.cp=l=>l.type==="line",f.cq=l=>l.type==="fill",f.cr=l=>l.type==="fill-extrusion",f.cs=l=>l.type==="hillshade",f.ct=l=>l.type==="color-relief",f.cu=l=>l.type==="background",f.cv=l=>l.type==="custom",f.cw=wt,f.cx=function(l,r,s){const d=Ve(r.x-s.x,r.y-s.y),g=Ve(l.x-s.x,l.y-s.y),_=Math.atan2(d[0]*g[1]-d[1]*g[0],function(x,C){return x[0]*C[0]+x[1]*C[1]}(d,g));return wn(_)},f.cy=xt,f.cz=function(l,r){return ae[r]&&(l instanceof MouseEvent||l instanceof WheelEvent)},f.d=yt,f.d0=py,f.d1=P,f.d2=class{constructor(l,r){this.layers={[ky]:this},this.name=ky,this.version=r?r.version:1,this.extent=r?r.extent:4096,this.length=l.length,this.features=l}feature(l){return new U5(this.features[l],this.extent)}},f.d3=xc,f.d4=$a,f.e=tt,f.f=l=>o(void 0,void 0,void 0,function*(){if(l.byteLength===0)return createImageBitmap(new ImageData(1,1));const r=new Blob([new Uint8Array(l)],{type:"image/png"});try{return createImageBitmap(r)}catch(s){throw new Error(`Could not load image because of ${s.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),f.g=Ye,f.h=l=>new Promise((r,s)=>{const d=new Image;d.onload=()=>{r(d),URL.revokeObjectURL(d.src),d.onload=null,window.requestAnimationFrame(()=>{d.src=Cr})},d.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const g=new Blob([new Uint8Array(l)],{type:"image/png"});d.src=l.byteLength?URL.createObjectURL(g):Cr}),f.i=Wt,f.j=(l,r)=>Ct(tt(l,{type:"json"}),r),f.k=br,f.l=Qt,f.m=Ct,f.n=(l,r)=>Ct(tt(l,{type:"arrayBuffer"}),r),f.o=function(l){return new p(l).readFields(zt,[])},f.p=gr,f.q=function(l){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(l))},f.r=tf,f.s=rn,f.t=Ti,f.u=Ze,f.v=oa,f.w=wr,f.x=Ol,f.y=Al,f.z=Mu}),c("worker",["./shared"],function(f){class o{constructor(ae,le){this.keyCache={},ae&&this.replace(ae,le)}replace(ae,le){this._layerConfigs={},this._layers={},this.update(ae,[],le)}update(ae,le,ue){for(const Re of ae){this._layerConfigs[Re.id]=Re;const Ye=this._layers[Re.id]=f.bT(Re,ue);Ye._featureFilter=f.aj(Ye.filter,ue),this.keyCache[Re.id]&&delete this.keyCache[Re.id]}for(const Re of le)delete this.keyCache[Re],delete this._layerConfigs[Re],delete this._layers[Re];this.familiesBySource={};const Pe=f.cL(Object.values(this._layerConfigs),this.keyCache);for(const Re of Pe){const Ye=Re.map($t=>this._layers[$t.id]),Xe=Ye[0];if(Xe.isHidden())continue;const $e=Xe.source||"";let Je=this.familiesBySource[$e];Je||(Je=this.familiesBySource[$e]={});const Ct=Xe.sourceLayer||f.ai;let yt=Je[Ct];yt||(yt=Je[Ct]=[]),yt.push(Ye)}}}class b{constructor(ae){const le={},ue=[];for(const Xe in ae){const $e=ae[Xe],Je=le[Xe]={};for(const Ct in $e){const yt=$e[+Ct];if(!yt||yt.bitmap.width===0||yt.bitmap.height===0)continue;const $t={x:0,y:0,w:yt.bitmap.width+2,h:yt.bitmap.height+2};ue.push($t),Je[Ct]={rect:$t,metrics:yt.metrics}}}const{w:Pe,h:Re}=f.p(ue),Ye=new f.r({width:Pe||1,height:Re||1});for(const Xe in ae){const $e=ae[Xe];for(const Je in $e){const Ct=$e[+Je];if(!Ct||Ct.bitmap.width===0||Ct.bitmap.height===0)continue;const yt=le[Xe][Je].rect;f.r.copy(Ct.bitmap,Ye,{x:0,y:0},{x:yt.x+1,y:yt.y+1},Ct.bitmap)}}this.image=Ye,this.positions=le}}f.cM("GlyphAtlas",b);class P{constructor(ae){this.tileID=new f.a2(ae.tileID.overscaledZ,ae.tileID.wrap,ae.tileID.canonical.z,ae.tileID.canonical.x,ae.tileID.canonical.y),this.uid=ae.uid,this.zoom=ae.zoom,this.pixelRatio=ae.pixelRatio,this.tileSize=ae.tileSize,this.source=ae.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ae.showCollisionBoxes,this.collectResourceTiming=!!ae.collectResourceTiming,this.returnDependencies=!!ae.returnDependencies,this.promoteId=ae.promoteId,this.inFlightDependencies=[]}parse(ae,le,ue,Pe,Re){return f._(this,void 0,void 0,function*(){this.status="parsing",this.data=ae,this.collisionBoxArray=new f.ag;const Ye=new f.cN(Object.keys(ae.layers).sort()),Xe=new f.cO(this.tileID,this.promoteId);Xe.bucketLayerIDs=[];const $e={},Je={featureIndex:Xe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:ue,subdivisionGranularity:Re},Ct=le.familiesBySource[this.source];for(const Vr in Ct){const Kr=ae.layers[Vr];if(!Kr)continue;Kr.version===1&&f.w(`Vector tile source "${this.source}" layer "${Vr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Vi=Ye.encode(Vr),Ui=[];for(let Et=0;Et<Kr.length;Et++){const vn=Kr.feature(Et),zn=Xe.getId(vn,Vr);Ui.push({feature:vn,id:zn,index:Et,sourceLayerIndex:Vi})}for(const Et of Ct[Vr]){const vn=Et[0];vn.source!==this.source&&f.w(`layer.source = ${vn.source} does not equal this.source = ${this.source}`),vn.isHidden(this.zoom,!0)||(I(Et,this.zoom,ue),($e[vn.id]=vn.createBucket({index:Xe.bucketLayerIDs.length,layers:Et,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Vi,sourceID:this.source})).populate(Ui,Je,this.tileID.canonical),Xe.bucketLayerIDs.push(Et.map(zn=>zn.id)))}}const yt=f.bY(Je.glyphDependencies,Vr=>Object.keys(Vr).map(Number));this.inFlightDependencies.forEach(Vr=>Vr?.abort()),this.inFlightDependencies=[];let $t=Promise.resolve({});if(Object.keys(yt).length){const Vr=new AbortController;this.inFlightDependencies.push(Vr),$t=Pe.sendAsync({type:"GG",data:{stacks:yt,source:this.source,tileID:this.tileID,type:"glyphs"}},Vr)}const qt=Object.keys(Je.iconDependencies);let Qt=Promise.resolve({});if(qt.length){const Vr=new AbortController;this.inFlightDependencies.push(Vr),Qt=Pe.sendAsync({type:"GI",data:{icons:qt,source:this.source,tileID:this.tileID,type:"icons"}},Vr)}const br=Object.keys(Je.patternDependencies);let tr=Promise.resolve({});if(br.length){const Vr=new AbortController;this.inFlightDependencies.push(Vr),tr=Pe.sendAsync({type:"GI",data:{icons:br,source:this.source,tileID:this.tileID,type:"patterns"}},Vr)}const Ze=Je.dashDependencies;let Lr=Promise.resolve({});if(Object.keys(Ze).length){const Vr=new AbortController;this.inFlightDependencies.push(Vr),Lr=Pe.sendAsync({type:"GDA",data:{dashes:Ze}},Vr)}const[mn,ar,Dr,ln]=yield Promise.all([$t,Qt,tr,Lr]),Xr=new b(mn),zr=new f.cP(ar,Dr);for(const Vr in $e){const Kr=$e[Vr];Kr instanceof f.ah?(I(Kr.layers,this.zoom,ue),f.cQ({bucket:Kr,glyphMap:mn,glyphPositions:Xr.positions,imageMap:ar,imagePositions:zr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Je.subdivisionGranularity})):Kr.hasDependencies&&(Kr instanceof f.cR||Kr instanceof f.cS||Kr instanceof f.cT)&&(I(Kr.layers,this.zoom,ue),Kr.addFeatures(Je,this.tileID.canonical,zr.patternPositions,ln))}return this.status="done",{buckets:Object.values($e).filter(Vr=>!Vr.isEmpty()),featureIndex:Xe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Xr.image,imageAtlas:zr,dashPositions:ln,glyphMap:this.returnDependencies?mn:null,iconMap:this.returnDependencies?ar:null,glyphPositions:this.returnDependencies?Xr.positions:null}})}}function I(He,ae,le){const ue=new f.H(ae);for(const Pe of He)Pe.recalculate(ue,le)}class D{constructor(ae,le,ue,Pe,Re){this.type=ae,this.properties=ue||{},this.extent=Re,this.pointsArray=le,this.id=Pe}loadGeometry(){return this.pointsArray.map(ae=>ae.map(le=>new f.P(le.x,le.y)))}}class z{constructor(ae,le,ue){this.version=2,this._myFeatures=ae,this.name=le,this.length=ae.length,this.extent=ue}feature(ae){return this._myFeatures[ae]}}class F{constructor(){this.layers={}}addLayer(ae){this.layers[ae.name]=ae}}function U(He){let ae=f.cU(He);return ae.byteOffset===0&&ae.byteLength===ae.buffer.byteLength||(ae=new Uint8Array(ae)),{vectorTile:He,rawData:ae.buffer}}function $(He,ae,le){const{extent:ue}=He,Pe=Math.pow(2,le.z-ae.z),Re=(le.x-ae.x*Pe)*ue,Ye=(le.y-ae.y*Pe)*ue,Xe=[];for(let $e=0;$e<He.length;$e++){const Je=He.feature($e);let Ct=Je.loadGeometry();for(const $t of Ct)for(const qt of $t)qt.x=qt.x*Pe-Re,qt.y=qt.y*Pe-Ye;const yt=128;Ct=f.cV(Ct,Je.type,-yt,-yt,ue+yt,ue+yt),Ct.length!==0&&Xe.push(new D(Je.type,Ct,Je.properties,Je.id,ue))}return new z(Xe,He.name,ue)}class j{constructor(ae,le,ue){this.actor=ae,this.layerIndex=le,this.availableImages=ue,this.fetching={},this.loading={},this.loaded={},this.overzoomedTileResultCache=new f.cW(1e3)}loadVectorTile(ae,le){return f._(this,void 0,void 0,function*(){const ue=yield f.n(ae.request,le);try{return{vectorTile:ae.encoding!=="mlt"?new f.cX(new f.cY(ue.data)):new f.cZ(ue.data),rawData:ue.data,cacheControl:ue.cacheControl,expires:ue.expires}}catch(Pe){const Re=new Uint8Array(ue.data);let Ye=`Unable to parse the tile at ${ae.request.url}, `;throw Ye+=Re[0]===31&&Re[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Pe.message}`,new Error(Ye)}})}loadTile(ae){return f._(this,void 0,void 0,function*(){const{uid:le,overzoomParameters:ue}=ae;ue&&(ae.request=ue.overzoomRequest);const Pe=!!(ae&&ae.request&&ae.request.collectResourceTiming)&&new f.c_(ae.request),Re=new P(ae);this.loading[le]=Re;const Ye=new AbortController;Re.abort=Ye;try{const Xe=yield this.loadVectorTile(ae,Ye);if(delete this.loading[le],!Xe)return null;if(ue){const $t=this._getOverzoomTile(ae,Xe.vectorTile);Xe.rawData=$t.rawData,Xe.vectorTile=$t.vectorTile}const $e=Xe.rawData,Je={};Xe.expires&&(Je.expires=Xe.expires),Xe.cacheControl&&(Je.cacheControl=Xe.cacheControl);const Ct={};if(Pe){const $t=Pe.finish();$t&&(Ct.resourceTiming=JSON.parse(JSON.stringify($t)))}Re.vectorTile=Xe.vectorTile;const yt=Re.parse(Xe.vectorTile,this.layerIndex,this.availableImages,this.actor,ae.subdivisionGranularity);this.loaded[le]=Re,this.fetching[le]={rawTileData:$e,cacheControl:Je,resourceTiming:Ct};try{const $t=yield yt;return f.e({rawTileData:$e.slice(0),encoding:ae.encoding},$t,Je,Ct)}finally{delete this.fetching[le]}}catch(Xe){throw delete this.loading[le],Re.status="done",this.loaded[le]=Re,Xe}})}_getOverzoomTile(ae,le){const{tileID:ue,source:Pe,overzoomParameters:Re}=ae,{maxZoomTileID:Ye}=Re,Xe=`${Ye.key}_${ue.key}`,$e=this.overzoomedTileResultCache.get(Xe);if($e)return $e;const Je=new F,Ct=this.layerIndex.familiesBySource[Pe];for(const $t in Ct){const qt=le.layers[$t];if(!qt)continue;const Qt=$(qt,Ye,ue.canonical);Qt.length>0&&Je.addLayer(Qt)}const yt=U(Je);return this.overzoomedTileResultCache.set(Xe,yt),yt}reloadTile(ae){return f._(this,void 0,void 0,function*(){const le=ae.uid;if(!this.loaded||!this.loaded[le])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ue=this.loaded[le];if(ue.showCollisionBoxes=ae.showCollisionBoxes,ue.status==="parsing"){const Pe=yield ue.parse(ue.vectorTile,this.layerIndex,this.availableImages,this.actor,ae.subdivisionGranularity);let Re;if(this.fetching[le]){const{rawTileData:Ye,cacheControl:Xe,resourceTiming:$e}=this.fetching[le];delete this.fetching[le],Re=f.e({rawTileData:Ye.slice(0),encoding:ae.encoding},Pe,Xe,$e)}else Re=Pe;return Re}if(ue.status==="done"&&ue.vectorTile)return ue.parse(ue.vectorTile,this.layerIndex,this.availableImages,this.actor,ae.subdivisionGranularity)})}abortTile(ae){return f._(this,void 0,void 0,function*(){const le=this.loading,ue=ae.uid;le&&le[ue]&&le[ue].abort&&(le[ue].abort.abort(),delete le[ue])})}removeTile(ae){return f._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ae.uid]&&delete this.loaded[ae.uid]})}}class ie{constructor(){this.loaded={}}loadTile(ae){return f._(this,void 0,void 0,function*(){const{uid:le,encoding:ue,rawImageData:Pe,redFactor:Re,greenFactor:Ye,blueFactor:Xe,baseShift:$e}=ae,Je=Pe.width+2,Ct=Pe.height+2,yt=f.b(Pe)?new f.R({width:Je,height:Ct},yield f.c$(Pe,-1,-1,Je,Ct)):Pe,$t=new f.d0(le,yt,ue,Re,Ye,Xe,$e);return this.loaded=this.loaded||{},this.loaded[le]=$t,$t})}removeTile(ae){const le=this.loaded,ue=ae.uid;le&&le[ue]&&delete le[ue]}}var se,Q,de=function(){if(Q)return se;function He(le,ue){if(le.length!==0){ae(le[0],ue);for(var Pe=1;Pe<le.length;Pe++)ae(le[Pe],!ue)}}function ae(le,ue){for(var Pe=0,Re=0,Ye=0,Xe=le.length,$e=Xe-1;Ye<Xe;$e=Ye++){var Je=(le[Ye][0]-le[$e][0])*(le[$e][1]+le[Ye][1]),Ct=Pe+Je;Re+=Math.abs(Pe)>=Math.abs(Je)?Pe-Ct+Je:Je-Ct+Pe,Pe=Ct}Pe+Re>=0!=!!ue&&le.reverse()}return Q=1,se=function le(ue,Pe){var Re,Ye=ue&&ue.type;if(Ye==="FeatureCollection")for(Re=0;Re<ue.features.length;Re++)le(ue.features[Re],Pe);else if(Ye==="GeometryCollection")for(Re=0;Re<ue.geometries.length;Re++)le(ue.geometries[Re],Pe);else if(Ye==="Feature")le(ue.geometry,Pe);else if(Ye==="Polygon")He(ue.coordinates,Pe);else if(Ye==="MultiPolygon")for(Re=0;Re<ue.coordinates.length;Re++)He(ue.coordinates[Re],Pe);return ue}}(),oe=f.d1(de);const be={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:He=>He},xe=Math.fround||(Me=new Float32Array(1),He=>(Me[0]=+He,Me[0]));var Me;class Ee{constructor(ae){this.options=Object.assign(Object.create(be),ae),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ae){const{log:le,minZoom:ue,maxZoom:Pe}=this.options;le&&console.time("total time");const Re=`prepare ${ae.length} points`;le&&console.time(Re),this.points=ae;const Ye=[];for(let $e=0;$e<ae.length;$e++){const Je=ae[$e];if(!Je.geometry)continue;const[Ct,yt]=Je.geometry.coordinates,$t=xe(Ge(Ct)),qt=xe(Ke(yt));Ye.push($t,qt,1/0,$e,-1,1),this.options.reduce&&Ye.push(0)}let Xe=this.trees[Pe+1]=this._createTree(Ye);le&&console.timeEnd(Re);for(let $e=Pe;$e>=ue;$e--){const Je=+Date.now();Xe=this.trees[$e]=this._createTree(this._cluster(Xe,$e)),le&&console.log("z%d: %d clusters in %dms",$e,Xe.numItems,+Date.now()-Je)}return le&&console.timeEnd("total time"),this}getClusters(ae,le){let ue=((ae[0]+180)%360+360)%360-180;const Pe=Math.max(-90,Math.min(90,ae[1]));let Re=ae[2]===180?180:((ae[2]+180)%360+360)%360-180;const Ye=Math.max(-90,Math.min(90,ae[3]));if(ae[2]-ae[0]>=360)ue=-180,Re=180;else if(ue>Re){const yt=this.getClusters([ue,Pe,180,Ye],le),$t=this.getClusters([-180,Pe,Re,Ye],le);return yt.concat($t)}const Xe=this.trees[this._limitZoom(le)],$e=Xe.range(Ge(ue),Ke(Ye),Ge(Re),Ke(Pe)),Je=Xe.data,Ct=[];for(const yt of $e){const $t=this.stride*yt;Ct.push(Je[$t+5]>1?re(Je,$t,this.clusterProps):this.points[Je[$t+3]])}return Ct}getChildren(ae){const le=this._getOriginId(ae),ue=this._getOriginZoom(ae),Pe="No cluster with the specified id.",Re=this.trees[ue];if(!Re)throw new Error(Pe);const Ye=Re.data;if(le*this.stride>=Ye.length)throw new Error(Pe);const Xe=this.options.radius/(this.options.extent*Math.pow(2,ue-1)),$e=Re.within(Ye[le*this.stride],Ye[le*this.stride+1],Xe),Je=[];for(const Ct of $e){const yt=Ct*this.stride;Ye[yt+4]===ae&&Je.push(Ye[yt+5]>1?re(Ye,yt,this.clusterProps):this.points[Ye[yt+3]])}if(Je.length===0)throw new Error(Pe);return Je}getLeaves(ae,le,ue){const Pe=[];return this._appendLeaves(Pe,ae,le=le||10,ue=ue||0,0),Pe}getTile(ae,le,ue){const Pe=this.trees[this._limitZoom(ae)],Re=Math.pow(2,ae),{extent:Ye,radius:Xe}=this.options,$e=Xe/Ye,Je=(ue-$e)/Re,Ct=(ue+1+$e)/Re,yt={features:[]};return this._addTileFeatures(Pe.range((le-$e)/Re,Je,(le+1+$e)/Re,Ct),Pe.data,le,ue,Re,yt),le===0&&this._addTileFeatures(Pe.range(1-$e/Re,Je,1,Ct),Pe.data,Re,ue,Re,yt),le===Re-1&&this._addTileFeatures(Pe.range(0,Je,$e/Re,Ct),Pe.data,-1,ue,Re,yt),yt.features.length?yt:null}getClusterExpansionZoom(ae){let le=this._getOriginZoom(ae)-1;for(;le<=this.options.maxZoom;){const ue=this.getChildren(ae);if(le++,ue.length!==1)break;ae=ue[0].properties.cluster_id}return le}_appendLeaves(ae,le,ue,Pe,Re){const Ye=this.getChildren(le);for(const Xe of Ye){const $e=Xe.properties;if($e&&$e.cluster?Re+$e.point_count<=Pe?Re+=$e.point_count:Re=this._appendLeaves(ae,$e.cluster_id,ue,Pe,Re):Re<Pe?Re++:ae.push(Xe),ae.length===ue)break}return Re}_createTree(ae){const le=new f.aT(ae.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ue=0;ue<ae.length;ue+=this.stride)le.add(ae[ue],ae[ue+1]);return le.finish(),le.data=ae,le}_addTileFeatures(ae,le,ue,Pe,Re,Ye){for(const Xe of ae){const $e=Xe*this.stride,Je=le[$e+5]>1;let Ct,yt,$t;if(Je)Ct=ke(le,$e,this.clusterProps),yt=le[$e],$t=le[$e+1];else{const br=this.points[le[$e+3]];Ct=br.properties;const[tr,Ze]=br.geometry.coordinates;yt=Ge(tr),$t=Ke(Ze)}const qt={type:1,geometry:[[Math.round(this.options.extent*(yt*Re-ue)),Math.round(this.options.extent*($t*Re-Pe))]],tags:Ct};let Qt;Qt=Je||this.options.generateId?le[$e+3]:this.points[le[$e+3]].id,Qt!==void 0&&(qt.id=Qt),Ye.features.push(qt)}}_limitZoom(ae){return Math.max(this.options.minZoom,Math.min(Math.floor(+ae),this.options.maxZoom+1))}_cluster(ae,le){const{radius:ue,extent:Pe,reduce:Re,minPoints:Ye}=this.options,Xe=ue/(Pe*Math.pow(2,le)),$e=ae.data,Je=[],Ct=this.stride;for(let yt=0;yt<$e.length;yt+=Ct){if($e[yt+2]<=le)continue;$e[yt+2]=le;const $t=$e[yt],qt=$e[yt+1],Qt=ae.within($e[yt],$e[yt+1],Xe),br=$e[yt+5];let tr=br;for(const Ze of Qt){const Lr=Ze*Ct;$e[Lr+2]>le&&(tr+=$e[Lr+5])}if(tr>br&&tr>=Ye){let Ze,Lr=$t*br,mn=qt*br,ar=-1;const Dr=(yt/Ct<<5)+(le+1)+this.points.length;for(const ln of Qt){const Xr=ln*Ct;if($e[Xr+2]<=le)continue;$e[Xr+2]=le;const zr=$e[Xr+5];Lr+=$e[Xr]*zr,mn+=$e[Xr+1]*zr,$e[Xr+4]=Dr,Re&&(Ze||(Ze=this._map($e,yt,!0),ar=this.clusterProps.length,this.clusterProps.push(Ze)),Re(Ze,this._map($e,Xr)))}$e[yt+4]=Dr,Je.push(Lr/tr,mn/tr,1/0,Dr,-1,tr),Re&&Je.push(ar)}else{for(let Ze=0;Ze<Ct;Ze++)Je.push($e[yt+Ze]);if(tr>1)for(const Ze of Qt){const Lr=Ze*Ct;if(!($e[Lr+2]<=le)){$e[Lr+2]=le;for(let mn=0;mn<Ct;mn++)Je.push($e[Lr+mn])}}}}return Je}_getOriginId(ae){return ae-this.points.length>>5}_getOriginZoom(ae){return(ae-this.points.length)%32}_map(ae,le,ue){if(ae[le+5]>1){const Ye=this.clusterProps[ae[le+6]];return ue?Object.assign({},Ye):Ye}const Pe=this.points[ae[le+3]].properties,Re=this.options.map(Pe);return ue&&Re===Pe?Object.assign({},Re):Re}}function re(He,ae,le){return{type:"Feature",id:He[ae+3],properties:ke(He,ae,le),geometry:{type:"Point",coordinates:[(ue=He[ae],360*(ue-.5)),gt(He[ae+1])]}};var ue}function ke(He,ae,le){const ue=He[ae+5],Pe=ue>=1e4?`${Math.round(ue/1e3)}k`:ue>=1e3?Math.round(ue/100)/10+"k":ue,Re=He[ae+6],Ye=Re===-1?{}:Object.assign({},le[Re]);return Object.assign(Ye,{cluster:!0,cluster_id:He[ae+3],point_count:ue,point_count_abbreviated:Pe})}function Ge(He){return He/360+.5}function Ke(He){const ae=Math.sin(He*Math.PI/180),le=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return le<0?0:le>1?1:le}function gt(He){const ae=(180-360*He)*Math.PI/180;return 360*Math.atan(Math.exp(ae))/Math.PI-90}function et(He,ae,le,ue){let Pe=ue;const Re=ae+(le-ae>>1);let Ye,Xe=le-ae;const $e=He[ae],Je=He[ae+1],Ct=He[le],yt=He[le+1];for(let $t=ae+3;$t<le;$t+=3){const qt=qe(He[$t],He[$t+1],$e,Je,Ct,yt);if(qt>Pe)Ye=$t,Pe=qt;else if(qt===Pe){const Qt=Math.abs($t-Re);Qt<Xe&&(Ye=$t,Xe=Qt)}}Pe>ue&&(Ye-ae>3&&et(He,ae,Ye,ue),He[Ye+2]=Pe,le-Ye>3&&et(He,Ye,le,ue))}function qe(He,ae,le,ue,Pe,Re){let Ye=Pe-le,Xe=Re-ue;if(Ye!==0||Xe!==0){const $e=((He-le)*Ye+(ae-ue)*Xe)/(Ye*Ye+Xe*Xe);$e>1?(le=Pe,ue=Re):$e>0&&(le+=Ye*$e,ue+=Xe*$e)}return Ye=He-le,Xe=ae-ue,Ye*Ye+Xe*Xe}function Qe(He,ae,le,ue){const Pe={id:He??null,type:ae,geometry:le,tags:ue,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ae==="Point"||ae==="MultiPoint"||ae==="LineString")Ve(Pe,le);else if(ae==="Polygon")Ve(Pe,le[0]);else if(ae==="MultiLineString")for(const Re of le)Ve(Pe,Re);else if(ae==="MultiPolygon")for(const Re of le)Ve(Pe,Re[0]);return Pe}function Ve(He,ae){for(let le=0;le<ae.length;le+=3)He.minX=Math.min(He.minX,ae[le]),He.minY=Math.min(He.minY,ae[le+1]),He.maxX=Math.max(He.maxX,ae[le]),He.maxY=Math.max(He.maxY,ae[le+1])}function je(He,ae,le,ue){if(!ae.geometry)return;const Pe=ae.geometry.coordinates;if(Pe&&Pe.length===0)return;const Re=ae.geometry.type,Ye=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2);let Xe=[],$e=ae.id;if(le.promoteId?$e=ae.properties[le.promoteId]:le.generateId&&($e=ue||0),Re==="Point")ct(Pe,Xe);else if(Re==="MultiPoint")for(const Je of Pe)ct(Je,Xe);else if(Re==="LineString")ye(Pe,Xe,Ye,!1);else if(Re==="MultiLineString"){if(le.lineMetrics){for(const Je of Pe)Xe=[],ye(Je,Xe,Ye,!1),He.push(Qe($e,"LineString",Xe,ae.properties));return}ze(Pe,Xe,Ye,!1)}else if(Re==="Polygon")ze(Pe,Xe,Ye,!0);else{if(Re!=="MultiPolygon"){if(Re==="GeometryCollection"){for(const Je of ae.geometry.geometries)je(He,{id:$e,geometry:Je,properties:ae.properties},le,ue);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Je of Pe){const Ct=[];ze(Je,Ct,Ye,!0),Xe.push(Ct)}}He.push(Qe($e,Re,Xe,ae.properties))}function ct(He,ae){ae.push(ft(He[0]),wt(He[1]),0)}function ye(He,ae,le,ue){let Pe,Re,Ye=0;for(let $e=0;$e<He.length;$e++){const Je=ft(He[$e][0]),Ct=wt(He[$e][1]);ae.push(Je,Ct,0),$e>0&&(Ye+=ue?(Pe*Ct-Je*Re)/2:Math.sqrt(Math.pow(Je-Pe,2)+Math.pow(Ct-Re,2))),Pe=Je,Re=Ct}const Xe=ae.length-3;ae[2]=1,et(ae,0,Xe,le),ae[Xe+2]=1,ae.size=Math.abs(Ye),ae.start=0,ae.end=ae.size}function ze(He,ae,le,ue){for(let Pe=0;Pe<He.length;Pe++){const Re=[];ye(He[Pe],Re,le,ue),ae.push(Re)}}function ft(He){return He/360+.5}function wt(He){const ae=Math.sin(He*Math.PI/180),le=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return le<0?0:le>1?1:le}function xt(He,ae,le,ue,Pe,Re,Ye,Xe){if(ue/=ae,Re>=(le/=ae)&&Ye<ue)return He;if(Ye<le||Re>=ue)return null;const $e=[];for(const Je of He){const Ct=Je.geometry;let yt=Je.type;const $t=Pe===0?Je.minX:Je.minY,qt=Pe===0?Je.maxX:Je.maxY;if($t>=le&&qt<ue){$e.push(Je);continue}if(qt<le||$t>=ue)continue;let Qt=[];if(yt==="Point"||yt==="MultiPoint")_t(Ct,Qt,le,ue,Pe);else if(yt==="LineString")St(Ct,Qt,le,ue,Pe,!1,Xe.lineMetrics);else if(yt==="MultiLineString")At(Ct,Qt,le,ue,Pe,!1);else if(yt==="Polygon")At(Ct,Qt,le,ue,Pe,!0);else if(yt==="MultiPolygon")for(const br of Ct){const tr=[];At(br,tr,le,ue,Pe,!0),tr.length&&Qt.push(tr)}if(Qt.length){if(Xe.lineMetrics&&yt==="LineString"){for(const br of Qt)$e.push(Qe(Je.id,yt,br,Je.tags));continue}yt!=="LineString"&&yt!=="MultiLineString"||(Qt.length===1?(yt="LineString",Qt=Qt[0]):yt="MultiLineString"),yt!=="Point"&&yt!=="MultiPoint"||(yt=Qt.length===3?"Point":"MultiPoint"),$e.push(Qe(Je.id,yt,Qt,Je.tags))}}return $e.length?$e:null}function _t(He,ae,le,ue,Pe){for(let Re=0;Re<He.length;Re+=3){const Ye=He[Re+Pe];Ye>=le&&Ye<=ue&&It(ae,He[Re],He[Re+1],He[Re+2])}}function St(He,ae,le,ue,Pe,Re,Ye){let Xe=tt(He);const $e=Pe===0?mr:ur;let Je,Ct,yt=He.start;for(let tr=0;tr<He.length-3;tr+=3){const Ze=He[tr],Lr=He[tr+1],mn=He[tr+2],ar=He[tr+3],Dr=He[tr+4],ln=Pe===0?Ze:Lr,Xr=Pe===0?ar:Dr;let zr=!1;Ye&&(Je=Math.sqrt(Math.pow(Ze-ar,2)+Math.pow(Lr-Dr,2))),ln<le?Xr>le&&(Ct=$e(Xe,Ze,Lr,ar,Dr,le),Ye&&(Xe.start=yt+Je*Ct)):ln>ue?Xr<ue&&(Ct=$e(Xe,Ze,Lr,ar,Dr,ue),Ye&&(Xe.start=yt+Je*Ct)):It(Xe,Ze,Lr,mn),Xr<le&&ln>=le&&(Ct=$e(Xe,Ze,Lr,ar,Dr,le),zr=!0),Xr>ue&&ln<=ue&&(Ct=$e(Xe,Ze,Lr,ar,Dr,ue),zr=!0),!Re&&zr&&(Ye&&(Xe.end=yt+Je*Ct),ae.push(Xe),Xe=tt(He)),Ye&&(yt+=Je)}let $t=He.length-3;const qt=He[$t],Qt=He[$t+1],br=Pe===0?qt:Qt;br>=le&&br<=ue&&It(Xe,qt,Qt,He[$t+2]),$t=Xe.length-3,Re&&$t>=3&&(Xe[$t]!==Xe[0]||Xe[$t+1]!==Xe[1])&&It(Xe,Xe[0],Xe[1],Xe[2]),Xe.length&&ae.push(Xe)}function tt(He){const ae=[];return ae.size=He.size,ae.start=He.start,ae.end=He.end,ae}function At(He,ae,le,ue,Pe,Re){for(const Ye of He)St(Ye,ae,le,ue,Pe,Re,!1)}function It(He,ae,le,ue){He.push(ae,le,ue)}function mr(He,ae,le,ue,Pe,Re){const Ye=(Re-ae)/(ue-ae);return It(He,Re,le+(Pe-le)*Ye,1),Ye}function ur(He,ae,le,ue,Pe,Re){const Ye=(Re-le)/(Pe-le);return It(He,ae+(ue-ae)*Ye,Re,1),Ye}function Hr(He,ae){const le=[];for(let ue=0;ue<He.length;ue++){const Pe=He[ue],Re=Pe.type;let Ye;if(Re==="Point"||Re==="MultiPoint"||Re==="LineString")Ye=wr(Pe.geometry,ae);else if(Re==="MultiLineString"||Re==="Polygon"){Ye=[];for(const Xe of Pe.geometry)Ye.push(wr(Xe,ae))}else if(Re==="MultiPolygon"){Ye=[];for(const Xe of Pe.geometry){const $e=[];for(const Je of Xe)$e.push(wr(Je,ae));Ye.push($e)}}le.push(Qe(Pe.id,Re,Ye,Pe.tags))}return le}function wr(He,ae){const le=[];le.size=He.size,He.start!==void 0&&(le.start=He.start,le.end=He.end);for(let ue=0;ue<He.length;ue+=3)le.push(He[ue]+ae,He[ue+1],He[ue+2]);return le}function sr(He,ae){if(He.transformed)return He;const le=1<<He.z,ue=He.x,Pe=He.y;for(const Re of He.features){const Ye=Re.geometry,Xe=Re.type;if(Re.geometry=[],Xe===1)for(let $e=0;$e<Ye.length;$e+=2)Re.geometry.push(Wt(Ye[$e],Ye[$e+1],ae,le,ue,Pe));else for(let $e=0;$e<Ye.length;$e++){const Je=[];for(let Ct=0;Ct<Ye[$e].length;Ct+=2)Je.push(Wt(Ye[$e][Ct],Ye[$e][Ct+1],ae,le,ue,Pe));Re.geometry.push(Je)}}return He.transformed=!0,He}function Wt(He,ae,le,ue,Pe,Re){return[Math.round(le*(He*ue-Pe)),Math.round(le*(ae*ue-Re))]}function yr(He,ae,le,ue,Pe){const Re=ae===Pe.maxZoom?0:Pe.tolerance/((1<<ae)*Pe.extent),Ye={features:[],numPoints:0,numSimplified:0,numFeatures:He.length,source:null,x:le,y:ue,z:ae,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Xe of He)Yt(Ye,Xe,Re,Pe);return Ye}function Yt(He,ae,le,ue){const Pe=ae.geometry,Re=ae.type,Ye=[];if(He.minX=Math.min(He.minX,ae.minX),He.minY=Math.min(He.minY,ae.minY),He.maxX=Math.max(He.maxX,ae.maxX),He.maxY=Math.max(He.maxY,ae.maxY),Re==="Point"||Re==="MultiPoint")for(let Xe=0;Xe<Pe.length;Xe+=3)Ye.push(Pe[Xe],Pe[Xe+1]),He.numPoints++,He.numSimplified++;else if(Re==="LineString")Cr(Ye,Pe,He,le,!1,!1);else if(Re==="MultiLineString"||Re==="Polygon")for(let Xe=0;Xe<Pe.length;Xe++)Cr(Ye,Pe[Xe],He,le,Re==="Polygon",Xe===0);else if(Re==="MultiPolygon")for(let Xe=0;Xe<Pe.length;Xe++){const $e=Pe[Xe];for(let Je=0;Je<$e.length;Je++)Cr(Ye,$e[Je],He,le,!0,Je===0)}if(Ye.length){let Xe=ae.tags||null;if(Re==="LineString"&&ue.lineMetrics){Xe={};for(const Je in ae.tags)Xe[Je]=ae.tags[Je];Xe.mapbox_clip_start=Pe.start/Pe.size,Xe.mapbox_clip_end=Pe.end/Pe.size}const $e={geometry:Ye,type:Re==="Polygon"||Re==="MultiPolygon"?3:Re==="LineString"||Re==="MultiLineString"?2:1,tags:Xe};ae.id!==null&&($e.id=ae.id),He.features.push($e)}}function Cr(He,ae,le,ue,Pe,Re){const Ye=ue*ue;if(ue>0&&ae.size<(Pe?Ye:ue))return void(le.numPoints+=ae.length/3);const Xe=[];for(let $e=0;$e<ae.length;$e+=3)(ue===0||ae[$e+2]>Ye)&&(le.numSimplified++,Xe.push(ae[$e],ae[$e+1])),le.numPoints++;Pe&&function($e,Je){let Ct=0;for(let yt=0,$t=$e.length,qt=$t-2;yt<$t;qt=yt,yt+=2)Ct+=($e[yt]-$e[qt])*($e[yt+1]+$e[qt+1]);if(Ct>0===Je)for(let yt=0,$t=$e.length;yt<$t/2;yt+=2){const qt=$e[yt],Qt=$e[yt+1];$e[yt]=$e[$t-2-yt],$e[yt+1]=$e[$t-1-yt],$e[$t-2-yt]=qt,$e[$t-1-yt]=Qt}}(Xe,Re),He.push(Xe)}const Rr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Or{constructor(ae,le){const ue=(le=this.options=function(Re,Ye){for(const Xe in Ye)Re[Xe]=Ye[Xe];return Re}(Object.create(Rr),le)).debug;if(ue&&console.time("preprocess data"),le.maxZoom<0||le.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(le.promoteId&&le.generateId)throw new Error("promoteId and generateId cannot be used together.");let Pe=function(Re,Ye){const Xe=[];if(Re.type==="FeatureCollection")for(let $e=0;$e<Re.features.length;$e++)je(Xe,Re.features[$e],Ye,$e);else je(Xe,Re.type==="Feature"?Re:{geometry:Re},Ye);return Xe}(ae,le);this.tiles={},this.tileCoords=[],ue&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",le.indexMaxZoom,le.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Pe=function(Re,Ye){const Xe=Ye.buffer/Ye.extent;let $e=Re;const Je=xt(Re,1,-1-Xe,Xe,0,-1,2,Ye),Ct=xt(Re,1,1-Xe,2+Xe,0,-1,2,Ye);return(Je||Ct)&&($e=xt(Re,1,-Xe,1+Xe,0,-1,2,Ye)||[],Je&&($e=Hr(Je,1).concat($e)),Ct&&($e=$e.concat(Hr(Ct,-1)))),$e}(Pe,le),Pe.length&&this.splitTile(Pe,0,0,0),ue&&(Pe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ae,le,ue,Pe,Re,Ye,Xe){const $e=[ae,le,ue,Pe],Je=this.options,Ct=Je.debug;for(;$e.length;){Pe=$e.pop(),ue=$e.pop(),le=$e.pop(),ae=$e.pop();const yt=1<<le,$t=Gr(le,ue,Pe);let qt=this.tiles[$t];if(!qt&&(Ct>1&&console.time("creation"),qt=this.tiles[$t]=yr(ae,le,ue,Pe,Je),this.tileCoords.push({z:le,x:ue,y:Pe}),Ct)){Ct>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",le,ue,Pe,qt.numFeatures,qt.numPoints,qt.numSimplified),console.timeEnd("creation"));const zr=`z${le}`;this.stats[zr]=(this.stats[zr]||0)+1,this.total++}if(qt.source=ae,Re==null){if(le===Je.indexMaxZoom||qt.numPoints<=Je.indexMaxPoints)continue}else{if(le===Je.maxZoom||le===Re)continue;if(Re!=null){const zr=Re-le;if(ue!==Ye>>zr||Pe!==Xe>>zr)continue}}if(qt.source=null,ae.length===0)continue;Ct>1&&console.time("clipping");const Qt=.5*Je.buffer/Je.extent,br=.5-Qt,tr=.5+Qt,Ze=1+Qt;let Lr=null,mn=null,ar=null,Dr=null,ln=xt(ae,yt,ue-Qt,ue+tr,0,qt.minX,qt.maxX,Je),Xr=xt(ae,yt,ue+br,ue+Ze,0,qt.minX,qt.maxX,Je);ae=null,ln&&(Lr=xt(ln,yt,Pe-Qt,Pe+tr,1,qt.minY,qt.maxY,Je),mn=xt(ln,yt,Pe+br,Pe+Ze,1,qt.minY,qt.maxY,Je),ln=null),Xr&&(ar=xt(Xr,yt,Pe-Qt,Pe+tr,1,qt.minY,qt.maxY,Je),Dr=xt(Xr,yt,Pe+br,Pe+Ze,1,qt.minY,qt.maxY,Je),Xr=null),Ct>1&&console.timeEnd("clipping"),$e.push(Lr||[],le+1,2*ue,2*Pe),$e.push(mn||[],le+1,2*ue,2*Pe+1),$e.push(ar||[],le+1,2*ue+1,2*Pe),$e.push(Dr||[],le+1,2*ue+1,2*Pe+1)}}getTile(ae,le,ue){ae=+ae,le=+le,ue=+ue;const Pe=this.options,{extent:Re,debug:Ye}=Pe;if(ae<0||ae>24)return null;const Xe=1<<ae,$e=Gr(ae,le=le+Xe&Xe-1,ue);if(this.tiles[$e])return sr(this.tiles[$e],Re);Ye>1&&console.log("drilling down to z%d-%d-%d",ae,le,ue);let Je,Ct=ae,yt=le,$t=ue;for(;!Je&&Ct>0;)Ct--,yt>>=1,$t>>=1,Je=this.tiles[Gr(Ct,yt,$t)];return Je&&Je.source?(Ye>1&&(console.log("found parent tile z%d-%d-%d",Ct,yt,$t),console.time("drilling down")),this.splitTile(Je.source,Ct,yt,$t,ae,le,ue),Ye>1&&console.timeEnd("drilling down"),this.tiles[$e]?sr(this.tiles[$e],Re):null):null}}function Gr(He,ae,le){return 32*((1<<He)*le+ae)+He}class rn extends j{constructor(ae,le,ue,Pe=Un){super(ae,le,ue),this._dataUpdateable=new Map,this._createGeoJSONIndex=Pe}loadVectorTile(ae,le){return f._(this,void 0,void 0,function*(){const ue=ae.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Pe=this._geoJSONIndex.getTile(ue.z,ue.x,ue.y);return Pe?U(new f.d2(Pe.features,{version:2,extent:f.a5})):null})}loadData(ae){return f._(this,void 0,void 0,function*(){var le;(le=this._pendingRequest)===null||le===void 0||le.abort();const ue=this._startPerformance(ae);this._pendingRequest=new AbortController;try{(!this._pendingData||ae.request||ae.data||ae.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(ae,this._pendingRequest));const Pe=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(Pe,ae),this.loaded={};const Re={};return ae.request&&(Re.data=Pe),this._finishPerformance(ue,ae,Re),Re}catch(Pe){if(delete this._pendingRequest,f.Z(Pe))return{abandoned:!0};throw Pe}})}_startPerformance(ae){var le;if(!((le=ae?.request)===null||le===void 0)&&le.collectResourceTiming)return new f.c_(ae.request)}_finishPerformance(ae,le,ue){if(!ae)return;const Pe=ae.finish();Pe&&(ue.resourceTiming={},ue.resourceTiming[le.source]=JSON.parse(JSON.stringify(Pe)))}getData(){return f._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(ae){const le=this.loaded;return le&&le[ae.uid]?super.reloadTile(ae):this.loadTile(ae)}loadAndProcessGeoJSON(ae,le){return f._(this,void 0,void 0,function*(){let ue;if(ae.request?ue=yield this.loadGeoJSONFromUrl(ae.request,ae.promoteId,le):ae.data?ue=this._loadGeoJSONFromObject(ae.data,ae.promoteId):ae.dataDiff&&(ue=this._loadGeoJSONFromDiff(ae.dataDiff,ae.promoteId,ae.source)),delete this._pendingRequest,typeof ue!="object")throw new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`);return oe(ue,!0),ae.filter&&(ue=this._filterGeoJSON(ue,ae.filter)),ue})}loadGeoJSONFromUrl(ae,le,ue){return f._(this,void 0,void 0,function*(){const Pe=yield f.j(ae,ue);return this._dataUpdateable=f.a7(Pe.data,le),Pe.data})}_loadGeoJSONFromObject(ae,le){return this._dataUpdateable=f.a7(ae,le),ae}_loadGeoJSONFromDiff(ae,le,ue){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ue}`);f.a8(this._dataUpdateable,ae,le);const Pe=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(Pe)}_filterGeoJSON(ae,le){const ue=f.d3(le,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ue.result==="error")throw new Error(ue.value.map(Re=>`${Re.key}: ${Re.message}`).join(", "));const Pe=ae.features.filter(Re=>ue.value.evaluate({zoom:0},Re));return this._toFeatureCollection(Pe)}_toFeatureCollection(ae){return{type:"FeatureCollection",features:ae}}removeSource(ae){return f._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ae){return this._geoJSONIndex.getClusterExpansionZoom(ae.clusterId)}getClusterChildren(ae){return this._geoJSONIndex.getChildren(ae.clusterId)}getClusterLeaves(ae){return this._geoJSONIndex.getLeaves(ae.clusterId,ae.limit,ae.offset)}}function Un(He,ae){return ae.cluster?new Ee(function({superclusterOptions:le,clusterProperties:ue}){if(!ue||!le)return le;const Pe={},Re={},Ye={accumulated:null,zoom:0},Xe={properties:null},$e=Object.keys(ue);for(const Je of $e){const[Ct,yt]=ue[Je],$t=f.d3(yt),qt=f.d3(typeof Ct=="string"?[Ct,["accumulated"],["get",Je]]:Ct);Pe[Je]=$t.value,Re[Je]=qt.value}return le.map=Je=>{Xe.properties=Je;const Ct={};for(const yt of $e)Ct[yt]=Pe[yt].evaluate(Ye,Xe);return Ct},le.reduce=(Je,Ct)=>{Xe.properties=Ct;for(const yt of $e)Ye.accumulated=Je[yt],Je[yt]=Re[yt].evaluate(Ye,Xe)},le}(ae)).load(He.features):function(le,ue){return new Or(le,ue)}(He,ae.geojsonVtOptions)}class wn{constructor(ae){this.self=ae,this.actor=new f.L(ae),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(le,ue)=>{if(this.externalWorkerSourceTypes[le])throw new Error(`Worker source with name "${le}" already registered.`);this.externalWorkerSourceTypes[le]=ue},this.self.addProtocol=f.cJ,this.self.removeProtocol=f.cK,this.self.registerRTLTextPlugin=le=>{f.d4.setMethods(le)},this.actor.registerMessageHandler("LDT",(le,ue)=>this._getDEMWorkerSource(le,ue.source).loadTile(ue)),this.actor.registerMessageHandler("RDT",(le,ue)=>f._(this,void 0,void 0,function*(){this._getDEMWorkerSource(le,ue.source).removeTile(ue)})),this.actor.registerMessageHandler("GCEZ",(le,ue)=>f._(this,void 0,void 0,function*(){return this._getWorkerSource(le,ue.type,ue.source).getClusterExpansionZoom(ue)})),this.actor.registerMessageHandler("GCC",(le,ue)=>f._(this,void 0,void 0,function*(){return this._getWorkerSource(le,ue.type,ue.source).getClusterChildren(ue)})),this.actor.registerMessageHandler("GCL",(le,ue)=>f._(this,void 0,void 0,function*(){return this._getWorkerSource(le,ue.type,ue.source).getClusterLeaves(ue)})),this.actor.registerMessageHandler("LD",(le,ue)=>this._getWorkerSource(le,ue.type,ue.source).loadData(ue)),this.actor.registerMessageHandler("GD",(le,ue)=>this._getWorkerSource(le,ue.type,ue.source).getData()),this.actor.registerMessageHandler("LT",(le,ue)=>this._getWorkerSource(le,ue.type,ue.source).loadTile(ue)),this.actor.registerMessageHandler("RT",(le,ue)=>this._getWorkerSource(le,ue.type,ue.source).reloadTile(ue)),this.actor.registerMessageHandler("AT",(le,ue)=>this._getWorkerSource(le,ue.type,ue.source).abortTile(ue)),this.actor.registerMessageHandler("RMT",(le,ue)=>this._getWorkerSource(le,ue.type,ue.source).removeTile(ue)),this.actor.registerMessageHandler("RS",(le,ue)=>f._(this,void 0,void 0,function*(){if(!this.workerSources[le]||!this.workerSources[le][ue.type]||!this.workerSources[le][ue.type][ue.source])return;const Pe=this.workerSources[le][ue.type][ue.source];delete this.workerSources[le][ue.type][ue.source],Pe.removeSource!==void 0&&Pe.removeSource(ue)})),this.actor.registerMessageHandler("RM",le=>f._(this,void 0,void 0,function*(){delete this.layerIndexes[le],delete this.availableImages[le],delete this.workerSources[le],delete this.demWorkerSources[le],this.globalStates.delete(le)})),this.actor.registerMessageHandler("SR",(le,ue)=>f._(this,void 0,void 0,function*(){this.referrer=ue})),this.actor.registerMessageHandler("SRPS",(le,ue)=>this._syncRTLPluginState(le,ue)),this.actor.registerMessageHandler("IS",(le,ue)=>f._(this,void 0,void 0,function*(){this.self.importScripts(ue)})),this.actor.registerMessageHandler("SI",(le,ue)=>this._setImages(le,ue)),this.actor.registerMessageHandler("UL",(le,ue)=>f._(this,void 0,void 0,function*(){this._getLayerIndex(le).update(ue.layers,ue.removedIds,this._getGlobalState(le))})),this.actor.registerMessageHandler("UGS",(le,ue)=>f._(this,void 0,void 0,function*(){const Pe=this._getGlobalState(le);for(const Re in ue)Pe[Re]=ue[Re]})),this.actor.registerMessageHandler("SL",(le,ue)=>f._(this,void 0,void 0,function*(){this._getLayerIndex(le).replace(ue,this._getGlobalState(le))}))}_getGlobalState(ae){let le=this.globalStates.get(ae);return le||(le={},this.globalStates.set(ae,le)),le}_setImages(ae,le){return f._(this,void 0,void 0,function*(){this.availableImages[ae]=le;for(const ue in this.workerSources[ae]){const Pe=this.workerSources[ae][ue];for(const Re in Pe)Pe[Re].availableImages=le}})}_syncRTLPluginState(ae,le){return f._(this,void 0,void 0,function*(){return yield f.d4.syncState(le,this.self.importScripts)})}_getAvailableImages(ae){let le=this.availableImages[ae];return le||(le=[]),le}_getLayerIndex(ae){let le=this.layerIndexes[ae];return le||(le=this.layerIndexes[ae]=new o),le}_getWorkerSource(ae,le,ue){if(this.workerSources[ae]||(this.workerSources[ae]={}),this.workerSources[ae][le]||(this.workerSources[ae][le]={}),!this.workerSources[ae][le][ue]){const Pe={sendAsync:(Re,Ye)=>(Re.targetMapId=ae,this.actor.sendAsync(Re,Ye))};switch(le){case"vector":this.workerSources[ae][le][ue]=new j(Pe,this._getLayerIndex(ae),this._getAvailableImages(ae));break;case"geojson":this.workerSources[ae][le][ue]=new rn(Pe,this._getLayerIndex(ae),this._getAvailableImages(ae));break;default:this.workerSources[ae][le][ue]=new this.externalWorkerSourceTypes[le](Pe,this._getLayerIndex(ae),this._getAvailableImages(ae))}}return this.workerSources[ae][le][ue]}_getDEMWorkerSource(ae,le){return this.demWorkerSources[ae]||(this.demWorkerSources[ae]={}),this.demWorkerSources[ae][le]||(this.demWorkerSources[ae][le]=new ie),this.demWorkerSources[ae][le]}}return f.i(self)&&(self.worker=new wn(self)),wn}),c("index",["exports","./shared"],function(f,o){var b="5.16.0";function P(){var w=new o.A(4);return o.A!=Float32Array&&(w[1]=0,w[2]=0),w[0]=1,w[3]=1,w}let I,D,z;const F={frame(w,n,u){const m=requestAnimationFrame(S=>{v(),n(S)}),{unsubscribe:v}=o.s(w.signal,"abort",()=>{v(),cancelAnimationFrame(m),u(new o.a(w.signal.reason))},!1)},frameAsync(w){return new Promise((n,u)=>{this.frame(w,n,u)})},getImageData(w,n=0){return this.getImageCanvasContext(w).getImageData(-n,-n,w.width+2*n,w.height+2*n)},getImageCanvasContext(w){const n=window.document.createElement("canvas"),u=n.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return n.width=w.width,n.height=w.height,u.drawImage(w,0,0,w.width,w.height),u},resolveURL:w=>(I||(I=document.createElement("a")),I.href=w,I.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return z!==void 0?z:!!matchMedia&&(D==null&&(D=matchMedia("(prefers-reduced-motion: reduce)")),D.matches)},set prefersReducedMotion(w){z=w}},U=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(w){this._frozenAt=w}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function $(){return U.getCurrentTime()}class j{static testProp(n){if(!j.docStyle)return n[0];for(let u=0;u<n.length;u++)if(n[u]in j.docStyle)return n[u];return n[0]}static create(n,u,m){const v=window.document.createElement(n);return u!==void 0&&(v.className=u),m&&m.appendChild(v),v}static createNS(n,u){return window.document.createElementNS(n,u)}static disableDrag(){j.docStyle&&j.selectProp&&(j.userSelect=j.docStyle[j.selectProp],j.docStyle[j.selectProp]="none")}static enableDrag(){j.docStyle&&j.selectProp&&(j.docStyle[j.selectProp]=j.userSelect)}static setTransform(n,u){n.style[j.transformProp]=u}static addEventListener(n,u,m,v={}){n.addEventListener(u,m,"passive"in v?v:v.capture)}static removeEventListener(n,u,m,v={}){n.removeEventListener(u,m,"passive"in v?v:v.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",j.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",j.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",j.suppressClickInternal,!0)},0)}static getScale(n){const u=n.getBoundingClientRect();return{x:u.width/n.offsetWidth||1,y:u.height/n.offsetHeight||1,boundingClientRect:u}}static getPoint(n,u,m){const v=u.boundingClientRect;return new o.P((m.clientX-v.left)/u.x-n.clientLeft,(m.clientY-v.top)/u.y-n.clientTop)}static mousePos(n,u){const m=j.getScale(n);return j.getPoint(n,m,u)}static touchPos(n,u){const m=[],v=j.getScale(n);for(let S=0;S<u.length;S++)m.push(j.getPoint(n,v,u[S]));return m}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}static sanitize(n){const u=new DOMParser().parseFromString(n,"text/html").body||document.createElement("body"),m=u.querySelectorAll("script");for(const v of m)v.remove();return j.clean(u),u.innerHTML}static isPossiblyDangerous(n,u){const m=u.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(n)||!m.includes("javascript:")&&!m.includes("data:"))||!!n.startsWith("on")||void 0}static clean(n){const u=n.children;for(const m of u)j.removeAttributes(m),j.clean(m)}static removeAttributes(n){for(const{name:u,value:m}of n.attributes)j.isPossiblyDangerous(u,m)&&n.removeAttribute(u)}}j.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,j.selectProp=j.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),j.transformProp=j.testProp(["transform","WebkitTransform"]);const ie={supported:!1,testSupport:function(w){!de&&Q&&(oe?be(w):se=w)}};let se,Q,de=!1,oe=!1;function be(w){const n=w.createTexture();w.bindTexture(w.TEXTURE_2D,n);try{if(w.texImage2D(w.TEXTURE_2D,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,Q),w.isContextLost())return;ie.supported=!0}catch{}w.deleteTexture(n),de=!0}var xe;typeof document<"u"&&(Q=document.createElement("img"),Q.onload=()=>{se&&be(se),se=null,oe=!0},Q.onerror=()=>{de=!0,se=null},Q.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(w){let n,u,m,v;w.resetRequestQueue=()=>{n=[],u=0,m=0,v={}},w.addThrottleControl=O=>{const B=m++;return v[B]=O,B},w.removeThrottleControl=O=>{delete v[O],M()},w.getImage=(O,B,q=!0)=>new Promise((Y,X)=>{ie.supported&&(O.headers||(O.headers={}),O.headers.accept="image/webp,*/*"),o.e(O,{type:"image"}),n.push({abortController:B,requestParameters:O,supportImageRefresh:q,state:"queued",onError:te=>{X(te)},onSuccess:te=>{Y(te)}}),M()});const S=O=>o._(this,void 0,void 0,function*(){O.state="running";const{requestParameters:B,supportImageRefresh:q,onError:Y,onSuccess:X,abortController:te}=O,ce=q===!1&&!o.i(self)&&!o.g(B.url)&&(!B.headers||Object.keys(B.headers).reduce((ve,Se)=>ve&&Se==="accept",!0));u++;const ge=ce?k(B,te):o.m(B,te);try{const ve=yield ge;delete O.abortController,O.state="completed",ve.data instanceof HTMLImageElement||o.b(ve.data)?X(ve):ve.data&&X({data:yield(_e=ve.data,typeof createImageBitmap=="function"?o.f(_e):o.h(_e)),cacheControl:ve.cacheControl,expires:ve.expires})}catch(ve){delete O.abortController,Y(ve)}finally{u--,M()}var _e}),M=()=>{const O=(()=>{for(const B of Object.keys(v))if(v[B]())return!0;return!1})()?o.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let B=u;B<O&&n.length>0;B++){const q=n.shift();q.abortController.signal.aborted?B--:S(q)}},k=(O,B)=>new Promise((q,Y)=>{const X=new Image,te=O.url,ce=O.credentials;ce&&ce==="include"?X.crossOrigin="use-credentials":(ce&&ce==="same-origin"||!o.d(te))&&(X.crossOrigin="anonymous"),B.signal.addEventListener("abort",()=>{X.src="",Y(new o.a(B.signal.reason))}),X.fetchPriority="high",X.onload=()=>{X.onerror=X.onload=null,q({data:X})},X.onerror=()=>{X.onerror=X.onload=null,B.signal.aborted||Y(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},X.src=te})}(xe||(xe={})),xe.resetRequestQueue();class Me{constructor(n){this._transformRequestFn=n??null}transformRequest(n,u){return this._transformRequestFn&&this._transformRequestFn(n,u)||{url:n}}setTransformRequest(n){this._transformRequestFn=n}}function Ee(w){const n=[];if(typeof w=="string")n.push({id:"default",url:w});else if(w&&w.length>0){const u=[];for(const{id:m,url:v}of w){const S=`${m}${v}`;u.indexOf(S)===-1&&(u.push(S),n.push({id:m,url:v}))}}return n}function re(w,n,u){try{const m=new URL(w);return m.pathname+=`${n}${u}`,m.toString()}catch{throw new Error(`Invalid sprite URL "${w}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function ke(w){const{userImage:n}=w;return!!(n&&n.render&&n.render())&&(w.data.replace(new Uint8Array(n.data.buffer)),!0)}class Ge extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const n of Object.keys(this.images))this.removeImage(n);this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:u,promiseResolve:m}of this.requestors)m(this._getImagesForIds(u));this.requestors=[]}}getImage(n){const u=this.images[n];if(u&&!u.data&&u.spriteData){const m=u.spriteData;u.data=new o.R({width:m.width,height:m.height},m.context.getImageData(m.x,m.y,m.width,m.height).data),u.spriteData=null}return u}addImage(n,u){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,u)&&(this.images[n]=u)}_validate(n,u){let m=!0;const v=u.data||u.spriteData;return this._validateStretch(u.stretchX,v&&v.width)||(this.fire(new o.k(new Error(`Image "${n}" has invalid "stretchX" value`))),m=!1),this._validateStretch(u.stretchY,v&&v.height)||(this.fire(new o.k(new Error(`Image "${n}" has invalid "stretchY" value`))),m=!1),this._validateContent(u.content,u)||(this.fire(new o.k(new Error(`Image "${n}" has invalid "content" value`))),m=!1),m}_validateStretch(n,u){if(!n)return!0;let m=0;for(const v of n){if(v[0]<m||v[1]<v[0]||u<v[1])return!1;m=v[1]}return!0}_validateContent(n,u){if(!n)return!0;if(n.length!==4)return!1;const m=u.spriteData,v=m&&m.width||u.data.width,S=m&&m.height||u.data.height;return!(n[0]<0||v<n[0]||n[1]<0||S<n[1]||n[2]<0||v<n[2]||n[3]<0||S<n[3]||n[2]<n[0]||n[3]<n[1])}updateImage(n,u,m=!0){const v=this.getImage(n);if(m&&(v.data.width!==u.data.width||v.data.height!==u.data.height))throw new Error(`size mismatch between old image (${v.data.width}x${v.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=v.version+1,this.images[n]=u,this.updatedImages[n]=!0}removeImage(n){const u=this.images[n];delete this.images[n],delete this.patterns[n],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n){return new Promise((u,m)=>{let v=!0;if(!this.isLoaded())for(const S of n)this.images[S]||(v=!1);this.isLoaded()||v?u(this._getImagesForIds(n)):this.requestors.push({ids:n,promiseResolve:u})})}_getImagesForIds(n){const u={};for(const m of n){let v=this.getImage(m);v||(this.fire(new o.l("styleimagemissing",{id:m})),v=this.getImage(m)),v?u[m]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,textFitWidth:v.textFitWidth,textFitHeight:v.textFitHeight,hasRenderCallback:!!(v.userImage&&v.userImage.render)}:o.w(`Image "${m}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return u}getPixelSize(){const{width:n,height:u}=this.atlasImage;return{width:n,height:u}}getPattern(n){const u=this.patterns[n],m=this.getImage(n);if(!m)return null;if(u&&u.position.version===m.version)return u.position;if(u)u.position.version=m.version;else{const v={w:m.data.width+2,h:m.data.height+2,x:0,y:0},S=new o.I(v,m);this.patterns[n]={bin:v,position:S}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const u=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.T(n,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const S in this.patterns)n.push(this.patterns[S].bin);const{w:u,h:m}=o.p(n),v=this.atlasImage;v.resize({width:u||1,height:m||1});for(const S in this.patterns){const{bin:M}=this.patterns[S],k=M.x+1,O=M.y+1,B=this.getImage(S).data,q=B.width,Y=B.height;o.R.copy(B,v,{x:0,y:0},{x:k,y:O},{width:q,height:Y}),o.R.copy(B,v,{x:0,y:Y-1},{x:k,y:O-1},{width:q,height:1}),o.R.copy(B,v,{x:0,y:0},{x:k,y:O+Y},{width:q,height:1}),o.R.copy(B,v,{x:q-1,y:0},{x:k-1,y:O},{width:1,height:Y}),o.R.copy(B,v,{x:0,y:0},{x:k+q,y:O},{width:1,height:Y})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const u of n){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const m=this.getImage(u);m||o.w(`Image with ID: "${u}" was not found`),ke(m)&&this.updateImage(u,m)}}cloneImages(){const n={};for(const u in this.images){const m=this.images[u];n[u]=Object.assign(Object.assign({},m),{data:m.data?m.data.clone():null})}return n}}const Ke=1e20;function gt(w,n,u,m,v,S,M,k,O){for(let B=n;B<n+m;B++)et(w,u*S+B,S,v,M,k,O);for(let B=u;B<u+v;B++)et(w,B*S+n,1,m,M,k,O)}function et(w,n,u,m,v,S,M){S[0]=0,M[0]=-Ke,M[1]=Ke,v[0]=w[n];for(let k=1,O=0,B=0;k<m;k++){v[k]=w[n+k*u];const q=k*k;do{const Y=S[O];B=(v[k]-v[Y]+q-Y*Y)/(k-Y)/2}while(B<=M[O]&&--O>-1);O++,S[O]=k,M[O]=B,M[O+1]=Ke}for(let k=0,O=0;k<m;k++){for(;M[O+1]<k;)O++;const B=S[O],q=k-B;w[n+k*u]=v[B]+q*q}}const qe=o.v.layout_symbol["text-font"].default.join(",");class Qe{constructor(n,u,m){this.requestManager=n,this.localIdeographFontFamily=u,this.entries={},this.lang=m}setURL(n){this.url=n}getGlyphs(n){return o._(this,void 0,void 0,function*(){const u=[];for(const S in n)for(const M of n[S])u.push(this._getAndCacheGlyphsPromise(S,M));const m=yield Promise.all(u),v={};for(const{stack:S,id:M,glyph:k}of m)v[S]||(v[S]={}),v[S][M]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics};return v})}_getAndCacheGlyphsPromise(n,u){return o._(this,void 0,void 0,function*(){let m=this.entries[n];m||(m=this.entries[n]={glyphs:{},requests:{},ranges:{}});let v=m.glyphs[u];return v!==void 0?{stack:n,id:u,glyph:v}:!this.url||this._charUsesLocalIdeographFontFamily(u)?(v=m.glyphs[u]=this._drawGlyph(m,n,u),{stack:n,id:u,glyph:v}):yield this._downloadAndCacheRangePromise(n,u)})}_downloadAndCacheRangePromise(n,u){return o._(this,void 0,void 0,function*(){const m=this.entries[n],v=Math.floor(u/256);if(m.ranges[v])return{stack:n,id:u,glyph:null};if(!m.requests[v]){const S=Qe.loadGlyphRange(n,v,this.url,this.requestManager);m.requests[v]=S}try{const S=yield m.requests[v];for(const M in S)m.glyphs[+M]=S[+M];return m.ranges[v]=!0,{stack:n,id:u,glyph:S[u]||null}}catch(S){const M=m.glyphs[u]=this._drawGlyph(m,n,u);return this._warnOnMissingGlyphRange(M,v,u,S),{stack:n,id:u,glyph:M}}})}_warnOnMissingGlyphRange(n,u,m,v){const S=256*u,M=S+255,k=m.toString(16).padStart(4,"0").toUpperCase();o.w(`Unable to load glyph range ${u}, ${S}-${M}. Rendering codepoint U+${k} locally instead. ${v}`)}_charUsesLocalIdeographFontFamily(n){return!!this.localIdeographFontFamily&&o.q(n)}_drawGlyph(n,u,m){const v=u===qe&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(m),S=v?"ideographTinySDF":"tinySDF";n[S]||(n[S]=this._createTinySDF(v?this.localIdeographFontFamily:u));const M=n[S].draw(String.fromCodePoint(m)),k=new RegExp("^\\p{gc=Cf}+$","u").test(String.fromCodePoint(m));return{id:m,bitmap:new o.r({width:M.width||60,height:M.height||60},M.data),metrics:{width:k?0:M.glyphWidth/2||24,height:M.glyphHeight/2||24,left:M.glyphLeft/2+.5||0,top:M.glyphTop/2-27.5||-8,advance:k?0:M.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(n){const u=n?n.split(","):[];u.push("sans-serif");const m=u.map(v=>/[-\w]+/.test(v)?v:`'${CSS.escape(v)}'`).join(",");return new Qe.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:m,fontWeight:this._fontWeight(u[0]),fontStyle:this._fontStyle(u[0]),lang:this.lang})}_fontStyle(n){return/italic/i.test(n)?"italic":/oblique/i.test(n)?"oblique":"normal"}_fontWeight(n){const u={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let m;for(const[v,S]of Object.entries(u))new RegExp(`\\b${v}\\b`,"i").test(n)&&(m=`${S}`);return m}destroy(){for(const n in this.entries){const u=this.entries[n];u.tinySDF&&(u.tinySDF=null),u.ideographTinySDF&&(u.ideographTinySDF=null),u.glyphs={},u.requests={},u.ranges={}}this.entries={}}}Qe.loadGlyphRange=function(w,n,u,m){return o._(this,void 0,void 0,function*(){const v=256*n,S=v+255,M=m.transformRequest(u.replace("{fontstack}",w).replace("{range}",`${v}-${S}`),"Glyphs"),k=yield o.n(M,new AbortController);if(!k||!k.data)throw new Error(`Could not load glyph range. range: ${n}, ${v}-${S}`);const O={};for(const B of o.o(k.data))O[B.id]=B;return O})},Qe.TinySDF=class{constructor({fontSize:w=24,buffer:n=3,radius:u=8,cutoff:m=.25,fontFamily:v="sans-serif",fontWeight:S="normal",fontStyle:M="normal",lang:k=null}={}){this.buffer=n,this.cutoff=m,this.radius=u,this.lang=k;const O=this.size=w+4*n,B=this._createCanvas(O),q=this.ctx=B.getContext("2d",{willReadFrequently:!0});q.font=`${M} ${S} ${w}px ${v}`,q.textBaseline="alphabetic",q.textAlign="left",q.fillStyle="black",this.gridOuter=new Float64Array(O*O),this.gridInner=new Float64Array(O*O),this.f=new Float64Array(O),this.z=new Float64Array(O+1),this.v=new Uint16Array(O)}_createCanvas(w){const n=document.createElement("canvas");return n.width=n.height=w,n}draw(w){const{width:n,actualBoundingBoxAscent:u,actualBoundingBoxDescent:m,actualBoundingBoxLeft:v,actualBoundingBoxRight:S}=this.ctx.measureText(w),M=Math.ceil(u),k=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(S-v))),O=Math.min(this.size-this.buffer,M+Math.ceil(m)),B=k+2*this.buffer,q=O+2*this.buffer,Y=Math.max(B*q,0),X=new Uint8ClampedArray(Y),te={data:X,width:B,height:q,glyphWidth:k,glyphHeight:O,glyphTop:M,glyphLeft:0,glyphAdvance:n};if(k===0||O===0)return te;const{ctx:ce,buffer:ge,gridInner:_e,gridOuter:ve}=this;this.lang&&(ce.lang=this.lang),ce.clearRect(ge,ge,k,O),ce.fillText(w,ge,ge+M);const Se=ce.getImageData(ge,ge,k,O);ve.fill(Ke,0,Y),_e.fill(0,0,Y);for(let Oe=0;Oe<O;Oe++)for(let Ce=0;Ce<k;Ce++){const De=Se.data[4*(Oe*k+Ce)+3]/255;if(De===0)continue;const Be=(Oe+ge)*B+Ce+ge;if(De===1)ve[Be]=0,_e[Be]=Ke;else{const Ae=.5-De;ve[Be]=Ae>0?Ae*Ae:0,_e[Be]=Ae<0?Ae*Ae:0}}gt(ve,0,0,B,q,B,this.f,this.v,this.z),gt(_e,ge,ge,k,O,B,this.f,this.v,this.z);for(let Oe=0;Oe<Y;Oe++){const Ce=Math.sqrt(ve[Oe])-Math.sqrt(_e[Oe]);X[Oe]=Math.round(255-255*(Ce/this.radius+this.cutoff))}return te}};class Ve{constructor(){this.specification=o.u.light.position}possiblyEvaluate(n,u){return o.F(n.expression.evaluate(u))}interpolate(n,u,m){return{x:o.G.number(n.x,u.x,m),y:o.G.number(n.y,u.y,m),z:o.G.number(n.z,u.z,m)}}}let je;class ct extends o.E{constructor(n){super(),je=je||new o.t({anchor:new o.D(o.u.light.anchor),position:new Ve,color:new o.D(o.u.light.color),intensity:new o.D(o.u.light.intensity)}),this._transitionable=new o.x(je,void 0),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,u={}){if(!this._validate(o.y,n,u))for(const m in n){const v=n[m];m.endsWith(o.z)?this._transitionable.setTransition(m.slice(0,-o.z.length),v):this._transitionable.setValue(m,v)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,m){return(!m||m.validate!==!1)&&o.B(this,n.call(o.C,{value:u,style:{glyphs:!0,sprite:!0},styleSpec:o.u}))}}const ye=new o.t({"sky-color":new o.D(o.u.sky["sky-color"]),"horizon-color":new o.D(o.u.sky["horizon-color"]),"fog-color":new o.D(o.u.sky["fog-color"]),"fog-ground-blend":new o.D(o.u.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.u.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.u.sky["atmosphere-blend"])});class ze extends o.E{constructor(n){super(),this._transitionable=new o.x(ye,void 0),this.setSky(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.H(0))}setSky(n,u={}){if(!this._validate(o.J,n,u)){n||(n={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const m in n){const v=n[m];m.endsWith(o.z)?this._transitionable.setTransition(m.slice(0,-o.z.length),v):this._transitionable.setValue(m,v)}}}getSky(){return this._transitionable.serialize()}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,m={}){return m?.validate!==!1&&o.B(this,n.call(o.C,o.e({value:u,style:{glyphs:!0,sprite:!0},styleSpec:o.u})))}calculateFogBlendOpacity(n){return n<60?0:n<70?(n-60)/10:1}}class ft{constructor(n,u){this.width=n,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,u){const m=n.join(",")+String(u);return this.dashEntry[m]||(this.dashEntry[m]=this.addDash(n,u)),this.dashEntry[m]}getDashRanges(n,u,m){const v=[];let S=n.length%2==1?-n[n.length-1]*m:0,M=n[0]*m,k=!0;v.push({left:S,right:M,isDash:k,zeroLength:n[0]===0});let O=n[0];for(let B=1;B<n.length;B++){k=!k;const q=n[B];S=O*m,O+=q,M=O*m,v.push({left:S,right:M,isDash:k,zeroLength:q===0})}return v}addRoundDash(n,u,m){const v=u/2;for(let S=-m;S<=m;S++){const M=this.width*(this.nextRow+m+S);let k=0,O=n[k];for(let B=0;B<this.width;B++){B/O.right>1&&(O=n[++k]);const q=Math.abs(B-O.left),Y=Math.abs(B-O.right),X=Math.min(q,Y);let te;const ce=S/m*(v+1);if(O.isDash){const ge=v-Math.abs(ce);te=Math.sqrt(X*X+ge*ge)}else te=v-Math.sqrt(X*X+ce*ce);this.data[M+B]=Math.max(0,Math.min(255,te+128))}}}addRegularDash(n){for(let k=n.length-1;k>=0;--k){const O=n[k],B=n[k+1];O.zeroLength?n.splice(k,1):B&&B.isDash===O.isDash&&(B.left=O.left,n.splice(k,1))}const u=n[0],m=n[n.length-1];u.isDash===m.isDash&&(u.left=m.left-this.width,m.right=u.right+this.width);const v=this.width*this.nextRow;let S=0,M=n[S];for(let k=0;k<this.width;k++){k/M.right>1&&(M=n[++S]);const O=Math.abs(k-M.left),B=Math.abs(k-M.right),q=Math.min(O,B);this.data[v+k]=Math.max(0,Math.min(255,(M.isDash?q:-q)+128))}}addDash(n,u){const m=u?7:0,v=2*m+1;if(this.nextRow+v>this.height)return o.w("LineAtlas out of space"),null;let S=0;for(let k=0;k<n.length;k++)S+=n[k];if(S!==0){const k=this.width/S,O=this.getDashRanges(n,this.width,k);u?this.addRoundDash(O,k,m):this.addRegularDash(O)}const M={y:this.nextRow+m,height:2*m,width:S};return this.nextRow+=v,this.dirty=!0,M}bind(n){const u=n.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}const wt="maplibre_preloaded_worker_pool";class xt{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<xt.workerCount;)this.workers.push(new Worker(o.c.WORKER_URL));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[wt]}numActive(){return Object.keys(this.active).length}}const _t=Math.floor(F.hardwareConcurrency/2);let St,tt;function At(){return St||(St=new xt),St}xt.workerCount=o.K(globalThis)?Math.max(Math.min(_t,3),1):1;class It{constructor(n,u){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=u;const m=this.workerPool.acquire(u);for(let v=0;v<m.length;v++){const S=new o.L(m[v],u);S.name=`Worker ${v}`,this.actors.push(S)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,u){const m=[];for(const v of this.actors)m.push(v.sendAsync({type:n,data:u}));return Promise.all(m)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(n=!0){this.actors.forEach(u=>{u.remove()}),this.actors=[],n&&this.workerPool.release(this.id)}registerMessageHandler(n,u){for(const m of this.actors)m.registerMessageHandler(n,u)}unregisterMessageHandler(n){for(const u of this.actors)u.unregisterMessageHandler(n)}}function mr(){return tt||(tt=new It(At(),o.M),tt.registerMessageHandler("GR",(w,n,u)=>o.m(n,u))),tt}function ur(w,n){const u=o.N();return o.O(u,u,[1,1,0]),o.Q(u,u,[.5*w.width,.5*w.height,1]),w.calculatePosMatrix?o.S(u,u,w.calculatePosMatrix(n.toUnwrapped())):u}function Hr(w,n,u,m,v,S,M){var k;const O=function(X,te,ce){if(X)for(const ge of X){const _e=te[ge];if(_e&&_e.source===ce&&_e.type==="fill-extrusion")return!0}else for(const ge in te){const _e=te[ge];if(_e.source===ce&&_e.type==="fill-extrusion")return!0}return!1}((k=v?.layers)!==null&&k!==void 0?k:null,n,w.id),B=S.maxPitchScaleFactor(),q=w.tilesIn(m,B,O);q.sort(wr);const Y=[];for(const X of q)Y.push({wrappedTileID:X.tileID.wrapped().key,queryResults:X.tile.queryRenderedFeatures(n,u,w.getState(),X.queryGeometry,X.cameraQueryGeometry,X.scale,v,S,B,ur(S,X.tileID),M?(te,ce)=>M(X.tileID,te,ce):void 0)});return function(X,te){for(const ce in X)for(const ge of X[ce])sr(ge,te);return X}(function(X){const te={},ce={};for(const ge of X){const _e=ge.queryResults,ve=ge.wrappedTileID,Se=ce[ve]=ce[ve]||{};for(const Oe in _e){const Ce=_e[Oe],De=Se[Oe]=Se[Oe]||{},Be=te[Oe]=te[Oe]||[];for(const Ae of Ce)De[Ae.featureIndex]||(De[Ae.featureIndex]=!0,Be.push(Ae))}}return te}(Y),w)}function wr(w,n){const u=w.tileID,m=n.tileID;return u.overscaledZ-m.overscaledZ||u.canonical.y-m.canonical.y||u.wrap-m.wrap||u.canonical.x-m.canonical.x}function sr(w,n){const u=w.feature,m=n.getFeatureState(u.layer["source-layer"],u.id);u.source=u.layer.source,u.layer["source-layer"]&&(u.sourceLayer=u.layer["source-layer"]),u.state=m}function Wt(w,n,u){return o._(this,void 0,void 0,function*(){let m=w;if(w.url?m=(yield o.j(n.transformRequest(w.url,"Source"),u)).data:yield F.frameAsync(u),!m)return null;const v=o.U(o.e(m,w),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in m&&m.vector_layers&&(v.vectorLayerIds=m.vector_layers.map(S=>S.id)),v})}class yr{constructor(n,u){n&&(u?this.setSouthWest(n).setNorthEast(u):Array.isArray(n)&&(n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1])))}setNorthEast(n){return this._ne=n instanceof o.V?new o.V(n.lng,n.lat):o.V.convert(n),this}setSouthWest(n){return this._sw=n instanceof o.V?new o.V(n.lng,n.lat):o.V.convert(n),this}extend(n){const u=this._sw,m=this._ne;let v,S;if(n instanceof o.V)v=n,S=n;else{if(!(n instanceof yr))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(yr.convert(n)):this.extend(o.V.convert(n)):n&&("lng"in n||"lon"in n)&&"lat"in n?this.extend(o.V.convert(n)):this;if(v=n._sw,S=n._ne,!v||!S)return this}return u||m?(u.lng=Math.min(v.lng,u.lng),u.lat=Math.min(v.lat,u.lat),m.lng=Math.max(S.lng,m.lng),m.lat=Math.max(S.lat,m.lat)):(this._sw=new o.V(v.lng,v.lat),this._ne=new o.V(S.lng,S.lat)),this}getCenter(){return new o.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.V(this.getWest(),this.getNorth())}getSouthEast(){return new o.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:u,lat:m}=o.V.convert(n);let v=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=m&&m<=this._ne.lat&&v}intersects(n){if(!((n=yr.convert(n)).getNorth()>=this.getSouth()&&n.getSouth()<=this.getNorth()))return!1;const u=Math.abs(this.getEast()-this.getWest()),m=Math.abs(n.getEast()-n.getWest());if(u>=360||m>=360)return!0;const v=o.W(this.getWest(),-180,180),S=o.W(this.getEast(),-180,180),M=o.W(n.getWest(),-180,180),k=o.W(n.getEast(),-180,180),O=v>=S,B=M>=k;return!(!O||!B)||(O?k>=v||M<=S:B?S>=M||v<=k:M<=S&&k>=v)}static convert(n){return n instanceof yr?n:n&&new yr(n)}static fromLngLat(n,u=0){const m=360*u/40075017,v=m/Math.cos(Math.PI/180*n.lat);return new yr(new o.V(n.lng-v,n.lat-m),new o.V(n.lng+v,n.lat+m))}adjustAntiMeridian(){const n=new o.V(this._sw.lng,this._sw.lat),u=new o.V(this._ne.lng,this._ne.lat);return new yr(n,n.lng>u.lng?new o.V(u.lng+360,u.lat):u)}}class Yt{constructor(n,u,m){this.bounds=yr.convert(this.validateBounds(n)),this.minzoom=u||0,this.maxzoom=m||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const u=Math.pow(2,n.z),m=Math.floor(o.Y(this.bounds.getWest())*u),v=Math.floor(o.X(this.bounds.getNorth())*u),S=Math.ceil(o.Y(this.bounds.getEast())*u),M=Math.ceil(o.X(this.bounds.getSouth())*u);return n.x>=m&&n.x<S&&n.y>=v&&n.y<M}}class Cr extends o.E{constructor(n,u,m,v){if(super(),this.id=n,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.U(u,["url","scheme","tileSize","promoteId","encoding"])),this._options=o.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v)}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield Wt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),n&&(o.e(this,n),n.bounds&&(this.tileBounds=new Yt(n.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this._loaded=!0,o.Z(n)||this.fire(new o.k(n))}})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.abort(),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(n){return o._(this,void 0,void 0,function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),m={request:this.map._requestManager.transformRequest(u,"Tile"),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(n)};m.request.collectResourceTiming=this._collectResourceTiming;let v="RT";if(n.actor&&n.state!=="expired"){if(n.state==="loading")return new Promise((S,M)=>{n.reloadPromise={resolve:S,reject:M}})}else n.actor=this.dispatcher.getActor(),v="LT";n.abortController=new AbortController;try{const S=yield n.actor.sendAsync({type:v,data:m},n.abortController);if(delete n.abortController,n.aborted)return;this._afterTileLoadWorkerResponse(n,S)}catch(S){if(delete n.abortController,n.aborted)return;if(S&&S.status!==404)throw S;this._afterTileLoadWorkerResponse(n,null)}})}_getOverzoomParameters(n){if(n.tileID.canonical.z<=this.maxzoom||this.map._zoomLevelsToOverscale===void 0)return;const u=n.tileID.scaledTo(this.maxzoom).canonical,m=u.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:u,overzoomRequest:this.map._requestManager.transformRequest(m,"Tile")}}_afterTileLoadWorkerResponse(n,u){if(u&&u.resourceTiming&&(n.resourceTiming=u.resourceTiming),u&&this.map._refreshExpiredTiles&&n.setExpiryData(u),n.loadVectorData(u,this.map.painter),n.reloadPromise){const m=n.reloadPromise;n.reloadPromise=null,this.loadTile(n).then(m.resolve).catch(m.reject)}}abortTile(n){return o._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.actor&&(yield n.actor.sendAsync({type:"AT",data:{uid:n.uid,type:this.type,source:this.id}}))})}unloadTile(n){return o._(this,void 0,void 0,function*(){n.unloadVectorData(),n.actor&&(yield n.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Rr extends o.E{constructor(n,u,m,v){super(),this.id=n,this.dispatcher=m,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},u),o.e(this,o.U(u,["url","scheme","tileSize"]))}load(){return o._(this,arguments,void 0,function*(n=!1){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const u=yield Wt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,u&&(o.e(this,u),u.bounds&&(this.tileBounds=new Yt(u.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:n})))}catch(u){this._tileJSONRequest=null,this._loaded=!0,o.Z(u)||this.fire(new o.k(u))}})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(n){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),n(),this.load(!0)}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}serialize(){return o.e({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n){return o._(this,void 0,void 0,function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.abortController=new AbortController;try{const m=yield xe.getImage(this.map._requestManager.transformRequest(u,"Tile"),n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(m&&m.data){this.map._refreshExpiredTiles&&(m.cacheControl||m.expires)&&n.setExpiryData({cacheControl:m.cacheControl,expires:m.expires});const v=this.map.painter.context,S=v.gl,M=m.data;n.texture=this.map.painter.getTileTexture(M.width),n.texture?n.texture.update(M,{useMipmap:!0}):(n.texture=new o.T(v,M,S.RGBA,{useMipmap:!0}),n.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST)),n.state="loaded"}}catch(m){if(delete n.abortController,n.aborted)n.state="unloaded";else if(m)throw n.state="errored",m}})}abortTile(n){return o._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController)})}unloadTile(n){return o._(this,void 0,void 0,function*(){n.texture&&this.map.painter.saveTileTexture(n.texture)})}hasTransition(){return!1}}class Or extends Rr{constructor(n,u,m,v){super(n,u,m,v),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(n){return o._(this,void 0,void 0,function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),m=this.map._requestManager.transformRequest(u,"Tile");n.neighboringTiles=this._getNeighboringTiles(n.tileID),n.abortController=new AbortController;try{const v=yield xe.getImage(m,n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(v&&v.data){const S=v.data;this.map._refreshExpiredTiles&&(v.cacheControl||v.expires)&&n.setExpiryData({cacheControl:v.cacheControl,expires:v.expires});const M=o.b(S)&&o.$()?S:yield this.readImageNow(S),k={type:this.type,uid:n.uid,source:this.id,rawImageData:M,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!n.actor||n.state==="expired"){n.actor=this.dispatcher.getActor();const O=yield n.actor.sendAsync({type:"LDT",data:k});n.dem=O,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded"}}}catch(v){if(delete n.abortController,n.aborted)n.state="unloaded";else if(v)throw n.state="errored",v}})}readImageNow(n){return o._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&o.a0()){const u=n.width+2,m=n.height+2;try{return new o.R({width:u,height:m},yield o.a1(n,-1,-1,u,m))}catch{}}return F.getImageData(n,1)})}_getNeighboringTiles(n){const u=n.canonical,m=Math.pow(2,u.z),v=(u.x-1+m)%m,S=u.x===0?n.wrap-1:n.wrap,M=(u.x+1+m)%m,k=u.x+1===m?n.wrap+1:n.wrap,O={};return O[new o.a2(n.overscaledZ,S,u.z,v,u.y).key]={backfilled:!1},O[new o.a2(n.overscaledZ,k,u.z,M,u.y).key]={backfilled:!1},u.y>0&&(O[new o.a2(n.overscaledZ,S,u.z,v,u.y-1).key]={backfilled:!1},O[new o.a2(n.overscaledZ,n.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},O[new o.a2(n.overscaledZ,k,u.z,M,u.y-1).key]={backfilled:!1}),u.y+1<m&&(O[new o.a2(n.overscaledZ,S,u.z,v,u.y+1).key]={backfilled:!1},O[new o.a2(n.overscaledZ,n.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},O[new o.a2(n.overscaledZ,k,u.z,M,u.y+1).key]={backfilled:!1}),O}unloadTile(n){return o._(this,void 0,void 0,function*(){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&(yield n.actor.sendAsync({type:"RDT",data:{type:this.type,uid:n.uid,source:this.id}}))})}}function Gr(w){return w.type==="GeometryCollection"?w.geometries.map(n=>n.coordinates).flat(1/0):w.coordinates.flat(1/0)}function rn(w){const n=new yr;let u;switch(w.type){case"FeatureCollection":u=w.features.map(m=>Gr(m.geometry)).flat(1/0);break;case"Feature":u=Gr(w.geometry);break;default:u=Gr(w)}if(u.length==0)return n;for(let m=0;m<u.length-1;m+=2)n.extend([u[m],u[m+1]]);return n}class Un extends o.E{constructor(n,u,m,v){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:u.data},this.actor=m.getActor(),this.setEventedParent(v),this._data=typeof u.data=="string"?{url:u.data}:{geojson:u.data},this._options=o.e({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId,u.clusterMaxZoom!==void 0&&this.maxzoom<=u.clusterMaxZoom&&o.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${u.clusterMaxZoom}".`),this.workerOptions=o.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(u.buffer!==void 0?u.buffer:128),tolerance:this._pixelsToTileUnits(u.tolerance!==void 0?u.tolerance:.375),extent:o.a5,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(u.clusterMaxZoom),minPoints:Math.max(2,u.clusterMinPoints||2),extent:o.a5,radius:this._pixelsToTileUnits(u.clusterRadius||50),log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(n){return n*(o.a5/this.tileSize)}_getClusterMaxZoom(n){const u=n?Math.round(n):this.maxzoom-1;return Number.isInteger(n)||n===void 0||o.w(`Integer expected for option 'clusterMaxZoom': provided value "${n}" rounded to "${u}"`),u}load(){return o._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(n){this.map=n,this.load()}setData(n,u){this._data=typeof n=="string"?{url:n}:{geojson:n},this._pendingWorkerUpdate={data:n};const m=this._updateWorkerData();return u?m:this}updateData(n,u){this._pendingWorkerUpdate.diff=o.a6(this._pendingWorkerUpdate.diff,n);const m=this._updateWorkerData();return u?m:this}getData(){return o._(this,void 0,void 0,function*(){const n=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:n})})}getBounds(){return o._(this,void 0,void 0,function*(){return rn(yield this.getData())})}setClusterOptions(n){return this.workerOptions.cluster=n.cluster,n.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(n.clusterRadius)),n.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(n.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(n){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:n,source:this.id}})}getClusterChildren(n){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:n,source:this.id}})}getClusterLeaves(n,u,m){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:n,limit:u,offset:m}})}_updateWorkerData(){return o._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void o.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:n,diff:u}=this._pendingWorkerUpdate,m=o.e({type:this.type},this.workerOptions);n!==void 0?(typeof n=="string"?(m.request=this.map._requestManager.transformRequest(F.resolveURL(n),"Source"),m.request.collectResourceTiming=this._collectResourceTiming):m.data=n,this._pendingWorkerUpdate.data=void 0):u&&(m.dataDiff=u,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new o.l("dataloading",{dataType:"source"}));try{const v=yield this.actor.sendAsync({type:"LD",data:m});if(this._isUpdatingWorker=!1,this._removed||v.abandoned)return void this.fire(new o.l("dataabort",{dataType:"source"}));v.data&&(this._data={geojson:v.data});const S=this._applyDiffToSource(u),M=this._getShouldReloadTileOptions(S);let k=null;v.resourceTiming&&v.resourceTiming[this.id]&&(k=v.resourceTiming[this.id].slice(0));const O={dataType:"source"};this._collectResourceTiming&&k&&k.length>0&&o.e(O,{resourceTiming:k}),this.fire(new o.l("data",Object.assign(Object.assign({},O),{sourceDataType:"metadata"}))),this.fire(new o.l("data",Object.assign(Object.assign({},O),{sourceDataType:"content",shouldReloadTileOptions:M})))}catch(v){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new o.l("dataabort",{dataType:"source"}));this.fire(new o.k(v))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}})}_applyDiffToSource(n){if(!n)return;const u=typeof this.promoteId=="string"?this.promoteId:void 0;if(!this._data.url&&!this._data.updateable){const v=o.a7(this._data.geojson,u);if(!v)throw new Error(`GeoJSONSource "${this.id}": GeoJSON data is not compatible with updateData`);this._data={updateable:v}}if(!this._data.updateable)return;const m=o.a8(this._data.updateable,n,u);return n.removeAll||this._options.cluster?void 0:m}_getShouldReloadTileOptions(n){if(n)return{affectedBounds:n.filter(Boolean).map(u=>rn(u))}}shouldReloadTile(n,{affectedBounds:u}){if(n.state==="loading")return!0;if(n.state==="unloaded")return!1;const{buffer:m,extent:v}=this.workerOptions.geojsonVtOptions,S=function({x:M,y:k,z:O},B=0){const q=o.a3((M-B)/Math.pow(2,O)),Y=o.a4((k+1+B)/Math.pow(2,O)),X=o.a3((M+1+B)/Math.pow(2,O)),te=o.a4((k-B)/Math.pow(2,O));return new yr([q,Y],[X,te])}(n.tileID.canonical,m/v);for(const M of u)if(S.intersects(M))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(n){return o._(this,void 0,void 0,function*(){const u=n.actor?"RT":"LT";n.actor=this.actor;const m={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};n.abortController=new AbortController;const v=yield this.actor.sendAsync({type:u,data:m},n.abortController);delete n.abortController,n.unloadVectorData(),n.aborted||n.loadVectorData(v,this.map.painter,u==="RT")})}abortTile(n){return o._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.aborted=!0})}unloadTile(n){return o._(this,void 0,void 0,function*(){n.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class wn extends o.E{constructor(n,u,m,v){super(),this.flippedWindingOrder=!1,this.id=n,this.dispatcher=m,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=u}load(n){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const u=yield xe.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,u&&u.data&&(this.image=u.data,n&&(this.coordinates=n),this._finishLoading())}catch(u){this._request=null,this._loaded=!0,o.Z(u)||this.fire(new o.k(u))}})}loaded(){return this._loaded}updateImage(n){return n.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=n.url,this.load(n.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(n){this.coordinates=n;const u=n.map(o.a9.fromLngLat);var m;return this.tileID=function(v){const S=o.aa.fromPoints(v),M=S.width(),k=S.height(),O=Math.max(M,k),B=Math.max(0,Math.floor(-Math.log(O)/Math.LN2)),q=Math.pow(2,B);return new o.ac(B,Math.floor((S.minX+S.maxX)/2*q),Math.floor((S.minY+S.maxY)/2*q))}(u),this.terrainTileRanges=this._getOverlappingTileRanges(u),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=u.map(v=>this.tileID.getTilePoint(v)._round()),this.flippedWindingOrder=((m=this.tileCoords)[1].x-m[0].x)*(m[2].y-m[0].y)-(m[1].y-m[0].y)*(m[2].x-m[0].x)<0,this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,u=n.gl;this.texture||(this.texture=new o.T(n,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let m=!1;for(const v in this.tiles){const S=this.tiles[v];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,m=!0)}m&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(n){return o._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={}):n.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(n){const{minX:u,minY:m,maxX:v,maxY:S}=o.aa.fromPoints(n),M={};for(let k=0;k<=o.ab;k++){const O=Math.pow(2,k),B=Math.floor(u*O),q=Math.floor(m*O),Y=Math.floor(v*O),X=Math.floor(S*O),te=(B%O+O)%O,ce=Y%O,ge=Math.floor(B/O),_e=Math.floor(Y/O);M[k]={minWrap:ge,maxWrap:_e,minTileXWrapped:te,maxTileXWrapped:ce,minTileY:q,maxTileY:X}}return M}}class He extends wn{constructor(n,u,m,v){super(n,u,m,v),this.roundZoom=!0,this.type="video",this.options=u}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1;const n=this.options;this.urls=[];for(const u of n.urls)this.urls.push(this.map._requestManager.transformRequest(u,"Source").url);try{const u=yield o.ad(this.urls);if(this._loaded=!0,!u)return;this.video=u,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(u){this.fire(new o.k(u))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const u=this.video.seekable;n<u.start(0)||n>u.end(0)?this.fire(new o.k(new o.ae(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,u=n.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(n,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let m=!1;for(const v in this.tiles){const S=this.tiles[v];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,m=!0)}m&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ae extends wn{constructor(n,u,m,v){super(n,u,m,v),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(S=>!Array.isArray(S)||S.length!==2||S.some(M=>typeof M!="number"))||this.fire(new o.k(new o.ae(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.k(new o.ae(`sources.${n}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new o.k(new o.ae(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new o.k(new o.ae(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.k(new o.ae(`sources.${n}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){return o._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context,m=u.gl;this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):(this.texture=new o.T(u,this.canvas,m.RGBA,{premultiply:!0}),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE));let v=!1;for(const S in this.tiles){const M=this.tiles[S];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture,v=!0)}v&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const le={},ue=w=>{switch(w){case"geojson":return Un;case"image":return wn;case"raster":return Rr;case"raster-dem":return Or;case"vector":return Cr;case"video":return He;case"canvas":return ae}return le[w]},Pe="RTLPluginLoaded";class Re extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=mr()}_syncState(n){return this.status=n,this.dispatcher.broadcast("SRPS",{pluginStatus:n,pluginURL:this.url}).catch(u=>{throw this.status="error",u})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(n){return o._(this,arguments,void 0,function*(u,m=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=F.resolveURL(u),!this.url)throw new Error(`requested url ${u} is invalid`);if(this.status==="unavailable"){if(!m)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return o._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.l(Pe))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ye=null;function Xe(){return Ye||(Ye=new Re),Ye}var $e,Je;(function(w){w[w.Base=0]="Base",w[w.Parent=1]="Parent"})($e||($e={})),function(w){w[w.Departing=0]="Departing",w[w.Incoming=1]="Incoming"}(Je||(Je={}));class Ct{constructor(n,u){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=n,this.uid=o.af(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(n){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(n||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:n,fadingDirection:u,fadingParentID:m,fadeEndTime:v}){this.resetFadeLogic(),this.fadingRole=n,this.fadingDirection=u,this.fadingParentID=m,this.fadeEndTime=v}setSelfFadeLogic(n){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=n}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=$(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(n,u,m){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData,this.latestFeatureIndex.encoding=n.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(v,S){const M={};if(!S)return M;for(const k of v){const O=k.layerIds.map(B=>S.getLayer(B)).filter(Boolean);if(O.length!==0){k.layers=O,k.stateDependentLayerIds&&(k.stateDependentLayers=k.stateDependentLayerIds.map(B=>O.filter(q=>q.id===B)[0]));for(const B of O)M[B.id]=k}}return M}(n.buckets,u?.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const S=this.buckets[v];if(S instanceof o.ah){if(this.hasSymbolBuckets=!0,!m)break;S.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const S=this.buckets[v];if(S instanceof o.ah&&S.hasRTLText){this.hasRTLText=!0,Xe().lazyLoad();break}}this.queryPadding=0;for(const v in this.buckets){const S=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(v).queryRadius(S))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage),this.dashPositions=n.dashPositions}else this.collisionBoxArray=new o.ag}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const m in this.buckets){const v=this.buckets[m];v.uploadPending()&&v.upload(n)}const u=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new o.T(n,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(n,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,u,m,v,S,M,k,O,B,q,Y){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:S,scale:M,tileSize:this.tileSize,pixelPosMatrix:q,transform:O,params:k,queryPadding:this.queryPadding*B,getElevation:Y},n,u,m):{}}querySourceFeatures(n,u){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const v=m.loadVTLayers(),S=u&&u.sourceLayer?u.sourceLayer:"",M=v[o.ai]||v[S];if(!M)return;const k=o.aj(u?.filter,u?.globalState),{z:O,x:B,y:q}=this.tileID.canonical,Y={z:O,x:B,y:q};for(let X=0;X<M.length;X++){const te=M.feature(X);if(k.needGeometry){const _e=o.ak(te,!0);if(!k.filter(new o.H(this.tileID.overscaledZ),_e,this.tileID.canonical))continue}else if(!k.filter(new o.H(this.tileID.overscaledZ),te))continue;const ce=m.getId(te,S),ge=new o.al(te,O,B,q,ce);ge.tile=Y,n.push(ge)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const u=this.expirationTime;if(n.cacheControl){const m=o.am(n.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const m=Date.now();let v=!1;if(this.expirationTime>m)v=!1;else if(u)if(this.expirationTime<u)v=!0;else{const S=this.expirationTime-u;S?this.expirationTime=m+Math.max(S,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const m=this.latestFeatureIndex.loadVTLayers();for(const v in this.buckets){if(!u.style.hasLayer(v))continue;const S=this.buckets[v],M=S.layers[0].sourceLayer||o.ai,k=m[M],O=n[M];if(!k||!O||Object.keys(O).length===0)continue;S.update(O,k,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const B=u&&u.style&&u.style.getLayer(v);B&&(this.queryPadding=Math.max(this.queryPadding,B.queryRadius(S)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<$()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(n){this.symbolFadeHoldUntil=$()+n}setDependencies(n,u){const m={};for(const v of u)m[v]=!0;this.dependencies[n]=m}hasDependency(n,u){for(const m of n){const v=this.dependencies[m];if(v){for(const S of u)if(v[S])return!0}}return!1}}class yt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,u,m){const v=String(u);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][v]=this.stateChanges[n][v]||{},o.e(this.stateChanges[n][v],m),this.deletedStates[n]===null){this.deletedStates[n]={};for(const S in this.state[n])S!==v&&(this.deletedStates[n][S]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][v]===null){this.deletedStates[n][v]={};for(const S in this.state[n][v])m[S]||(this.deletedStates[n][v][S]=null)}else for(const S in m)this.deletedStates[n]&&this.deletedStates[n][v]&&this.deletedStates[n][v][S]===null&&delete this.deletedStates[n][v][S]}removeFeatureState(n,u,m){if(this.deletedStates[n]===null)return;const v=String(u);if(this.deletedStates[n]=this.deletedStates[n]||{},m&&u!==void 0)this.deletedStates[n][v]!==null&&(this.deletedStates[n][v]=this.deletedStates[n][v]||{},this.deletedStates[n][v][m]=null);else if(u!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][v])for(m in this.deletedStates[n][v]={},this.stateChanges[n][v])this.deletedStates[n][v][m]=null;else this.deletedStates[n][v]=null;else this.deletedStates[n]=null}getState(n,u){const m=String(u),v=o.e({},(this.state[n]||{})[m],(this.stateChanges[n]||{})[m]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const S=this.deletedStates[n][u];if(S===null)return{};for(const M in S)delete v[M]}return v}initializeTileState(n,u){n.setFeatureState(this.state,u)}coalesceChanges(n,u){const m={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const S={};for(const M in this.stateChanges[v])this.state[v][M]||(this.state[v][M]={}),o.e(this.state[v][M],this.stateChanges[v][M]),S[M]=this.state[v][M];m[v]=S}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const S={};if(this.deletedStates[v]===null)for(const M in this.state[v])S[M]={},this.state[v][M]={};else for(const M in this.deletedStates[v]){if(this.deletedStates[v][M]===null)this.state[v][M]={};else for(const k of Object.keys(this.deletedStates[v][M]))delete this.state[v][M][k];S[M]=this.state[v][M]}m[v]=m[v]||{},o.e(m[v],S)}this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0&&n.setFeatureState(m,u)}}const $t=89.25;function qt(w,n){const u=o.an(n.lat,-o.ao,o.ao);return new o.P(o.Y(n.lng)*w,o.X(u)*w)}function Qt(w,n){return new o.a9(n.x/w,n.y/w).toLngLat()}function br(w){return w.cameraToCenterDistance*Math.min(.85*Math.tan(o.ap(90-w.pitch)),Math.tan(o.ap($t-w.pitch)))}function tr(w,n){const u=w.canonical,m=n/o.aq(u.z),v=u.x+Math.pow(2,u.z)*w.wrap,S=o.ar(new Float64Array(16));return o.O(S,S,[v*m,u.y*m,0]),o.Q(S,S,[m/o.a5,m/o.a5,1]),S}function Ze(w,n,u,m,v){const S=o.a9.fromLngLat(w,n),M=v*o.as(1,w.lat),{x:k,y:O,z:B}=Lr(u,m);return new o.a9(S.x+M*-k,S.y+M*-O,S.z+M*-B)}function Lr(w,n){const u=o.ap(w),m=o.ap(n),v=Math.cos(-u),S=Math.sin(u);return{x:S*Math.sin(m),y:-S*Math.cos(m),z:v}}function mn(w,n,u){const m=n.intersectsFrustum(w);if(!u||m===0)return m;const v=n.intersectsPlane(u);return v===0?0:m===2&&v===2?2:1}function ar(w,n,u){let m=0;const v=(u-n)/10;for(let S=0;S<10;S++)m+=v*Math.pow(Math.cos(n+(S+.5)/10*(u-n)),w);return m}function Dr(w,n){return function(u,m,v,S,M){const k=2*((w-1)/o.at(Math.cos(o.ap($t-M))/Math.cos(o.ap($t)))-1),O=Math.acos(v/S),B=2*ar(k-1,0,o.ap(M/2)),q=Math.min(o.ap($t),O+o.ap(M/2)),Y=ar(k-1,Math.min(q,O-o.ap(M/2)),q),X=Math.atan(m/v),te=Math.hypot(m,v);let ce=u;return ce+=o.at(S/te/Math.max(.5,Math.cos(o.ap(M/2)))),ce+=k*o.at(Math.cos(X))/2,ce-=o.at(Math.max(1,Y/B/n))/2,ce}}const ln=Dr(9.314,3);function Xr(w,n){const u=(n.roundZoom?Math.round:Math.floor)(w.zoom+o.at(w.tileSize/n.tileSize));return Math.max(0,u)}function zr(w,n){const u=w.getCameraFrustum(),m=w.getClippingPlane(),v=w.screenPointToMercatorCoordinate(w.getCameraPoint()),S=o.a9.fromLngLat(w.center,w.elevation);v.z=S.z+Math.cos(w.pitchInRadians)*w.cameraToCenterDistance/w.worldSize;const M=w.getCoveringTilesDetailsProvider(),k=M.allowVariableZoom(w,n),O=Xr(w,n),B=n.minzoom||0,q=n.maxzoom!==void 0?n.maxzoom:w.maxZoom,Y=Math.min(Math.max(0,O),q),X=Math.pow(2,Y),te=[X*v.x,X*v.y,0],ce=[X*S.x,X*S.y,0],ge=Math.hypot(S.x-v.x,S.y-v.y),_e=Math.abs(S.z-v.z),ve=Math.hypot(ge,_e),Se=De=>({zoom:0,x:0,y:0,wrap:De,fullyVisible:!1}),Oe=[],Ce=[];if(w.renderWorldCopies&&M.allowWorldCopies())for(let De=1;De<=3;De++)Oe.push(Se(-De)),Oe.push(Se(De));for(Oe.push(Se(0));Oe.length>0;){const De=Oe.pop(),Be=De.x,Ae=De.y;let Ue=De.fullyVisible;const ut={x:Be,y:Ae,z:De.zoom},it=M.getTileBoundingVolume(ut,De.wrap,w.elevation,n);if(!Ue){const Dt=mn(u,it,m);if(Dt===0)continue;Ue=Dt===2}const st=M.distanceToTile2d(v.x,v.y,ut,it);let at=O;k&&(at=(n.calculateTileZoom||ln)(w.zoom+o.at(w.tileSize/n.tileSize),st,_e,ve,w.fov)),at=(n.roundZoom?Math.round:Math.floor)(at),at=Math.max(0,at);const Rt=Math.min(at,q);if(De.wrap=M.getWrap(S,ut,De.wrap),De.zoom>=Rt){if(De.zoom<B)continue;const Dt=Y-De.zoom,Tt=te[0]-.5-(Be<<Dt),Nt=te[1]-.5-(Ae<<Dt),kr=n.reparseOverscaled?Math.max(De.zoom,at):De.zoom;Ce.push({tileID:new o.a2(De.zoom===q?kr:De.zoom,De.wrap,De.zoom,Be,Ae),distanceSq:o.au([ce[0]-.5-Be,ce[1]-.5-Ae]),tileDistanceToCamera:Math.sqrt(Tt*Tt+Nt*Nt)})}else for(let Dt=0;Dt<4;Dt++)Oe.push({zoom:De.zoom+1,x:(Be<<1)+Dt%2,y:(Ae<<1)+(Dt>>1),wrap:De.wrap,fullyVisible:Ue})}return Ce.sort((De,Be)=>De.distanceSq-Be.distanceSq).map(De=>De.tileID)}const Vr=o.aa.fromPoints([new o.P(0,0),new o.P(o.a5,o.a5)]);function Kr(w){return w==="raster"||w==="image"||w==="video"}function Vi(w,n,u,m,v,S,M){if(!n.hasData())return!1;const{tileID:k,fadingRole:O,fadingDirection:B,fadingParentID:q}=n;if(O===$e.Base&&B===Je.Incoming&&q)return u[q.key]=q,!0;const Y=Math.max(k.overscaledZ-v,S);for(let X=k.overscaledZ-1;X>=Y;X--){const te=k.scaledTo(X),ce=w.getLoadedTile(te);if(ce)return n.setCrossFadeLogic({fadingRole:$e.Base,fadingDirection:Je.Incoming,fadingParentID:ce.tileID,fadeEndTime:m+M}),ce.setCrossFadeLogic({fadingRole:$e.Parent,fadingDirection:Je.Departing,fadeEndTime:m+M}),u[te.key]=te,!0}return!1}function Ui(w,n,u,m,v,S){if(!n.hasData())return!1;const M=n.tileID.children(v);let k=Et(w,n,M,u,m,v,S);if(k)return!0;for(const O of M)Et(w,n,O.children(v),u,m,v,S)&&(k=!0);return k}function Et(w,n,u,m,v,S,M){if(u[0].overscaledZ>=S)return!1;let k=!1;for(const O of u){const B=w.getLoadedTile(O);if(!B)continue;const{fadingRole:q,fadingDirection:Y,fadingParentID:X}=B;q===$e.Base&&Y===Je.Departing&&X||(B.setCrossFadeLogic({fadingRole:$e.Base,fadingDirection:Je.Departing,fadingParentID:n.tileID,fadeEndTime:v+M}),n.setCrossFadeLogic({fadingRole:$e.Parent,fadingDirection:Je.Incoming,fadeEndTime:v+M})),m[O.key]=O,k=!0}return k}function vn(w,n,u,m){const v=w.tileID;return!!w.selfFading||!w.hasData()&&!!n.has(v)&&(w.setSelfFadeLogic(u+m),!0)}function zn(w,n){var u;w.needsHillshadePrepare=!0,w.needsTerrainPrepare=!0;let m=n.tileID.canonical.x-w.tileID.canonical.x;const v=n.tileID.canonical.y-w.tileID.canonical.y,S=Math.pow(2,w.tileID.canonical.z),M=n.tileID.key;m===0&&v===0||Math.abs(v)>1||(Math.abs(m)>1&&(Math.abs(m+S)===1?m+=S:Math.abs(m-S)===1&&(m-=S)),n.dem&&w.dem&&(w.dem.backfillBorder(n.dem,m,v),!((u=w.neighboringTiles)===null||u===void 0)&&u[M]&&(w.neighboringTiles[M].backfilled=!0)))}class fs{constructor(){this._tiles={}}handleWrapJump(n){const u={};for(const m in this._tiles){const v=this._tiles[m];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+n),u[v.tileID.key]=v}this._tiles=u}setFeatureState(n,u){for(const m in this._tiles)this._tiles[m].setFeatureState(n,u)}getAllTiles(){return Object.values(this._tiles)}getAllIds(n=!1){return n?Object.values(this._tiles).map(u=>u.tileID).sort(o.aw).map(u=>u.key):Object.keys(this._tiles)}getTileById(n){return this._tiles[n]}setTile(n,u){this._tiles[n]=u}deleteTileById(n){delete this._tiles[n]}getLoadedTile(n){const u=this.getTileById(n.key);return u?.hasData()?u:null}isIdRenderable(n,u=!1){var m;return(m=this.getTileById(n))===null||m===void 0?void 0:m.isRenderable(u)}getRenderableIds(n=0,u){const m=[];for(const v of this.getAllIds())this.isIdRenderable(v,u)&&m.push(this.getTileById(v));return u?m.sort((v,S)=>{const M=v.tileID,k=S.tileID,O=new o.P(M.canonical.x,M.canonical.y)._rotate(-n),B=new o.P(k.canonical.x,k.canonical.y)._rotate(-n);return M.overscaledZ-k.overscaledZ||B.y-O.y||B.x-O.x}).map(v=>v.tileID.key):m.map(v=>v.tileID).sort(o.aw).map(v=>v.key)}}class Ki extends o.E{constructor(n,u,m){super(),this.id=n,this.dispatcher=m,this.on("data",v=>this._dataHandler(v)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((v,S,M,k)=>{const O=new(ue(S.type))(v,S,M,k);if(O.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${O.id}`);return O})(n,u,m,this),this._inViewTiles=new fs,this._outOfViewCache=new o.ax(0,v=>this._unloadTile(v)),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new yt,this._didEmitContent=!1,this._updated=!1}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._maxTileCacheZoomLevels=n?n._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){for(const u of this._inViewTiles.getAllTiles())u.unloadVectorData();this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n),this._inViewTiles=new fs}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const n of this._inViewTiles.getAllTiles())if(n.state!=="loaded"&&n.state!=="errored")return!1;return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,u,m){return o._(this,void 0,void 0,function*(){try{yield this._source.loadTile(n),this._tileLoaded(n,u,m)}catch(v){n.state="errored",v.status!==404?this._source.fire(new o.k(v,{tile:n})):this.update(this.transform,this.terrain)}})}_unloadTile(n){this._source.unloadTile&&this._source.unloadTile(n)}_abortTile(n){this._source.abortTile&&this._source.abortTile(n),this._source.fire(new o.l("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._inViewTiles,this.map?this.map.painter:null);for(const u of this._inViewTiles.getAllTiles())u.upload(n),u.prepare(this.map.style.imageManager)}getIds(){return this._inViewTiles.getAllIds(!0)}getRenderableIds(n){var u;return this._inViewTiles.getRenderableIds((u=this.transform)===null||u===void 0?void 0:u.bearingInRadians,n)}hasRenderableParent(n){const u=n.overscaledZ-1;if(u>=this._source.minzoom){const m=this.getLoadedTile(n.scaledTo(u));if(m)return this._inViewTiles.isIdRenderable(m.tileID.key)}return!1}reload(n,u=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._outOfViewCache.reset();for(const m of this._inViewTiles.getAllIds()){const v=this._inViewTiles.getTileById(m);u&&!this._source.shouldReloadTile(v,u)||(n?this._reloadTile(m,"expired"):v.state!=="errored"&&this._reloadTile(m,"reloading"))}}}_reloadTile(n,u){return o._(this,void 0,void 0,function*(){const m=this._inViewTiles.getTileById(n);m&&(m.state!=="loading"&&(m.state=u),yield this._loadTile(m,n,u))})}_tileLoaded(n,u,m){n.timeAdded=$(),n.selfFading&&(n.fadeEndTime=n.timeAdded+this._rasterFadeDuration),m==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(u,n),this.getSource().type==="raster-dem"&&n.dem&&function(v,S){var M,k;const O=S.getRenderableIds();for(const B of O){if(!v.neighboringTiles||!v.neighboringTiles[B])continue;const q=S.getTileById(B);v.neighboringTiles[B].backfilled||zn(v,q),!((k=(M=q.neighboringTiles)===null||M===void 0?void 0:M[v.tileID.key])===null||k===void 0)&&k.backfilled||zn(q,v)}}(n,this._inViewTiles),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new o.l("data",{dataType:"source",tile:n,coord:n.tileID}))}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._inViewTiles.getTileById(n)}_retainLoadedChildren(n,u){const m=this._getLoadedDescendents(u),v=new Set;for(const S of u){const M=m[S.key];if(!M?.length){v.add(S);continue}const k=S.overscaledZ+Ki.maxOverzooming,O=M.filter(Y=>Y.tileID.overscaledZ<=k);if(!O.length){v.add(S);continue}const B=Math.min(...O.map(Y=>Y.tileID.overscaledZ)),q=O.filter(Y=>Y.tileID.overscaledZ===B).map(Y=>Y.tileID);for(const Y of q)n[Y.key]=Y;this._areDescendentsComplete(q,B,S.overscaledZ)||v.add(S)}return v}_getLoadedDescendents(n){var u;const m={};for(const v of this._inViewTiles.getAllTiles().filter(S=>S.hasData()))for(const S of n)v.tileID.isChildOf(S)&&(m[u=S.key]||(m[u]=[])).push(v);return m}_areDescendentsComplete(n,u,m){return n.length===1&&n[0].isOverscaled()?n[0].overscaledZ===u:Math.pow(4,u-m)===n.length}getLoadedTile(n){return this._inViewTiles.getLoadedTile(n)}updateCacheSize(n){const u=Math.ceil(n.width/this._source.tileSize)+1,m=Math.ceil(n.height/this._source.tileSize)+1,v=Math.floor(u*m*(this._maxTileCacheZoomLevels===null?o.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._outOfViewCache.setMaxSize(S)}handleWrapJump(n){const u=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);this._prevLng=n,u&&(this._inViewTiles.handleWrapJump(u),this._resetTileReloadTimers())}update(n,u){if(!this._sourceLoaded||this._paused)return;let m;this.transform=n,this.terrain=u,this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?m=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(O=>new o.a2(O.canonical.z,O.wrap,O.canonical.z,O.canonical.x,O.canonical.y)):(m=zr(n,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.type==="vector"&&this.map._zoomLevelsToOverscale!==void 0?n.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(m=m.filter(O=>this._source.hasTile(O)))):m=[],this.usedForTerrain&&(m=this._addTerrainIdealTiles(m));const v=m.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,v&&this.fire(new o.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const S=Xr(n,this._source),M=this._updateRetainedTiles(m,S),k=Kr(this._source.type);k&&this._rasterFadeDuration>0&&!u&&function(O,B,q,Y,X,te,ce){const ge=$(),_e=o.av(B);for(const ve of B){const Se=O.getTileById(ve.key);Se.fadingDirection!==Je.Departing&&Se.fadeOpacity!==0||Se.resetFadeLogic(),Vi(O,Se,q,ge,Y,X,ce)||Ui(O,Se,q,ge,te,ce)||vn(Se,_e,ge,ce)||Se.resetFadeLogic()}}(this._inViewTiles,m,M,this._maxFadingAncestorLevels,this._source.minzoom,this._source.maxzoom,this._rasterFadeDuration),k?this._cleanUpRasterTiles(M):this._cleanUpVectorTiles(M)}_cleanUpRasterTiles(n){for(const u of this._inViewTiles.getAllIds())n[u]||this._removeTile(u)}_cleanUpVectorTiles(n){for(const u of this._inViewTiles.getAllIds()){const m=this._inViewTiles.getTileById(u);n[u]?m.clearSymbolFadeHold():m.hasSymbolBuckets?m.holdingForSymbolFade()?m.symbolFadeFinished()&&this._removeTile(u):m.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(u)}}_addTerrainIdealTiles(n){const u=[];for(const m of n)if(m.canonical.z>this._source.minzoom){const v=m.scaledTo(m.canonical.z-1);u.push(v);const S=m.scaledTo(Math.max(this._source.minzoom,Math.min(m.canonical.z,5)));u.push(S)}return n.concat(u)}releaseSymbolFadeTiles(){for(const n of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(n).holdingForSymbolFade()&&this._removeTile(n)}_updateRetainedTiles(n,u){var m;const v=new Set;for(const B of n)this._addTile(B).hasData()||v.add(B);const S=n.reduce((B,q)=>(B[q.key]=q,B),{}),M=this._retainLoadedChildren(S,v),k={},O=Math.max(u-Ki.maxUnderzooming,this._source.minzoom);for(const B of M){let q=this._inViewTiles.getTileById(B.key),Y=q?.wasRequested();for(let X=B.overscaledZ-1;X>=O;--X){const te=B.scaledTo(X);if(k[te.key])break;if(k[te.key]=!0,q=this.getTile(te),!q&&Y&&(q=this._addTile(te)),q){const ce=q.hasData();if((ce||!(!((m=this.map)===null||m===void 0)&&m.cancelPendingTileRequestsWhileZooming)||Y)&&(S[te.key]=te),Y=q.wasRequested(),ce)break}}}return S}_addTile(n){let u=this._inViewTiles.getTileById(n.key);if(u)return u;u=this._outOfViewCache.getAndRemove(n),u&&(u.resetFadeLogic(),this._setTileReloadTimer(n.key,u),u.tileID=n,this._state.initializeTileState(u,this.map?this.map.painter:null));const m=u;return u||(u=new Ct(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(u,n.key,u.state)),u.uses++,this._inViewTiles.setTile(n.key,u),m||this._source.fire(new o.l("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(n,u){this._clearTileReloadTimer(n);const m=u.getExpiryTimeout();m&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},m))}_clearTileReloadTimer(n){const u=this._timers[n];u&&(clearTimeout(u),delete this._timers[n])}_resetTileReloadTimers(){for(const n in this._timers)clearTimeout(this._timers[n]),delete this._timers[n];for(const n of this._inViewTiles.getAllIds()){const u=this._inViewTiles.getTileById(n);this._setTileReloadTimer(n,u)}}refreshTiles(n){for(const u of this._inViewTiles.getAllIds()){const m=this._inViewTiles.getTileById(u);(this._inViewTiles.isIdRenderable(u)||m.state=="errored")&&n.some(v=>v.equals(m.tileID.canonical))&&this._reloadTile(u,"expired")}}_removeTile(n){const u=this._inViewTiles.getTileById(n);u&&(u.uses--,this._inViewTiles.deleteTileById(n),this._clearTileReloadTimer(n),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._outOfViewCache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}_dataHandler(n){n.dataType==="source"&&(n.sourceDataType!=="metadata"?n.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(n.sourceDataChanged,n.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n of this._inViewTiles.getAllIds())this._removeTile(n);this._outOfViewCache.reset()}tilesIn(n,u,m){const v=[],S=this.transform;if(!S)return v;const M=S.getCoveringTilesDetailsProvider().allowWorldCopies(),k=m?S.getCameraQueryGeometry(n):n,O=te=>S.screenPointToMercatorCoordinate(te,this.terrain),B=this.transformBbox(n,O,!M),q=this.transformBbox(k,O,!M),Y=this.getIds(),X=o.aa.fromPoints(q);for(let te=0;te<Y.length;te++){const ce=this._inViewTiles.getTileById(Y[te]);if(ce.holdingForSymbolFade())continue;const ge=M?[ce.tileID]:[ce.tileID.unwrapTo(-1),ce.tileID.unwrapTo(0)],_e=Math.pow(2,S.zoom-ce.tileID.overscaledZ),ve=u*ce.queryPadding*o.a5/ce.tileSize/_e;for(const Se of ge){const Oe=X.map(Ce=>Se.getTilePoint(new o.a9(Ce.x,Ce.y)));if(Oe.expandBy(ve),Oe.intersects(Vr)){const Ce=B.map(Be=>Se.getTilePoint(Be)),De=q.map(Be=>Se.getTilePoint(Be));v.push({tile:ce,tileID:M?Se:Se.unwrapTo(0),queryGeometry:Ce,cameraQueryGeometry:De,scale:_e})}}}return v}transformBbox(n,u,m){let v=n.map(u);if(m){const S=o.aa.fromPoints(n);S.shrinkBy(.001*Math.min(S.width(),S.height()));const M=S.map(u);o.aa.fromPoints(v).covers(M)||(v=v.map(k=>k.x>.5?new o.a9(k.x-1,k.y,k.z):k))}return v}getVisibleCoordinates(n){const u=this.getRenderableIds(n).map(m=>this._inViewTiles.getTileById(m).tileID);return this.transform&&this.transform.populateCache(u),u}hasTransition(){return!!this._source.hasTransition()||!(!Kr(this._source.type)||!function(n,u){if(u<=0)return!1;const m=$();for(const v of n.getAllTiles())if(v.fadeEndTime>=m)return!0;return!1}(this._inViewTiles,this._rasterFadeDuration))}setRasterFadeDuration(n){this._rasterFadeDuration=n}setFeatureState(n,u,m){this._state.updateState(n=n||o.ai,u,m)}removeFeatureState(n,u,m){this._state.removeFeatureState(n=n||o.ai,u,m)}getFeatureState(n,u){return this._state.getState(n=n||o.ai,u)}setDependencies(n,u,m){const v=this._inViewTiles.getTileById(n);v&&v.setDependencies(u,m)}reloadTilesForDependencies(n,u){for(const m of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(m).hasDependency(n,u)&&this._reloadTile(m,"reloading");this._outOfViewCache.filter(m=>!m.hasDependency(n,u))}areTilesLoaded(){for(const n of this._inViewTiles.getAllTiles())if(n.state!=="loaded"&&n.state!=="errored")return!1;return!0}}Ki.maxUnderzooming=10,Ki.maxOverzooming=3;class jt{constructor(n,u){this.reset(n,u)}reset(n,u){this.points=n||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=o.an(n,0,1);let u=1,m=this._distances[u];const v=n*this.paddedLength+this.padding;for(;m<v&&u<this._distances.length;)m=this._distances[++u];const S=u-1,M=this._distances[S],k=m-M,O=k>0?(v-M)/k:0;return this.points[S].mult(1-O).add(this.points[u].mult(O))}}function ot(w,n){let u=!0;return w==="always"||w!=="never"&&n!=="never"||(u=!1),u}class rt{constructor(n,u,m){const v=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(n/m),this.yCellCount=Math.ceil(u/m);for(let M=0;M<this.xCellCount*this.yCellCount;M++)v.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=u,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,u,m,v,S){this._forEachCell(u,m,v,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(v),this.bboxes.push(S)}insertCircle(n,u,m,v){this._forEachCell(u-v,m-v,u+v,m+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(u),this.circles.push(m),this.circles.push(v)}_insertBoxCell(n,u,m,v,S,M){this.boxCells[S].push(M)}_insertCircleCell(n,u,m,v,S,M){this.circleCells[S].push(M)}_query(n,u,m,v,S,M,k){if(m<0||n>this.width||v<0||u>this.height)return[];const O=[];if(n<=0&&u<=0&&this.width<=m&&this.height<=v){if(S)return[{key:null,x1:n,y1:u,x2:m,y2:v}];for(let B=0;B<this.boxKeys.length;B++)O.push({key:this.boxKeys[B],x1:this.bboxes[4*B],y1:this.bboxes[4*B+1],x2:this.bboxes[4*B+2],y2:this.bboxes[4*B+3]});for(let B=0;B<this.circleKeys.length;B++){const q=this.circles[3*B],Y=this.circles[3*B+1],X=this.circles[3*B+2];O.push({key:this.circleKeys[B],x1:q-X,y1:Y-X,x2:q+X,y2:Y+X})}}else this._forEachCell(n,u,m,v,this._queryCell,O,{hitTest:S,overlapMode:M,seenUids:{box:{},circle:{}}},k);return O}query(n,u,m,v){return this._query(n,u,m,v,!1,null)}hitTest(n,u,m,v,S,M){return this._query(n,u,m,v,!0,S,M).length>0}hitTestCircle(n,u,m,v,S){const M=n-m,k=n+m,O=u-m,B=u+m;if(k<0||M>this.width||B<0||O>this.height)return!1;const q=[];return this._forEachCell(M,O,k,B,this._queryCellCircle,q,{hitTest:!0,overlapMode:v,circle:{x:n,y:u,radius:m},seenUids:{box:{},circle:{}}},S),q.length>0}_queryCell(n,u,m,v,S,M,k,O){const{seenUids:B,hitTest:q,overlapMode:Y}=k,X=this.boxCells[S];if(X!==null){const ce=this.bboxes;for(const ge of X)if(!B.box[ge]){B.box[ge]=!0;const _e=4*ge,ve=this.boxKeys[ge];if(n<=ce[_e+2]&&u<=ce[_e+3]&&m>=ce[_e+0]&&v>=ce[_e+1]&&(!O||O(ve))&&(!q||!ot(Y,ve.overlapMode))&&(M.push({key:ve,x1:ce[_e],y1:ce[_e+1],x2:ce[_e+2],y2:ce[_e+3]}),q))return!0}}const te=this.circleCells[S];if(te!==null){const ce=this.circles;for(const ge of te)if(!B.circle[ge]){B.circle[ge]=!0;const _e=3*ge,ve=this.circleKeys[ge];if(this._circleAndRectCollide(ce[_e],ce[_e+1],ce[_e+2],n,u,m,v)&&(!O||O(ve))&&(!q||!ot(Y,ve.overlapMode))){const Se=ce[_e],Oe=ce[_e+1],Ce=ce[_e+2];if(M.push({key:ve,x1:Se-Ce,y1:Oe-Ce,x2:Se+Ce,y2:Oe+Ce}),q)return!0}}}return!1}_queryCellCircle(n,u,m,v,S,M,k,O){const{circle:B,seenUids:q,overlapMode:Y}=k,X=this.boxCells[S];if(X!==null){const ce=this.bboxes;for(const ge of X)if(!q.box[ge]){q.box[ge]=!0;const _e=4*ge,ve=this.boxKeys[ge];if(this._circleAndRectCollide(B.x,B.y,B.radius,ce[_e+0],ce[_e+1],ce[_e+2],ce[_e+3])&&(!O||O(ve))&&!ot(Y,ve.overlapMode))return M.push(!0),!0}}const te=this.circleCells[S];if(te!==null){const ce=this.circles;for(const ge of te)if(!q.circle[ge]){q.circle[ge]=!0;const _e=3*ge,ve=this.circleKeys[ge];if(this._circlesCollide(ce[_e],ce[_e+1],ce[_e+2],B.x,B.y,B.radius)&&(!O||O(ve))&&!ot(Y,ve.overlapMode))return M.push(!0),!0}}}_forEachCell(n,u,m,v,S,M,k,O){const B=this._convertToXCellCoord(n),q=this._convertToYCellCoord(u),Y=this._convertToXCellCoord(m),X=this._convertToYCellCoord(v);for(let te=B;te<=Y;te++)for(let ce=q;ce<=X;ce++)if(S.call(this,n,u,m,v,this.xCellCount*ce+te,M,k,O))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,u,m,v,S,M){const k=v-n,O=S-u,B=m+M;return B*B>k*k+O*O}_circleAndRectCollide(n,u,m,v,S,M,k){const O=(M-v)/2,B=Math.abs(n-(v+O));if(B>O+m)return!1;const q=(k-S)/2,Y=Math.abs(u-(S+q));if(Y>q+m)return!1;if(B<=O||Y<=q)return!0;const X=B-O,te=Y-q;return X*X+te*te<=m*m}}function Zt(w,n,u){const m=o.N();if(!w){const{vecSouth:Y,vecEast:X}=Nr(n),te=P();te[0]=X[0],te[1]=X[1],te[2]=Y[0],te[3]=Y[1],v=te,(q=(M=(S=te)[0])*(B=S[3])-(O=S[2])*(k=S[1]))&&(v[0]=B*(q=1/q),v[1]=-k*q,v[2]=-O*q,v[3]=M*q),m[0]=te[0],m[1]=te[1],m[4]=te[2],m[5]=te[3]}var v,S,M,k,O,B,q;return o.Q(m,m,[1/u,1/u,1]),m}function Tr(w,n,u,m){if(w){const v=o.N();if(!n){const{vecSouth:S,vecEast:M}=Nr(u);v[0]=M[0],v[1]=M[1],v[4]=S[0],v[5]=S[1]}return o.Q(v,v,[m,m,1]),v}return u.pixelsToClipSpaceMatrix}function Nr(w){const n=Math.cos(w.rollInRadians),u=Math.sin(w.rollInRadians),m=Math.cos(w.pitchInRadians),v=Math.cos(w.bearingInRadians),S=Math.sin(w.bearingInRadians),M=o.aC();M[0]=-v*m*u-S*n,M[1]=-S*m*u+v*n;const k=o.aD(M);k<1e-9?o.aE(M):o.aF(M,M,1/k);const O=o.aC();O[0]=v*m*n-S*u,O[1]=S*m*n+v*u;const B=o.aD(O);return B<1e-9?o.aE(O):o.aF(O,O,1/B),{vecEast:O,vecSouth:M}}function ir(w,n,u,m){let v;m?(v=[w,n,m(w,n),1],o.aH(v,v,u)):(v=[w,n,0,1],os(v,v,u));const S=v[3];return{point:new o.P(v[0]/S,v[1]/S),signedDistanceFromCamera:S,isOccluded:!1}}function An(w,n){return .5+w/n*.5}function Gi(w,n){return w.x>=-n[0]&&w.x<=n[0]&&w.y>=-n[1]&&w.y<=n[1]}function Ra(w,n,u,m,v,S,M,k,O,B,q,Y,X){const te=u?w.textSizeData:w.iconSizeData,ce=o.ay(te,n.transform.zoom),ge=[256/n.width*2+1,256/n.height*2+1],_e=u?w.text.dynamicLayoutVertexArray:w.icon.dynamicLayoutVertexArray;_e.clear();const ve=w.lineVertexArray,Se=u?w.text.placedSymbolArray:w.icon.placedSymbolArray,Oe=n.transform.width/n.transform.height;let Ce=!1;for(let De=0;De<Se.length;De++){const Be=Se.get(De);if(Be.hidden||Be.writingMode===o.az.vertical&&!Ce){Rs(Be.numGlyphs,_e);continue}Ce=!1;const Ae=new o.P(Be.anchorX,Be.anchorY),Ue={getElevation:X,pitchedLabelPlaneMatrix:m,lineVertexArray:ve,pitchWithMap:S,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:n.transform,tileAnchorPoint:Ae,unwrappedTileID:O,width:B,height:q,translation:Y},ut=Mr(Be.anchorX,Be.anchorY,Ue);if(!Gi(ut.point,ge)){Rs(Be.numGlyphs,_e);continue}const it=An(n.transform.cameraToCenterDistance,ut.signedDistanceFromCamera),st=o.aA(te,ce,Be),at=S?st*n.transform.getPitchedTextCorrection(Be.anchorX,Be.anchorY,O)/it:st*it,Rt=ml({projectionContext:Ue,pitchedLabelPlaneMatrixInverse:v,symbol:Be,fontSize:at,flip:!1,keepUpright:M,glyphOffsetArray:w.glyphOffsetArray,dynamicLayoutVertexArray:_e,aspectRatio:Oe,rotateToLine:k});Ce=Rt.useVertical,(Rt.notEnoughRoom||Ce||Rt.needsFlipping&&ml({projectionContext:Ue,pitchedLabelPlaneMatrixInverse:v,symbol:Be,fontSize:at,flip:!0,keepUpright:M,glyphOffsetArray:w.glyphOffsetArray,dynamicLayoutVertexArray:_e,aspectRatio:Oe,rotateToLine:k}).notEnoughRoom)&&Rs(Be.numGlyphs,_e)}u?w.text.dynamicLayoutVertexBuffer.updateData(_e):w.icon.dynamicLayoutVertexBuffer.updateData(_e)}function pl(w,n,u,m,v,S,M,k){const O=S.glyphStartIndex+S.numGlyphs,B=S.lineStartIndex,q=S.lineStartIndex+S.lineLength,Y=n.getoffsetX(S.glyphStartIndex),X=n.getoffsetX(O-1),te=fi(w*Y,u,m,v,S.segment,B,q,k,M);if(!te)return null;const ce=fi(w*X,u,m,v,S.segment,B,q,k,M);return ce?k.projectionCache.anyProjectionOccluded?null:{first:te,last:ce}:null}function Gn(w,n,u,m){return w===o.az.horizontal&&Math.abs(u.y-n.y)>Math.abs(u.x-n.x)*m?{useVertical:!0}:(w===o.az.vertical?n.y<u.y:n.x>u.x)?{needsFlipping:!0}:null}function ml(w){const{projectionContext:n,pitchedLabelPlaneMatrixInverse:u,symbol:m,fontSize:v,flip:S,keepUpright:M,glyphOffsetArray:k,dynamicLayoutVertexArray:O,aspectRatio:B,rotateToLine:q}=w,Y=v/24,X=m.lineOffsetX*Y,te=m.lineOffsetY*Y;let ce;if(m.numGlyphs>1){const ge=m.glyphStartIndex+m.numGlyphs,_e=m.lineStartIndex,ve=m.lineStartIndex+m.lineLength,Se=pl(Y,k,X,te,S,m,q,n);if(!Se)return{notEnoughRoom:!0};const Oe=nc(Se.first.point.x,Se.first.point.y,n,u),Ce=nc(Se.last.point.x,Se.last.point.y,n,u);if(M&&!S){const De=Gn(m.writingMode,Oe,Ce,B);if(De)return De}ce=[Se.first];for(let De=m.glyphStartIndex+1;De<ge-1;De++){const Be=fi(Y*k.getoffsetX(De),X,te,S,m.segment,_e,ve,n,q);if(!Be)return{notEnoughRoom:!0};ce.push(Be)}ce.push(Se.last)}else{if(M&&!S){const _e=nn(n.tileAnchorPoint.x,n.tileAnchorPoint.y,n).point,ve=m.lineStartIndex+m.segment+1,Se=new o.P(n.lineVertexArray.getx(ve),n.lineVertexArray.gety(ve)),Oe=nn(Se.x,Se.y,n),Ce=Oe.signedDistanceFromCamera>0?Oe.point:Qs(n.tileAnchorPoint,Se,_e,1,n),De=nc(_e.x,_e.y,n,u),Be=nc(Ce.x,Ce.y,n,u),Ae=Gn(m.writingMode,De,Be,B);if(Ae)return Ae}const ge=fi(Y*k.getoffsetX(m.glyphStartIndex),X,te,S,m.segment,m.lineStartIndex,m.lineStartIndex+m.lineLength,n,q);if(!ge||n.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};ce=[ge]}for(const ge of ce)o.aG(O,ge.point,ge.angle);return{}}function Qs(w,n,u,m,v){const S=w.add(w.sub(n)._unit()),M=nn(S.x,S.y,v).point,k=u.sub(M);return u.add(k._mult(m/k.mag()))}function Yi(w,n,u){const m=n.projectionCache;if(m.projections[w])return m.projections[w];const v=new o.P(n.lineVertexArray.getx(w),n.lineVertexArray.gety(w)),S=nn(v.x,v.y,n);if(S.signedDistanceFromCamera>0)return m.projections[w]=S.point,m.anyProjectionOccluded=m.anyProjectionOccluded||S.isOccluded,S.point;const M=w-u.direction;return Qs(u.distanceFromAnchor===0?n.tileAnchorPoint:new o.P(n.lineVertexArray.getx(M),n.lineVertexArray.gety(M)),v,u.previousVertex,u.absOffsetX-u.distanceFromAnchor+1,n)}function nn(w,n,u){const m=w+u.translation[0],v=n+u.translation[1];let S;return u.pitchWithMap?(S=ir(m,v,u.pitchedLabelPlaneMatrix,u.getElevation),S.isOccluded=!1):(S=u.transform.projectTileCoordinates(m,v,u.unwrappedTileID,u.getElevation),S.point.x=(.5*S.point.x+.5)*u.width,S.point.y=(.5*-S.point.y+.5)*u.height),S}function nc(w,n,u,m){if(u.pitchWithMap){const v=[w,n,0,1];return o.aH(v,v,m),u.transform.projectTileCoordinates(v[0]/v[3],v[1]/v[3],u.unwrappedTileID,u.getElevation).point}return{x:w/u.width*2-1,y:1-n/u.height*2}}function Mr(w,n,u){return u.transform.projectTileCoordinates(w,n,u.unwrappedTileID,u.getElevation)}function Ei(w,n,u){return w._unit()._perp()._mult(n*u)}function on(w,n,u,m,v,S,M,k,O){if(k.projectionCache.offsets[w])return k.projectionCache.offsets[w];const B=u.add(n);if(w+O.direction<m||w+O.direction>=v)return k.projectionCache.offsets[w]=B,B;const q=Yi(w+O.direction,k,O),Y=Ei(q.sub(u),M,O.direction),X=u.add(Y),te=q.add(Y);return k.projectionCache.offsets[w]=o.aI(S,B,X,te)||B,k.projectionCache.offsets[w]}function fi(w,n,u,m,v,S,M,k,O){const B=m?w-n:w+n;let q=B>0?1:-1,Y=0;m&&(q*=-1,Y=Math.PI),q<0&&(Y+=Math.PI);let X,te=q>0?S+v:S+v+1;k.projectionCache.cachedAnchorPoint?X=k.projectionCache.cachedAnchorPoint:(X=nn(k.tileAnchorPoint.x,k.tileAnchorPoint.y,k).point,k.projectionCache.cachedAnchorPoint=X);let ce,ge,_e=X,ve=X,Se=0,Oe=0;const Ce=Math.abs(B),De=[];let Be;for(;Se+Oe<=Ce;){if(te+=q,te<S||te>=M)return null;Se+=Oe,ve=_e,ge=ce;const ut={absOffsetX:Ce,direction:q,distanceFromAnchor:Se,previousVertex:ve};if(_e=Yi(te,k,ut),u===0)De.push(ve),Be=_e.sub(ve);else{let it;const st=_e.sub(ve);it=st.mag()===0?Ei(Yi(te+q,k,ut).sub(_e),u,q):Ei(st,u,q),ge||(ge=ve.add(it)),ce=on(te,it,_e,S,M,ge,u,k,ut),De.push(ge),Be=ce.sub(ge)}Oe=Be.mag()}const Ae=Be._mult((Ce-Se)/Oe)._add(ge||ve),Ue=Y+Math.atan2(_e.y-ve.y,_e.x-ve.x);return De.push(Ae),{point:Ae,angle:O?Ue:0,path:De}}const Ii=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Rs(w,n){for(let u=0;u<w;u++){const m=n.length;n.resize(m+4),n.float32.set(Ii,3*m)}}function os(w,n,u){const m=n[0],v=n[1];return w[0]=u[0]*m+u[4]*v+u[12],w[1]=u[1]*m+u[5]*v+u[13],w[3]=u[3]*m+u[7]*v+u[15],w}const gn=100;class lh{constructor(n,u=new rt(n.width+200,n.height+200,25),m=new rt(n.width+200,n.height+200,25)){this.transform=n,this.grid=u,this.ignoredGrid=m,this.pitchFactor=Math.cos(n.pitch*Math.PI/180)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+gn,this.screenBottomBoundary=n.height+gn,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,u,m,v,S,M,k,O,B,q,Y,X){const te=this.projectAndGetPerspectiveRatio(n.anchorPointX+O[0],n.anchorPointY+O[1],S,q,X),ce=m*te.perspectiveRatio;let ge;if(M||k)ge=this._projectCollisionBox(n,ce,v,S,M,k,O,te,q,Y,X);else{const Be=te.x+(Y?Y.x*ce:0),Ae=te.y+(Y?Y.y*ce:0);ge={allPointsOccluded:!1,box:[Be+n.x1*ce,Ae+n.y1*ce,Be+n.x2*ce,Ae+n.y2*ce]}}const[_e,ve,Se,Oe]=ge.box,Ce=M?ge.allPointsOccluded:te.isOccluded;let De=Ce;return De||(De=te.perspectiveRatio<this.perspectiveRatioCutoff),De||(De=!this.isInsideGrid(_e,ve,Se,Oe)),De||u!=="always"&&this.grid.hitTest(_e,ve,Se,Oe,u,B)?{box:[_e,ve,Se,Oe],placeable:!1,offscreen:!1,occluded:Ce}:{box:[_e,ve,Se,Oe],placeable:!0,offscreen:this.isOffscreen(_e,ve,Se,Oe),occluded:Ce}}placeCollisionCircles(n,u,m,v,S,M,k,O,B,q,Y,X,te,ce){const ge=[],_e=new o.P(u.anchorX,u.anchorY),ve=this.getPerspectiveRatio(_e.x,_e.y,M,ce),Se=(B?S*this.transform.getPitchedTextCorrection(u.anchorX,u.anchorY,M)/ve:S*ve)/o.aM,Oe={getElevation:ce,pitchedLabelPlaneMatrix:k,lineVertexArray:m,pitchWithMap:B,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:_e,unwrappedTileID:M,width:this.transform.width,height:this.transform.height,translation:te},Ce=pl(Se,v,u.lineOffsetX*Se,u.lineOffsetY*Se,!1,u,!1,Oe);let De=!1,Be=!1,Ae=!0;if(Ce){const Ue=.5*Y*ve+X,ut=new o.P(-100,-100),it=new o.P(this.screenRightBoundary,this.screenBottomBoundary),st=new jt,at=Ce.first,Rt=Ce.last;let Dt=[];for(let kr=at.path.length-1;kr>=1;kr--)Dt.push(at.path[kr]);for(let kr=1;kr<Rt.path.length;kr++)Dt.push(Rt.path[kr]);const Tt=2.5*Ue;if(B){const kr=this.projectPathToScreenSpace(Dt,Oe);Dt=kr.some(xn=>xn.signedDistanceFromCamera<=0)?[]:kr.map(xn=>xn.point)}let Nt=[];if(Dt.length>0){const kr=Dt[0].clone(),xn=Dt[0].clone();for(let Zn=1;Zn<Dt.length;Zn++)kr.x=Math.min(kr.x,Dt[Zn].x),kr.y=Math.min(kr.y,Dt[Zn].y),xn.x=Math.max(xn.x,Dt[Zn].x),xn.y=Math.max(xn.y,Dt[Zn].y);Nt=kr.x>=ut.x&&xn.x<=it.x&&kr.y>=ut.y&&xn.y<=it.y?[Dt]:xn.x<ut.x||kr.x>it.x||xn.y<ut.y||kr.y>it.y?[]:o.aJ([Dt],ut.x,ut.y,it.x,it.y)}for(const kr of Nt){st.reset(kr,.25*Ue);let xn=0;xn=st.length<=.5*Ue?1:Math.ceil(st.paddedLength/Tt)+1;for(let Zn=0;Zn<xn;Zn++){const Pn=Zn/Math.max(xn-1,1),Xn=st.lerp(Pn),En=Xn.x+gn,Kn=Xn.y+gn;ge.push(En,Kn,Ue,0);const ii=En-Ue,no=Kn-Ue,ki=En+Ue,yn=Kn+Ue;if(Ae=Ae&&this.isOffscreen(ii,no,ki,yn),Be=Be||this.isInsideGrid(ii,no,ki,yn),n!=="always"&&this.grid.hitTestCircle(En,Kn,Ue,n,q)&&(De=!0,!O))return{circles:[],offscreen:!1,collisionDetected:De}}}}return{circles:!O&&De||!Be||ve<this.perspectiveRatioCutoff?[]:ge,offscreen:Ae,collisionDetected:De}}projectPathToScreenSpace(n,u){const m=function(v,S){const M=o.N();return o.aB(M,S.pitchedLabelPlaneMatrix),v.map(k=>{const O=ir(k.x,k.y,M,S.getElevation),B=S.transform.projectTileCoordinates(O.point.x,O.point.y,S.unwrappedTileID,S.getElevation);return B.point.x=(.5*B.point.x+.5)*S.width,B.point.y=(.5*-B.point.y+.5)*S.height,B})}(n,u);return function(v){let S=0,M=0,k=0,O=0;for(let B=0;B<v.length;B++)v[B].isOccluded?(k=B+1,O=0):(O++,O>M&&(M=O,S=k));return v.slice(S,S+M)}(m)}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[],m=new o.aa;for(const Y of n){const X=new o.P(Y.x+gn,Y.y+gn);m.extend(X),u.push(X)}const{minX:v,minY:S,maxX:M,maxY:k}=m,O=this.grid.query(v,S,M,k).concat(this.ignoredGrid.query(v,S,M,k)),B={},q={};for(const Y of O){const X=Y.key;if(B[X.bucketInstanceId]===void 0&&(B[X.bucketInstanceId]={}),B[X.bucketInstanceId][X.featureIndex])continue;const te=[new o.P(Y.x1,Y.y1),new o.P(Y.x2,Y.y1),new o.P(Y.x2,Y.y2),new o.P(Y.x1,Y.y2)];o.aK(u,te)&&(B[X.bucketInstanceId][X.featureIndex]=!0,q[X.bucketInstanceId]===void 0&&(q[X.bucketInstanceId]=[]),q[X.bucketInstanceId].push(X.featureIndex))}return q}insertCollisionBox(n,u,m,v,S,M){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:S,collisionGroupID:M,overlapMode:u},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,u,m,v,S,M){const k=m?this.ignoredGrid:this.grid,O={bucketInstanceId:v,featureIndex:S,collisionGroupID:M,overlapMode:u};for(let B=0;B<n.length;B+=4)k.insertCircle(O,n[B],n[B+1],n[B+2])}projectAndGetPerspectiveRatio(n,u,m,v,S){if(S){let M;v?(M=[n,u,v(n,u),1],o.aH(M,M,S)):(M=[n,u,0,1],os(M,M,S));const k=M[3];return{x:(M[0]/k+1)/2*this.transform.width+gn,y:(-M[1]/k+1)/2*this.transform.height+gn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/k*.5,isOccluded:!1,signedDistanceFromCamera:k}}{const M=this.transform.projectTileCoordinates(n,u,m,v);return{x:(M.point.x+1)/2*this.transform.width+gn,y:(1-M.point.y)/2*this.transform.height+gn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/M.signedDistanceFromCamera*.5,isOccluded:M.isOccluded,signedDistanceFromCamera:M.signedDistanceFromCamera}}}getPerspectiveRatio(n,u,m,v){const S=this.transform.projectTileCoordinates(n,u,m,v);return .5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5}isOffscreen(n,u,m,v){return m<gn||n>=this.screenRightBoundary||v<gn||u>this.screenBottomBoundary}isInsideGrid(n,u,m,v){return m>=0&&n<this.gridRightBoundary&&v>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const n=o.ar([]);return o.O(n,n,[-100,-100,0]),n}_projectCollisionBox(n,u,m,v,S,M,k,O,B,q,Y){let X=1,te=0,ce=0,ge=1;const _e=n.anchorPointX+k[0],ve=n.anchorPointY+k[1];if(M&&!S){const Dt=this.projectAndGetPerspectiveRatio(_e+1,ve,v,B,Y),Tt=Dt.x-O.x,Nt=Math.atan((Dt.y-O.y)/Tt)+(Tt<0?Math.PI:0),kr=Math.sin(Nt),xn=Math.cos(Nt);X=xn,te=kr,ce=-kr,ge=xn}else if(!M&&S){const Dt=Nr(this.transform);X=Dt.vecEast[0],te=Dt.vecEast[1],ce=Dt.vecSouth[0],ge=Dt.vecSouth[1]}let Se=O.x,Oe=O.y,Ce=u;S&&(Se=_e,Oe=ve,Ce=Math.pow(2,-(this.transform.zoom-m.overscaledZ)),Ce*=this.transform.getPitchedTextCorrection(_e,ve,v),q||(Ce*=o.an(.5+O.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),q&&(Se+=X*q.x*Ce+ce*q.y*Ce,Oe+=te*q.x*Ce+ge*q.y*Ce);const De=n.x1*Ce,Be=n.x2*Ce,Ae=(De+Be)/2,Ue=n.y1*Ce,ut=n.y2*Ce,it=(Ue+ut)/2,st=[{offsetX:De,offsetY:Ue},{offsetX:Ae,offsetY:Ue},{offsetX:Be,offsetY:Ue},{offsetX:Be,offsetY:it},{offsetX:Be,offsetY:ut},{offsetX:Ae,offsetY:ut},{offsetX:De,offsetY:ut},{offsetX:De,offsetY:it}];let at=[];for(const{offsetX:Dt,offsetY:Tt}of st)at.push(new o.P(Se+X*Dt+ce*Tt,Oe+te*Dt+ge*Tt));let Rt=!1;if(S){const Dt=at.map(Tt=>this.projectAndGetPerspectiveRatio(Tt.x,Tt.y,v,B,Y));Rt=Dt.some(Tt=>!Tt.isOccluded),at=Dt.map(Tt=>new o.P(Tt.x,Tt.y))}else Rt=!0;return{box:o.aL(at),allPointsOccluded:!Rt}}}class ch{constructor(n,u,m,v){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?u:-u))):v&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class Da{constructor(n,u,m,v,S){this.text=new ch(n?n.text:null,u,m,S),this.icon=new ch(n?n.icon:null,u,v,S)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class uh{constructor(n,u,m){this.text=n,this.icon=u,this.skipFade=m}}class hm{constructor(n,u,m,v,S){this.bucketInstanceId=n,this.featureIndex=u,this.sourceLayerIndex=m,this.bucketIndex=v,this.tileID=S}}class dm{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const u=++this.maxGroupID;this.collisionGroups[n]={ID:u,predicate:m=>m.collisionGroupID===u}}return this.collisionGroups[n]}}function lu(w,n,u,m,v){const{horizontalAlign:S,verticalAlign:M}=o.aS(w);return new o.P(-(S-.5)*n+m[0]*v,-(M-.5)*u+m[1]*v)}class hd{constructor(n,u,m,v,S){this.transform=n.clone(),this.terrain=u,this.collisionIndex=new lh(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new dm(v),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(n){const u=this.terrain;return u?(m,v)=>u.getElevation(n,m,v):null}getBucketParts(n,u,m,v){const S=m.getBucket(u),M=m.latestFeatureIndex;if(!S||!M||u.id!==S.layerIds[0])return;const k=m.collisionBoxArray,O=S.layers[0].layout,B=S.layers[0].paint,q=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),Y=m.tileSize/o.a5,X=m.tileID.toUnwrapped(),te=O.get("text-rotation-alignment")==="map",ce=o.aN(m,1,this.transform.zoom),ge=o.aO(this.collisionIndex.transform,m,B.get("text-translate"),B.get("text-translate-anchor")),_e=o.aO(this.collisionIndex.transform,m,B.get("icon-translate"),B.get("icon-translate-anchor")),ve=Zt(te,this.transform,ce);this.retainedQueryData[S.bucketInstanceId]=new hm(S.bucketInstanceId,M,S.sourceLayerIndex,S.index,m.tileID);const Se={bucket:S,layout:O,translationText:ge,translationIcon:_e,unwrappedTileID:X,pitchedLabelPlaneMatrix:ve,scale:q,textPixelRatio:Y,holdingForFade:m.holdingForSymbolFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:o.ay(S.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID)};if(v)for(const Oe of S.sortKeyRanges){const{sortKey:Ce,symbolInstanceStart:De,symbolInstanceEnd:Be}=Oe;n.push({sortKey:Ce,symbolInstanceStart:De,symbolInstanceEnd:Be,parameters:Se})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:Se})}attemptAnchorPlacement(n,u,m,v,S,M,k,O,B,q,Y,X,te,ce,ge,_e,ve,Se,Oe,Ce){const De=o.aP[n.textAnchor],Be=[n.textOffset0,n.textOffset1],Ae=lu(De,m,v,Be,S),Ue=this.collisionIndex.placeCollisionBox(u,X,O,B,q,k,M,_e,Y.predicate,Oe,Ae,Ce);if((!Se||this.collisionIndex.placeCollisionBox(Se,X,O,B,q,k,M,ve,Y.predicate,Oe,Ae,Ce).placeable)&&Ue.placeable){let ut;if(this.prevPlacement&&this.prevPlacement.variableOffsets[te.crossTileID]&&this.prevPlacement.placements[te.crossTileID]&&this.prevPlacement.placements[te.crossTileID].text&&(ut=this.prevPlacement.variableOffsets[te.crossTileID].anchor),te.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[te.crossTileID]={textOffset:Be,width:m,height:v,anchor:De,textBoxScale:S,prevAnchor:ut},this.markUsedJustification(ce,De,te,ge),ce.allowVerticalPlacement&&(this.markUsedOrientation(ce,ge,te),this.placedOrientations[te.crossTileID]=ge),{shift:Ae,placedGlyphBoxes:Ue}}}placeLayerBucketPart(n,u,m){const{bucket:v,layout:S,translationText:M,translationIcon:k,unwrappedTileID:O,pitchedLabelPlaneMatrix:B,textPixelRatio:q,holdingForFade:Y,collisionBoxArray:X,partiallyEvaluatedTextSize:te,collisionGroup:ce}=n.parameters,ge=S.get("text-optional"),_e=S.get("icon-optional"),ve=o.aQ(S,"text-overlap","text-allow-overlap"),Se=ve==="always",Oe=o.aQ(S,"icon-overlap","icon-allow-overlap"),Ce=Oe==="always",De=S.get("text-rotation-alignment")==="map",Be=S.get("text-pitch-alignment")==="map",Ae=S.get("icon-text-fit")!=="none",Ue=S.get("symbol-z-order")==="viewport-y",ut=Se&&(Ce||!v.hasIconData()||_e),it=Ce&&(Se||!v.hasTextData()||ge);!v.collisionArrays&&X&&v.deserializeCollisionBoxes(X);const st=this.retainedQueryData[v.bucketInstanceId].tileID,at=this._getTerrainElevationFunc(st),Rt=this.transform.getFastPathSimpleProjectionMatrix(st),Dt=(Tt,Nt,kr)=>{var xn,Zn;if(u[Tt.crossTileID])return;if(Y)return void(this.placements[Tt.crossTileID]=new uh(!1,!1,!1));let Pn=!1,Xn=!1,En=!0,Kn=null,ii={box:null,placeable:!1,offscreen:null,occluded:!1},no={placeable:!1},ki=null,yn=null,Hi=null,Gs=0,ha=0,qs=0;Nt.textFeatureIndex?Gs=Nt.textFeatureIndex:Tt.useRuntimeCollisionCircles&&(Gs=Tt.featureIndex),Nt.verticalTextFeatureIndex&&(ha=Nt.verticalTextFeatureIndex);const Fo=Nt.textBox;if(Fo){const Ko=Rn=>{let In=o.az.horizontal;if(v.allowVerticalPlacement&&!Rn&&this.prevPlacement){const $i=this.prevPlacement.placedOrientations[Tt.crossTileID];$i&&(this.placedOrientations[Tt.crossTileID]=$i,In=$i,this.markUsedOrientation(v,In,Tt))}return In},fa=(Rn,In)=>{if(v.allowVerticalPlacement&&Tt.numVerticalGlyphVertices>0&&Nt.verticalTextBox){for(const $i of v.writingModes)if($i===o.az.vertical?(ii=In(),no=ii):ii=Rn(),ii&&ii.placeable)break}else ii=Rn()},Cs=Tt.textAnchorOffsetStartIndex,Ts=Tt.textAnchorOffsetEndIndex;if(Ts===Cs){const Rn=(In,$i)=>{const Wi=this.collisionIndex.placeCollisionBox(In,ve,q,st,O,Be,De,M,ce.predicate,at,void 0,Rt);return Wi&&Wi.placeable&&(this.markUsedOrientation(v,$i,Tt),this.placedOrientations[Tt.crossTileID]=$i),Wi};fa(()=>Rn(Fo,o.az.horizontal),()=>{const In=Nt.verticalTextBox;return v.allowVerticalPlacement&&Tt.numVerticalGlyphVertices>0&&In?Rn(In,o.az.vertical):{box:null,offscreen:null}}),Ko(ii&&ii.placeable)}else{let Rn=o.aP[(Zn=(xn=this.prevPlacement)===null||xn===void 0?void 0:xn.variableOffsets[Tt.crossTileID])===null||Zn===void 0?void 0:Zn.anchor];const In=(Wi,Bo,Co)=>{const $l=Wi.x2-Wi.x1,Tm=Wi.y2-Wi.y1,lp=Tt.textBoxScale,Wd=Ae&&Oe==="never"?Bo:null;let qa=null,pa=ve==="never"?1:2,Ha="never";Rn&&pa++;for(let Nh=0;Nh<pa;Nh++){for(let Zd=Cs;Zd<Ts;Zd++){const Vh=v.textAnchorOffsets.get(Zd);if(Rn&&Vh.textAnchor!==Rn)continue;const Iu=this.attemptAnchorPlacement(Vh,Wi,$l,Tm,lp,De,Be,q,st,O,ce,Ha,Tt,v,Co,M,k,Wd,at);if(Iu&&(qa=Iu.placedGlyphBoxes,qa&&qa.placeable))return Pn=!0,Kn=Iu.shift,qa}Rn?Rn=null:Ha=ve}return m&&!qa&&(qa={box:this.collisionIndex.placeCollisionBox(Fo,"always",q,st,O,Be,De,M,ce.predicate,at,void 0,Rt).box,offscreen:!1,placeable:!1,occluded:!1}),qa};fa(()=>In(Fo,Nt.iconBox,o.az.horizontal),()=>{const Wi=Nt.verticalTextBox;return v.allowVerticalPlacement&&(!ii||!ii.placeable)&&Tt.numVerticalGlyphVertices>0&&Wi?In(Wi,Nt.verticalIconBox,o.az.vertical):{box:null,occluded:!0,offscreen:null}}),ii&&(Pn=ii.placeable,En=ii.offscreen);const $i=Ko(ii&&ii.placeable);if(!Pn&&this.prevPlacement){const Wi=this.prevPlacement.variableOffsets[Tt.crossTileID];Wi&&(this.variableOffsets[Tt.crossTileID]=Wi,this.markUsedJustification(v,Wi.anchor,Tt,$i))}}}if(ki=ii,Pn=ki&&ki.placeable,En=ki&&ki.offscreen,Tt.useRuntimeCollisionCircles&&Tt.centerJustifiedTextSymbolIndex>=0){const Ko=v.text.placedSymbolArray.get(Tt.centerJustifiedTextSymbolIndex),fa=o.aA(v.textSizeData,te,Ko),Cs=S.get("text-padding");yn=this.collisionIndex.placeCollisionCircles(ve,Ko,v.lineVertexArray,v.glyphOffsetArray,fa,O,B,m,Be,ce.predicate,Tt.collisionCircleDiameter,Cs,M,at),yn.circles.length&&yn.collisionDetected&&!m&&o.w("Collisions detected, but collision boxes are not shown"),Pn=Se||yn.circles.length>0&&!yn.collisionDetected,En=En&&yn.offscreen}if(Nt.iconFeatureIndex&&(qs=Nt.iconFeatureIndex),Nt.iconBox){const Ko=fa=>this.collisionIndex.placeCollisionBox(fa,Oe,q,st,O,Be,De,k,ce.predicate,at,Ae&&Kn?Kn:void 0,Rt);no&&no.placeable&&Nt.verticalIconBox?(Hi=Ko(Nt.verticalIconBox),Xn=Hi.placeable):(Hi=Ko(Nt.iconBox),Xn=Hi.placeable),En=En&&Hi.offscreen}const Ua=ge||Tt.numHorizontalGlyphVertices===0&&Tt.numVerticalGlyphVertices===0,da=_e||Tt.numIconVertices===0;Ua||da?da?Ua||(Xn=Xn&&Pn):Pn=Xn&&Pn:Xn=Pn=Xn&&Pn;const Ga=Xn&&Hi.placeable;if(Pn&&ki.placeable&&this.collisionIndex.insertCollisionBox(ki.box,ve,S.get("text-ignore-placement"),v.bucketInstanceId,no&&no.placeable&&ha?ha:Gs,ce.ID),Ga&&this.collisionIndex.insertCollisionBox(Hi.box,Oe,S.get("icon-ignore-placement"),v.bucketInstanceId,qs,ce.ID),yn&&Pn&&this.collisionIndex.insertCollisionCircles(yn.circles,ve,S.get("text-ignore-placement"),v.bucketInstanceId,Gs,ce.ID),m&&this.storeCollisionData(v.bucketInstanceId,kr,Nt,ki,Hi,yn),Tt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(v.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Tt.crossTileID]=new uh((Pn||ut)&&!ki?.occluded,(Xn||it)&&!Hi?.occluded,En||v.justReloaded),u[Tt.crossTileID]=!0};if(Ue){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Tt=v.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Nt=Tt.length-1;Nt>=0;--Nt){const kr=Tt[Nt];Dt(v.symbolInstances.get(kr),v.collisionArrays[kr],kr)}}else for(let Tt=n.symbolInstanceStart;Tt<n.symbolInstanceEnd;Tt++)Dt(v.symbolInstances.get(Tt),v.collisionArrays[Tt],Tt);v.justReloaded=!1}storeCollisionData(n,u,m,v,S,M){if(m.textBox||m.iconBox){let k,O;this.collisionBoxArrays.has(n)?k=this.collisionBoxArrays.get(n):(k=new Map,this.collisionBoxArrays.set(n,k)),k.has(u)?O=k.get(u):(O={text:null,icon:null},k.set(u,O)),m.textBox&&(O.text=v.box),m.iconBox&&(O.icon=S.box)}if(M){let k=this.collisionCircleArrays[n];k===void 0&&(k=this.collisionCircleArrays[n]=[]);for(let O=0;O<M.circles.length;O+=4)k.push(M.circles[O+0]-gn),k.push(M.circles[O+1]-gn),k.push(M.circles[O+2]),k.push(M.collisionDetected?1:0)}}markUsedJustification(n,u,m,v){let S;S=v===o.az.vertical?m.verticalPlacedTextSymbolIndex:{left:m.leftJustifiedTextSymbolIndex,center:m.centerJustifiedTextSymbolIndex,right:m.rightJustifiedTextSymbolIndex}[o.aR(u)];const M=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex,m.verticalPlacedTextSymbolIndex];for(const k of M)k>=0&&(n.text.placedSymbolArray.get(k).crossTileID=S>=0&&k!==S?0:m.crossTileID)}markUsedOrientation(n,u,m){const v=u===o.az.horizontal||u===o.az.horizontalOnly?u:0,S=u===o.az.vertical?u:0,M=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex];for(const k of M)n.text.placedSymbolArray.get(k).placedOrientation=v;m.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(m.verticalPlacedTextSymbolIndex).placedOrientation=S)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let m=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const v=u?u.symbolFadeChange(n):1,S=u?u.opacities:{},M=u?u.variableOffsets:{},k=u?u.placedOrientations:{};for(const O in this.placements){const B=this.placements[O],q=S[O];q?(this.opacities[O]=new Da(q,v,B.text,B.icon),m=m||B.text!==q.text.placed||B.icon!==q.icon.placed):(this.opacities[O]=new Da(null,v,B.text,B.icon,B.skipFade),m=m||B.text||B.icon)}for(const O in S){const B=S[O];if(!this.opacities[O]){const q=new Da(B,v,!1,!1);q.isHidden()||(this.opacities[O]=q,m=m||B.text.placed||B.icon.placed)}}for(const O in M)this.variableOffsets[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.variableOffsets[O]=M[O]);for(const O in k)this.placedOrientations[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.placedOrientations[O]=k[O]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");m?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:n)}updateLayerOpacities(n,u){const m={};for(const v of u){const S=v.getBucket(n);S&&v.latestFeatureIndex&&n.id===S.layerIds[0]&&this.updateBucketOpacities(S,v.tileID,m,v.collisionBoxArray)}}updateBucketOpacities(n,u,m,v){n.hasTextData()&&(n.text.opacityVertexArray.clear(),n.text.hasVisibleVertices=!1),n.hasIconData()&&(n.icon.opacityVertexArray.clear(),n.icon.hasVisibleVertices=!1),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const S=n.layers[0],M=S.layout,k=new Da(null,0,!1,!1,!0),O=M.get("text-allow-overlap"),B=M.get("icon-allow-overlap"),q=S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Y=M.get("text-rotation-alignment")==="map",X=M.get("text-pitch-alignment")==="map",te=M.get("icon-text-fit")!=="none",ce=new Da(null,0,O&&(B||!n.hasIconData()||M.get("icon-optional")),B&&(O||!n.hasTextData()||M.get("text-optional")),!0);!n.collisionArrays&&v&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(v);const ge=(ve,Se,Oe)=>{for(let Ce=0;Ce<Se/4;Ce++)ve.opacityVertexArray.emplaceBack(Oe);ve.hasVisibleVertices=ve.hasVisibleVertices||Oe!==cu},_e=this.collisionBoxArrays.get(n.bucketInstanceId);for(let ve=0;ve<n.symbolInstances.length;ve++){const Se=n.symbolInstances.get(ve),{numHorizontalGlyphVertices:Oe,numVerticalGlyphVertices:Ce,crossTileID:De}=Se;let Be=this.opacities[De];m[De]?Be=k:Be||(Be=ce,this.opacities[De]=Be),m[De]=!0;const Ae=Se.numIconVertices>0,Ue=this.placedOrientations[Se.crossTileID],ut=Ue===o.az.vertical,it=Ue===o.az.horizontal||Ue===o.az.horizontalOnly;if(Oe>0||Ce>0){const at=dd(Be.text);ge(n.text,Oe,ut?cu:at),ge(n.text,Ce,it?cu:at);const Rt=Be.text.isHidden();[Se.rightJustifiedTextSymbolIndex,Se.centerJustifiedTextSymbolIndex,Se.leftJustifiedTextSymbolIndex].forEach(Nt=>{Nt>=0&&(n.text.placedSymbolArray.get(Nt).hidden=Rt||ut?1:0)}),Se.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(Se.verticalPlacedTextSymbolIndex).hidden=Rt||it?1:0);const Dt=this.variableOffsets[Se.crossTileID];Dt&&this.markUsedJustification(n,Dt.anchor,Se,Ue);const Tt=this.placedOrientations[Se.crossTileID];Tt&&(this.markUsedJustification(n,"left",Se,Tt),this.markUsedOrientation(n,Tt,Se))}if(Ae){const at=dd(Be.icon),Rt=!(te&&Se.verticalPlacedIconSymbolIndex&&ut);Se.placedIconSymbolIndex>=0&&(ge(n.icon,Se.numIconVertices,Rt?at:cu),n.icon.placedSymbolArray.get(Se.placedIconSymbolIndex).hidden=Be.icon.isHidden()),Se.verticalPlacedIconSymbolIndex>=0&&(ge(n.icon,Se.numVerticalIconVertices,Rt?cu:at),n.icon.placedSymbolArray.get(Se.verticalPlacedIconSymbolIndex).hidden=Be.icon.isHidden())}const st=_e&&_e.has(ve)?_e.get(ve):{text:null,icon:null};if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const at=n.collisionArrays[ve];if(at){let Rt=new o.P(0,0);if(at.textBox||at.verticalTextBox){let Dt=!0;if(q){const Tt=this.variableOffsets[De];Tt?(Rt=lu(Tt.anchor,Tt.width,Tt.height,Tt.textOffset,Tt.textBoxScale),Y&&Rt._rotate(X?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Dt=!1}if(at.textBox||at.verticalTextBox){let Tt;at.textBox&&(Tt=ut),at.verticalTextBox&&(Tt=it),hh(n.textCollisionBox.collisionVertexArray,Be.text.placed,!Dt||Tt,st.text,Rt.x,Rt.y)}}if(at.iconBox||at.verticalIconBox){const Dt=!!(!it&&at.verticalIconBox);let Tt;at.iconBox&&(Tt=Dt),at.verticalIconBox&&(Tt=!Dt),hh(n.iconCollisionBox.collisionVertexArray,Be.icon.placed,Tt,st.icon,te?Rt.x:0,te?Rt.y:0)}}}}if(n.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);n.bucketInstanceId in this.collisionCircleArrays&&(n.collisionCircleArray=this.collisionCircleArrays[n.bucketInstanceId],delete this.collisionCircleArrays[n.bucketInstanceId])}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,u){const m=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*m>n}setStale(){this.stale=!0}}function hh(w,n,u,m,v,S){m&&m.length!==0||(m=[0,0,0,0]);const M=m[0]-gn,k=m[1]-gn,O=m[2]-gn,B=m[3]-gn;w.emplaceBack(n?1:0,u?1:0,v||0,S||0,M,k),w.emplaceBack(n?1:0,u?1:0,v||0,S||0,O,k),w.emplaceBack(n?1:0,u?1:0,v||0,S||0,O,B),w.emplaceBack(n?1:0,u?1:0,v||0,S||0,M,B)}const ic=Math.pow(2,25),Lf=Math.pow(2,24),Ff=Math.pow(2,17),fn=Math.pow(2,16),dh=Math.pow(2,9),Bf=Math.pow(2,8),gl=Math.pow(2,1);function dd(w){if(w.opacity===0&&!w.placed)return 0;if(w.opacity===1&&w.placed)return 4294967295;const n=w.placed?1:0,u=Math.floor(127*w.opacity);return u*ic+n*Lf+u*Ff+n*fn+u*dh+n*Bf+u*gl+n}const cu=0;class za{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,u,m,v,S){const M=this._bucketParts;for(;this._currentTileIndex<n.length;)if(u.getBucketParts(M,v,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort((k,O)=>k.sortKey-O.sortKey));this._currentPartIndex<M.length;)if(u.placeLayerBucketPart(M[this._currentPartIndex],this._seenCrossTileIDs,m),this._currentPartIndex++,S())return!0;return!1}}class yl{constructor(n,u,m,v,S,M,k,O){this.placement=new hd(n,u,M,k,O),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(n,u,m){const v=$(),S=()=>!this._forceFullPlacement&&$()-v>2;for(;this._currentPlacementIndex>=0;){const M=u[n[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(M.type==="symbol"&&(!M.minzoom||M.minzoom<=k)&&(!M.maxzoom||M.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new za(M)),this._inProgressLayer.continuePlacement(m[M.source],this.placement,this._showCollisionBoxes,M,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Fr=512/o.a5/2;class ea{constructor(n,u,m){this.tileID=n,this.bucketInstanceId=m,this._symbolsByKey={};const v=new Map;for(let S=0;S<u.length;S++){const M=u.get(S),k=M.key,O=v.get(k);O?O.push(M):v.set(k,[M])}for(const[S,M]of v){const k={positions:M.map(O=>({x:Math.floor(O.anchorX*Fr),y:Math.floor(O.anchorY*Fr)})),crossTileIDs:M.map(O=>O.crossTileID)};if(k.positions.length>128){const O=new o.aT(k.positions.length,16,Uint16Array);for(const{x:B,y:q}of k.positions)O.add(B,q);O.finish(),delete k.positions,k.index=O}this._symbolsByKey[S]=k}}getScaledCoordinates(n,u){const{x:m,y:v,z:S}=this.tileID.canonical,{x:M,y:k,z:O}=u.canonical,B=Fr/Math.pow(2,O-S),q=(k*o.a5+n.anchorY)*B,Y=v*o.a5*Fr;return{x:Math.floor((M*o.a5+n.anchorX)*B-m*o.a5*Fr),y:Math.floor(q-Y)}}findMatches(n,u,m){const v=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let S=0;S<n.length;S++){const M=n.get(S);if(M.crossTileID)continue;const k=this._symbolsByKey[M.key];if(!k)continue;const O=this.getScaledCoordinates(M,u);if(k.index){const B=k.index.range(O.x-v,O.y-v,O.x+v,O.y+v).sort();for(const q of B){const Y=k.crossTileIDs[q];if(!m[Y]){m[Y]=!0,M.crossTileID=Y;break}}}else if(k.positions)for(let B=0;B<k.positions.length;B++){const q=k.positions[B],Y=k.crossTileIDs[B];if(Math.abs(q.x-O.x)<=v&&Math.abs(q.y-O.y)<=v&&!m[Y]){m[Y]=!0,M.crossTileID=Y;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:n})=>n)}}class vl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ta{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const u=Math.round((n-this.lng)/360);if(u!==0)for(const m in this.indexes){const v=this.indexes[m],S={};for(const M in v){const k=v[M];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+u),S[k.tileID.key]=k}this.indexes[m]=S}this.lng=n}addBucket(n,u,m){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let S=0;S<u.symbolInstances.length;S++)u.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const v=this.usedCrossTileIDs[n.overscaledZ];for(const S in this.indexes){const M=this.indexes[S];if(Number(S)>n.overscaledZ)for(const k in M){const O=M[k];O.tileID.isChildOf(n)&&O.findMatches(u.symbolInstances,n,v)}else{const k=M[n.scaledTo(Number(S)).key];k&&k.findMatches(u.symbolInstances,n,v)}}for(let S=0;S<u.symbolInstances.length;S++){const M=u.symbolInstances.get(S);M.crossTileID||(M.crossTileID=m.generate(),v[M.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new ea(n,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(n,u){for(const m of u.getCrossTileIDsLists())for(const v of m)delete this.usedCrossTileIDs[n][v]}removeStaleBuckets(n){let u=!1;for(const m in this.indexes){const v=this.indexes[m];for(const S in v)n[v[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,v[S]),delete v[S],u=!0)}return u}}class Ji{constructor(){this.layerIndexes={},this.crossTileIDs=new vl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,u,m){let v=this.layerIndexes[n.id];v===void 0&&(v=this.layerIndexes[n.id]=new ta);let S=!1;const M={};v.handleWrapJump(m);for(const k of u){const O=k.getBucket(n);O&&n.id===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(k.tileID,O,this.crossTileIDs)&&(S=!0),M[O.bucketInstanceId]=!0)}return v.removeStaleBuckets(M)&&(S=!0),S}pruneUnusedLayers(n){const u={};n.forEach(m=>{u[m]=!0});for(const m in this.layerIndexes)u[m]||delete this.layerIndexes[m]}}var Oi="void main() {fragColor=vec4(1.0);}";const _n={prelude:Sr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Sr("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Sr("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Sr(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Sr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Sr(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Sr(Oi,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Sr(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Sr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Sr("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Sr("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Sr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Sr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Sr(Oi,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Sr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Sr(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Sr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Sr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Sr(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Sr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Sr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Sr(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Sr(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Sr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Sr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Sr(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:Sr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:Sr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Sr(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Sr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Sr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Sr("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Sr("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Sr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Sr("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Sr(`#ifdef GL_ES
precision highp float;
#endif
in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Sr("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Sr(w,n){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=n.match(/in ([\w]+) ([\w]+)/g),v=w.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),M=S?S.concat(v):v,k={};return{fragmentSource:w=w.replace(u,(O,B,q,Y,X)=>(k[X]=!0,B==="define"?`
#ifndef HAS_UNIFORM_u_${X}
in ${q} ${Y} ${X};
#else
uniform ${q} ${Y} u_${X};
#endif
`:`
#ifdef HAS_UNIFORM_u_${X}
    ${q} ${Y} ${X} = u_${X};
#endif
`)),vertexSource:n=n.replace(u,(O,B,q,Y,X)=>{const te=Y==="float"?"vec2":"vec4",ce=X.match(/color/)?"color":te;return k[X]?B==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
in ${q} ${te} a_${X};
out ${q} ${Y} ${X};
#else
uniform ${q} ${Y} u_${X};
#endif
`:ce==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = a_${X};
#else
    ${q} ${Y} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = unpack_mix_${ce}(a_${X}, u_${X}_t);
#else
    ${q} ${Y} ${X} = u_${X};
#endif
`:B==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
in ${q} ${te} a_${X};
#else
uniform ${q} ${Y} u_${X};
#endif
`:ce==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${q} ${Y} ${X} = a_${X};
#else
    ${q} ${Y} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${q} ${Y} ${X} = unpack_mix_${ce}(a_${X}, u_${X}_t);
#else
    ${q} ${Y} ${X} = u_${X};
#endif
`}),staticAttributes:m,staticUniforms:M}}class Mn{constructor(n,u,m){this.vertexBuffer=n,this.indexBuffer=u,this.segments=m}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ps=o.aU([{name:"a_pos",type:"Int16",components:2}]);const Do="#define PROJECTION_MERCATOR",Go="mercator";class Qi{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Go}get shaderDefine(){return Do}get shaderPreludeCode(){return _n.projectionMercator}get vertexShaderPreludeCode(){return _n.projectionMercator.vertexSource}get subdivisionGranularity(){return o.aV.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(n){}getMeshFromTileID(n,u,m,v,S){if(this._cachedMesh)return this._cachedMesh;const M=new o.aW;M.emplaceBack(0,0),M.emplaceBack(o.a5,0),M.emplaceBack(0,o.a5),M.emplaceBack(o.a5,o.a5);const k=n.createVertexBuffer(M,ps.members),O=o.aX.simpleSegment(0,0,4,2),B=new o.aY;B.emplaceBack(1,0,2),B.emplaceBack(1,2,3);const q=n.createIndexBuffer(B);return this._cachedMesh=new Mn(k,q,O),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(n){}}class oc{constructor(n=0,u=0,m=0,v=0){if(isNaN(n)||n<0||isNaN(u)||u<0||isNaN(m)||m<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=u,this.left=m,this.right=v}interpolate(n,u,m){return u.top!=null&&n.top!=null&&(this.top=o.G.number(n.top,u.top,m)),u.bottom!=null&&n.bottom!=null&&(this.bottom=o.G.number(n.bottom,u.bottom,m)),u.left!=null&&n.left!=null&&(this.left=o.G.number(n.left,u.left,m)),u.right!=null&&n.right!=null&&(this.right=o.G.number(n.right,u.right,m)),this}getCenter(n,u){const m=o.an((this.left+n-this.right)/2,0,n),v=o.an((this.top+u-this.bottom)/2,0,u);return new o.P(m,v)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new oc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function _l(w,n){if(!w.renderWorldCopies||w.lngRange)return;const u=n.lng-w.center.lng;n.lng+=u>180?-360:u<-180?360:0}function qn(w){return Math.max(0,Math.floor(w))}class Ds{constructor(n,u){var m;this.applyConstrain=(v,S)=>this._constrainOverride!==null?this._constrainOverride(v,S):this._callbacks.defaultConstrain(v,S),this._callbacks=n,this._tileSize=512,this._renderWorldCopies=u?.renderWorldCopies===void 0||!!u?.renderWorldCopies,this._minZoom=u?.minZoom||0,this._maxZoom=u?.maxZoom||22,this._minPitch=u?.minPitch==null?0:u?.minPitch,this._maxPitch=u?.maxPitch==null?60:u?.maxPitch,this._constrainOverride=(m=u?.constrainOverride)!==null&&m!==void 0?m:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new o.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=qn(this._zoom),this._scale=o.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new oc,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(n,u,m){this._constrainOverride=n.constrainOverride,this._latRange=n.latRange,this._lngRange=n.lngRange,this._width=n.width,this._height=n.height,this._center=n.center,this._elevation=n.elevation,this._minElevationForCurrentTile=n.minElevationForCurrentTile,this._zoom=n.zoom,this._tileZoom=qn(this._zoom),this._scale=o.aq(this._zoom),this._bearingInRadians=n.bearingInRadians,this._fovInRadians=n.fovInRadians,this._pitchInRadians=n.pitchInRadians,this._rollInRadians=n.rollInRadians,this._unmodified=n.unmodified,this._edgeInsets=new oc(n.padding.top,n.padding.bottom,n.padding.left,n.padding.right),this._minZoom=n.minZoom,this._maxZoom=n.maxZoom,this._minPitch=n.minPitch,this._maxPitch=n.maxPitch,this._renderWorldCopies=n.renderWorldCopies,this._cameraToCenterDistance=n.cameraToCenterDistance,this._nearZ=n.nearZ,this._farZ=n.farZ,this._autoCalculateNearFarZ=!m&&n.autoCalculateNearFarZ,u&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(n){this._minElevationForCurrentTile=n}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(n){this._minZoom!==n&&(this._minZoom=n,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(n){this._minPitch!==n&&(this._minPitch=n,this.setPitch(Math.max(this.pitch,n)))}get maxPitch(){return this._maxPitch}setMaxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.setPitch(Math.min(this.pitch,n)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get constrainOverride(){return this._constrainOverride}setConstrainOverride(n){n===void 0&&(n=null),this._constrainOverride!==n&&(this._constrainOverride=n,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(n){const u=o.W(n,-180,180)*Math.PI/180;var m,v,S,M,k,O,B,q,Y;this._bearingInRadians!==u&&(this._unmodified=!1,this._bearingInRadians=u,this._calcMatrices(),this._rotationMatrix=P(),m=this._rotationMatrix,S=-this._bearingInRadians,M=(v=this._rotationMatrix)[0],k=v[1],O=v[2],B=v[3],q=Math.sin(S),Y=Math.cos(S),m[0]=M*Y+O*q,m[1]=k*Y+B*q,m[2]=M*-q+O*Y,m[3]=k*-q+B*Y)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(n){const u=o.an(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==u&&(this._unmodified=!1,this._pitchInRadians=u,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(n){const u=n/180*Math.PI;this._rollInRadians!==u&&(this._unmodified=!1,this._rollInRadians=u,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return o.aZ(this._fovInRadians)}setFov(n){n=o.an(n,.1,150),this.fov!==n&&(this._unmodified=!1,this._fovInRadians=o.ap(n),this._calcMatrices())}get zoom(){return this._zoom}setZoom(n){const u=this.applyConstrain(this._center,n).zoom;this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this._tileZoom=Math.max(0,Math.floor(u)),this._scale=o.aq(u),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(n){n!==this._elevation&&(this._elevation=n,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(n,u){this._autoCalculateNearFarZ=!1,this._nearZ=n,this._farZ=u,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,u,m){this._unmodified=!1,this._edgeInsets.interpolate(n,u,m),this.constrainInternal(),this._calcMatrices()}resize(n,u,m=!0){this._width=n,this._height=u,m&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new yr([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(n){n?(this._lngRange=[n.getWest(),n.getEast()],this._latRange=[n.getSouth(),n.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-o.ao,o.ao])}getCameraQueryGeometry(n,u){if(u.length===1)return[u[0],n];{const{minX:m,minY:v,maxX:S,maxY:M}=o.aa.fromPoints(u).extend(n);return[new o.P(m,v),new o.P(S,v),new o.P(S,M),new o.P(m,M),new o.P(m,v)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const n=this._unmodified,{center:u,zoom:m}=this.applyConstrain(this.center,this.zoom);this.setCenter(u),this.setZoom(m),this._unmodified=n,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let n=o.ar(new Float64Array(16));o.Q(n,n,[this._width/2,-this._height/2,1]),o.O(n,n,[1,-1,0]),this._clipSpaceToPixelsMatrix=n,n=o.ar(new Float64Array(16)),o.Q(n,n,[1,-1,1]),o.O(n,n,[-1,-1,0]),o.Q(n,n,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=n,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(n,u,m,v){const S=m!==void 0?m:this.bearing,M=v=v!==void 0?v:this.pitch,{distanceToCenter:k,clampedElevation:O}=this._distanceToCenterFromAltElevationPitch(u,this.elevation,M),{x:B,y:q}=Lr(M,S),Y=o.a9.fromLngLat(n,u);let X,te,ce=o.a_(1,Y.y),ge=0;do{if(ge+=1,ge>10)break;te=k/ce,X=new o.a9(Y.x+B*te,Y.y+q*te),ce=1/X.meterInMercatorCoordinateUnits()}while(Math.abs(k-te*ce)>1e-12);return{center:X.toLngLat(),elevation:O,zoom:o.at(this.height/2/Math.tan(this.fovInRadians/2)/te/this.tileSize)}}recalculateZoomAndCenter(n){if(this.elevation-n==0)return;const u=1/this.worldSize,m=o.as(1,this.center.lat)*this.worldSize,v=o.a9.fromLngLat(this.center,this.elevation),S=v.x/u,M=v.y/u,k=v.z/u,O=this.pitch,B=this.bearing,{x:q,y:Y,z:X}=Lr(O,B),te=this.cameraToCenterDistance,ce=S+te*-q,ge=M+te*-Y,_e=k+te*X,{distanceToCenter:ve,clampedElevation:Se}=this._distanceToCenterFromAltElevationPitch(_e/m,n,O),Oe=ve*m,Ce=new o.a9((ce+q*Oe)*u,(ge+Y*Oe)*u,0).toLngLat(),De=o.as(1,Ce.lat),Be=o.at(this.height/2/Math.tan(this.fovInRadians/2)/ve/De/this.tileSize);this._elevation=Se,this._center=Ce,this.setZoom(Be)}_distanceToCenterFromAltElevationPitch(n,u,m){const v=-Math.cos(o.ap(m)),S=n-u;let M,k=u;return v*S>=0||Math.abs(v)<.1?(M=1e4,k=n+M*v):M=-S/v,{distanceToCenter:M,clampedElevation:k}}getCameraPoint(){const n=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(n*Math.sin(this.rollInRadians),n*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const n=o.as(1,this.center.lat)*this.worldSize;return Ze(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/n).toLngLat()}getMercatorTileCoordinates(n){if(!n)return[0,0,1,1];const u=n.canonical.z>=0?1<<n.canonical.z:Math.pow(2,n.canonical.z);return[n.canonical.x/u,n.canonical.y/u,1/u/o.a5,1/u/o.a5]}}class zo{constructor(n,u){this.min=n,this.max=u,this.center=o.a$([],o.b0([],this.min,this.max),.5)}quadrant(n){const u=[n%2==0,n<2],m=o.b1(this.min),v=o.b1(this.max);for(let S=0;S<u.length;S++)m[S]=u[S]?this.min[S]:this.center[S],v[S]=u[S]?this.center[S]:this.max[S];return v[2]=this.max[2],new zo(m,v)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersectsFrustum(n){let u=!0;for(let m=0;m<n.planes.length;m++){const v=this.intersectsPlane(n.planes[m]);if(v===0)return 0;v===1&&(u=!1)}return u?2:n.aabb.min[0]>this.max[0]||n.aabb.min[1]>this.max[1]||n.aabb.min[2]>this.max[2]||n.aabb.max[0]<this.min[0]||n.aabb.max[1]<this.min[1]||n.aabb.max[2]<this.min[2]?0:1}intersectsPlane(n){let u=n[3],m=n[3];for(let v=0;v<3;v++)n[v]>0?(u+=n[v]*this.min[v],m+=n[v]*this.max[v]):(m+=n[v]*this.min[v],u+=n[v]*this.max[v]);return u>=0?2:m<0?0:1}}class sc{distanceToTile2d(n,u,m,v){const S=v.distanceX([n,u]),M=v.distanceY([n,u]);return Math.hypot(S,M)}getWrap(n,u,m){return m}getTileBoundingVolume(n,u,m,v){var S,M;let k=0,O=0;if(v?.terrain){const q=new o.a2(n.z,u,n.z,n.x,n.y),Y=v.terrain.getMinMaxElevation(q);k=(S=Y.minElevation)!==null&&S!==void 0?S:Math.min(0,m),O=(M=Y.maxElevation)!==null&&M!==void 0?M:Math.max(0,m)}const B=1<<n.z;return new zo([u+n.x/B,n.y/B,k],[u+(n.x+1)/B,(n.y+1)/B,O])}allowVariableZoom(n,u){const m=n.fov*(Math.abs(Math.cos(n.rollInRadians))*n.height+Math.abs(Math.sin(n.rollInRadians))*n.width)/n.height,v=o.an(78.5-m/2,0,60);return!!u.terrain||n.pitch>v}allowWorldCopies(){return!0}prepareNextFrame(){}}class qo{constructor(n,u,m){this.points=n,this.planes=u,this.aabb=m}static fromInvProjectionMatrix(n,u=1,m=0,v,S){const M=S?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],k=Math.pow(2,m),O=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(X=>function(te,ce,ge,_e){const ve=o.aH([],te,ce),Se=1/ve[3]/ge*_e;return o.b6(ve,ve,[Se,Se,1/ve[3],Se])}(X,n,u,k));v&&function(X,te,ce,ge){const _e=ge?4:0,ve=ge?0:4;let Se=0;const Oe=[],Ce=[];for(let Ae=0;Ae<4;Ae++){const Ue=o.b2([],X[Ae+ve],X[Ae+_e]),ut=o.b7(Ue);o.a$(Ue,Ue,1/ut),Oe.push(ut),Ce.push(Ue)}for(let Ae=0;Ae<4;Ae++){const Ue=o.b8(X[Ae+_e],Ce[Ae],ce);Se=Ue!==null&&Ue>=0?Math.max(Se,Ue):Math.max(Se,Oe[Ae])}const De=function(Ae,Ue){const ut=o.b2([],Ae[Ue[0]],Ae[Ue[1]]),it=o.b2([],Ae[Ue[2]],Ae[Ue[1]]),st=[0,0,0,0];return o.b3(st,o.b4([],ut,it)),st[3]=-o.b5(st,Ae[Ue[0]]),st}(X,te),Be=function(Ae,Ue){const ut=o.b9(Ae),it=o.ba([],Ae,1/ut),st=o.b2([],Ue,o.a$([],it,o.b5(Ue,it))),at=o.b9(st);if(at>0){const Rt=Math.sqrt(1-it[3]*it[3]),Dt=o.a$([],it,-it[3]),Tt=o.b0([],Dt,o.a$([],st,Rt/at));return o.bb(Ue,Tt)}return null}(ce,De);if(Be!==null){const Ae=Be/o.b5(Ce[0],De);Se=Math.min(Se,Ae)}for(let Ae=0;Ae<4;Ae++){const Ue=Math.min(Se,Oe[Ae]);X[Ae+ve]=[X[Ae+_e][0]+Ce[Ae][0]*Ue,X[Ae+_e][1]+Ce[Ae][1]*Ue,X[Ae+_e][2]+Ce[Ae][2]*Ue,1]}}(O,M[0],v,S);const B=M.map(X=>{const te=o.b2([],O[X[0]],O[X[1]]),ce=o.b2([],O[X[2]],O[X[1]]),ge=o.b3([],o.b4([],te,ce)),_e=-o.b5(ge,O[X[1]]);return ge.concat(_e)}),q=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],Y=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const X of O)for(let te=0;te<3;te++)q[te]=Math.min(q[te],X[te]),Y[te]=Math.max(Y[te],X[te]);return new qo(O,B,new zo(q,Y))}}class ac{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,u,m){return this._helper.interpolatePadding(n,u,m)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,u,m=!0){this._helper.resize(n,u,m)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}setConstrainOverride(n){this._helper.setConstrainOverride(n)}overrideNearFarZ(n,u){this._helper.overrideNearFarZ(n,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(n,u){}constructor(n){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(u,m)=>{m=o.an(+m,this.minZoom,this.maxZoom);const v={center:new o.V(u.lng,u.lat),zoom:m};let S=this._helper._lngRange;if(!this._helper._renderWorldCopies&&S===null){const Ce=179.9999999999;S=[-Ce,Ce]}const M=this.tileSize*o.aq(v.zoom);let k=0,O=M,B=0,q=M,Y=0,X=0;const{x:te,y:ce}=this.size;if(this._helper._latRange){const Ce=this._helper._latRange;k=o.X(Ce[1])*M,O=o.X(Ce[0])*M,O-k<ce&&(Y=ce/(O-k))}S&&(B=o.W(o.Y(S[0])*M,0,M),q=o.W(o.Y(S[1])*M,0,M),q<B&&(q+=M),q-B<te&&(X=te/(q-B)));const{x:ge,y:_e}=qt(M,u);let ve,Se;const Oe=Math.max(X||0,Y||0);if(Oe){const Ce=new o.P(X?(q+B)/2:ge,Y?(O+k)/2:_e);return v.center=Qt(M,Ce).wrap(),v.zoom+=o.at(Oe),v}if(this._helper._latRange){const Ce=ce/2;_e-Ce<k&&(Se=k+Ce),_e+Ce>O&&(Se=O-Ce)}if(S){const Ce=(B+q)/2;let De=ge;this._helper._renderWorldCopies&&(De=o.W(ge,Ce-M/2,Ce+M/2));const Be=te/2;De-Be<B&&(ve=B+Be),De+Be>q&&(ve=q-Be)}if(ve!==void 0||Se!==void 0){const Ce=new o.P(ve??ge,Se??_e);v.center=Qt(M,Ce).wrap()}return v},this.applyConstrain=(u,m)=>this._helper.applyConstrain(u,m),this._helper=new Ds({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(u,m)=>this.defaultConstrain(u,m)},n),this._coveringTilesDetailsProvider=new sc}clone(){const n=new ac;return n.apply(this,!1),n}apply(n,u,m){this._helper.apply(n,u,m)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(n){const u=[new o.bc(0,n)];if(this._helper._renderWorldCopies){const m=this.screenPointToMercatorCoordinate(new o.P(0,0)),v=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,0)),S=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,this._helper._height)),M=this.screenPointToMercatorCoordinate(new o.P(0,this._helper._height)),k=Math.floor(Math.min(m.x,v.x,S.x,M.x)),O=Math.floor(Math.max(m.x,v.x,S.x,M.x)),B=1;for(let q=k-B;q<=O+B;q++)q!==0&&u.push(new o.bc(q,n))}return u}getCameraFrustum(){return qo.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(n){const u=this.screenPointToLocation(this.centerPoint,n),m=n?n.getElevationForLngLatZoom(u,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(m)}setLocationAtPoint(n,u){const m=o.as(this.elevation,this.center.lat),v=this.screenPointToMercatorCoordinateAtZ(u,m),S=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,m),M=o.a9.fromLngLat(n),k=new o.a9(M.x-(v.x-S.x),M.y-(v.y-S.y));this.setCenter(k?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(n,u){return u?this.coordinatePoint(o.a9.fromLngLat(n),u.getElevationForLngLat(n,this),this._pixelMatrix3D):this.coordinatePoint(o.a9.fromLngLat(n))}screenPointToLocation(n,u){var m;return(m=this.screenPointToMercatorCoordinate(n,u))===null||m===void 0?void 0:m.toLngLat()}screenPointToMercatorCoordinate(n,u){if(u){const m=u.pointCoordinate(n);if(m!=null)return m}return this.screenPointToMercatorCoordinateAtZ(n)}screenPointToMercatorCoordinateAtZ(n,u){const m=u||0,v=[n.x,n.y,0,1],S=[n.x,n.y,1,1];o.aH(v,v,this._pixelMatrixInverse),o.aH(S,S,this._pixelMatrixInverse);const M=v[3],k=S[3],O=v[1]/M,B=S[1]/k,q=v[2]/M,Y=S[2]/k,X=q===Y?0:(m-q)/(Y-q);return new o.a9(o.G.number(v[0]/M,S[0]/k,X)/this.worldSize,o.G.number(O,B,X)/this.worldSize,m)}coordinatePoint(n,u=0,m=this._pixelMatrix){const v=[n.x*this.worldSize,n.y*this.worldSize,u,1];return o.aH(v,v,m),new o.P(v[0]/v[3],v[1]/v[3])}getBounds(){const n=Math.max(0,this._helper._height/2-br(this));return new yr().extend(this.screenPointToLocation(new o.P(0,n))).extend(this.screenPointToLocation(new o.P(this._helper._width,n))).extend(this.screenPointToLocation(new o.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new o.P(0,this._helper._height)))}isPointOnMapSurface(n,u){return u?u.pointCoordinate(n)!=null:n.y>this.height/2-br(this)}calculatePosMatrix(n,u=!1,m){var v;const S=(v=n.key)!==null&&v!==void 0?v:o.bd(n.wrap,n.canonical.z,n.canonical.z,n.canonical.x,n.canonical.y),M=u?this._alignedPosMatrixCache:this._posMatrixCache;if(M.has(S)){const B=M.get(S);return m?B.f32:B.f64}const k=tr(n,this.worldSize);o.S(k,u?this._alignedProjMatrix:this._viewProjMatrix,k);const O={f64:k,f32:new Float32Array(k)};return M.set(S,O),m?O.f32:O.f64}calculateFogMatrix(n){const u=n.key,m=this._fogMatrixCacheF32;if(m.has(u))return m.get(u);const v=tr(n,this.worldSize);return o.S(v,this._fogMatrix,v),m.set(u,new Float32Array(v)),m.get(u)}calculateCenterFromCameraLngLatAlt(n,u,m,v){return this._helper.calculateCenterFromCameraLngLatAlt(n,u,m,v)}_calculateNearFarZIfNeeded(n,u,m){if(!this._helper.autoCalculateNearFarZ)return;const v=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),S=n-v*this._helper._pixelPerMeter/Math.cos(u),M=v<0?S:n,k=Math.PI/2+this.pitchInRadians,O=o.ap(this.fov)*(Math.abs(Math.cos(o.ap(this.roll)))*this.height+Math.abs(Math.sin(o.ap(this.roll)))*this.width)/this.height*(.5+m.y/this.height),B=Math.sin(O)*M/Math.sin(o.an(Math.PI-k-O,.01,Math.PI-.01)),q=br(this),Y=Math.atan(q/this._helper.cameraToCenterDistance),X=o.ap(.75),te=Y>X?2*Y*(.5+m.y/(2*q)):X,ce=Math.sin(te)*M/Math.sin(o.an(Math.PI-k-te,.01,Math.PI-.01)),ge=Math.min(B,ce);this._helper._farZ=1.01*(Math.cos(Math.PI/2-u)*ge+M),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const n=this.centerOffset,u=qt(this.worldSize,this.center),m=u.x,v=u.y;this._helper._pixelPerMeter=o.as(1,this.center.lat)*this.worldSize;const S=o.ap(Math.min(this.pitch,$t)),M=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(S));let k;this._calculateNearFarZIfNeeded(M,S,n),k=new Float64Array(16),o.be(k,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),o.aB(this._invProjMatrix,k),k[8]=2*-n.x/this._helper._width,k[9]=2*n.y/this._helper._height,this._projectionMatrix=o.bf(k),o.Q(k,k,[1,-1,1]),o.O(k,k,[0,0,-this._helper.cameraToCenterDistance]),o.bg(k,k,-this.rollInRadians),o.bh(k,k,this.pitchInRadians),o.bg(k,k,-this.bearingInRadians),o.O(k,k,[-m,-v,0]),this._mercatorMatrix=o.Q([],k,[this.worldSize,this.worldSize,this.worldSize]),o.Q(k,k,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=o.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,k),o.O(k,k,[0,0,-this.elevation]),this._viewProjMatrix=k,this._invViewProjMatrix=o.aB([],k);const O=[0,0,-1,1];o.aH(O,O,this._invViewProjMatrix),this._cameraPosition=[O[0]/O[3],O[1]/O[3],O[2]/O[3]],this._fogMatrix=new Float64Array(16),o.be(this._fogMatrix,this.fovInRadians,this.width/this.height,M,this._helper._farZ),this._fogMatrix[8]=2*-n.x/this.width,this._fogMatrix[9]=2*n.y/this.height,o.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),o.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),o.bg(this._fogMatrix,this._fogMatrix,-this.rollInRadians),o.bh(this._fogMatrix,this._fogMatrix,this.pitchInRadians),o.bg(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),o.O(this._fogMatrix,this._fogMatrix,[-m,-v,0]),o.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),o.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=o.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,k);const B=this._helper._width%2/2,q=this._helper._height%2/2,Y=Math.cos(this.bearingInRadians),X=Math.sin(-this.bearingInRadians),te=m-Math.round(m)+Y*B+X*q,ce=v-Math.round(v)+Y*q+X*B,ge=new Float64Array(k);if(o.O(ge,ge,[te>.5?te-1:te,ce>.5?ce-1:ce,0]),this._alignedProjMatrix=ge,k=o.aB(new Float64Array(16),this._pixelMatrix),!k)throw new Error("failed to invert matrix");this._pixelMatrixInverse=k,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const n=this.screenPointToMercatorCoordinate(new o.P(0,0)),u=[n.x*this.worldSize,n.y*this.worldSize,0,1];return o.aH(u,u,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const n=o.as(1,this.center.lat)*this.worldSize;return Ze(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/n).toLngLat()}lngLatToCameraDepth(n,u){const m=o.a9.fromLngLat(n),v=[m.x*this.worldSize,m.y*this.worldSize,u,1];return o.aH(v,v,this._viewProjMatrix),v[2]/v[3]}getProjectionData(n){const{overscaledTileID:u,aligned:m,applyTerrainMatrix:v}=n,S=this._helper.getMercatorTileCoordinates(u),M=u?this.calculatePosMatrix(u,m,!0):null;let k;return k=u&&u.terrainRttPosMatrix32f&&v?u.terrainRttPosMatrix32f:M||o.bi(),{mainMatrix:k,tileMercatorCoords:S,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:k}}isLocationOccluded(n){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(n,u,m){return 1}transformLightDirection(n){return o.b1(n)}getRayDirectionFromPixel(n){throw new Error("Not implemented.")}projectTileCoordinates(n,u,m,v){const S=this.calculatePosMatrix(m);let M;v?(M=[n,u,v(n,u),1],o.aH(M,M,S)):(M=[n,u,0,1],os(M,M,S));const k=M[3];return{point:new o.P(M[0]/k,M[1]/k),signedDistanceFromCamera:k,isOccluded:!1}}populateCache(n){for(const u of n)this.calculatePosMatrix(u)}getMatrixForModel(n,u){const m=o.a9.fromLngLat(n,u),v=m.meterInMercatorCoordinateUnits(),S=o.bj();return o.O(S,S,[m.x,m.y,m.z]),o.bg(S,S,Math.PI),o.bh(S,S,Math.PI/2),o.Q(S,S,[-v,v,v]),S}getProjectionDataForCustomLayer(n=!0){const u=new o.a2(0,0,0,0,0),m=this.getProjectionData({overscaledTileID:u,applyGlobeMatrix:n}),v=tr(u,this.worldSize);o.S(v,this._viewProjMatrix,v),m.tileMercatorCoords=[0,0,1,1];const S=[o.a5,o.a5,this.worldSize/this._helper.pixelsPerMeter],M=o.bk();return o.Q(M,v,S),m.fallbackMatrix=M,m.mainMatrix=M,m}getFastPathSimpleProjectionMatrix(n){return this.calculatePosMatrix(n)}}function zs(){o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function fh(w){if(w.useSlerp)if(w.k<1){const n=o.bl(w.startEulerAngles.roll,w.startEulerAngles.pitch,w.startEulerAngles.bearing),u=o.bl(w.endEulerAngles.roll,w.endEulerAngles.pitch,w.endEulerAngles.bearing),m=new Float64Array(4);o.bm(m,n,u,w.k);const v=o.bn(m);w.tr.setRoll(v.roll),w.tr.setPitch(v.pitch),w.tr.setBearing(v.bearing)}else w.tr.setRoll(w.endEulerAngles.roll),w.tr.setPitch(w.endEulerAngles.pitch),w.tr.setBearing(w.endEulerAngles.bearing);else w.tr.setRoll(o.G.number(w.startEulerAngles.roll,w.endEulerAngles.roll,w.k)),w.tr.setPitch(o.G.number(w.startEulerAngles.pitch,w.endEulerAngles.pitch,w.k)),w.tr.setBearing(o.G.number(w.startEulerAngles.bearing,w.endEulerAngles.bearing,w.k))}function ph(w,n,u,m,v){const S=v.padding,M=qt(v.worldSize,u.getNorthWest()),k=qt(v.worldSize,u.getNorthEast()),O=qt(v.worldSize,u.getSouthEast()),B=qt(v.worldSize,u.getSouthWest()),q=o.ap(-m),Y=M.rotate(q),X=k.rotate(q),te=O.rotate(q),ce=B.rotate(q),ge=new o.P(Math.max(Y.x,X.x,ce.x,te.x),Math.max(Y.y,X.y,ce.y,te.y)),_e=new o.P(Math.min(Y.x,X.x,ce.x,te.x),Math.min(Y.y,X.y,ce.y,te.y)),ve=ge.sub(_e),Se=(v.width-(S.left+S.right+n.left+n.right))/ve.x,Oe=(v.height-(S.top+S.bottom+n.top+n.bottom))/ve.y;if(Oe<0||Se<0)return void zs();const Ce=Math.min(o.at(v.scale*Math.min(Se,Oe)),w.maxZoom),De=o.P.convert(w.offset),Be=new o.P((n.left-n.right)/2,(n.top-n.bottom)/2).rotate(o.ap(m)),Ae=De.add(Be).mult(v.scale/o.aq(Ce));return{center:Qt(v.worldSize,M.add(O).div(2).sub(Ae)),zoom:Ce,bearing:m}}class xl{get useGlobeControls(){return!1}handlePanInertia(n,u){const m=n.mag(),v=Math.abs(br(u));return{easingOffset:n.mult(Math.min(.75*v/m,1)),easingCenter:u.center}}handleMapControlsRollPitchBearingZoom(n,u){n.bearingDelta&&u.setBearing(u.bearing+n.bearingDelta),n.pitchDelta&&u.setPitch(u.pitch+n.pitchDelta),n.rollDelta&&u.setRoll(u.roll+n.rollDelta),n.zoomDelta&&u.setZoom(u.zoom+n.zoomDelta)}handleMapControlsPan(n,u,m){n.around.distSqr(u.centerPoint)<.01||u.setLocationAtPoint(m,n.around)}cameraForBoxAndBearing(n,u,m,v,S){return ph(n,u,m,v,S)}handleJumpToCenterZoom(n,u){n.zoom!==(u.zoom!==void 0?+u.zoom:n.zoom)&&n.setZoom(+u.zoom),u.center!==void 0&&n.setCenter(o.V.convert(u.center))}handleEaseTo(n,u){const m=n.zoom,v=n.padding,S={roll:n.roll,pitch:n.pitch,bearing:n.bearing},M={roll:u.roll===void 0?n.roll:u.roll,pitch:u.pitch===void 0?n.pitch:u.pitch,bearing:u.bearing===void 0?n.bearing:u.bearing},k=u.zoom!==void 0,O=!n.isPaddingEqual(u.padding);let B=!1;const q=k?+u.zoom:n.zoom;let Y=n.centerPoint.add(u.offsetAsPoint);const X=n.screenPointToLocation(Y),{center:te,zoom:ce}=n.applyConstrain(o.V.convert(u.center||X),q??m);_l(n,te);const ge=qt(n.worldSize,X),_e=qt(n.worldSize,te).sub(ge),ve=o.aq(ce-m);return B=ce!==m,{easeFunc:Se=>{if(B&&n.setZoom(o.G.number(m,ce,Se)),o.bo(S,M)||fh({startEulerAngles:S,endEulerAngles:M,tr:n,k:Se,useSlerp:S.roll!=M.roll}),O&&(n.interpolatePadding(v,u.padding,Se),Y=n.centerPoint.add(u.offsetAsPoint)),u.around)n.setLocationAtPoint(u.around,u.aroundPoint);else{const Oe=o.aq(n.zoom-m),Ce=ce>m?Math.min(2,ve):Math.max(.5,ve),De=Math.pow(Ce,1-Se),Be=Qt(n.worldSize,ge.add(_e.mult(Se*De)).mult(Oe));n.setLocationAtPoint(n.renderWorldCopies?Be.wrap():Be,Y)}},isZooming:B,elevationCenter:te}}handleFlyTo(n,u){const m=u.zoom!==void 0,v=n.zoom,S=n.applyConstrain(o.V.convert(u.center||u.locationAtOffset),m?+u.zoom:v),M=S.center,k=S.zoom;_l(n,M);const O=qt(n.worldSize,u.locationAtOffset),B=qt(n.worldSize,M).sub(O),q=B.mag(),Y=o.aq(k-v);let X;if(u.minZoom!==void 0){const te=Math.min(+u.minZoom,v,k),ce=n.applyConstrain(M,te).zoom;X=o.aq(ce-v)}return{easeFunc:(te,ce,ge,_e)=>{n.setZoom(te===1?k:v+o.at(ce));const ve=te===1?M:Qt(n.worldSize,O.add(B.mult(ge)).mult(ce));n.setLocationAtPoint(n.renderWorldCopies?ve.wrap():ve,_e)},scaleOfZoom:Y,targetCenter:M,scaleOfMinZoom:X,pixelPathLength:q}}}class sn{constructor(n,u,m){this.blendFunction=n,this.blendColor=u,this.mask=m}}sn.Replace=[1,0],sn.disabled=new sn(sn.Replace,o.bp.transparent,[!1,!1,!1,!1]),sn.unblended=new sn(sn.Replace,o.bp.transparent,[!0,!0,!0,!0]),sn.alphaBlended=new sn([1,771],o.bp.transparent,[!0,!0,!0,!0]);const bl=2305;class Zr{constructor(n,u,m){this.enable=n,this.mode=u,this.frontFace=m}}Zr.disabled=new Zr(!1,1029,bl),Zr.backCCW=new Zr(!0,1029,bl),Zr.frontCCW=new Zr(!0,1028,bl);class Br{constructor(n,u,m){this.func=n,this.mask=u,this.range=m}}Br.ReadOnly=!1,Br.ReadWrite=!0,Br.disabled=new Br(519,Br.ReadOnly,[0,1]);const Oa=7680;class Yr{constructor(n,u,m,v,S,M){this.test=n,this.ref=u,this.mask=m,this.fail=v,this.depthFail=S,this.pass=M}}Yr.disabled=new Yr({func:519,mask:0},0,0,Oa,Oa,Oa);const uu=new WeakMap;function li(w){var n;if(uu.has(w))return uu.get(w);{const u=(n=w.getParameter(w.VERSION))===null||n===void 0?void 0:n.startsWith("WebGL 2.0");return uu.set(w,u),u}}class Os{get awaitingQuery(){return!!this._readbackQueue}constructor(n){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=n;const u=n.context,m=u.gl;this._texFormat=m.RGBA,this._texType=m.UNSIGNED_BYTE;const v=new o.aW;v.emplaceBack(-1,-1),v.emplaceBack(2,-1),v.emplaceBack(-1,2);const S=new o.aY;S.emplaceBack(0,1,2),this._fullscreenTriangle=new Mn(u.createVertexBuffer(v,ps.members),u.createIndexBuffer(S),o.aX.simpleSegment(0,0,v.length,S.length)),this._resultBuffer=new Uint8Array(4),u.activeTexture.set(m.TEXTURE1);const M=m.createTexture();m.bindTexture(m.TEXTURE_2D,M),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST),m.texImage2D(m.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=u.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(M),li(m)&&(this._pbo=m.createBuffer(),m.bindBuffer(m.PIXEL_PACK_BUFFER,this._pbo),m.bufferData(m.PIXEL_PACK_BUFFER,4,m.STREAM_READ),m.bindBuffer(m.PIXEL_PACK_BUFFER,null))}destroy(){const n=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),n.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(n,u){const m=this._updateCount;return this._readbackQueue?m>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():m>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(n,u),this._updateCount++,this._measuredError}_bindFramebuffer(){const n=this._cachedRenderContext.context,u=n.gl;n.activeTexture.set(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,this._fbo.colorAttachment.get()),n.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(n,u){const m=this._cachedRenderContext.context,v=m.gl;if(this._bindFramebuffer(),m.viewport.set([0,0,this._texWidth,this._texHeight]),m.clear({color:o.bp.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(m,v.TRIANGLES,Br.disabled,Yr.disabled,sn.unblended,Zr.disabled,((S,M)=>({u_input:S,u_output_expected:M}))(n,u),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&li(v)){v.bindBuffer(v.PIXEL_PACK_BUFFER,this._pbo),v.readBuffer(v.COLOR_ATTACHMENT0),v.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),v.bindBuffer(v.PIXEL_PACK_BUFFER,null);const S=v.fenceSync(v.SYNC_GPU_COMMANDS_COMPLETE,0);v.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:S}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const n=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&li(n)){const u=n.clientWaitSync(this._readbackQueue.sync,0,0);if(u===n.WAIT_FAILED)return o.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(u===n.TIMEOUT_EXPIRED)return;n.bindBuffer(n.PIXEL_PACK_BUFFER,this._pbo),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),n.bindBuffer(n.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),n.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Os._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(n){let u=0;return u+=n[0]/256,u+=n[1]/65536,u+=n[2]/16777216,n[3]<127&&(u=-u),u/128}}const ra=o.a5/128;function hu(w,n){const u=w.granularity!==void 0?Math.max(w.granularity,1):1,m=u+(w.generateBorders?2:0),v=u+(w.extendToNorthPole||w.generateBorders?1:0)+(w.extendToSouthPole||w.generateBorders?1:0),S=m+1,M=v+1,k=w.generateBorders?-1:0,O=w.generateBorders||w.extendToNorthPole?-1:0,B=u+(w.generateBorders?1:0),q=u+(w.generateBorders||w.extendToSouthPole?1:0),Y=S*M,X=m*v*6,te=S*M>65536;if(te&&n==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const ce=te||n==="32bit",ge=new Int16Array(2*Y);let _e=0;for(let Oe=O;Oe<=q;Oe++)for(let Ce=k;Ce<=B;Ce++){let De=Ce/u*o.a5;Ce===-1&&(De=-ra),Ce===u+1&&(De=o.a5+ra);let Be=Oe/u*o.a5;Oe===-1&&(Be=w.extendToNorthPole?o.br:-ra),Oe===u+1&&(Be=w.extendToSouthPole?o.bs:o.a5+ra),ge[_e++]=De,ge[_e++]=Be}const ve=ce?new Uint32Array(X):new Uint16Array(X);let Se=0;for(let Oe=0;Oe<v;Oe++)for(let Ce=0;Ce<m;Ce++){const De=Ce+1+Oe*S,Be=Ce+(Oe+1)*S,Ae=Ce+1+(Oe+1)*S;ve[Se++]=Ce+Oe*S,ve[Se++]=Be,ve[Se++]=De,ve[Se++]=De,ve[Se++]=Be,ve[Se++]=Ae}return{vertices:ge.buffer.slice(0),indices:ve.buffer.slice(0),uses32bitIndices:ce}}const mh=new o.aV({fill:new o.bt(128,2),line:new o.bt(512,0),tile:new o.bt(128,32),stencil:new o.bt(128,1),circle:3});class gh{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return _n.projectionGlobe}get vertexShaderPreludeCode(){return _n.projectionMercator.vertexSource}get subdivisionGranularity(){return mh}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(n){this._errorMeasurement||(this._errorMeasurement=new Os(n));const u=o.X(this._errorQueryLatitudeDegrees),m=2*Math.atan(Math.exp(Math.PI-u*Math.PI*2))-.5*Math.PI,v=this._errorMeasurement.updateErrorLoop(u,m),S=$();v!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=v,this._errorMeasurementLastChangeTime=S);const M=Math.min(Math.max((S-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=o.bu(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,o.bv(M))}_getMeshKey(n){return`${n.granularity.toString(36)}_${n.generateBorders?"b":""}${n.extendToNorthPole?"n":""}${n.extendToSouthPole?"s":""}`}getMeshFromTileID(n,u,m,v,S){const M=(S==="stencil"?mh.stencil:mh.tile).getGranularityForZoomLevel(u.z);return this._getMesh(n,{granularity:M,generateBorders:m,extendToNorthPole:u.y===0&&v,extendToSouthPole:u.y===(1<<u.z)-1&&v})}_getMesh(n,u){const m=this._getMeshKey(u);if(m in this._tileMeshCache)return this._tileMeshCache[m];const v=function(S,M){const k=hu(M,"16bit"),O=o.aW.deserialize({arrayBuffer:k.vertices,length:k.vertices.byteLength/2/2}),B=o.aY.deserialize({arrayBuffer:k.indices,length:k.indices.byteLength/2/3});return new Mn(S.createVertexBuffer(O,ps.members),S.createIndexBuffer(B),o.aX.simpleSegment(0,0,O.length,B.length))}(n,u);return this._tileMeshCache[m]=v,v}recalculate(n){}hasTransition(){const n=$();let u=!1;return u=u||(n-this._errorMeasurementLastChangeTime)/1e3<.7,u=u||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,u}setErrorQueryLatitudeDegrees(n){this._errorQueryLatitudeDegrees=n}}const $f=new o.t({type:new o.D(o.u.projection.type)});class du extends o.E{constructor(n){super(),this._transitionable=new o.x($f,void 0),this.setProjection(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.H(0)),this._mercatorProjection=new Qi,this._verticalPerspectiveProjection=new gh}get transitionState(){const n=this.properties.get("type");if(typeof n=="string"&&n==="mercator")return 0;if(typeof n=="string"&&n==="vertical-perspective")return 1;if(n instanceof o.bw){if(n.from==="vertical-perspective"&&n.to==="mercator")return 1-n.transition;if(n.from==="mercator"&&n.to==="vertical-perspective")return n.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(n){this._mercatorProjection.updateGPUdependent(n),this._verticalPerspectiveProjection.updateGPUdependent(n)}getMeshFromTileID(n,u,m,v,S){return this.currentProjection.getMeshFromTileID(n,u,m,v,S)}setProjection(n){this._transitionable.setValue("type",n?.type||"mercator")}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}setErrorQueryLatitudeDegrees(n){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(n),this._mercatorProjection.setErrorQueryLatitudeDegrees(n)}}function eo(w){const n=lc(w.worldSize,w.center.lat);return 2*Math.PI*n}function Ls(w,n,u,m,v){const S=1/(1<<v),M=n/o.a5*S+m*S,k=o.by((w/o.a5*S+u*S)*Math.PI*2+Math.PI,2*Math.PI),O=2*Math.atan(Math.exp(Math.PI-M*Math.PI*2))-.5*Math.PI,B=Math.cos(O),q=new Float64Array(3);return q[0]=Math.sin(k)*B,q[1]=Math.sin(O),q[2]=Math.cos(k)*B,q}function ti(w){return function(n,u){const m=Math.cos(u),v=new Float64Array(3);return v[0]=Math.sin(n)*m,v[1]=Math.sin(u),v[2]=Math.cos(n)*m,v}(w.lng*Math.PI/180,w.lat*Math.PI/180)}function lc(w,n){return w/(2*Math.PI)/Math.cos(n*Math.PI/180)}function jf(w){const n=Math.asin(w[1])/Math.PI*180,u=Math.sqrt(w[0]*w[0]+w[2]*w[2]);if(u>1e-6){const m=w[0]/u,v=Math.acos(w[2]/u),S=(m>0?v:-v)/Math.PI*180;return new o.V(o.W(S,-180,180),n)}return new o.V(0,n)}function cc(w){return Math.cos(w*Math.PI/180)}function pi(w,n){const u=cc(w),m=cc(n);return o.at(m/u)}function fm(w,n){const u=w.rotate(n.bearingInRadians),m=n.zoom+pi(n.center.lat,0),v=o.bu(1/cc(n.center.lat),1/cc(Math.min(Math.abs(n.center.lat),60)),o.bx(m,7,3,0,1)),S=360/eo({worldSize:n.worldSize,center:{lat:n.center.lat}});return new o.V(n.center.lng-u.x*S*v,o.an(n.center.lat+u.y*S,-o.ao,o.ao))}function Nf(w){const n=.5*w,u=Math.sin(n),m=Math.cos(n);return Math.log(u+m)-Math.log(m-u)}function pm(w,n,u,m){const v=w.lat+u*m;if(Math.abs(u)>1){const S=(Math.sign(w.lat+u)!==Math.sign(w.lat)?-Math.abs(w.lat):Math.abs(w.lat))*Math.PI/180,M=Math.abs(w.lat+u)*Math.PI/180,k=Nf(S+m*(M-S)),O=Nf(S),B=Nf(M);return new o.V(w.lng+n*((k-O)/(B-O)),v)}return new o.V(w.lng+n*m,v)}class ny{constructor(n){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=n}swapBuffers(){if(!this._hadAnyChanges)return;const n=this._cachePrevious;this._cachePrevious=this._cache,this._cache=n,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(n,u,m,v){const S=`${n.z}_${n.x}_${n.y}_${v?.terrain?"t":""}`,M=this._cache.get(S);if(M)return M;const k=this._cachePrevious.get(S);if(k)return this._cache.set(S,k),k;const O=this._boundingVolumeFactory(n,u,m,v);return this._cache.set(S,O),this._hadAnyChanges=!0,O}}class uc{constructor(n,u,m,v){this.min=m,this.max=v,this.points=n,this.planes=u}static fromAabb(n,u){const m=[];for(let v=0;v<8;v++)m.push([1&~v?n[0]:u[0],(v>>1&1)==1?u[1]:n[1],(v>>2&1)==1?u[2]:n[2]]);return new uc(m,[[-1,0,0,u[0]],[1,0,0,-n[0]],[0,-1,0,u[1]],[0,1,0,-n[1]],[0,0,-1,u[2]],[0,0,1,-n[2]]],n,u)}static fromCenterSizeAngles(n,u,m){const v=o.bB([],m[0],m[1],m[2]),S=o.bC([],[u[0],0,0],v),M=o.bC([],[0,u[1],0],v),k=o.bC([],[0,0,u[2]],v),O=[...n],B=[...n];for(let Y=0;Y<8;Y++)for(let X=0;X<3;X++){const te=n[X]+S[X]*(1&~Y?-1:1)+M[X]*((Y>>1&1)==1?1:-1)+k[X]*((Y>>2&1)==1?1:-1);O[X]=Math.min(O[X],te),B[X]=Math.max(B[X],te)}const q=[];for(let Y=0;Y<8;Y++){const X=[...n];o.b0(X,X,o.a$([],S,1&~Y?-1:1)),o.b0(X,X,o.a$([],M,(Y>>1&1)==1?1:-1)),o.b0(X,X,o.a$([],k,(Y>>2&1)==1?1:-1)),q.push(X)}return new uc(q,[[...S,-o.b5(S,q[0])],[...M,-o.b5(M,q[0])],[...k,-o.b5(k,q[0])],[-S[0],-S[1],-S[2],-o.b5(S,q[7])],[-M[0],-M[1],-M[2],-o.b5(M,q[7])],[-k[0],-k[1],-k[2],-o.b5(k,q[7])]],O,B)}intersectsFrustum(n){let u=!0;const m=this.points.length,v=this.planes.length,S=n.planes.length,M=n.points.length;for(let k=0;k<S;k++){const O=n.planes[k];let B=0;for(let q=0;q<m;q++){const Y=this.points[q];O[0]*Y[0]+O[1]*Y[1]+O[2]*Y[2]+O[3]>=0&&B++}if(B===0)return 0;B<m&&(u=!1)}if(u)return 2;for(let k=0;k<v;k++){const O=this.planes[k];let B=0;for(let q=0;q<M;q++){const Y=n.points[q];O[0]*Y[0]+O[1]*Y[1]+O[2]*Y[2]+O[3]>=0&&B++}if(B===0)return 0}return 1}intersectsPlane(n){const u=this.points.length;let m=0;for(let v=0;v<u;v++){const S=this.points[v];n[0]*S[0]+n[1]*S[1]+n[2]*S[2]+n[3]>=0&&m++}return m===u?2:m===0?0:1}}function fd(w,n,u){const m=w-n;return m<0?-m:Math.max(0,m-u)}function fu(w,n,u,m,v){const S=w-u;let M;return M=S<0?Math.min(-S,1+S-v):S>1?Math.min(Math.max(S-v,0),1-S):0,Math.max(M,fd(n,m,v))}class Vf{constructor(){this._boundingVolumeCache=new ny(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(n,u,m,v){const S=1<<m.z,M=1/S,k=m.x/S,O=m.y/S;let B=2;return B=Math.min(B,fu(n,u,k,O,M)),B=Math.min(B,fu(n,u,k+.5,-O-M,M)),B=Math.min(B,fu(n,u,k+.5,2-O-M,M)),B}getWrap(n,u,m){const v=1<<u.z,S=1/v,M=u.x/v,k=fd(n.x,M,S),O=fd(n.x,M-1,S),B=fd(n.x,M+1,S),q=Math.min(k,O,B);return q===B?1:q===O?-1:0}allowVariableZoom(n,u){return Xr(n,u)>4}allowWorldCopies(){return!1}getTileBoundingVolume(n,u,m,v){return this._boundingVolumeCache.getTileBoundingVolume(n,u,m,v)}_computeTileBoundingVolume(n,u,m,v){var S,M;let k=0,O=0;if(v?.terrain){const B=new o.a2(n.z,u,n.z,n.x,n.y),q=v.terrain.getMinMaxElevation(B);k=(S=q.minElevation)!==null&&S!==void 0?S:Math.min(0,m),O=(M=q.maxElevation)!==null&&M!==void 0?M:Math.max(0,m)}if(k/=o.bE,O/=o.bE,k+=1,O+=1,n.z<=0)return uc.fromAabb([-O,-O,-O],[O,O,O]);if(n.z===1)return uc.fromAabb([n.x===0?-O:0,n.y===0?0:-O,-O],[n.x===0?0:O,n.y===0?O:0,O]);{const B=[Ls(0,0,n.x,n.y,n.z),Ls(o.a5,0,n.x,n.y,n.z),Ls(o.a5,o.a5,n.x,n.y,n.z),Ls(0,o.a5,n.x,n.y,n.z)],q=[];for(const st of B)q.push(o.a$([],st,O));if(O!==k)for(const st of B)q.push(o.a$([],st,k));n.y===0&&q.push([0,1,0]),n.y===(1<<n.z)-1&&q.push([0,-1,0]);const Y=[1,1,1],X=[-1,-1,-1];for(const st of q)for(let at=0;at<3;at++)Y[at]=Math.min(Y[at],st[at]),X[at]=Math.max(X[at],st[at]);const te=Ls(o.a5/2,o.a5/2,n.x,n.y,n.z),ce=o.b4([],[0,1,0],te);o.b3(ce,ce);const ge=o.b4([],te,ce);o.b3(ge,ge);const _e=o.b4([],B[2],B[1]);o.b3(_e,_e);const ve=o.b4([],B[0],B[3]);o.b3(ve,ve),q.push(o.a$([],te,O)),n.y>=(1<<n.z)/2&&q.push(o.a$([],Ls(o.a5/2,0,n.x,n.y,n.z),O)),n.y<(1<<n.z)/2&&q.push(o.a$([],Ls(o.a5/2,o.a5,n.x,n.y,n.z),O));const Se=yh(te,q),Oe=yh(ge,q),Ce=[-te[0],-te[1],-te[2],Se.max],De=[te[0],te[1],te[2],-Se.min],Be=[-ge[0],-ge[1],-ge[2],Oe.max],Ae=[ge[0],ge[1],ge[2],-Oe.min],Ue=[..._e,0],ut=[...ve,0],it=[];return n.y===0?it.push(o.bD(ut,Ue,Ce),o.bD(ut,Ue,De)):it.push(o.bD(Be,Ue,Ce),o.bD(Be,Ue,De),o.bD(Be,ut,Ce),o.bD(Be,ut,De)),n.y===(1<<n.z)-1?it.push(o.bD(ut,Ue,Ce),o.bD(ut,Ue,De)):it.push(o.bD(Ae,Ue,Ce),o.bD(Ae,Ue,De),o.bD(Ae,ut,Ce),o.bD(Ae,ut,De)),new uc(it,[Ce,De,Be,Ae,Ue,ut],Y,X)}}}function yh(w,n){let u=1/0,m=-1/0;for(const v of n){const S=o.b5(w,v);u=Math.min(u,S),m=Math.max(m,S)}return{min:u,max:m}}class wl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,u,m){return this._helper.interpolatePadding(n,u,m)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,u){this._helper.resize(n,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}setConstrainOverride(n){this._helper.setConstrainOverride(n)}overrideNearFarZ(n,u){this._helper.overrideNearFarZ(n,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(n){}constructor(n){this._cachedClippingPlane=o.bF(),this._projectionMatrix=o.bj(),this._globeViewProjMatrix32f=o.bi(),this._globeViewProjMatrixNoCorrection=o.bj(),this._globeViewProjMatrixNoCorrectionInverted=o.bj(),this._globeProjMatrixInverted=o.bj(),this._cameraPosition=o.bz(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(u,m)=>{const v=o.an(u.lat,-o.ao,o.ao),S=o.an(+m,this.minZoom+pi(0,v),this.maxZoom);return{center:new o.V(u.lng,v),zoom:S}},this.applyConstrain=(u,m)=>this._helper.applyConstrain(u,m),this._helper=new Ds({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(u,m)=>this.defaultConstrain(u,m)},n),this._coveringTilesDetailsProvider=new Vf}clone(){const n=new wl;return n.apply(this,!1),n}apply(n,u,m){this._globeLatitudeErrorCorrectionRadians=m||0,this._helper.apply(n,u)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const n=o.bz();return n[0]=this._cameraPosition[0],n[1]=this._cameraPosition[1],n[2]=this._cameraPosition[2],n}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(n){const{overscaledTileID:u,applyGlobeMatrix:m}=n,v=this._helper.getMercatorTileCoordinates(u);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:v,clippingPlane:this._cachedClippingPlane,projectionTransition:m?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(n){const u=this.pitchInRadians,m=this.cameraToCenterDistance/n,v=Math.sin(u)*m,S=Math.cos(u)*m+1,M=1/Math.sqrt(v*v+S*S)*1;let k=-v,O=S;const B=Math.sqrt(k*k+O*O);k/=B,O/=B;const q=[0,k,O];o.bG(q,q,[0,0,0],-this.bearingInRadians),o.bH(q,q,[0,0,0],-1*this.center.lat*Math.PI/180),o.bI(q,q,[0,0,0],this.center.lng*Math.PI/180);const Y=1/o.b7(q);return o.a$(q,q,Y),[...q,-M*Y]}isLocationOccluded(n){return!this.isSurfacePointVisible(ti(n))}transformLightDirection(n){const u=this._helper._center.lng*Math.PI/180,m=this._helper._center.lat*Math.PI/180,v=Math.cos(m),S=[Math.sin(u)*v,Math.sin(m),Math.cos(u)*v],M=[S[2],0,-S[0]],k=[0,0,0];o.b4(k,M,S),o.b3(M,M),o.b3(k,k);const O=[0,0,0];return o.b3(O,[M[0]*n[0]+k[0]*n[1]+S[0]*n[2],M[1]*n[0]+k[1]*n[1]+S[1]*n[2],M[2]*n[0]+k[2]*n[1]+S[2]*n[2]]),O}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(n,u,m){const v=function(k,O,B){const q=1/(1<<B.z);return new o.a9(k/o.a5*q+B.x*q,O/o.a5*q+B.y*q)}(n,u,m.canonical),S=(M=v.y,[o.by(v.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-M*Math.PI*2))-.5*Math.PI]);var M;return this.getCircleRadiusCorrection()/Math.cos(S[1])}projectTileCoordinates(n,u,m,v){const S=m.canonical,M=Ls(n,u,S.x,S.y,S.z),k=1+(v?v(n,u):0)/o.bE,O=[M[0]*k,M[1]*k,M[2]*k,1];o.aH(O,O,this._globeViewProjMatrixNoCorrection);const B=this._cachedClippingPlane,q=B[0]*M[0]+B[1]*M[1]+B[2]*M[2]+B[3]<0;return{point:new o.P(O[0]/O[3],O[1]/O[3]),signedDistanceFromCamera:O[3],isOccluded:q}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const n=lc(this.worldSize,this.center.lat),u=o.bk(),m=o.bk();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*n),o.be(u,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const v=this.centerOffset;u[8]=2*-v.x/this._helper._width,u[9]=2*v.y/this._helper._height,this._projectionMatrix=o.bf(u),this._globeProjMatrixInverted=o.bk(),o.aB(this._globeProjMatrixInverted,u),o.O(u,u,[0,0,-this.cameraToCenterDistance]),o.bg(u,u,this.rollInRadians),o.bh(u,u,-this.pitchInRadians),o.bg(u,u,this.bearingInRadians),o.O(u,u,[0,0,-n]);const S=o.bz();S[0]=n,S[1]=n,S[2]=n,o.bh(m,u,this.center.lat*Math.PI/180),o.bJ(m,m,-this.center.lng*Math.PI/180),o.Q(m,m,S),this._globeViewProjMatrixNoCorrection=m,o.bh(u,u,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),o.bJ(u,u,-this.center.lng*Math.PI/180),o.Q(u,u,S),this._globeViewProjMatrix32f=new Float32Array(u),this._globeViewProjMatrixNoCorrectionInverted=o.bk(),o.aB(this._globeViewProjMatrixNoCorrectionInverted,m);const M=o.bz();this._cameraPosition=o.bz(),this._cameraPosition[2]=this.cameraToCenterDistance/n,o.bG(this._cameraPosition,this._cameraPosition,M,-this.rollInRadians),o.bH(this._cameraPosition,this._cameraPosition,M,this.pitchInRadians),o.bG(this._cameraPosition,this._cameraPosition,M,-this.bearingInRadians),o.b0(this._cameraPosition,this._cameraPosition,[0,0,1]),o.bH(this._cameraPosition,this._cameraPosition,M,-this.center.lat*Math.PI/180),o.bI(this._cameraPosition,this._cameraPosition,M,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(n);const k=o.bf(this._globeViewProjMatrixNoCorrectionInverted);o.Q(k,k,[1,1,-1]),this._cachedFrustum=qo.fromInvProjectionMatrix(k,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(n){o.w("calculateFogMatrix is not supported on globe projection.");const u=o.bk();return o.ar(u),u}getVisibleUnwrappedCoordinates(n){return[new o.bc(0,n)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(n){n&&o.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(n,u){if(!this._globeViewProjMatrixNoCorrection)return 1;const m=ti(n);o.a$(m,m,1+u/o.bE);const v=o.bF();return o.aH(v,[m[0],m[1],m[2],1],this._globeViewProjMatrixNoCorrection),v[2]/v[3]}populateCache(n){}getBounds(){const n=.5*this.width,u=.5*this.height,m=[new o.P(0,0),new o.P(n,0),new o.P(this.width,0),new o.P(this.width,u),new o.P(this.width,this.height),new o.P(n,this.height),new o.P(0,this.height),new o.P(0,u)],v=[];for(const Y of m)v.push(this.unprojectScreenPoint(Y));let S=0,M=0,k=0,O=0;const B=this.center;for(const Y of v){const X=o.bK(B.lng,Y.lng),te=o.bK(B.lat,Y.lat);X<M&&(M=X),X>S&&(S=X),te<O&&(O=te),te>k&&(k=te)}const q=[B.lng+M,B.lat+O,B.lng+S,B.lat+k];return this.isSurfacePointOnScreen([0,1,0])&&(q[3]=90,q[0]=-180,q[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(q[1]=-90,q[0]=-180,q[2]=180),new yr(q)}calculateCenterFromCameraLngLatAlt(n,u,m,v){return this._helper.calculateCenterFromCameraLngLatAlt(n,u,m,v)}setLocationAtPoint(n,u){const m=ti(this.unprojectScreenPoint(u)),v=ti(n),S=o.bz();o.bL(S);const M=o.bz();o.bI(M,m,S,-this.center.lng*Math.PI/180),o.bH(M,M,S,this.center.lat*Math.PI/180);const k=v[0]*v[0]+v[2]*v[2],O=M[0]*M[0];if(k<O)return;const B=Math.sqrt(k-O),q=-B,Y=o.bM(v[0],v[2],M[0],B),X=o.bM(v[0],v[2],M[0],q),te=o.bz();o.bI(te,v,S,-Y);const ce=o.bM(te[1],te[2],M[1],M[2]),ge=o.bz();o.bI(ge,v,S,-X);const _e=o.bM(ge[1],ge[2],M[1],M[2]),ve=.5*Math.PI,Se=ce>=-ve&&ce<=ve,Oe=_e>=-ve&&_e<=ve;let Ce,De;if(Se&&Oe){const ut=this.center.lng*Math.PI/180,it=this.center.lat*Math.PI/180;o.bN(Y,ut)+o.bN(ce,it)<o.bN(X,ut)+o.bN(_e,it)?(Ce=Y,De=ce):(Ce=X,De=_e)}else if(Se)Ce=Y,De=ce;else{if(!Oe)return;Ce=X,De=_e}const Be=Ce/Math.PI*180,Ae=De/Math.PI*180,Ue=this.center.lat;this.setCenter(new o.V(Be,o.an(Ae,-90,90))),this.setZoom(this.zoom+pi(Ue,this.center.lat))}locationToScreenPoint(n,u){const m=ti(n);if(u){const v=u.getElevationForLngLatZoom(n,this._helper._tileZoom);o.a$(m,m,1+v/o.bE)}return this._projectSurfacePointToScreen(m)}_projectSurfacePointToScreen(n){const u=o.bF();return o.aH(u,[...n,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],new o.P((.5*u[0]+.5)*this.width,(.5*-u[1]+.5)*this.height)}screenPointToMercatorCoordinate(n,u){if(u){const m=u.pointCoordinate(n);if(m)return m}return o.a9.fromLngLat(this.unprojectScreenPoint(n))}screenPointToLocation(n,u){var m;return(m=this.screenPointToMercatorCoordinate(n,u))===null||m===void 0?void 0:m.toLngLat()}isPointOnMapSurface(n,u){const m=this._cameraPosition,v=this.getRayDirectionFromPixel(n);return!!this.rayPlanetIntersection(m,v)}getRayDirectionFromPixel(n){const u=o.bF();u[0]=n.x/this.width*2-1,u[1]=-1*(n.y/this.height*2-1),u[2]=1,u[3]=1,o.aH(u,u,this._globeViewProjMatrixNoCorrectionInverted),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3];const m=o.bz();m[0]=u[0]-this._cameraPosition[0],m[1]=u[1]-this._cameraPosition[1],m[2]=u[2]-this._cameraPosition[2];const v=o.bz();return o.b3(v,m),v}isSurfacePointVisible(n){const u=this._cachedClippingPlane;return u[0]*n[0]+u[1]*n[1]+u[2]*n[2]+u[3]>=0}isSurfacePointOnScreen(n){if(!this.isSurfacePointVisible(n))return!1;const u=o.bF();return o.aH(u,[...n,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3],u[0]>-1&&u[0]<1&&u[1]>-1&&u[1]<1&&u[2]>-1&&u[2]<1}rayPlanetIntersection(n,u){const m=o.b5(n,u),v=o.bz(),S=o.bz();o.a$(S,u,m),o.b2(v,n,S);const M=1-o.b5(v,v);if(M<0)return null;const k=o.b5(n,n)-1,O=-m+(m<0?1:-1)*Math.sqrt(M),B=k/O,q=O;return{tMin:Math.min(B,q),tMax:Math.max(B,q)}}unprojectScreenPoint(n){const u=this._cameraPosition,m=this.getRayDirectionFromPixel(n),v=this.rayPlanetIntersection(u,m);if(v){const q=o.bz();o.b0(q,u,[m[0]*v.tMin,m[1]*v.tMin,m[2]*v.tMin]);const Y=o.bz();return o.b3(Y,q),jf(Y)}const S=this._cachedClippingPlane,M=S[0]*m[0]+S[1]*m[1]+S[2]*m[2],k=-o.bb(S,u)/M,O=o.bz();if(k>0)o.b0(O,u,[m[0]*k,m[1]*k,m[2]*k]);else{const q=o.bz();o.b0(q,u,[2*m[0],2*m[1],2*m[2]]);const Y=o.bb(this._cachedClippingPlane,q);o.b2(O,q,[this._cachedClippingPlane[0]*Y,this._cachedClippingPlane[1]*Y,this._cachedClippingPlane[2]*Y])}const B=function(q){const Y=o.bz();return Y[0]=q[0]*-q[3],Y[1]=q[1]*-q[3],Y[2]=q[2]*-q[3],{center:Y,radius:Math.sqrt(1-q[3]*q[3])}}(S);return jf(function(q,Y,X){const te=o.bz();o.b2(te,X,q);const ce=o.bz();return o.bA(ce,q,te,Y/o.b9(te)),ce}(B.center,B.radius,O))}getMatrixForModel(n,u){const m=o.V.convert(n),v=1/o.bE,S=o.bj();return o.bJ(S,S,m.lng/180*Math.PI),o.bh(S,S,-m.lat/180*Math.PI),o.O(S,S,[0,0,1+u/o.bE]),o.bh(S,S,.5*Math.PI),o.Q(S,S,[v,v,v]),S}getProjectionDataForCustomLayer(n=!0){const u=this.getProjectionData({overscaledTileID:new o.a2(0,0,0,0,0),applyGlobeMatrix:n});return u.tileMercatorCoords=[0,0,1,1],u}getFastPathSimpleProjectionMatrix(n){}}class pu{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,u,m){return this._helper.interpolatePadding(n,u,m)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,u,m=!0){this._helper.resize(n,u,m)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}setConstrainOverride(n){this._helper.setConstrainOverride(n)}overrideNearFarZ(n,u){this._helper.overrideNearFarZ(n,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(n,u){this._globeness=n,this._globeLatitudeErrorCorrectionRadians=u,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(n){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(u,m)=>this.currentTransform.defaultConstrain(u,m),this.applyConstrain=(u,m)=>this._helper.applyConstrain(u,m),this._helper=new Ds({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(u,m)=>this.defaultConstrain(u,m)},n),this._globeness=1,this._mercatorTransform=new ac,this._verticalPerspectiveTransform=new wl}clone(){const n=new pu;return n._globeness=this._globeness,n._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,n.apply(this,!1),n}apply(n,u){this._helper.apply(n,u),this._mercatorTransform.apply(this,!1),this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(n){const u=this._mercatorTransform.getProjectionData(n),m=this._verticalPerspectiveTransform.getProjectionData(n);return{mainMatrix:this.isGlobeRendering?m.mainMatrix:u.mainMatrix,clippingPlane:m.clippingPlane,tileMercatorCoords:m.tileMercatorCoords,projectionTransition:n.applyGlobeMatrix?this._globeness:0,fallbackMatrix:u.fallbackMatrix}}isLocationOccluded(n){return this.currentTransform.isLocationOccluded(n)}transformLightDirection(n){return this.currentTransform.transformLightDirection(n)}getPixelScale(){return o.bu(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return o.bu(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(n,u,m){const v=this._mercatorTransform.getPitchedTextCorrection(n,u,m),S=this._verticalPerspectiveTransform.getPitchedTextCorrection(n,u,m);return o.bu(v,S,this._globeness)}projectTileCoordinates(n,u,m,v){return this.currentTransform.projectTileCoordinates(n,u,m,v)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(n){return this.currentTransform.calculateFogMatrix(n)}getVisibleUnwrappedCoordinates(n){return this.currentTransform.getVisibleUnwrappedCoordinates(n)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(n){this._mercatorTransform.recalculateZoomAndCenter(n),this._verticalPerspectiveTransform.recalculateZoomAndCenter(n)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(n,u){return this.currentTransform.lngLatToCameraDepth(n,u)}populateCache(n){this._mercatorTransform.populateCache(n),this._verticalPerspectiveTransform.populateCache(n)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(n,u,m,v){return this._helper.calculateCenterFromCameraLngLatAlt(n,u,m,v)}setLocationAtPoint(n,u){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(n,u),void this.apply(this._mercatorTransform,!1);this._verticalPerspectiveTransform.setLocationAtPoint(n,u),this.apply(this._verticalPerspectiveTransform,!1)}locationToScreenPoint(n,u){return this.currentTransform.locationToScreenPoint(n,u)}screenPointToMercatorCoordinate(n,u){return this.currentTransform.screenPointToMercatorCoordinate(n,u)}screenPointToLocation(n,u){return this.currentTransform.screenPointToLocation(n,u)}isPointOnMapSurface(n,u){return this.currentTransform.isPointOnMapSurface(n,u)}getRayDirectionFromPixel(n){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(n)}getMatrixForModel(n,u){return this.currentTransform.getMatrixForModel(n,u)}getProjectionDataForCustomLayer(n=!0){const u=this._mercatorTransform.getProjectionDataForCustomLayer(n);if(!this.isGlobeRendering)return u;const m=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(n);return m.fallbackMatrix=u.mainMatrix,m}getFastPathSimpleProjectionMatrix(n){return this.currentTransform.getFastPathSimpleProjectionMatrix(n)}}class Li{get useGlobeControls(){return!0}handlePanInertia(n,u){const m=fm(n,u);return Math.abs(m.lng-u.center.lng)>180&&(m.lng=u.center.lng+179.5*Math.sign(m.lng-u.center.lng)),{easingCenter:m,easingOffset:new o.P(0,0)}}handleMapControlsRollPitchBearingZoom(n,u){const m=n.around,v=u.screenPointToLocation(m);n.bearingDelta&&u.setBearing(u.bearing+n.bearingDelta),n.pitchDelta&&u.setPitch(u.pitch+n.pitchDelta),n.rollDelta&&u.setRoll(u.roll+n.rollDelta);const S=u.zoom;n.zoomDelta&&u.setZoom(u.zoom+n.zoomDelta);const M=u.zoom-S;if(M===0)return;const k=o.bK(u.center.lng,v.lng),O=k/(Math.abs(k/180)+1),B=o.bK(u.center.lat,v.lat),q=u.getRayDirectionFromPixel(m),Y=u.cameraPosition,X=-1*o.b5(Y,q),te=o.bz();o.b0(te,Y,[q[0]*X,q[1]*X,q[2]*X]);const ce=o.b7(te)-1,ge=Math.exp(.5*-Math.max(ce-.3,0)),_e=lc(u.worldSize,u.center.lat)/Math.min(u.width,u.height),ve=o.bx(_e,.9,.5,1,.25),Se=(1-o.aq(-M))*Math.min(ge,ve),Oe=u.center.lat,Ce=u.zoom,De=new o.V(u.center.lng+O*Se,o.an(u.center.lat+B*Se,-o.ao,o.ao));u.setLocationAtPoint(v,m);const Be=u.center,Ae=o.bx(Math.abs(k),45,85,0,1),Ue=o.bx(_e,.75,.35,0,1),ut=Math.pow(Math.max(Ae,Ue),.25),it=o.bK(Be.lng,De.lng),st=o.bK(Be.lat,De.lat);u.setCenter(new o.V(Be.lng+it*ut,Be.lat+st*ut).wrap()),u.setZoom(Ce+pi(Oe,u.center.lat))}handleMapControlsPan(n,u,m){if(!n.panDelta)return;const v=u.center.lat,S=u.zoom;u.setCenter(fm(n.panDelta,u).wrap()),u.setZoom(S+pi(v,u.center.lat))}cameraForBoxAndBearing(n,u,m,v,S){const M=ph(n,u,m,v,S),k=u.left/S.width*2-1,O=(S.width-u.right)/S.width*2-1,B=u.top/S.height*-2+1,q=(S.height-u.bottom)/S.height*-2+1,Y=o.bK(m.getWest(),m.getEast())<0,X=Y?m.getEast():m.getWest(),te=Y?m.getWest():m.getEast(),ce=Math.max(m.getNorth(),m.getSouth()),ge=Math.min(m.getNorth(),m.getSouth()),_e=X+.5*o.bK(X,te),ve=ce+.5*o.bK(ce,ge),Se=S.clone();Se.setCenter(M.center),Se.setBearing(M.bearing),Se.setPitch(0),Se.setRoll(0),Se.setZoom(M.zoom);const Oe=Se.modelViewProjectionMatrix,Ce=[ti(m.getNorthWest()),ti(m.getNorthEast()),ti(m.getSouthWest()),ti(m.getSouthEast()),ti(new o.V(te,ve)),ti(new o.V(X,ve)),ti(new o.V(_e,ce)),ti(new o.V(_e,ge))],De=ti(M.center);let Be=Number.POSITIVE_INFINITY;for(const Ae of Ce)k<0&&(Be=Li.getLesserNonNegativeNonNull(Be,Li.solveVectorScale(Ae,De,Oe,"x",k))),O>0&&(Be=Li.getLesserNonNegativeNonNull(Be,Li.solveVectorScale(Ae,De,Oe,"x",O))),B>0&&(Be=Li.getLesserNonNegativeNonNull(Be,Li.solveVectorScale(Ae,De,Oe,"y",B))),q<0&&(Be=Li.getLesserNonNegativeNonNull(Be,Li.solveVectorScale(Ae,De,Oe,"y",q)));if(Number.isFinite(Be)&&Be!==0)return M.zoom=Se.zoom+o.at(Be),M;zs()}handleJumpToCenterZoom(n,u){const m=n.center.lat,v=n.applyConstrain(u.center?o.V.convert(u.center):n.center,n.zoom).center;n.setCenter(v.wrap());const S=u.zoom!==void 0?+u.zoom:n.zoom+pi(m,v.lat);n.zoom!==S&&n.setZoom(S)}handleEaseTo(n,u){const m=n.zoom,v=n.center,S=n.padding,M={roll:n.roll,pitch:n.pitch,bearing:n.bearing},k={roll:u.roll===void 0?n.roll:u.roll,pitch:u.pitch===void 0?n.pitch:u.pitch,bearing:u.bearing===void 0?n.bearing:u.bearing},O=u.zoom!==void 0,B=!n.isPaddingEqual(u.padding);let q=!1;const Y=u.center?o.V.convert(u.center):v,X=n.applyConstrain(Y,m).center;_l(n,X);const te=n.clone();te.setCenter(X),te.setZoom(O?+u.zoom:m+pi(v.lat,Y.lat)),te.setBearing(u.bearing);const ce=new o.P(o.an(n.centerPoint.x+u.offsetAsPoint.x,0,n.width),o.an(n.centerPoint.y+u.offsetAsPoint.y,0,n.height));te.setLocationAtPoint(X,ce);const ge=(u.offset&&u.offsetAsPoint.mag())>0?te.center:X,_e=O?+u.zoom:m+pi(v.lat,ge.lat),ve=m+pi(v.lat,0),Se=_e+pi(ge.lat,0),Oe=o.bK(v.lng,ge.lng),Ce=o.bK(v.lat,ge.lat),De=o.aq(Se-ve);return q=_e!==m,{easeFunc:Be=>{if(o.bo(M,k)||fh({startEulerAngles:M,endEulerAngles:k,tr:n,k:Be,useSlerp:M.roll!=k.roll}),B&&n.interpolatePadding(S,u.padding,Be),u.around)o.w("Easing around a point is not supported under globe projection."),n.setLocationAtPoint(u.around,u.aroundPoint);else{const Ae=Se>ve?Math.min(2,De):Math.max(.5,De),Ue=Math.pow(Ae,1-Be),ut=pm(v,Oe,Ce,Be*Ue);n.setCenter(ut.wrap())}if(q){const Ae=o.G.number(ve,Se,Be)+pi(0,n.center.lat);n.setZoom(Ae)}},isZooming:q,elevationCenter:ge}}handleFlyTo(n,u){const m=u.zoom!==void 0,v=n.center,S=n.zoom,M=n.padding,k=!n.isPaddingEqual(u.padding),O=n.applyConstrain(o.V.convert(u.center||u.locationAtOffset),S).center,B=m?+u.zoom:n.zoom+pi(n.center.lat,O.lat),q=n.clone();q.setCenter(O),q.setZoom(B),q.setBearing(u.bearing);const Y=new o.P(o.an(n.centerPoint.x+u.offsetAsPoint.x,0,n.width),o.an(n.centerPoint.y+u.offsetAsPoint.y,0,n.height));q.setLocationAtPoint(O,Y);const X=q.center;_l(n,X);const te=function(Ce,De,Be){const Ae=ti(De),Ue=ti(Be),ut=o.b5(Ae,Ue),it=Math.acos(ut),st=eo(Ce);return it/(2*Math.PI)*st}(n,v,X),ce=S+pi(v.lat,0),ge=B+pi(X.lat,0),_e=o.aq(ge-ce);let ve;if(typeof u.minZoom=="number"){const Ce=+u.minZoom+pi(X.lat,0),De=Math.min(Ce,ce,ge)+pi(0,X.lat),Be=n.applyConstrain(X,De).zoom+pi(X.lat,0);ve=o.aq(Be-ce)}const Se=o.bK(v.lng,X.lng),Oe=o.bK(v.lat,X.lat);return{easeFunc:(Ce,De,Be,Ae)=>{const Ue=pm(v,Se,Oe,Be);k&&n.interpolatePadding(M,u.padding,Ce);const ut=Ce===1?X:Ue;n.setCenter(ut.wrap());const it=ce+o.at(De);n.setZoom(Ce===1?B:it+pi(0,ut.lat))},scaleOfZoom:_e,targetCenter:X,scaleOfMinZoom:ve,pixelPathLength:te}}static solveVectorScale(n,u,m,v,S){const M=v==="x"?[m[0],m[4],m[8],m[12]]:[m[1],m[5],m[9],m[13]],k=[m[3],m[7],m[11],m[15]],O=n[0]*M[0]+n[1]*M[1]+n[2]*M[2],B=n[0]*k[0]+n[1]*k[1]+n[2]*k[2],q=u[0]*M[0]+u[1]*M[1]+u[2]*M[2],Y=u[0]*k[0]+u[1]*k[1]+u[2]*k[2];return q+S*B===O+S*Y||k[3]*(O-q)+M[3]*(Y-B)+O*Y==q*B?null:(q+M[3]-S*Y-S*k[3])/(q-O-S*Y+S*B)}static getLesserNonNegativeNonNull(n,u){return u!==null&&u>=0&&u<n?u:n}}class mm{constructor(n){this._globe=n,this._mercatorCameraHelper=new xl,this._verticalPerspectiveCameraHelper=new Li}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(n,u){return this.currentHelper.handlePanInertia(n,u)}handleMapControlsRollPitchBearingZoom(n,u){return this.currentHelper.handleMapControlsRollPitchBearingZoom(n,u)}handleMapControlsPan(n,u,m){this.currentHelper.handleMapControlsPan(n,u,m)}cameraForBoxAndBearing(n,u,m,v,S){return this.currentHelper.cameraForBoxAndBearing(n,u,m,v,S)}handleJumpToCenterZoom(n,u){this.currentHelper.handleJumpToCenterZoom(n,u)}handleEaseTo(n,u){return this.currentHelper.handleEaseTo(n,u)}handleFlyTo(n,u){return this.currentHelper.handleFlyTo(n,u)}}const hc=(w,n)=>o.B(w,n&&n.filter(u=>u.identifier!=="source.canvas")),vh=o.bO();class dc extends o.E{constructor(n,u={}){var m,v;super(),this._rtlPluginLoaded=()=>{for(const M in this.tileManagers){const k=this.tileManagers[M].getSource().type;k!=="vector"&&k!=="geojson"||this.tileManagers[M].reload()}},this.map=n,this.dispatcher=new It(At(),n._getMapId()),this.dispatcher.registerMessageHandler("GG",(M,k)=>this.getGlyphs(M,k)),this.dispatcher.registerMessageHandler("GI",(M,k)=>this.getImages(M,k)),this.dispatcher.registerMessageHandler("GDA",(M,k)=>this.getDashes(M,k)),this.imageManager=new Ge,this.imageManager.setEventedParent(this);const S=((m=n._container)===null||m===void 0?void 0:m.lang)||typeof document<"u"&&((v=document.documentElement)===null||v===void 0?void 0:v.lang)||void 0;this.glyphManager=new Qe(n._requestManager,u.localIdeographFontFamily,S),this.lineAtlas=new ft(256,512),this.crossTileSymbolIndex=new Ji,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",o.bP()),Xe().on(Pe,this._rtlPluginLoaded),this.on("data",M=>{if(M.dataType!=="source"||M.sourceDataType!=="metadata")return;const k=this.tileManagers[M.sourceId];if(!k)return;const O=k.getSource();if(O&&O.vectorLayerIds)for(const B in this._layers){const q=this._layers[B];q.source===O.id&&this._validateLayer(q)}})}_setInitialValues(){var n;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new o.bQ,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new(((n=this.crossTileSymbolIndex)===null||n===void 0?void 0:n.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(n,u){var m,v,S;this._checkLoaded();const M=u===null?(S=(v=(m=this.stylesheet.state)===null||m===void 0?void 0:m[n])===null||v===void 0?void 0:v.default)!==null&&S!==void 0?S:null:u;if(o.bR(M,this._globalState[n]))return this;this._globalState[n]=M,this._applyGlobalStateChanges([n])}getGlobalState(){return this._globalState}setGlobalState(n){this._checkLoaded();const u=[];for(const m in n)!o.bR(this._globalState[m],n[m].default)&&(u.push(m),this._globalState[m]=n[m].default);this._applyGlobalStateChanges(u)}_applyGlobalStateChanges(n){if(n.length===0)return;const u=new Set,m={};for(const v of n){m[v]=this._globalState[v];for(const S in this._layers){const M=this._layers[S],k=M.getLayoutAffectingGlobalStateRefs(),O=M.getPaintAffectingGlobalStateRefs(),B=M.getVisibilityAffectingGlobalStateRefs();if(k.has(v)&&u.add(M.source),O.has(v))for(const{name:q,value:Y}of O.get(v))this._updatePaintProperty(M,q,Y);B?.has(v)&&(M.recalculateVisibility(),this._updateLayer(M))}}this.dispatcher.broadcast("UGS",m);for(const v in this.tileManagers)u.has(v)&&(this._reloadSource(v),this._changed=!0)}loadURL(n,u={},m){this.fire(new o.l("dataloading",{dataType:"style"})),u.validate=typeof u.validate!="boolean"||u.validate;const v=this.map._requestManager.transformRequest(n,"Style");this._loadStyleRequest=new AbortController;const S=this._loadStyleRequest;o.j(v,this._loadStyleRequest).then(M=>{this._loadStyleRequest=null,this._load(M.data,u,m)}).catch(M=>{this._loadStyleRequest=null,M&&!S.signal.aborted&&this.fire(new o.k(M))})}loadJSON(n,u={},m){this.fire(new o.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,F.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,u.validate=u.validate!==!1,this._load(n,u,m)}).catch(()=>{})}loadEmpty(){this.fire(new o.l("dataloading",{dataType:"style"})),this._load(vh,{validate:!1})}_load(n,u,m){var v,S;let M=u.transformStyle?u.transformStyle(m,n):n;if(!u.validate||!hc(this,o.C(M))){M=Object.assign({},M),this._loaded=!0,this.stylesheet=M;for(const k in M.sources)this.addSource(k,M.sources[k],{validate:!1});M.sprite?this._loadSprite(M.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(M.glyphs),this._createLayers(),this.light=new ct(this.stylesheet.light),this._setProjectionInternal(((v=this.stylesheet.projection)===null||v===void 0?void 0:v.type)||"mercator"),this.sky=new ze(this.stylesheet.sky),this.map.setTerrain((S=this.stylesheet.terrain)!==null&&S!==void 0?S:null),this.fire(new o.l("data",{dataType:"style"})),this.fire(new o.l("style.load"))}}_createLayers(){var n,u,m;const v=o.bS(this.stylesheet.layers);this.setGlobalState((n=this.stylesheet.state)!==null&&n!==void 0?n:null),this.dispatcher.broadcast("SL",v),this._order=v.map(S=>S.id),this._layers={},this._serializedLayers=null;for(const S of v){const M=o.bT(S,this._globalState);if(M.setEventedParent(this,{layer:{id:S.id}}),this._layers[S.id]=M,o.bU(M)&&this.tileManagers[M.source]){const k=(m=(u=S.paint)===null||u===void 0?void 0:u["raster-fade-duration"])!==null&&m!==void 0?m:M.paint.get("raster-fade-duration");this.tileManagers[M.source].setRasterFadeDuration(k)}}}_loadSprite(n,u=!1,m=void 0){this.imageManager.setLoaded(!1);const v=new AbortController;let S;this._spriteRequest=v,function(M,k,O,B){return o._(this,void 0,void 0,function*(){const q=Ee(M),Y=O>1?"@2x":"",X={},te={};for(const{id:ce,url:ge}of q){const _e=k.transformRequest(re(ge,Y,".json"),"SpriteJSON");X[ce]=o.j(_e,B);const ve=k.transformRequest(re(ge,Y,".png"),"SpriteImage");te[ce]=xe.getImage(ve,B)}return yield Promise.all([...Object.values(X),...Object.values(te)]),function(ce,ge){return o._(this,void 0,void 0,function*(){const _e={};for(const ve in ce){_e[ve]={};const Se=F.getImageCanvasContext((yield ge[ve]).data),Oe=(yield ce[ve]).data;for(const Ce in Oe){const{width:De,height:Be,x:Ae,y:Ue,sdf:ut,pixelRatio:it,stretchX:st,stretchY:at,content:Rt,textFitWidth:Dt,textFitHeight:Tt}=Oe[Ce];_e[ve][Ce]={data:null,pixelRatio:it,sdf:ut,stretchX:st,stretchY:at,content:Rt,textFitWidth:Dt,textFitHeight:Tt,spriteData:{width:De,height:Be,x:Ae,y:Ue,context:Se}}}}return _e})}(X,te)})}(n,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(M=>{if(this._spriteRequest=null,M)for(const k in M){this._spritesImagesIds[k]=[];const O=this._spritesImagesIds[k]?this._spritesImagesIds[k].filter(B=>!(B in M)):[];for(const B of O)this.imageManager.removeImage(B),this._changedImages[B]=!0;for(const B in M[k]){const q=k==="default"?B:`${k}:${B}`;this._spritesImagesIds[k].push(q),q in this.imageManager.images?this.imageManager.updateImage(q,M[k][B],!1):this.imageManager.addImage(q,M[k][B]),u&&(this._changedImages[q]=!0)}}}).catch(M=>{this._spriteRequest=null,S=M,v.signal.aborted||this.fire(new o.k(S))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"})),m&&m(S)})}_unloadSprite(){for(const n of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(n),this._changedImages[n]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}_validateLayer(n){const u=this.tileManagers[n.source];if(!u)return;const m=n.sourceLayer;if(!m)return;const v=u.getSource();(v.type==="geojson"||v.vectorLayerIds&&v.vectorLayerIds.indexOf(m)===-1)&&this.fire(new o.k(new Error(`Source layer "${m}" does not exist on source "${v.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.tileManagers)if(!this.tileManagers[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(n,u=!1){const m=this._serializedAllLayers();if(!n||n.length===0)return Object.values(u?o.bV(m):m);const v=[];for(const S of n)if(m[S]){const M=u?o.bV(m[S]):m[S];v.push(M)}return v}_serializedAllLayers(){let n=this._serializedLayers;if(n)return n;n=this._serializedLayers={};const u=Object.keys(this._layers);for(const m of u){const v=this._layers[m];v.type!=="custom"&&(n[m]=v.serialize())}return n}hasTransitions(){var n,u,m;if(!((n=this.light)===null||n===void 0)&&n.hasTransition()||!((u=this.sky)===null||u===void 0)&&u.hasTransition()||!((m=this.projection)===null||m===void 0)&&m.hasTransition())return!0;for(const v in this.tileManagers)if(this.tileManagers[v].hasTransition())return!0;for(const v in this._layers)if(this._layers[v].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const u=this._changed;if(u){const v=Object.keys(this._updatedLayers),S=Object.keys(this._removedLayers);(v.length||S.length)&&this._updateWorkerLayers(v,S);for(const M in this._updatedSources){const k=this._updatedSources[M];if(k==="reload")this._reloadSource(M);else{if(k!=="clear")throw new Error(`Invalid action ${k}`);this._clearSource(M)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const M in this._updatedPaintProps)this._layers[M].updateTransitions(n);this.light.updateTransitions(n),this.sky.updateTransitions(n),this._resetUpdates()}const m={};for(const v in this.tileManagers){const S=this.tileManagers[v];m[v]=S.used,S.used=!1}for(const v of this._order){const S=this._layers[v];S.recalculate(n,this._availableImages),!S.isHidden(n.zoom)&&S.source&&(this.tileManagers[S.source].used=!0)}for(const v in m){const S=this.tileManagers[v];!!m[v]!=!!S.used&&S.fire(new o.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:v}))}this.light.recalculate(n),this.sky.recalculate(n),this.projection.recalculate(n),this.z=n.zoom,u&&this.fire(new o.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const u in this.tileManagers)this.tileManagers[u].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const n in this.tileManagers)this.tileManagers[n].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(n,u){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(n,!1),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(n,u={}){var m;this._checkLoaded();const v=this.serialize();if(n=u.transformStyle?u.transformStyle(v,n):n,((m=u.validate)===null||m===void 0||m)&&hc(this,o.C(n)))return!1;(n=o.bV(n)).layers=o.bS(n.layers);const S=o.bW(v,n),M=this._getOperationsToPerform(S);if(M.unimplemented.length>0)throw new Error(`Unimplemented: ${M.unimplemented.join(", ")}.`);if(M.operations.length===0)return!1;for(const k of M.operations)k();return this.stylesheet=n,this._serializedLayers=null,this.fire(new o.l("style.load",{style:this})),!0}_getOperationsToPerform(n){const u=[],m=[];for(const v of n)switch(v.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":u.push(()=>this.addLayer.apply(this,v.args));break;case"removeLayer":u.push(()=>this.removeLayer.apply(this,v.args));break;case"setPaintProperty":u.push(()=>this.setPaintProperty.apply(this,v.args));break;case"setLayoutProperty":u.push(()=>this.setLayoutProperty.apply(this,v.args));break;case"setFilter":u.push(()=>this.setFilter.apply(this,v.args));break;case"addSource":u.push(()=>this.addSource.apply(this,v.args));break;case"removeSource":u.push(()=>this.removeSource.apply(this,v.args));break;case"setLayerZoomRange":u.push(()=>this.setLayerZoomRange.apply(this,v.args));break;case"setLight":u.push(()=>this.setLight.apply(this,v.args));break;case"setGeoJSONSourceData":u.push(()=>this.setGeoJSONSourceData.apply(this,v.args));break;case"setGlyphs":u.push(()=>this.setGlyphs.apply(this,v.args));break;case"setSprite":u.push(()=>this.setSprite.apply(this,v.args));break;case"setTerrain":u.push(()=>this.map.setTerrain.apply(this,v.args));break;case"setSky":u.push(()=>this.setSky.apply(this,v.args));break;case"setProjection":this.setProjection.apply(this,v.args);break;case"setGlobalState":u.push(()=>this.setGlobalState.apply(this,v.args));break;case"setTransition":u.push(()=>{});break;default:m.push(v.command)}return{operations:u,unimplemented:m}}addImage(n,u){if(this.getImage(n))return this.fire(new o.k(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,u),this._afterImageUpdated(n)}updateImage(n,u){this.imageManager.updateImage(n,u)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new o.k(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,u,m={}){if(this._checkLoaded(),this.tileManagers[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(o.C.source,`sources.${n}`,u,null,m))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const v=this.tileManagers[n]=new Ki(n,u,this.dispatcher);v.style=this,v.setEventedParent(this,()=>({isSourceLoaded:v.loaded(),source:v.serialize(),sourceId:n})),v.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.tileManagers[n]===void 0)throw new Error("There is no source with this ID");for(const m in this._layers)if(this._layers[m].source===n)return this.fire(new o.k(new Error(`Source "${n}" cannot be removed while layer "${m}" is using it.`)));const u=this.tileManagers[n];delete this.tileManagers[n],delete this._updatedSources[n],u.fire(new o.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,u){if(this._checkLoaded(),this.tileManagers[n]===void 0)throw new Error(`There is no source with this ID=${n}`);const m=this.tileManagers[n].getSource();if(m.type!=="geojson")throw new Error(`geojsonSource.type is ${m.type}, which is !== 'geojson`);m.setData(u),this._changed=!0}getSource(n){return this.tileManagers[n]&&this.tileManagers[n].getSource()}addLayer(n,u,m={}){this._checkLoaded();const v=n.id;if(this.getLayer(v))return void this.fire(new o.k(new Error(`Layer "${v}" already exists on this map.`)));let S;if(n.type==="custom"){if(hc(this,o.bX(n)))return;S=o.bT(n,this._globalState)}else{if("source"in n&&typeof n.source=="object"&&(this.addSource(v,n.source),n=o.bV(n),n=o.e(n,{source:v})),this._validate(o.C.layer,`layers.${v}`,n,{arrayIndex:-1},m))return;S=o.bT(n,this._globalState),this._validateLayer(S),S.setEventedParent(this,{layer:{id:v}})}const M=u?this._order.indexOf(u):this._order.length;if(u&&M===-1)this.fire(new o.k(new Error(`Cannot add layer "${v}" before non-existing layer "${u}".`)));else{if(this._order.splice(M,0,v),this._layerOrderChanged=!0,this._layers[v]=S,this._removedLayers[v]&&S.source&&S.type!=="custom"){const k=this._removedLayers[v];delete this._removedLayers[v],k.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.tileManagers[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}moveLayer(n,u){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new o.k(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===u)return;const m=this._order.indexOf(n);this._order.splice(m,1);const v=u?this._order.indexOf(u):this._order.length;u&&v===-1?this.fire(new o.k(new Error(`Cannot move layer "${n}" before non-existing layer "${u}".`))):(this._order.splice(v,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const u=this._layers[n];if(!u)return void this.fire(new o.k(new Error(`Cannot remove non-existing layer "${n}".`)));u.setEventedParent(null);const m=this._order.indexOf(n);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=u,delete this._layers[n],this._serializedLayers&&delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],u.onRemove&&u.onRemove(this.map)}getLayer(n){return this._layers[n]}getLayersOrder(){return[...this._order]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,u,m){this._checkLoaded();const v=this.getLayer(n);v?v.minzoom===u&&v.maxzoom===m||(u!=null&&(v.minzoom=u),m!=null&&(v.maxzoom=m),this._updateLayer(v)):this.fire(new o.k(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,u,m={}){this._checkLoaded();const v=this.getLayer(n);if(v){if(!o.bR(v.filter,u))return u==null?(v.setFilter(void 0),void this._updateLayer(v)):void(this._validate(o.C.filter,`layers.${v.id}.filter`,u,null,m)||(v.setFilter(o.bV(u)),this._updateLayer(v)))}else this.fire(new o.k(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return o.bV(this.getLayer(n).filter)}setLayoutProperty(n,u,m,v={}){this._checkLoaded();const S=this.getLayer(n);S?o.bR(S.getLayoutProperty(u),m)||(S.setLayoutProperty(u,m,v),this._updateLayer(S)):this.fire(new o.k(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,u){const m=this.getLayer(n);if(m)return m.getLayoutProperty(u);this.fire(new o.k(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,u,m,v={}){this._checkLoaded();const S=this.getLayer(n);S?o.bR(S.getPaintProperty(u),m)||this._updatePaintProperty(S,u,m,v):this.fire(new o.k(new Error(`Cannot style non-existing layer "${n}".`)))}_updatePaintProperty(n,u,m,v={}){n.setPaintProperty(u,m,v)&&this._updateLayer(n),o.bU(n)&&u==="raster-fade-duration"&&this.tileManagers[n.source].setRasterFadeDuration(m),this._changed=!0,this._updatedPaintProps[n.id]=!0,this._serializedLayers=null}getPaintProperty(n,u){return this.getLayer(n).getPaintProperty(u)}setFeatureState(n,u){this._checkLoaded();const m=n.source,v=n.sourceLayer,S=this.tileManagers[m];if(S===void 0)return void this.fire(new o.k(new Error(`The source '${m}' does not exist in the map's style.`)));const M=S.getSource().type;M==="geojson"&&v?this.fire(new o.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):M!=="vector"||v?(n.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),S.setFeatureState(v,n.id,u)):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,u){this._checkLoaded();const m=n.source,v=this.tileManagers[m];if(v===void 0)return void this.fire(new o.k(new Error(`The source '${m}' does not exist in the map's style.`)));const S=v.getSource().type,M=S==="vector"?n.sourceLayer:void 0;S!=="vector"||M?u&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new o.k(new Error("A feature id is required to remove its specific state property."))):v.removeFeatureState(M,n.id,u):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const u=n.source,m=n.sourceLayer,v=this.tileManagers[u];if(v!==void 0)return v.getSource().type!=="vector"||m?(n.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),v.getFeatureState(m,n.id)):void this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.k(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const n=o.bY(this.tileManagers,S=>S.serialize()),u=this._serializeByIds(this._order,!0),m=this.map.getTerrain()||void 0,v=this.stylesheet;return o.bZ({version:v.version,name:v.name,metadata:v.metadata,light:v.light,sky:v.sky,center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch,sprite:v.sprite,glyphs:v.glyphs,transition:v.transition,projection:v.projection,sources:n,layers:u,terrain:m},S=>S!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.tileManagers[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.tileManagers[n.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(n){const u=M=>this._layers[M].type==="fill-extrusion",m={},v=[];for(let M=this._order.length-1;M>=0;M--){const k=this._order[M];if(u(k)){m[k]=M;for(const O of n){const B=O[k];if(B)for(const q of B)v.push(q)}}}v.sort((M,k)=>k.intersectionZ-M.intersectionZ);const S=[];for(let M=this._order.length-1;M>=0;M--){const k=this._order[M];if(u(k))for(let O=v.length-1;O>=0;O--){const B=v[O].feature;if(m[B.layer.id]<M)break;S.push(B),v.pop()}else for(const O of n){const B=O[k];if(B)for(const q of B)S.push(q.feature)}}return S}queryRenderedFeatures(n,u,m){u&&u.filter&&this._validate(o.C.filter,"queryRenderedFeatures.filter",u.filter,null,u);const v={};if(u&&u.layers){if(!(Array.isArray(u.layers)||u.layers instanceof Set))return this.fire(new o.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const B of u.layers){const q=this._layers[B];if(!q)return this.fire(new o.k(new Error(`The layer '${B}' does not exist in the map's style and cannot be queried for features.`))),[];v[q.source]=!0}}const S=[];u.availableImages=this._availableImages;const M=this._serializedAllLayers(),k=u.layers instanceof Set?u.layers:Array.isArray(u.layers)?new Set(u.layers):null,O=Object.assign(Object.assign({},u),{layers:k,globalState:this._globalState});for(const B in this.tileManagers)u.layers&&!v[B]||S.push(Hr(this.tileManagers[B],this._layers,M,n,O,m,this.map.terrain?(q,Y,X)=>this.map.terrain.getElevation(q,Y,X):void 0));return this.placement&&S.push(function(B,q,Y,X,te,ce,ge){const _e={},ve=ce.queryRenderedSymbols(X),Se=[];for(const Oe of Object.keys(ve).map(Number))Se.push(ge[Oe]);Se.sort(wr);for(const Oe of Se){const Ce=Oe.featureIndex.lookupSymbolFeatures(ve[Oe.bucketInstanceId],q,Oe.bucketIndex,Oe.sourceLayerIndex,{filterSpec:te.filter,globalState:te.globalState},te.layers,te.availableImages,B);for(const De in Ce){const Be=_e[De]=_e[De]||[],Ae=Ce[De];Ae.sort((Ue,ut)=>{const it=Oe.featureSortOrder;if(it){const st=it.indexOf(Ue.featureIndex);return it.indexOf(ut.featureIndex)-st}return ut.featureIndex-Ue.featureIndex});for(const Ue of Ae)Be.push(Ue)}}return function(Oe,Ce,De){for(const Be in Oe)for(const Ae of Oe[Be])sr(Ae,De[Ce[Be].source]);return Oe}(_e,B,Y)}(this._layers,M,this.tileManagers,n,O,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(S)}querySourceFeatures(n,u){u?.filter&&this._validate(o.C.filter,"querySourceFeatures.filter",u.filter,null,u);const m=this.tileManagers[n];return m?function(v,S){const M=v.getRenderableIds().map(B=>v.getTileByID(B)),k=[],O={};for(let B=0;B<M.length;B++){const q=M[B],Y=q.tileID.canonical.key;O[Y]||(O[Y]=!0,q.querySourceFeatures(k,S))}return k}(m,u?Object.assign(Object.assign({},u),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(n,u={}){this._checkLoaded();const m=this.light.getLight();let v=!1;for(const M in n)if(!o.bR(n[M],m[M])){v=!0;break}if(!v)return;const S={now:$(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,u),this.light.updateTransitions(S)}getProjection(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.projection}setProjection(n){if(this._checkLoaded(),this.projection){if(this.projection.name===n.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=n,this._setProjectionInternal(n.type)}getSky(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.sky}setSky(n,u={}){this._checkLoaded();const m=this.getSky();let v=!1;if(!n&&!m)return;if(n&&!m)v=!0;else if(!n&&m)v=!0;else for(const M in n)if(!o.bR(n[M],m[M])){v=!0;break}if(!v)return;const S={now:$(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=n,this.sky.setSky(n,u),this.sky.updateTransitions(S)}_setProjectionInternal(n){const u=function(m,v){const S={constrainOverride:v};if(Array.isArray(m)){const M=new du({type:m});return{projection:M,transform:new pu(S),cameraHelper:new mm(M)}}switch(m){case"mercator":return{projection:new Qi,transform:new ac(S),cameraHelper:new xl};case"globe":{const M=new du({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:M,transform:new pu(S),cameraHelper:new mm(M)}}case"vertical-perspective":return{projection:new gh,transform:new wl(S),cameraHelper:new Li};default:return o.w(`Unknown projection name: ${m}. Falling back to mercator projection.`),{projection:new Qi,transform:new ac(S),cameraHelper:new xl}}}(n,this.map.transformConstrain);this.projection=u.projection,this.map.migrateProjection(u.transform,u.cameraHelper);for(const m in this.tileManagers)this.tileManagers[m].reload()}_validate(n,u,m,v,S={}){return(!S||S.validate!==!1)&&hc(this,n.call(o.C,o.e({key:u,style:this.serialize(),value:m,styleSpec:o.u},v)))}_remove(n=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Xe().off(Pe,this._rtlPluginLoaded);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.tileManagers){const m=this.tileManagers[u];m.setEventedParent(null),m.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),n&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(n)}_clearSource(n){this.tileManagers[n].clearTiles()}_reloadSource(n){this.tileManagers[n].resume(),this.tileManagers[n].reload()}_updateSources(n){for(const u in this.tileManagers)this.tileManagers[u].update(n,this.map.terrain)}_generateCollisionBoxes(){for(const n in this.tileManagers)this._reloadSource(n)}_updatePlacement(n,u,m,v,S=!1){let M=!1,k=!1;const O={};for(const B of this._order){const q=this._layers[B];if(q.type!=="symbol")continue;if(!O[q.source]){const X=this.tileManagers[q.source];O[q.source]=X.getRenderableIds(!0).map(te=>X.getTileByID(te)).sort((te,ce)=>ce.tileID.overscaledZ-te.tileID.overscaledZ||(te.tileID.isLessThan(ce.tileID)?-1:1))}const Y=this.crossTileSymbolIndex.addLayer(q,O[q.source],n.center.lng);M=M||Y}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||m===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent($(),n.zoom))&&(this.pauseablePlacement=new yl(n,this.map.terrain,this._order,S,u,m,v,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit($()),k=!0),M&&this.pauseablePlacement.placement.setStale()),k||M)for(const B of this._order){const q=this._layers[B];q.type==="symbol"&&this.placement.updateLayerOpacities(q,O[q.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions($())}_releaseSymbolFadeTiles(){for(const n in this.tileManagers)this.tileManagers[n].releaseSymbolFadeTiles()}getImages(n,u){return o._(this,void 0,void 0,function*(){const m=yield this.imageManager.getImages(u.icons);this._updateTilesForChangedImages();const v=this.tileManagers[u.source];return v&&v.setDependencies(u.tileID.key,u.type,u.icons),m})}getGlyphs(n,u){return o._(this,void 0,void 0,function*(){const m=yield this.glyphManager.getGlyphs(u.stacks),v=this.tileManagers[u.source];return v&&v.setDependencies(u.tileID.key,u.type,[""]),m})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(n,u={}){this._checkLoaded(),n&&this._validate(o.C.glyphs,"glyphs",n,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=n,this.glyphManager.entries={},this.glyphManager.setURL(n))}getDashes(n,u){return o._(this,void 0,void 0,function*(){const m={};for(const[v,S]of Object.entries(u.dashes))m[v]=this.lineAtlas.getDash(S.dasharray,S.round);return m})}addSprite(n,u,m={},v){this._checkLoaded();const S=[{id:n,url:u}],M=[...Ee(this.stylesheet.sprite),...S];this._validate(o.C.sprite,"sprite",M,null,m)||(this.stylesheet.sprite=M,this._loadSprite(S,!0,v))}removeSprite(n){this._checkLoaded();const u=Ee(this.stylesheet.sprite);if(u.find(m=>m.id===n)){if(this._spritesImagesIds[n])for(const m of this._spritesImagesIds[n])this.imageManager.removeImage(m),this._changedImages[m]=!0;u.splice(u.findIndex(m=>m.id===n),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[n],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}else this.fire(new o.k(new Error(`Sprite "${n}" doesn't exists on this map.`)))}getSprite(){return Ee(this.stylesheet.sprite)}setSprite(n,u={},m){this._checkLoaded(),n&&this._validate(o.C.sprite,"sprite",n,null,u)||(this.stylesheet.sprite=n,n?this._loadSprite(n,!0,m):(this._unloadSprite(),m&&m(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const n in this.tileManagers){const u=this.tileManagers[n];u.setEventedParent(null),u.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const n in this._layers){const u=this._layers[n];u.setEventedParent(null),u.onRemove&&u.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var iy=o.aU([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class pd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,u,m,v,S,M,k,O,B){this.context=n;let q=this.boundPaintVertexBuffers.length!==v.length;for(let Y=0;!q&&Y<v.length;Y++)this.boundPaintVertexBuffers[Y]!==v[Y]&&(q=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==m||q||this.boundIndexBuffer!==S||this.boundVertexOffset!==M||this.boundDynamicVertexBuffer!==k||this.boundDynamicVertexBuffer2!==O||this.boundDynamicVertexBuffer3!==B?this.freshBind(u,m,v,S,M,k,O,B):(n.bindVertexArray.set(this.vao),k&&k.bind(),S&&S.dynamicDraw&&S.bind(),O&&O.bind(),B&&B.bind())}freshBind(n,u,m,v,S,M,k,O){const B=n.numAttributes,q=this.context,Y=q.gl;this.vao&&this.destroy(),this.vao=q.createVertexArray(),q.bindVertexArray.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=v,this.boundVertexOffset=S,this.boundDynamicVertexBuffer=M,this.boundDynamicVertexBuffer2=k,this.boundDynamicVertexBuffer3=O,u.enableAttributes(Y,n);for(const X of m)X.enableAttributes(Y,n);M&&M.enableAttributes(Y,n),k&&k.enableAttributes(Y,n),O&&O.enableAttributes(Y,n),u.bind(),u.setVertexAttribPointers(Y,n,S);for(const X of m)X.bind(),X.setVertexAttribPointers(Y,n,S);M&&(M.bind(),M.setVertexAttribPointers(Y,n,S)),v&&v.bind(),k&&(k.bind(),k.setVertexAttribPointers(Y,n,S)),O&&(O.bind(),O.setVertexAttribPointers(Y,n,S)),q.currentNumAttributes=B}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const oy=(w,n,u,m,v)=>({u_texture:0,u_ele_delta:w,u_fog_matrix:n,u_fog_color:u?u.properties.get("fog-color"):o.bp.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:v?0:u?u.calculateFogBlendOpacity(m):0,u_horizon_color:u?u.properties.get("horizon-color"):o.bp.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1,u_is_globe_mode:v?1:0}),mu={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function md(w){const n=[];for(let u=0;u<w.length;u++){if(w[u]===null)continue;const m=w[u].split(" ");n.push(m.pop())}return n}class gd{constructor(n,u,m,v,S,M,k,O,B=[]){const q=n.gl;this.program=q.createProgram();const Y=md(u.staticAttributes),X=m?m.getBinderAttributes():[],te=Y.concat(X),ce=_n.prelude.staticUniforms?md(_n.prelude.staticUniforms):[],ge=k.staticUniforms?md(k.staticUniforms):[],_e=u.staticUniforms?md(u.staticUniforms):[],ve=m?m.getBinderUniforms():[],Se=ce.concat(ge).concat(_e).concat(ve),Oe=[];for(const it of Se)Oe.indexOf(it)<0&&Oe.push(it);const Ce=m?m.defines():[];li(q)&&Ce.unshift("#version 300 es"),S&&Ce.push("#define OVERDRAW_INSPECTOR;"),M&&Ce.push("#define TERRAIN3D;"),O&&Ce.push(O),B&&Ce.push(...B);let De=Ce.concat(_n.prelude.fragmentSource,k.fragmentSource,u.fragmentSource).join(`
`),Be=Ce.concat(_n.prelude.vertexSource,k.vertexSource,u.vertexSource).join(`
`);li(q)||(De=function(it){return it.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(De),Be=function(it){return it.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Be));const Ae=q.createShader(q.FRAGMENT_SHADER);if(q.isContextLost())return void(this.failedToCreate=!0);if(q.shaderSource(Ae,De),q.compileShader(Ae),!q.getShaderParameter(Ae,q.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${q.getShaderInfoLog(Ae)}`);q.attachShader(this.program,Ae);const Ue=q.createShader(q.VERTEX_SHADER);if(q.isContextLost())return void(this.failedToCreate=!0);if(q.shaderSource(Ue,Be),q.compileShader(Ue),!q.getShaderParameter(Ue,q.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${q.getShaderInfoLog(Ue)}`);q.attachShader(this.program,Ue),this.attributes={};const ut={};this.numAttributes=te.length;for(let it=0;it<this.numAttributes;it++)te[it]&&(q.bindAttribLocation(this.program,it,te[it]),this.attributes[te[it]]=it);if(q.linkProgram(this.program),!q.getProgramParameter(this.program,q.LINK_STATUS))throw new Error(`Program failed to link: ${q.getProgramInfoLog(this.program)}`);q.deleteShader(Ue),q.deleteShader(Ae);for(let it=0;it<Oe.length;it++){const st=Oe[it];if(st&&!ut[st]){const at=q.getUniformLocation(this.program,st);at&&(ut[st]=at)}}this.fixedUniforms=v(n,ut),this.terrainUniforms=((it,st)=>({u_depth:new o.b_(it,st.u_depth),u_terrain:new o.b_(it,st.u_terrain),u_terrain_dim:new o.bq(it,st.u_terrain_dim),u_terrain_matrix:new o.c0(it,st.u_terrain_matrix),u_terrain_unpack:new o.c1(it,st.u_terrain_unpack),u_terrain_exaggeration:new o.bq(it,st.u_terrain_exaggeration)}))(n,ut),this.projectionUniforms=((it,st)=>({u_projection_matrix:new o.c0(it,st.u_projection_matrix),u_projection_tile_mercator_coords:new o.c1(it,st.u_projection_tile_mercator_coords),u_projection_clipping_plane:new o.c1(it,st.u_projection_clipping_plane),u_projection_transition:new o.bq(it,st.u_projection_transition),u_projection_fallback_matrix:new o.c0(it,st.u_projection_fallback_matrix)}))(n,ut),this.binderUniforms=m?m.getUniforms(n,ut):[]}draw(n,u,m,v,S,M,k,O,B,q,Y,X,te,ce,ge,_e,ve,Se,Oe){const Ce=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(m),n.setStencilMode(v),n.setColorMode(S),n.setCullFace(M),O){n.activeTexture.set(Ce.TEXTURE2),Ce.bindTexture(Ce.TEXTURE_2D,O.depthTexture),n.activeTexture.set(Ce.TEXTURE3),Ce.bindTexture(Ce.TEXTURE_2D,O.texture);for(const Be in this.terrainUniforms)this.terrainUniforms[Be].set(O[Be])}if(B)for(const Be in B)this.projectionUniforms[mu[Be]].set(B[Be]);if(k)for(const Be in this.fixedUniforms)this.fixedUniforms[Be].set(k[Be]);_e&&_e.setUniforms(n,this.binderUniforms,ce,{zoom:ge});let De=0;switch(u){case Ce.LINES:De=2;break;case Ce.TRIANGLES:De=3;break;case Ce.LINE_STRIP:De=1}for(const Be of te.get()){const Ae=Be.vaos||(Be.vaos={});(Ae[q]||(Ae[q]=new pd)).bind(n,this,Y,_e?_e.getPaintVertexBuffers():[],X,Be.vertexOffset,ve,Se,Oe),Ce.drawElements(u,Be.primitiveLength*De,Ce.UNSIGNED_SHORT,Be.primitiveOffset*De*2)}}}function gu(w,n,u){const m=1/o.aN(u,1,n.transform.tileZoom),v=Math.pow(2,u.tileID.overscaledZ),S=u.tileSize*Math.pow(2,n.transform.tileZoom)/v,M=S*(u.tileID.canonical.x+u.tileID.wrap*v),k=S*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[m,w.fromScale,w.toScale],u_fade:w.t,u_pixel_coord_upper:[M>>16,k>>16],u_pixel_coord_lower:[65535&M,65535&k]}}const Uf=(w,n,u,m)=>{const v=w.style.light,S=v.properties.get("position"),M=[S.x,S.y,S.z],k=o.c4();v.properties.get("anchor")==="viewport"&&o.c5(k,w.transform.bearingInRadians),o.c6(M,M,k);const O=w.transform.transformLightDirection(M),B=v.properties.get("color");return{u_lightpos:M,u_lightpos_globe:O,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[B.r,B.g,B.b],u_vertical_gradient:+n,u_opacity:u,u_fill_translate:m}},yd=(w,n,u,m,v,S,M)=>o.e(Uf(w,n,u,m),gu(S,w,M),{u_height_factor:-Math.pow(2,v.overscaledZ)/M.tileSize/8}),vd=(w,n,u,m)=>o.e(gu(n,w,u),{u_fill_translate:m}),Gf=(w,n)=>({u_world:w,u_fill_translate:n}),qf=(w,n,u,m,v)=>o.e(vd(w,n,u,v),{u_world:m}),Hf=(w,n,u,m,v)=>{const S=w.transform;let M,k,O=0;if(u.paint.get("circle-pitch-alignment")==="map"){const B=o.aN(n,1,S.zoom);M=!0,k=[B,B],O=B/(o.a5*Math.pow(2,n.tileID.overscaledZ))*2*Math.PI*v}else M=!1,k=S.pixelsToGLUnits;return{u_camera_to_center_distance:S.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+M,u_device_pixel_ratio:w.pixelRatio,u_extrude_scale:k,u_globe_extrude_scale:O,u_translate:m}},ms=w=>({u_pixel_extrude_scale:[1/w.width,1/w.height]}),gm=w=>({u_viewport_size:[w.width,w.height]}),Wf=(w,n=1)=>({u_color:w,u_overlay:0,u_overlay_scale:n}),yu=(w,n,u,m)=>{const v=o.aN(w,1,n)/(o.a5*Math.pow(2,w.tileID.overscaledZ))*2*Math.PI*m;return{u_extrude_scale:o.aN(w,1,n),u_intensity:u,u_globe_extrude_scale:v}},Zf=(w,n,u,m)=>{const v=o.N();o.c7(v,0,w.width,w.height,0,0,1);const S=w.context.gl;return{u_matrix:v,u_world:[S.drawingBufferWidth,S.drawingBufferHeight],u_image:u,u_color_ramp:m,u_opacity:n.paint.get("heatmap-opacity")}},_h=(w,n,u)=>{const m=u.paint.get("hillshade-accent-color");let v;switch(u.paint.get("hillshade-method")){case"basic":v=4;break;case"combined":v=1;break;case"igor":v=2;break;case"multidirectional":v=3;break;default:v=0}const S=u.getIlluminationProperties();for(let M=0;M<S.directionRadians.length;M++)u.paint.get("hillshade-illumination-anchor")==="viewport"&&(S.directionRadians[M]+=w.transform.bearingInRadians);return{u_image:0,u_latrange:bh(0,n.tileID),u_exaggeration:u.paint.get("hillshade-exaggeration"),u_altitudes:S.altitudeRadians,u_azimuths:S.directionRadians,u_accent:m,u_method:v,u_highlights:S.highlightColor,u_shadows:S.shadowColor}},xh=(w,n)=>{const u=n.stride,m=o.N();return o.c7(m,0,o.a5,-o.a5,0,0,1),o.O(m,m,[0,-o.a5,0]),{u_matrix:m,u_image:1,u_dimension:[u,u],u_zoom:w.overscaledZ,u_unpack:n.getUnpackVector()}};function bh(w,n){const u=Math.pow(2,n.canonical.z),m=n.canonical.y;return[new o.a9(0,m/u).toLngLat().lat,new o.a9(0,(m+1)/u).toLngLat().lat]}const ym=(w,n,u=0)=>({u_image:0,u_unpack:n.getUnpackVector(),u_dimension:[n.stride,n.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:u,u_opacity:w.paint.get("color-relief-opacity")}),Sl=(w,n,u,m)=>{const v=w.transform;return{u_translation:wh(w,n,u),u_ratio:m/o.aN(n,1,v.zoom),u_device_pixel_ratio:w.pixelRatio,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},vm=(w,n,u,m,v)=>o.e(Sl(w,n,u,m),{u_image:0,u_image_height:v}),_d=(w,n,u,m,v)=>{const S=w.transform,M=gs(n,S);return{u_translation:wh(w,n,u),u_texsize:n.imageAtlasTexture.size,u_ratio:m/o.aN(n,1,S.zoom),u_device_pixel_ratio:w.pixelRatio,u_image:0,u_scale:[M,v.fromScale,v.toScale],u_fade:v.t,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]]}},xd=(w,n,u,m,v)=>{const S=gs(n,w.transform);return o.e(Sl(w,n,u,m),{u_tileratio:S,u_crossfade_from:v.fromScale,u_crossfade_to:v.toScale,u_image:0,u_mix:v.t,u_lineatlas_width:w.lineAtlas.width,u_lineatlas_height:w.lineAtlas.height})},vu=(w,n,u,m,v,S)=>{const M=gs(n,w.transform);return o.e(Sl(w,n,u,m),{u_image:0,u_image_height:S,u_tileratio:M,u_crossfade_from:v.fromScale,u_crossfade_to:v.toScale,u_image_dash:1,u_mix:v.t,u_lineatlas_width:w.lineAtlas.width,u_lineatlas_height:w.lineAtlas.height})};function gs(w,n){return 1/o.aN(w,1,n.tileZoom)}function wh(w,n,u){return o.aO(w.transform,n,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const bd=(w,n,u,m,v)=>{return{u_tl_parent:w,u_scale_parent:n,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*m.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:m.paint.get("raster-brightness-min"),u_brightness_high:m.paint.get("raster-brightness-max"),u_saturation_factor:(M=m.paint.get("raster-saturation"),M>0?1-1/(1.001-M):-M),u_contrast_factor:(S=m.paint.get("raster-contrast"),S>0?1/(1-S):1+S),u_spin_weights:Xf(m.paint.get("raster-hue-rotate")),u_coords_top:[v[0].x,v[0].y,v[1].x,v[1].y],u_coords_bottom:[v[3].x,v[3].y,v[2].x,v[2].y]};var S,M};function Xf(w){w*=Math.PI/180;const n=Math.sin(w),u=Math.cos(w);return[(2*u+1)/3,(-Math.sqrt(3)*n-u+1)/3,(Math.sqrt(3)*n-u+1)/3]}const Kf=(w,n,u,m,v,S,M,k,O,B,q,Y,X)=>{const te=M.transform;return{u_is_size_zoom_constant:+(w==="constant"||w==="source"),u_is_size_feature_constant:+(w==="constant"||w==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:te.cameraToCenterDistance,u_pitch:te.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:te.width/te.height,u_fade_change:M.options.fadeDuration?M.symbolFadeChange:1,u_label_plane_matrix:k,u_coord_matrix:O,u_is_text:+q,u_pitch_with_map:+m,u_is_along_line:v,u_is_variable_anchor:S,u_texsize:Y,u_texture:0,u_translation:B,u_pitched_scale:X}},wd=(w,n,u,m,v,S,M,k,O,B,q,Y,X,te)=>{const ce=M.transform;return o.e(Kf(w,n,u,m,v,S,M,k,O,B,q,Y,te),{u_gamma_scale:m?Math.cos(ce.pitch*Math.PI/180)*ce.cameraToCenterDistance:1,u_device_pixel_ratio:M.pixelRatio,u_is_halo:1})},fc=(w,n,u,m,v,S,M,k,O,B,q,Y,X)=>o.e(wd(w,n,u,m,v,S,M,k,O,B,!0,q,0,X),{u_texsize_icon:Y,u_texture_icon:1}),Yf=(w,n)=>({u_opacity:w,u_color:n}),Fs=(w,n,u,m,v)=>o.e(function(S,M,k,O){const B=k.imageManager.getPattern(S.from.toString()),q=k.imageManager.getPattern(S.to.toString()),{width:Y,height:X}=k.imageManager.getPixelSize(),te=Math.pow(2,O.tileID.overscaledZ),ce=O.tileSize*Math.pow(2,k.transform.tileZoom)/te,ge=ce*(O.tileID.canonical.x+O.tileID.wrap*te),_e=ce*O.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:B.tl,u_pattern_br_a:B.br,u_pattern_tl_b:q.tl,u_pattern_br_b:q.br,u_texsize:[Y,X],u_mix:M.t,u_pattern_size_a:B.displaySize,u_pattern_size_b:q.displaySize,u_scale_a:M.fromScale,u_scale_b:M.toScale,u_tile_units_to_pixels:1/o.aN(O,1,k.transform.tileZoom),u_pixel_coord_upper:[ge>>16,_e>>16],u_pixel_coord_lower:[65535&ge,65535&_e]}}(u,v,n,m),{u_opacity:w}),_u=(w,n)=>{},_m={fillExtrusion:(w,n)=>({u_lightpos:new o.c2(w,n.u_lightpos),u_lightpos_globe:new o.c2(w,n.u_lightpos_globe),u_lightintensity:new o.bq(w,n.u_lightintensity),u_lightcolor:new o.c2(w,n.u_lightcolor),u_vertical_gradient:new o.bq(w,n.u_vertical_gradient),u_opacity:new o.bq(w,n.u_opacity),u_fill_translate:new o.c3(w,n.u_fill_translate)}),fillExtrusionPattern:(w,n)=>({u_lightpos:new o.c2(w,n.u_lightpos),u_lightpos_globe:new o.c2(w,n.u_lightpos_globe),u_lightintensity:new o.bq(w,n.u_lightintensity),u_lightcolor:new o.c2(w,n.u_lightcolor),u_vertical_gradient:new o.bq(w,n.u_vertical_gradient),u_height_factor:new o.bq(w,n.u_height_factor),u_opacity:new o.bq(w,n.u_opacity),u_fill_translate:new o.c3(w,n.u_fill_translate),u_image:new o.b_(w,n.u_image),u_texsize:new o.c3(w,n.u_texsize),u_pixel_coord_upper:new o.c3(w,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(w,n.u_pixel_coord_lower),u_scale:new o.c2(w,n.u_scale),u_fade:new o.bq(w,n.u_fade)}),fill:(w,n)=>({u_fill_translate:new o.c3(w,n.u_fill_translate)}),fillPattern:(w,n)=>({u_image:new o.b_(w,n.u_image),u_texsize:new o.c3(w,n.u_texsize),u_pixel_coord_upper:new o.c3(w,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(w,n.u_pixel_coord_lower),u_scale:new o.c2(w,n.u_scale),u_fade:new o.bq(w,n.u_fade),u_fill_translate:new o.c3(w,n.u_fill_translate)}),fillOutline:(w,n)=>({u_world:new o.c3(w,n.u_world),u_fill_translate:new o.c3(w,n.u_fill_translate)}),fillOutlinePattern:(w,n)=>({u_world:new o.c3(w,n.u_world),u_image:new o.b_(w,n.u_image),u_texsize:new o.c3(w,n.u_texsize),u_pixel_coord_upper:new o.c3(w,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(w,n.u_pixel_coord_lower),u_scale:new o.c2(w,n.u_scale),u_fade:new o.bq(w,n.u_fade),u_fill_translate:new o.c3(w,n.u_fill_translate)}),circle:(w,n)=>({u_camera_to_center_distance:new o.bq(w,n.u_camera_to_center_distance),u_scale_with_map:new o.b_(w,n.u_scale_with_map),u_pitch_with_map:new o.b_(w,n.u_pitch_with_map),u_extrude_scale:new o.c3(w,n.u_extrude_scale),u_device_pixel_ratio:new o.bq(w,n.u_device_pixel_ratio),u_globe_extrude_scale:new o.bq(w,n.u_globe_extrude_scale),u_translate:new o.c3(w,n.u_translate)}),collisionBox:(w,n)=>({u_pixel_extrude_scale:new o.c3(w,n.u_pixel_extrude_scale)}),collisionCircle:(w,n)=>({u_viewport_size:new o.c3(w,n.u_viewport_size)}),debug:(w,n)=>({u_color:new o.b$(w,n.u_color),u_overlay:new o.b_(w,n.u_overlay),u_overlay_scale:new o.bq(w,n.u_overlay_scale)}),depth:_u,clippingMask:_u,heatmap:(w,n)=>({u_extrude_scale:new o.bq(w,n.u_extrude_scale),u_intensity:new o.bq(w,n.u_intensity),u_globe_extrude_scale:new o.bq(w,n.u_globe_extrude_scale)}),heatmapTexture:(w,n)=>({u_matrix:new o.c0(w,n.u_matrix),u_world:new o.c3(w,n.u_world),u_image:new o.b_(w,n.u_image),u_color_ramp:new o.b_(w,n.u_color_ramp),u_opacity:new o.bq(w,n.u_opacity)}),hillshade:(w,n)=>({u_image:new o.b_(w,n.u_image),u_latrange:new o.c3(w,n.u_latrange),u_exaggeration:new o.bq(w,n.u_exaggeration),u_altitudes:new o.c9(w,n.u_altitudes),u_azimuths:new o.c9(w,n.u_azimuths),u_accent:new o.b$(w,n.u_accent),u_method:new o.b_(w,n.u_method),u_shadows:new o.c8(w,n.u_shadows),u_highlights:new o.c8(w,n.u_highlights)}),hillshadePrepare:(w,n)=>({u_matrix:new o.c0(w,n.u_matrix),u_image:new o.b_(w,n.u_image),u_dimension:new o.c3(w,n.u_dimension),u_zoom:new o.bq(w,n.u_zoom),u_unpack:new o.c1(w,n.u_unpack)}),colorRelief:(w,n)=>({u_image:new o.b_(w,n.u_image),u_unpack:new o.c1(w,n.u_unpack),u_dimension:new o.c3(w,n.u_dimension),u_elevation_stops:new o.b_(w,n.u_elevation_stops),u_color_stops:new o.b_(w,n.u_color_stops),u_color_ramp_size:new o.b_(w,n.u_color_ramp_size),u_opacity:new o.bq(w,n.u_opacity)}),line:(w,n)=>({u_translation:new o.c3(w,n.u_translation),u_ratio:new o.bq(w,n.u_ratio),u_device_pixel_ratio:new o.bq(w,n.u_device_pixel_ratio),u_units_to_pixels:new o.c3(w,n.u_units_to_pixels)}),lineGradient:(w,n)=>({u_translation:new o.c3(w,n.u_translation),u_ratio:new o.bq(w,n.u_ratio),u_device_pixel_ratio:new o.bq(w,n.u_device_pixel_ratio),u_units_to_pixels:new o.c3(w,n.u_units_to_pixels),u_image:new o.b_(w,n.u_image),u_image_height:new o.bq(w,n.u_image_height)}),linePattern:(w,n)=>({u_translation:new o.c3(w,n.u_translation),u_texsize:new o.c3(w,n.u_texsize),u_ratio:new o.bq(w,n.u_ratio),u_device_pixel_ratio:new o.bq(w,n.u_device_pixel_ratio),u_image:new o.b_(w,n.u_image),u_units_to_pixels:new o.c3(w,n.u_units_to_pixels),u_scale:new o.c2(w,n.u_scale),u_fade:new o.bq(w,n.u_fade)}),lineSDF:(w,n)=>({u_translation:new o.c3(w,n.u_translation),u_ratio:new o.bq(w,n.u_ratio),u_device_pixel_ratio:new o.bq(w,n.u_device_pixel_ratio),u_units_to_pixels:new o.c3(w,n.u_units_to_pixels),u_image:new o.b_(w,n.u_image),u_mix:new o.bq(w,n.u_mix),u_tileratio:new o.bq(w,n.u_tileratio),u_crossfade_from:new o.bq(w,n.u_crossfade_from),u_crossfade_to:new o.bq(w,n.u_crossfade_to),u_lineatlas_width:new o.bq(w,n.u_lineatlas_width),u_lineatlas_height:new o.bq(w,n.u_lineatlas_height)}),lineGradientSDF:(w,n)=>({u_translation:new o.c3(w,n.u_translation),u_ratio:new o.bq(w,n.u_ratio),u_device_pixel_ratio:new o.bq(w,n.u_device_pixel_ratio),u_units_to_pixels:new o.c3(w,n.u_units_to_pixels),u_image:new o.b_(w,n.u_image),u_image_height:new o.bq(w,n.u_image_height),u_tileratio:new o.bq(w,n.u_tileratio),u_crossfade_from:new o.bq(w,n.u_crossfade_from),u_crossfade_to:new o.bq(w,n.u_crossfade_to),u_image_dash:new o.b_(w,n.u_image_dash),u_mix:new o.bq(w,n.u_mix),u_lineatlas_width:new o.bq(w,n.u_lineatlas_width),u_lineatlas_height:new o.bq(w,n.u_lineatlas_height)}),raster:(w,n)=>({u_tl_parent:new o.c3(w,n.u_tl_parent),u_scale_parent:new o.bq(w,n.u_scale_parent),u_buffer_scale:new o.bq(w,n.u_buffer_scale),u_fade_t:new o.bq(w,n.u_fade_t),u_opacity:new o.bq(w,n.u_opacity),u_image0:new o.b_(w,n.u_image0),u_image1:new o.b_(w,n.u_image1),u_brightness_low:new o.bq(w,n.u_brightness_low),u_brightness_high:new o.bq(w,n.u_brightness_high),u_saturation_factor:new o.bq(w,n.u_saturation_factor),u_contrast_factor:new o.bq(w,n.u_contrast_factor),u_spin_weights:new o.c2(w,n.u_spin_weights),u_coords_top:new o.c1(w,n.u_coords_top),u_coords_bottom:new o.c1(w,n.u_coords_bottom)}),symbolIcon:(w,n)=>({u_is_size_zoom_constant:new o.b_(w,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(w,n.u_is_size_feature_constant),u_size_t:new o.bq(w,n.u_size_t),u_size:new o.bq(w,n.u_size),u_camera_to_center_distance:new o.bq(w,n.u_camera_to_center_distance),u_pitch:new o.bq(w,n.u_pitch),u_rotate_symbol:new o.b_(w,n.u_rotate_symbol),u_aspect_ratio:new o.bq(w,n.u_aspect_ratio),u_fade_change:new o.bq(w,n.u_fade_change),u_label_plane_matrix:new o.c0(w,n.u_label_plane_matrix),u_coord_matrix:new o.c0(w,n.u_coord_matrix),u_is_text:new o.b_(w,n.u_is_text),u_pitch_with_map:new o.b_(w,n.u_pitch_with_map),u_is_along_line:new o.b_(w,n.u_is_along_line),u_is_variable_anchor:new o.b_(w,n.u_is_variable_anchor),u_texsize:new o.c3(w,n.u_texsize),u_texture:new o.b_(w,n.u_texture),u_translation:new o.c3(w,n.u_translation),u_pitched_scale:new o.bq(w,n.u_pitched_scale)}),symbolSDF:(w,n)=>({u_is_size_zoom_constant:new o.b_(w,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(w,n.u_is_size_feature_constant),u_size_t:new o.bq(w,n.u_size_t),u_size:new o.bq(w,n.u_size),u_camera_to_center_distance:new o.bq(w,n.u_camera_to_center_distance),u_pitch:new o.bq(w,n.u_pitch),u_rotate_symbol:new o.b_(w,n.u_rotate_symbol),u_aspect_ratio:new o.bq(w,n.u_aspect_ratio),u_fade_change:new o.bq(w,n.u_fade_change),u_label_plane_matrix:new o.c0(w,n.u_label_plane_matrix),u_coord_matrix:new o.c0(w,n.u_coord_matrix),u_is_text:new o.b_(w,n.u_is_text),u_pitch_with_map:new o.b_(w,n.u_pitch_with_map),u_is_along_line:new o.b_(w,n.u_is_along_line),u_is_variable_anchor:new o.b_(w,n.u_is_variable_anchor),u_texsize:new o.c3(w,n.u_texsize),u_texture:new o.b_(w,n.u_texture),u_gamma_scale:new o.bq(w,n.u_gamma_scale),u_device_pixel_ratio:new o.bq(w,n.u_device_pixel_ratio),u_is_halo:new o.b_(w,n.u_is_halo),u_translation:new o.c3(w,n.u_translation),u_pitched_scale:new o.bq(w,n.u_pitched_scale)}),symbolTextAndIcon:(w,n)=>({u_is_size_zoom_constant:new o.b_(w,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(w,n.u_is_size_feature_constant),u_size_t:new o.bq(w,n.u_size_t),u_size:new o.bq(w,n.u_size),u_camera_to_center_distance:new o.bq(w,n.u_camera_to_center_distance),u_pitch:new o.bq(w,n.u_pitch),u_rotate_symbol:new o.b_(w,n.u_rotate_symbol),u_aspect_ratio:new o.bq(w,n.u_aspect_ratio),u_fade_change:new o.bq(w,n.u_fade_change),u_label_plane_matrix:new o.c0(w,n.u_label_plane_matrix),u_coord_matrix:new o.c0(w,n.u_coord_matrix),u_is_text:new o.b_(w,n.u_is_text),u_pitch_with_map:new o.b_(w,n.u_pitch_with_map),u_is_along_line:new o.b_(w,n.u_is_along_line),u_is_variable_anchor:new o.b_(w,n.u_is_variable_anchor),u_texsize:new o.c3(w,n.u_texsize),u_texsize_icon:new o.c3(w,n.u_texsize_icon),u_texture:new o.b_(w,n.u_texture),u_texture_icon:new o.b_(w,n.u_texture_icon),u_gamma_scale:new o.bq(w,n.u_gamma_scale),u_device_pixel_ratio:new o.bq(w,n.u_device_pixel_ratio),u_is_halo:new o.b_(w,n.u_is_halo),u_translation:new o.c3(w,n.u_translation),u_pitched_scale:new o.bq(w,n.u_pitched_scale)}),background:(w,n)=>({u_opacity:new o.bq(w,n.u_opacity),u_color:new o.b$(w,n.u_color)}),backgroundPattern:(w,n)=>({u_opacity:new o.bq(w,n.u_opacity),u_image:new o.b_(w,n.u_image),u_pattern_tl_a:new o.c3(w,n.u_pattern_tl_a),u_pattern_br_a:new o.c3(w,n.u_pattern_br_a),u_pattern_tl_b:new o.c3(w,n.u_pattern_tl_b),u_pattern_br_b:new o.c3(w,n.u_pattern_br_b),u_texsize:new o.c3(w,n.u_texsize),u_mix:new o.bq(w,n.u_mix),u_pattern_size_a:new o.c3(w,n.u_pattern_size_a),u_pattern_size_b:new o.c3(w,n.u_pattern_size_b),u_scale_a:new o.bq(w,n.u_scale_a),u_scale_b:new o.bq(w,n.u_scale_b),u_pixel_coord_upper:new o.c3(w,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(w,n.u_pixel_coord_lower),u_tile_units_to_pixels:new o.bq(w,n.u_tile_units_to_pixels)}),terrain:(w,n)=>({u_texture:new o.b_(w,n.u_texture),u_ele_delta:new o.bq(w,n.u_ele_delta),u_fog_matrix:new o.c0(w,n.u_fog_matrix),u_fog_color:new o.b$(w,n.u_fog_color),u_fog_ground_blend:new o.bq(w,n.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.bq(w,n.u_fog_ground_blend_opacity),u_horizon_color:new o.b$(w,n.u_horizon_color),u_horizon_fog_blend:new o.bq(w,n.u_horizon_fog_blend),u_is_globe_mode:new o.bq(w,n.u_is_globe_mode)}),terrainDepth:(w,n)=>({u_ele_delta:new o.bq(w,n.u_ele_delta)}),terrainCoords:(w,n)=>({u_texture:new o.b_(w,n.u_texture),u_terrain_coords_id:new o.bq(w,n.u_terrain_coords_id),u_ele_delta:new o.bq(w,n.u_ele_delta)}),projectionErrorMeasurement:(w,n)=>({u_input:new o.bq(w,n.u_input),u_output_expected:new o.bq(w,n.u_output_expected)}),atmosphere:(w,n)=>({u_sun_pos:new o.c2(w,n.u_sun_pos),u_atmosphere_blend:new o.bq(w,n.u_atmosphere_blend),u_globe_position:new o.c2(w,n.u_globe_position),u_globe_radius:new o.bq(w,n.u_globe_radius),u_inv_proj_matrix:new o.c0(w,n.u_inv_proj_matrix)}),sky:(w,n)=>({u_sky_color:new o.b$(w,n.u_sky_color),u_horizon_color:new o.b$(w,n.u_horizon_color),u_horizon:new o.c3(w,n.u_horizon),u_horizon_normal:new o.c3(w,n.u_horizon_normal),u_sky_horizon_blend:new o.bq(w,n.u_sky_horizon_blend),u_sky_blend:new o.bq(w,n.u_sky_blend)})};class xm{constructor(n,u,m){this.context=n;const v=n.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Jf={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class bm{constructor(n,u,m,v){this.length=u.length,this.attributes=m,this.itemSize=u.bytesPerElement,this.dynamicDraw=v,this.context=n;const S=n.gl;this.buffer=S.createBuffer(),n.bindVertexBuffer.set(this.buffer),S.bufferData(S.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,u){for(let m=0;m<this.attributes.length;m++){const v=u.attributes[this.attributes[m].name];v!==void 0&&n.enableVertexAttribArray(v)}}setVertexAttribPointers(n,u,m){for(let v=0;v<this.attributes.length;v++){const S=this.attributes[v],M=u.attributes[S.name];M!==void 0&&n.vertexAttribPointer(M,S.components,n[Jf[S.type]],!1,this.itemSize,S.offset+this.itemSize*(m||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class an{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Sd extends an{getDefault(){return o.bp.transparent}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Cd extends an{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class La extends an{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class Sh extends an{getDefault(){return[!0,!0,!0,!0]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Bs extends an{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class pc extends an{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class mc extends an{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const u=this.current;(n.func!==u.func||n.ref!==u.ref||n.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class Oo extends an{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class gc extends an{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=n,this.dirty=!1}}class Td extends an{getDefault(){return[0,1]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class Md extends an{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=n,this.dirty=!1}}class na extends an{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class Ch extends an{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.BLEND):u.disable(u.BLEND),this.current=n,this.dirty=!1}}class Th extends an{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class xu extends an{getDefault(){return o.bp.transparent}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Mh extends an{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class Qf extends an{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=n,this.dirty=!1}}class yc extends an{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class ss extends an{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class Pd extends an{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class Ph extends an{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class qr extends an{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Ed extends an{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class Eh extends an{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class wm extends an{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class bu extends an{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Sm extends an{getDefault(){return null}set(n){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class ri extends an{getDefault(){return null}set(n){var u;if(n===this.current&&!this.dirty)return;const m=this.gl;li(m)?m.bindVertexArray(n):(u=m.getExtension("OES_vertex_array_object"))===null||u===void 0||u.bindVertexArrayOES(n),this.current=n,this.dirty=!1}}class Id extends an{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class kd extends an{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class vc extends an{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class _c extends an{constructor(n,u){super(n),this.context=n,this.parent=u}getDefault(){return null}}class xc extends _c{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class Cl extends _c{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class wu extends _c{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}const Tl="Framebuffer is not complete";class Ih{constructor(n,u,m,v,S){this.context=n,this.width=u,this.height=m;const M=n.gl,k=this.framebuffer=M.createFramebuffer();if(this.colorAttachment=new xc(n,k),v)this.depthAttachment=S?new wu(n,k):new Cl(n,k);else if(S)throw new Error("Stencil cannot be set without depth");if(M.checkFramebufferStatus(M.FRAMEBUFFER)!==M.FRAMEBUFFER_COMPLETE)throw new Error(Tl)}destroy(){const n=this.context.gl,u=this.colorAttachment.get();if(u&&n.deleteTexture(u),this.depthAttachment){const m=this.depthAttachment.get();m&&n.deleteRenderbuffer(m)}n.deleteFramebuffer(this.framebuffer)}}class Ad{constructor(n){var u,m;if(this.gl=n,this.clearColor=new Sd(this),this.clearDepth=new Cd(this),this.clearStencil=new La(this),this.colorMask=new Sh(this),this.depthMask=new Bs(this),this.stencilMask=new pc(this),this.stencilFunc=new mc(this),this.stencilOp=new Oo(this),this.stencilTest=new gc(this),this.depthRange=new Td(this),this.depthTest=new Md(this),this.depthFunc=new na(this),this.blend=new Ch(this),this.blendFunc=new Th(this),this.blendColor=new xu(this),this.blendEquation=new Mh(this),this.cullFace=new Qf(this),this.cullFaceSide=new yc(this),this.frontFace=new ss(this),this.program=new Pd(this),this.activeTexture=new Ph(this),this.viewport=new qr(this),this.bindFramebuffer=new Ed(this),this.bindRenderbuffer=new Eh(this),this.bindTexture=new wm(this),this.bindVertexBuffer=new bu(this),this.bindElementBuffer=new Sm(this),this.bindVertexArray=new ri(this),this.pixelStoreUnpack=new Id(this),this.pixelStoreUnpackPremultiplyAlpha=new kd(this),this.pixelStoreUnpackFlipY=new vc(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),li(n)){this.HALF_FLOAT=n.HALF_FLOAT;const v=n.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(u=n.RGBA16F)!==null&&u!==void 0?u:v?.RGBA16F_EXT,this.RGB16F=(m=n.RGB16F)!==null&&m!==void 0?m:v?.RGB16F_EXT,n.getExtension("EXT_color_buffer_float")}else{n.getExtension("EXT_color_buffer_half_float"),n.getExtension("OES_texture_half_float_linear");const v=n.getExtension("OES_texture_half_float");this.HALF_FLOAT=v?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,u){return new xm(this,n,u)}createVertexBuffer(n,u,m){return new bm(this,n,u,m)}createRenderbuffer(n,u,m){const v=this.gl,S=v.createRenderbuffer();return this.bindRenderbuffer.set(S),v.renderbufferStorage(v.RENDERBUFFER,n,u,m),this.bindRenderbuffer.set(null),S}createFramebuffer(n,u,m,v){return new Ih(this,n,u,m,v)}clear({color:n,depth:u,stencil:m}){const v=this.gl;let S=0;n&&(S|=v.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(S|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),m!==void 0&&(S|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),v.clear(S)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){o.bR(n.blendFunction,sn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}createVertexArray(){var n;return li(this.gl)?this.gl.createVertexArray():(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.createVertexArrayOES()}deleteVertexArray(n){var u;return li(this.gl)?this.gl.deleteVertexArray(n):(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.deleteVertexArrayOES(n)}unbindVAO(){this.bindVertexArray.set(null)}}let Ml;function Pl(w,n,u,m,v){const S=w.context,M=w.transform,k=S.gl,O=w.useProgram("collisionBox"),B=[];let q=0,Y=0;for(let ve=0;ve<m.length;ve++){const Se=m[ve],Oe=n.getTile(Se).getBucket(u);if(!Oe)continue;const Ce=v?Oe.textCollisionBox:Oe.iconCollisionBox,De=Oe.collisionCircleArray;De.length>0&&(B.push({circleArray:De,circleOffset:Y,coord:Se}),q+=De.length/4,Y=q),Ce&&O.draw(S,k.LINES,Br.disabled,Yr.disabled,w.colorModeForRenderPass(),Zr.disabled,ms(w.transform),w.style.map.terrain&&w.style.map.terrain.getTerrainData(Se),M.getProjectionData({overscaledTileID:Se,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),u.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segments,null,w.transform.zoom,null,null,Ce.collisionVertexBuffer)}if(!v||!B.length)return;const X=w.useProgram("collisionCircle"),te=new o.ca;te.resize(4*q),te._trim();let ce=0;for(const ve of B)for(let Se=0;Se<ve.circleArray.length/4;Se++){const Oe=4*Se,Ce=ve.circleArray[Oe+0],De=ve.circleArray[Oe+1],Be=ve.circleArray[Oe+2],Ae=ve.circleArray[Oe+3];te.emplace(ce++,Ce,De,Be,Ae,0),te.emplace(ce++,Ce,De,Be,Ae,1),te.emplace(ce++,Ce,De,Be,Ae,2),te.emplace(ce++,Ce,De,Be,Ae,3)}(!Ml||Ml.length<2*q)&&(Ml=function(ve){const Se=2*ve,Oe=new o.cc;Oe.resize(Se),Oe._trim();for(let Ce=0;Ce<Se;Ce++){const De=6*Ce;Oe.uint16[De+0]=4*Ce+0,Oe.uint16[De+1]=4*Ce+1,Oe.uint16[De+2]=4*Ce+2,Oe.uint16[De+3]=4*Ce+2,Oe.uint16[De+4]=4*Ce+3,Oe.uint16[De+5]=4*Ce+0}return Oe}(q));const ge=S.createIndexBuffer(Ml,!0),_e=S.createVertexBuffer(te,o.cb.members,!0);for(const ve of B){const Se=gm(w.transform);X.draw(S,k.TRIANGLES,Br.disabled,Yr.disabled,w.colorModeForRenderPass(),Zr.disabled,Se,w.style.map.terrain&&w.style.map.terrain.getTerrainData(ve.coord),null,u.id,_e,ge,o.aX.simpleSegment(0,2*ve.circleOffset,ve.circleArray.length,ve.circleArray.length/2),null,w.transform.zoom,null,null,null)}_e.destroy(),ge.destroy()}const Su=o.ar(new Float32Array(16));function Rd(w,n,u,m,v,S){const{horizontalAlign:M,verticalAlign:k}=o.aS(w);return new o.P((-(M-.5)*n/v+m[0])*S,(-(k-.5)*u/v+m[1])*S)}function bc(w,n,u,m,v,S){const M=n.tileAnchorPoint.add(new o.P(n.translation[0],n.translation[1]));if(n.pitchWithMap){let k=m.mult(S);u||(k=k.rotate(-v));const O=M.add(k);return ir(O.x,O.y,n.pitchedLabelPlaneMatrix,n.getElevation).point}if(u){const k=nn(n.tileAnchorPoint.x+1,n.tileAnchorPoint.y,n).point.sub(w),O=Math.atan(k.y/k.x)+(k.x<0?Math.PI:0);return w.add(m.rotate(O))}return w.add(m)}function ep(w,n,u,m,v,S,M,k,O,B,q,Y){const X=w.text.placedSymbolArray,te=w.text.dynamicLayoutVertexArray,ce=w.icon.dynamicLayoutVertexArray,ge={};te.clear();for(let _e=0;_e<X.length;_e++){const ve=X.get(_e),Se=ve.hidden||!ve.crossTileID||w.allowVerticalPlacement&&!ve.placedOrientation?null:m[ve.crossTileID];if(Se){const Oe=new o.P(ve.anchorX,ve.anchorY),Ce={getElevation:Y,width:v.width,height:v.height,pitchedLabelPlaneMatrix:S,pitchWithMap:u,transform:v,tileAnchorPoint:Oe,translation:B,unwrappedTileID:q},De=u?Mr(Oe.x,Oe.y,Ce):nn(Oe.x,Oe.y,Ce),Be=An(v.cameraToCenterDistance,De.signedDistanceFromCamera);let Ae=o.aA(w.textSizeData,k,ve)*Be/o.aM;u&&(Ae*=w.tilePixelRatio/M);const{width:Ue,height:ut,anchor:it,textOffset:st,textBoxScale:at}=Se,Rt=Rd(it,Ue,ut,st,at,Ae),Dt=v.getPitchedTextCorrection(Oe.x+B[0],Oe.y+B[1],q),Tt=bc(De.point,Ce,n,Rt,-v.bearingInRadians,Dt),Nt=w.allowVerticalPlacement&&ve.placedOrientation===o.az.vertical?Math.PI/2:0;for(let kr=0;kr<ve.numGlyphs;kr++)o.aG(te,Tt,Nt);O&&ve.associatedIconIndex>=0&&(ge[ve.associatedIconIndex]={shiftedAnchor:Tt,angle:Nt})}else Rs(ve.numGlyphs,te)}if(O){ce.clear();const _e=w.icon.placedSymbolArray;for(let ve=0;ve<_e.length;ve++){const Se=_e.get(ve);if(Se.hidden)Rs(Se.numGlyphs,ce);else{const Oe=ge[ve];if(Oe)for(let Ce=0;Ce<Se.numGlyphs;Ce++)o.aG(ce,Oe.shiftedAnchor,Oe.angle);else Rs(Se.numGlyphs,ce)}}w.icon.dynamicLayoutVertexBuffer.updateData(ce)}w.text.dynamicLayoutVertexBuffer.updateData(te)}function Dd(w,n,u){return u.iconsInText&&n?"symbolTextAndIcon":w?"symbolSDF":"symbolIcon"}function wc(w,n,u,m,v,S,M,k,O,B,q,Y,X){const te=w.context,ce=te.gl,ge=w.transform,_e=k==="map",ve=O==="map",Se=k!=="viewport"&&u.layout.get("symbol-placement")!=="point",Oe=_e&&!ve&&!Se,Ce=!u.layout.get("symbol-sort-key").isConstant();let De=!1;const Be=w.getDepthModeForSublayer(0,Br.ReadOnly),Ae=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ue=[],ut=ge.getCircleRadiusCorrection();for(const it of m){const st=n.getTile(it),at=st.getBucket(u);if(!at)continue;const Rt=v?at.text:at.icon;if(!Rt||!Rt.segments.get().length||!Rt.hasVisibleVertices)continue;const Dt=Rt.programConfigurations.get(u.id),Tt=v||at.sdfIcons,Nt=v?at.textSizeData:at.iconSizeData,kr=ve||ge.pitch!==0,xn=w.useProgram(Dd(Tt,v,at),Dt),Zn=o.ay(Nt,ge.zoom),Pn=w.style.map.terrain&&w.style.map.terrain.getTerrainData(it);let Xn,En,Kn,ii,no=[0,0],ki=null;if(v)En=st.glyphAtlasTexture,Kn=ce.LINEAR,Xn=st.glyphAtlasTexture.size,at.iconsInText&&(no=st.imageAtlasTexture.size,ki=st.imageAtlasTexture,ii=kr||w.options.rotating||w.options.zooming||Nt.kind==="composite"||Nt.kind==="camera"?ce.LINEAR:ce.NEAREST);else{const Rn=u.layout.get("icon-size").constantOr(0)!==1||at.iconsNeedLinear;En=st.imageAtlasTexture,Kn=Tt||w.options.rotating||w.options.zooming||Rn||kr?ce.LINEAR:ce.NEAREST,Xn=st.imageAtlasTexture.size}const yn=o.aN(st,1,w.transform.zoom),Hi=Zt(_e,w.transform,yn),Gs=o.N();o.aB(Gs,Hi);const ha=Tr(ve,_e,w.transform,yn),qs=o.aO(ge,st,S,M),Fo=ge.getProjectionData({overscaledTileID:it,applyGlobeMatrix:!X,applyTerrainMatrix:!0}),Ua=Ae&&at.hasTextData(),da=u.layout.get("icon-text-fit")!=="none"&&Ua&&at.hasIconData();if(Se){const Rn=w.style.map.terrain?($i,Wi)=>w.style.map.terrain.getElevation(it,$i,Wi):null,In=u.layout.get("text-rotation-alignment")==="map";Ra(at,w,v,Hi,Gs,ve,B,In,it.toUnwrapped(),ge.width,ge.height,qs,Rn)}const Ga=v&&Ae||da,Ko=Se||Ga?Su:ve?Hi:w.transform.clipSpaceToPixelsMatrix,fa=Tt&&u.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Cs;Cs=Tt?at.iconsInText?fc(Nt.kind,Zn,Oe,ve,Se,Ga,w,Ko,ha,qs,Xn,no,ut):wd(Nt.kind,Zn,Oe,ve,Se,Ga,w,Ko,ha,qs,v,Xn,0,ut):Kf(Nt.kind,Zn,Oe,ve,Se,Ga,w,Ko,ha,qs,v,Xn,ut);const Ts={program:xn,buffers:Rt,uniformValues:Cs,projectionData:Fo,atlasTexture:En,atlasTextureIcon:ki,atlasInterpolation:Kn,atlasInterpolationIcon:ii,isSDF:Tt,hasHalo:fa};if(Ce&&at.canOverlap){De=!0;const Rn=Rt.segments.get();for(const In of Rn)Ue.push({segments:new o.aX([In]),sortKey:In.sortKey,state:Ts,terrainData:Pn})}else Ue.push({segments:Rt.segments,sortKey:0,state:Ts,terrainData:Pn})}De&&Ue.sort((it,st)=>it.sortKey-st.sortKey);for(const it of Ue){const st=it.state;if(te.activeTexture.set(ce.TEXTURE0),st.atlasTexture.bind(st.atlasInterpolation,ce.CLAMP_TO_EDGE),st.atlasTextureIcon&&(te.activeTexture.set(ce.TEXTURE1),st.atlasTextureIcon&&st.atlasTextureIcon.bind(st.atlasInterpolationIcon,ce.CLAMP_TO_EDGE)),st.isSDF){const at=st.uniformValues;st.hasHalo&&(at.u_is_halo=1,zd(st.buffers,it.segments,u,w,st.program,Be,q,Y,at,st.projectionData,it.terrainData)),at.u_is_halo=0}zd(st.buffers,it.segments,u,w,st.program,Be,q,Y,st.uniformValues,st.projectionData,it.terrainData)}}function zd(w,n,u,m,v,S,M,k,O,B,q){const Y=m.context;v.draw(Y,Y.gl.TRIANGLES,S,M,k,Zr.backCCW,O,q,B,u.id,w.layoutVertexBuffer,w.indexBuffer,n,u.paint,m.transform.zoom,w.programConfigurations.get(u.id),w.dynamicLayoutVertexBuffer,w.opacityVertexBuffer)}function tp(w,n,u,m,v){const S=w.context,M=S.gl,k=Yr.disabled,O=new sn([M.ONE,M.ONE],o.bp.transparent,[!0,!0,!0,!0]),B=n.getBucket(u);if(!B)return;const q=m.key;let Y=u.heatmapFbos.get(q);Y||(Y=kh(S,n.tileSize,n.tileSize),u.heatmapFbos.set(q,Y)),S.bindFramebuffer.set(Y.framebuffer),S.viewport.set([0,0,n.tileSize,n.tileSize]),S.clear({color:o.bp.transparent});const X=B.programConfigurations.get(u.id),te=w.useProgram("heatmap",X,!v),ce=w.transform.getProjectionData({overscaledTileID:n.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ge=w.style.map.terrain.getTerrainData(m);te.draw(S,M.TRIANGLES,Br.disabled,k,O,Zr.disabled,yu(n,w.transform.zoom,u.paint.get("heatmap-intensity"),1),ge,ce,u.id,B.layoutVertexBuffer,B.indexBuffer,B.segments,u.paint,w.transform.zoom,X)}function Cm(w,n,u,m,v){const S=w.context,M=S.gl,k=w.transform;S.setColorMode(w.colorModeForRenderPass());const O=Cu(S,n),B=u.key,q=n.heatmapFbos.get(B);if(!q)return;S.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,q.colorAttachment.get()),S.activeTexture.set(M.TEXTURE1),O.bind(M.LINEAR,M.CLAMP_TO_EDGE);const Y=k.getProjectionData({overscaledTileID:u,applyTerrainMatrix:v,applyGlobeMatrix:!m});w.useProgram("heatmapTexture").draw(S,M.TRIANGLES,Br.disabled,Yr.disabled,w.colorModeForRenderPass(),Zr.disabled,Zf(w,n,0,1),null,Y,n.id,w.rasterBoundsBuffer,w.quadTriangleIndexBuffer,w.rasterBoundsSegments,n.paint,k.zoom),q.destroy(),n.heatmapFbos.delete(B)}function kh(w,n,u){var m,v;const S=w.gl,M=S.createTexture();S.bindTexture(S.TEXTURE_2D,M),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_S,S.CLAMP_TO_EDGE),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_T,S.CLAMP_TO_EDGE),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MIN_FILTER,S.LINEAR),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MAG_FILTER,S.LINEAR);const k=(m=w.HALF_FLOAT)!==null&&m!==void 0?m:S.UNSIGNED_BYTE,O=(v=w.RGBA16F)!==null&&v!==void 0?v:S.RGBA;S.texImage2D(S.TEXTURE_2D,0,O,n,u,0,S.RGBA,k,null);const B=w.createFramebuffer(n,u,!1,!1);return B.colorAttachment.set(M),B}function Cu(w,n){return n.colorRampTexture||(n.colorRampTexture=new o.T(w,n.colorRamp,w.gl.RGBA)),n.colorRampTexture}function Fa(w,n,u,m,v,S,M,k){let O=256;if(v.stepInterpolant){const B=n.getSource().maxzoom,q=M.canonical.z===B?Math.ceil(1<<w.transform.maxZoom-M.canonical.z):1;O=o.an(o.ce(S.maxLineLength/o.a5*1024*q),256,u.maxTextureSize)}return k.gradient=o.cf({expression:v.gradientExpression(),evaluationKey:"lineProgress",resolution:O,image:k.gradient||void 0,clips:S.lineClipsArray}),k.texture?k.texture.update(k.gradient):k.texture=new o.T(u,k.gradient,m.RGBA),k.version=v.gradientVersion,k.texture}function rp(w,n,u,m,v){w.activeTexture.set(n.TEXTURE0),u.imageAtlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE),m.updatePaintBuffers(v)}function On(w,n,u,m,v,S){(v||w.lineAtlas.dirty)&&(n.activeTexture.set(u.TEXTURE0),w.lineAtlas.bind(n)),m.updatePaintBuffers(S)}function wo(w,n,u,m,v,S,M){const k=S.gradients[v.id];let O=k.texture;v.gradientVersion!==k.version&&(O=Fa(w,n,u,m,v,S,M,k)),u.activeTexture.set(m.TEXTURE0),O.bind(v.stepInterpolant?m.NEAREST:m.LINEAR,m.CLAMP_TO_EDGE)}function po(w,n,u,m,v,S,M,k,O){const B=S.gradients[v.id];let q=B.texture;v.gradientVersion!==B.version&&(q=Fa(w,n,u,m,v,S,M,B)),u.activeTexture.set(m.TEXTURE0),q.bind(v.stepInterpolant?m.NEAREST:m.LINEAR,m.CLAMP_TO_EDGE),u.activeTexture.set(m.TEXTURE1),w.lineAtlas.bind(u),k.updatePaintBuffers(O)}function ys(w,n,u,m,v){if(!u||!m||!m.imageAtlas)return;const S=m.imageAtlas.patternPositions;let M=S[u.to.toString()],k=S[u.from.toString()];if(!M&&k&&(M=k),!k&&M&&(k=M),!M||!k){const O=v.getPaintProperty(n);M=S[O],k=S[O]}M&&k&&w.setConstantPatternPositions(M,k)}function Sc(w,n,u,m,v,S,M,k){const O=w.context.gl,B="fill-pattern",q=u.paint.get(B),Y=q&&q.constantOr(1),X=u.getCrossfadeParameters();let te,ce,ge,_e,ve;const Se=w.transform,Oe=u.paint.get("fill-translate"),Ce=u.paint.get("fill-translate-anchor");M?(ce=Y&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",te=O.LINES):(ce=Y?"fillPattern":"fill",te=O.TRIANGLES);const De=q.constantOr(null);for(const Be of m){const Ae=n.getTile(Be);if(Y&&!Ae.patternsLoaded())continue;const Ue=Ae.getBucket(u);if(!Ue)continue;const ut=Ue.programConfigurations.get(u.id),it=w.useProgram(ce,ut),st=w.style.map.terrain&&w.style.map.terrain.getTerrainData(Be);Y&&(w.context.activeTexture.set(O.TEXTURE0),Ae.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),ut.updatePaintBuffers(X)),ys(ut,B,De,Ae,u);const at=Se.getProjectionData({overscaledTileID:Be,applyGlobeMatrix:!k,applyTerrainMatrix:!0}),Rt=o.aO(Se,Ae,Oe,Ce);if(M){_e=Ue.indexBuffer2,ve=Ue.segments2;const Tt=[O.drawingBufferWidth,O.drawingBufferHeight];ge=ce==="fillOutlinePattern"&&Y?qf(w,X,Ae,Tt,Rt):Gf(Tt,Rt)}else _e=Ue.indexBuffer,ve=Ue.segments,ge=Y?vd(w,X,Ae,Rt):{u_fill_translate:Rt};const Dt=w.stencilModeForClipping(Be);it.draw(w.context,te,v,Dt,S,Zr.backCCW,ge,st,at,u.id,Ue.layoutVertexBuffer,_e,ve,u.paint,w.transform.zoom,ut)}}function Od(w,n,u,m,v,S,M,k){const O=w.context,B=O.gl,q="fill-extrusion-pattern",Y=u.paint.get(q),X=Y.constantOr(1),te=u.getCrossfadeParameters(),ce=u.paint.get("fill-extrusion-opacity"),ge=Y.constantOr(null),_e=w.transform;for(const ve of m){const Se=n.getTile(ve),Oe=Se.getBucket(u);if(!Oe)continue;const Ce=w.style.map.terrain&&w.style.map.terrain.getTerrainData(ve),De=Oe.programConfigurations.get(u.id),Be=w.useProgram(X?"fillExtrusionPattern":"fillExtrusion",De);X&&(w.context.activeTexture.set(B.TEXTURE0),Se.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),De.updatePaintBuffers(te));const Ae=_e.getProjectionData({overscaledTileID:ve,applyGlobeMatrix:!k,applyTerrainMatrix:!0});ys(De,q,ge,Se,u);const Ue=o.aO(_e,Se,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),ut=u.paint.get("fill-extrusion-vertical-gradient"),it=X?yd(w,ut,ce,Ue,ve,te,Se):Uf(w,ut,ce,Ue);Be.draw(O,O.gl.TRIANGLES,v,S,M,Zr.backCCW,it,Ce,Ae,u.id,Oe.layoutVertexBuffer,Oe.indexBuffer,Oe.segments,u.paint,w.transform.zoom,De,w.style.map.terrain&&Oe.centroidVertexBuffer)}}function El(w,n,u,m,v,S,M,k,O){var B;const q=w.style.projection,Y=w.context,X=w.transform,te=Y.gl,ce=[`#define NUM_ILLUMINATION_SOURCES ${u.paint.get("hillshade-highlight-color").values.length}`],ge=w.useProgram("hillshade",null,!1,ce),_e=!w.options.moving;for(const ve of m){const Se=n.getTile(ve),Oe=Se.fbo;if(!Oe)continue;const Ce=q.getMeshFromTileID(Y,ve.canonical,k,!0,"raster"),De=(B=w.style.map.terrain)===null||B===void 0?void 0:B.getTerrainData(ve);Y.activeTexture.set(te.TEXTURE0),te.bindTexture(te.TEXTURE_2D,Oe.colorAttachment.get());const Be=X.getProjectionData({overscaledTileID:ve,aligned:_e,applyGlobeMatrix:!O,applyTerrainMatrix:!0});ge.draw(Y,te.TRIANGLES,S,v[ve.overscaledZ],M,Zr.backCCW,_h(w,Se,u),De,Be,u.id,Ce.vertexBuffer,Ce.indexBuffer,Ce.segments)}}function $s(w,n,u,m,v,S,M,k,O){var B;const q=w.style.projection,Y=w.context,X=w.transform,te=Y.gl,ce=w.useProgram("colorRelief"),ge=!w.options.moving;let _e=!0,ve=0;for(const Se of m){const Oe=n.getTile(Se),Ce=Oe.dem;if(_e){const it=te.getParameter(te.MAX_TEXTURE_SIZE),{elevationTexture:st,colorTexture:at}=u.getColorRampTextures(Y,it,Ce.getUnpackVector());Y.activeTexture.set(te.TEXTURE1),st.bind(te.NEAREST,te.CLAMP_TO_EDGE),Y.activeTexture.set(te.TEXTURE4),at.bind(te.LINEAR,te.CLAMP_TO_EDGE),_e=!1,ve=st.size[0]}if(!Ce||!Ce.data)continue;const De=Ce.stride,Be=Ce.getPixels();if(Y.activeTexture.set(te.TEXTURE0),Y.pixelStoreUnpackPremultiplyAlpha.set(!1),Oe.demTexture=Oe.demTexture||w.getTileTexture(De),Oe.demTexture){const it=Oe.demTexture;it.update(Be,{premultiply:!1}),it.bind(te.LINEAR,te.CLAMP_TO_EDGE)}else Oe.demTexture=new o.T(Y,Be,te.RGBA,{premultiply:!1}),Oe.demTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE);const Ae=q.getMeshFromTileID(Y,Se.canonical,k,!0,"raster"),Ue=(B=w.style.map.terrain)===null||B===void 0?void 0:B.getTerrainData(Se),ut=X.getProjectionData({overscaledTileID:Se,aligned:ge,applyGlobeMatrix:!O,applyTerrainMatrix:!0});ce.draw(Y,te.TRIANGLES,S,v[Se.overscaledZ],M,Zr.backCCW,ym(u,Oe.dem,ve),Ue,ut,u.id,Ae.vertexBuffer,Ae.indexBuffer,Ae.segments)}}const js=[new o.P(0,0),new o.P(o.a5,0),new o.P(o.a5,o.a5),new o.P(0,o.a5)];function Ns(w,n,u,m,v,S,M,k,O=!1,B=!1){const q=m[m.length-1].overscaledZ,Y=w.context,X=Y.gl,te=w.useProgram("raster"),ce=w.transform,ge=w.style.projection,_e=w.colorModeForRenderPass(),ve=!w.options.moving,Se=u.paint.get("raster-opacity"),Oe=u.paint.get("raster-resampling"),Ce=u.paint.get("raster-fade-duration"),De=!!w.style.map.terrain;for(const Be of m){const Ae=w.getDepthModeForSublayer(Be.overscaledZ-q,Se===1?Br.ReadWrite:Br.ReadOnly,X.LESS),Ue=n.getTile(Be),ut=Oe==="nearest"?X.NEAREST:X.LINEAR;Y.activeTexture.set(X.TEXTURE0),Ue.texture.bind(ut,X.CLAMP_TO_EDGE,X.LINEAR_MIPMAP_NEAREST),Y.activeTexture.set(X.TEXTURE1);const{parentTile:it,parentScaleBy:st,parentTopLeft:at,fadeValues:Rt}=Ah(Ue,n,Ce,De);Ue.fadeOpacity=Rt.tileOpacity,it?(it.fadeOpacity=Rt.parentTileOpacity,it.texture.bind(ut,X.CLAMP_TO_EDGE,X.LINEAR_MIPMAP_NEAREST)):Ue.texture.bind(ut,X.CLAMP_TO_EDGE,X.LINEAR_MIPMAP_NEAREST),Ue.texture.useMipmap&&Y.extTextureFilterAnisotropic&&w.transform.pitch>20&&X.texParameterf(X.TEXTURE_2D,Y.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Y.extTextureFilterAnisotropicMax);const Dt=w.style.map.terrain&&w.style.map.terrain.getTerrainData(Be),Tt=ce.getProjectionData({overscaledTileID:Be,aligned:ve,applyGlobeMatrix:!B,applyTerrainMatrix:!0}),Nt=bd(at,st,Rt.fadeMix,u,k),kr=ge.getMeshFromTileID(Y,Be.canonical,S,M,"raster");te.draw(Y,X.TRIANGLES,Ae,v?v[Be.overscaledZ]:Yr.disabled,_e,O?Zr.frontCCW:Zr.backCCW,Nt,Dt,Tt,u.id,kr.vertexBuffer,kr.indexBuffer,kr.segments)}}function Ah(w,n,u,m){const v={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(u===0||m)return v;if(w.fadingParentID){const S=n.getLoadedTile(w.fadingParentID);if(!S)return v;const M=Math.pow(2,S.tileID.overscaledZ-w.tileID.overscaledZ),k=[w.tileID.canonical.x*M%1,w.tileID.canonical.y*M%1],O=function(B,q,Y){const X=$(),te=(X-q.timeAdded)/Y,ce=B.fadingDirection===Je.Incoming,ge=o.an((X-B.timeAdded)/Y,0,1),_e=o.an(1-te,0,1),ve=ce?ge:_e;return{tileOpacity:ve,parentTileOpacity:ce?_e:ge,fadeMix:{opacity:1,mix:1-ve}}}(w,S,u);return{parentTile:S,parentScaleBy:M,parentTopLeft:k,fadeValues:O}}if(w.selfFading){const S=function(M,k){const O=($()-M.timeAdded)/k,B=o.an(O,0,1);return{tileOpacity:B,fadeMix:{opacity:B,mix:0}}}(w,u);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:S}}return v}const Ld=new o.bp(1,0,0,1),Cc=new o.bp(0,1,0,1),Ba=new o.bp(0,0,1,1),Hn=new o.bp(1,0,1,1),pn=new o.bp(0,1,1,1);function ia(w,n,u,m){ro(w,0,n+u/2,w.transform.width,u,m)}function to(w,n,u,m){ro(w,n-u/2,0,u,w.transform.height,m)}function ro(w,n,u,m,v,S){const M=w.context,k=M.gl;k.enable(k.SCISSOR_TEST),k.scissor(n*w.pixelRatio,u*w.pixelRatio,m*w.pixelRatio,v*w.pixelRatio),M.clear({color:S}),k.disable(k.SCISSOR_TEST)}function Il(w,n,u){const m=w.context,v=m.gl,S=w.useProgram("debug"),M=Br.disabled,k=Yr.disabled,O=w.colorModeForRenderPass(),B="$debug",q=w.style.map.terrain&&w.style.map.terrain.getTerrainData(u);m.activeTexture.set(v.TEXTURE0);const Y=n.getTileByID(u.key).latestRawTileData,X=Math.floor((Y&&Y.byteLength||0)/1024),te=n.getTile(u).tileSize,ce=512/Math.min(te,512)*(u.overscaledZ/w.transform.zoom)*.5;let ge=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(ge+=` => ${u.overscaledZ}`),function(ve,Se){ve.initDebugOverlayCanvas();const Oe=ve.debugOverlayCanvas,Ce=ve.context.gl,De=ve.debugOverlayCanvas.getContext("2d");De.clearRect(0,0,Oe.width,Oe.height),De.shadowColor="white",De.shadowBlur=2,De.lineWidth=1.5,De.strokeStyle="white",De.textBaseline="top",De.font="bold 36px Open Sans, sans-serif",De.fillText(Se,5,5),De.strokeText(Se,5,5),ve.debugOverlayTexture.update(Oe),ve.debugOverlayTexture.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE)}(w,`${ge} ${X}kB`);const _e=w.transform.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!0,applyTerrainMatrix:!0});S.draw(m,v.TRIANGLES,M,k,sn.alphaBlended,Zr.disabled,Wf(o.bp.transparent,ce),null,_e,B,w.debugBuffer,w.quadTriangleIndexBuffer,w.debugSegments),S.draw(m,v.LINE_STRIP,M,k,O,Zr.disabled,Wf(o.bp.red),q,_e,B,w.debugBuffer,w.tileBorderIndexBuffer,w.debugSegments)}function kl(w,n,u,m){const{isRenderingGlobe:v}=m,S=w.context,M=S.gl,k=w.transform,O=w.colorModeForRenderPass(),B=w.getDepthModeFor3D(),q=w.useProgram("terrain");S.bindFramebuffer.set(null),S.viewport.set([0,0,w.width,w.height]);for(const Y of u){const X=n.getTerrainMesh(Y.tileID),te=w.renderToTexture.getTexture(Y),ce=n.getTerrainData(Y.tileID);S.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,te.texture);const ge=n.getMeshFrameDelta(k.zoom),_e=k.calculateFogMatrix(Y.tileID.toUnwrapped()),ve=oy(ge,_e,w.style.sky,k.pitch,v),Se=k.getProjectionData({overscaledTileID:Y.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});q.draw(S,M.TRIANGLES,B,Yr.disabled,O,Zr.backCCW,ve,ce,Se,"terrain",X.vertexBuffer,X.indexBuffer,X.segments)}}function So(w,n){if(!n.mesh){const u=new o.aW;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(1,1),u.emplaceBack(-1,1);const m=new o.aY;m.emplaceBack(0,1,2),m.emplaceBack(0,2,3),n.mesh=new Mn(w.createVertexBuffer(u,ps.members),w.createIndexBuffer(m),o.aX.simpleSegment(0,0,u.length,m.length))}return n.mesh}class Rh{constructor(n,u){this.context=new Ad(n),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ki.maxOverzooming+Ki.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ji}resize(n,u,m){if(this.width=Math.floor(n*m),this.height=Math.floor(u*m),this.pixelRatio=m,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style._order)this.style._layers[v].resize()}setup(){const n=this.context,u=new o.aW;u.emplaceBack(0,0),u.emplaceBack(o.a5,0),u.emplaceBack(0,o.a5),u.emplaceBack(o.a5,o.a5),this.tileExtentBuffer=n.createVertexBuffer(u,ps.members),this.tileExtentSegments=o.aX.simpleSegment(0,0,4,2);const m=new o.aW;m.emplaceBack(0,0),m.emplaceBack(o.a5,0),m.emplaceBack(0,o.a5),m.emplaceBack(o.a5,o.a5),this.debugBuffer=n.createVertexBuffer(m,ps.members),this.debugSegments=o.aX.simpleSegment(0,0,4,5);const v=new o.ch;v.emplaceBack(0,0,0,0),v.emplaceBack(o.a5,0,o.a5,0),v.emplaceBack(0,o.a5,0,o.a5),v.emplaceBack(o.a5,o.a5,o.a5,o.a5),this.rasterBoundsBuffer=n.createVertexBuffer(v,iy.members),this.rasterBoundsSegments=o.aX.simpleSegment(0,0,4,2);const S=new o.aW;S.emplaceBack(0,0),S.emplaceBack(o.a5,0),S.emplaceBack(0,o.a5),S.emplaceBack(o.a5,o.a5),this.rasterBoundsBufferPosOnly=n.createVertexBuffer(S,ps.members),this.rasterBoundsSegmentsPosOnly=o.aX.simpleSegment(0,0,4,5);const M=new o.aW;M.emplaceBack(0,0),M.emplaceBack(1,0),M.emplaceBack(0,1),M.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(M,ps.members),this.viewportSegments=o.aX.simpleSegment(0,0,4,2);const k=new o.ci;k.emplaceBack(0),k.emplaceBack(1),k.emplaceBack(3),k.emplaceBack(2),k.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(k);const O=new o.aY;O.emplaceBack(1,0,2),O.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(O);const B=this.context.gl;this.stencilClearMode=new Yr({func:B.ALWAYS,mask:0},0,255,B.ZERO,B.ZERO,B.ZERO),this.tileExtentMesh=new Mn(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const n=this.context,u=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const m=o.N();o.c7(m,0,this.width,this.height,0,0,1),o.Q(m,m,[u.drawingBufferWidth,u.drawingBufferHeight,0]);const v={mainMatrix:m,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:m};this.useProgram("clippingMask",null,!0).draw(n,u.TRIANGLES,Br.disabled,this.stencilClearMode,sn.disabled,Zr.disabled,null,null,v,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,u,m){if(this.currentStencilSource===n.source||!n.isTileClipped()||!u||!u.length)return;this.currentStencilSource=n.source,this.nextStencilID+u.length>256&&this.clearStencil();const v=this.context;v.setColorMode(sn.disabled),v.setDepthMode(Br.disabled);const S={};for(const M of u)S[M.key]=this.nextStencilID++;this._renderTileMasks(S,u,m,!0),this._renderTileMasks(S,u,m,!1),this._tileClippingMaskIDs=S}_renderTileMasks(n,u,m,v){const S=this.context,M=S.gl,k=this.style.projection,O=this.transform,B=this.useProgram("clippingMask");for(const q of u){const Y=n[q.key],X=this.style.map.terrain&&this.style.map.terrain.getTerrainData(q),te=k.getMeshFromTileID(this.context,q.canonical,v,!0,"stencil"),ce=O.getProjectionData({overscaledTileID:q,applyGlobeMatrix:!m,applyTerrainMatrix:!0});B.draw(S,M.TRIANGLES,Br.disabled,new Yr({func:M.ALWAYS,mask:0},Y,255,M.KEEP,M.KEEP,M.REPLACE),sn.disabled,m?Zr.disabled:Zr.backCCW,null,X,ce,"$clipping",te.vertexBuffer,te.indexBuffer,te.segments)}}_renderTilesDepthBuffer(){const n=this.context,u=n.gl,m=this.style.projection,v=this.transform,S=this.useProgram("depth"),M=this.getDepthModeFor3D(),k=zr(v,{tileSize:v.tileSize});for(const O of k){const B=this.style.map.terrain&&this.style.map.terrain.getTerrainData(O),q=m.getMeshFromTileID(this.context,O.canonical,!0,!0,"raster"),Y=v.getProjectionData({overscaledTileID:O,applyGlobeMatrix:!0,applyTerrainMatrix:!0});S.draw(n,u.TRIANGLES,M,Yr.disabled,sn.disabled,Zr.backCCW,null,B,Y,"$clipping",q.vertexBuffer,q.indexBuffer,q.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,u=this.context.gl;return new Yr({func:u.NOTEQUAL,mask:255},n,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(n){const u=this.context.gl;return new Yr({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,u.KEEP,u.KEEP,u.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(n){const u=this.context.gl,m=n.sort((M,k)=>k.overscaledZ-M.overscaledZ),v=m[m.length-1].overscaledZ,S=m[0].overscaledZ-v+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const M={};for(let k=0;k<S;k++)M[k+v]=new Yr({func:u.GEQUAL,mask:255},k+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=S,[M,m]}return[{[v]:Yr.disabled},m]}stencilConfigForOverlapTwoPass(n){const u=this.context.gl,m=n.sort((M,k)=>k.overscaledZ-M.overscaledZ),v=m[m.length-1].overscaledZ,S=m[0].overscaledZ-v+1;if(this.clearStencil(),S>1){const M={},k={};for(let O=0;O<S;O++)M[O+v]=new Yr({func:u.GREATER,mask:255},S+1+O,255,u.KEEP,u.KEEP,u.REPLACE),k[O+v]=new Yr({func:u.GREATER,mask:255},1+O,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID=2*S+1,[M,k,m]}return this.nextStencilID=3,[{[v]:new Yr({func:u.GREATER,mask:255},2,255,u.KEEP,u.KEEP,u.REPLACE)},{[v]:new Yr({func:u.GREATER,mask:255},1,255,u.KEEP,u.KEEP,u.REPLACE)},m]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new sn([n.CONSTANT_COLOR,n.ONE],new o.bp(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?sn.unblended:sn.alphaBlended}getDepthModeForSublayer(n,u,m){if(!this.opaquePassEnabledForLayer())return Br.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new Br(m||this.context.gl.LEQUAL,u,[v,v])}getDepthModeFor3D(){return new Br(this.context.gl.LEQUAL,Br.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,u){var m,v;this.style=n,this.options=u,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange($()),this.imageManager.beginFrame();const S=this.style._order,M=this.style.tileManagers,k={},O={},B={},q={isRenderingToTexture:!1,isRenderingGlobe:((m=n.projection)===null||m===void 0?void 0:m.transitionState)>0};for(const X in M){const te=M[X];te.used&&te.prepare(this.context),k[X]=te.getVisibleCoordinates(!1),O[X]=k[X].slice().reverse(),B[X]=te.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let X=0;X<S.length;X++)if(this.style._layers[S[X]].is3D()){this.opaquePassCutoff=X;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const X of S){const te=this.style._layers[X];if(!te.hasOffscreenPass()||te.isHidden(this.transform.zoom))continue;const ce=O[te.source];(te.type==="custom"||ce.length)&&this.renderLayer(this,M[te.source],te,ce,q)}if((v=this.style.projection)===null||v===void 0||v.updateGPUdependent({context:this.context,useProgram:X=>this.useProgram(X)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?o.bp.black:o.bp.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(X,te){const ce=X.context,ge=ce.gl,_e=((Be,Ae,Ue)=>{const ut=Math.cos(Ae.rollInRadians),it=Math.sin(Ae.rollInRadians),st=br(Ae),at=Ae.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Be.properties.get("sky-color"),u_horizon_color:Be.properties.get("horizon-color"),u_horizon:[(Ae.width/2-st*it)*Ue,(Ae.height/2+st*ut)*Ue],u_horizon_normal:[-it,ut],u_sky_horizon_blend:Be.properties.get("sky-horizon-blend")*Ae.height/2*Ue,u_sky_blend:at}})(te,X.style.map.transform,X.pixelRatio),ve=new Br(ge.LEQUAL,Br.ReadWrite,[0,1]),Se=Yr.disabled,Oe=X.colorModeForRenderPass(),Ce=X.useProgram("sky"),De=So(ce,te);Ce.draw(ce,ge.TRIANGLES,ve,Se,Oe,Zr.disabled,_e,null,void 0,"sky",De.vertexBuffer,De.indexBuffer,De.segments)}(this,this.style.sky),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=S.length-1;this.currentLayer>=0;this.currentLayer--){const X=this.style._layers[S[this.currentLayer]],te=M[X.source],ce=k[X.source];this._renderTileClippingMasks(X,ce,!1),this.renderLayer(this,te,X,ce,q)}this.renderPass="translucent";let Y=!1;for(this.currentLayer=0;this.currentLayer<S.length;this.currentLayer++){const X=this.style._layers[S[this.currentLayer]],te=M[X.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(X,q))continue;this.opaquePassEnabledForLayer()||Y||(Y=!0,q.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const ce=(X.type==="symbol"?B:O)[X.source];this._renderTileClippingMasks(X,k[X.source],!!this.renderToTexture),this.renderLayer(this,te,X,ce,q)}if(q.isRenderingGlobe&&function(X,te,ce){const ge=X.context,_e=ge.gl,ve=X.useProgram("atmosphere"),Se=new Br(_e.LEQUAL,Br.ReadOnly,[0,1]),Oe=X.transform,Ce=function(at,Rt){const Dt=at.properties.get("position"),Tt=[-Dt.x,-Dt.y,-Dt.z],Nt=o.ar(new Float64Array(16));return at.properties.get("anchor")==="map"&&(o.bg(Nt,Nt,Rt.rollInRadians),o.bh(Nt,Nt,-Rt.pitchInRadians),o.bg(Nt,Nt,Rt.bearingInRadians),o.bh(Nt,Nt,Rt.center.lat*Math.PI/180),o.bJ(Nt,Nt,-Rt.center.lng*Math.PI/180)),o.cg(Tt,Tt,Nt),Tt}(ce,X.transform),De=Oe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Be=te.properties.get("atmosphere-blend")*De.projectionTransition;if(Be===0)return;const Ae=lc(Oe.worldSize,Oe.center.lat),Ue=Oe.inverseProjectionMatrix,ut=new Float64Array(4);ut[3]=1,o.aH(ut,ut,Oe.modelViewProjectionMatrix),ut[0]/=ut[3],ut[1]/=ut[3],ut[2]/=ut[3],ut[3]=1,o.aH(ut,ut,Ue),ut[0]/=ut[3],ut[1]/=ut[3],ut[2]/=ut[3],ut[3]=1;const it=((at,Rt,Dt,Tt,Nt)=>({u_sun_pos:at,u_atmosphere_blend:Rt,u_globe_position:Dt,u_globe_radius:Tt,u_inv_proj_matrix:Nt}))(Ce,Be,[ut[0],ut[1],ut[2]],Ae,Ue),st=So(ge,te);ve.draw(ge,_e.TRIANGLES,Se,Yr.disabled,sn.alphaBlended,Zr.disabled,it,null,null,"atmosphere",st.vertexBuffer,st.indexBuffer,st.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const X=function(te,ce){let ge=null;const _e=Object.values(te._layers).flatMap(Ce=>Ce.source&&!Ce.isHidden(ce)?[te.tileManagers[Ce.source]]:[]),ve=_e.filter(Ce=>Ce.getSource().type==="vector"),Se=_e.filter(Ce=>Ce.getSource().type!=="vector"),Oe=Ce=>{(!ge||ge.getSource().maxzoom<Ce.getSource().maxzoom)&&(ge=Ce)};return ve.forEach(Ce=>Oe(Ce)),ge||Se.forEach(Ce=>Oe(Ce)),ge}(this.style,this.transform.zoom);X&&function(te,ce,ge){for(let _e=0;_e<ge.length;_e++)Il(te,ce,ge[_e])}(this,X,X.getVisibleCoordinates())}this.options.showPadding&&function(X){const te=X.transform.padding;ia(X,X.transform.height-(te.top||0),3,Ld),ia(X,te.bottom||0,3,Cc),to(X,te.left||0,3,Ba),to(X,X.transform.width-(te.right||0),3,Hn);const ce=X.transform.centerPoint;(function(ge,_e,ve,Se){ro(ge,_e-1,ve-10,2,20,Se),ro(ge,_e-10,ve-1,20,2,Se)})(X,ce.x,X.transform.height-ce.y,pn)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(n){if(!this.style||!this.style.map||!this.style.map.terrain)return;const u=this.terrainFacilitator.matrix,m=this.transform.modelViewProjectionMatrix;let v=this.terrainFacilitator.dirty;v||(v=n?!o.cj(u,m):!o.ck(u,m)),v||(v=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),v&&(o.cl(u,m),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(S,M){const k=S.context,O=k.gl,B=S.transform,q=sn.unblended,Y=new Br(O.LEQUAL,Br.ReadWrite,[0,1]),X=M.tileManager.getRenderableTiles(),te=S.useProgram("terrainDepth");k.bindFramebuffer.set(M.getFramebuffer("depth").framebuffer),k.viewport.set([0,0,S.width/devicePixelRatio,S.height/devicePixelRatio]),k.clear({color:o.bp.transparent,depth:1});for(const ce of X){const ge=M.getTerrainMesh(ce.tileID),_e=M.getTerrainData(ce.tileID),ve=B.getProjectionData({overscaledTileID:ce.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),Se={u_ele_delta:M.getMeshFrameDelta(B.zoom)};te.draw(k,O.TRIANGLES,Y,Yr.disabled,q,Zr.backCCW,Se,_e,ve,"terrain",ge.vertexBuffer,ge.indexBuffer,ge.segments)}k.bindFramebuffer.set(null),k.viewport.set([0,0,S.width,S.height])}(this,this.style.map.terrain),function(S,M){const k=S.context,O=k.gl,B=S.transform,q=sn.unblended,Y=new Br(O.LEQUAL,Br.ReadWrite,[0,1]),X=M.getCoordsTexture(),te=M.tileManager.getRenderableTiles(),ce=S.useProgram("terrainCoords");k.bindFramebuffer.set(M.getFramebuffer("coords").framebuffer),k.viewport.set([0,0,S.width/devicePixelRatio,S.height/devicePixelRatio]),k.clear({color:o.bp.transparent,depth:1}),M.coordsIndex=[];for(const ge of te){const _e=M.getTerrainMesh(ge.tileID),ve=M.getTerrainData(ge.tileID);k.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,X.texture);const Se={u_terrain_coords_id:(255-M.coordsIndex.length)/255,u_texture:0,u_ele_delta:M.getMeshFrameDelta(B.zoom)},Oe=B.getProjectionData({overscaledTileID:ge.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});ce.draw(k,O.TRIANGLES,Y,Yr.disabled,q,Zr.backCCW,Se,ve,Oe,"terrain",_e.vertexBuffer,_e.indexBuffer,_e.segments),M.coordsIndex.push(ge.tileID.key)}k.bindFramebuffer.set(null),k.viewport.set([0,0,S.width,S.height])}(this,this.style.map.terrain))}renderLayer(n,u,m,v,S){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="custom"||(v||[]).length)&&(this.id=m.id,o.cm(m)?function(M,k,O,B,q,Y){if(M.renderPass!=="translucent")return;const{isRenderingToTexture:X}=Y,te=Yr.disabled,ce=M.colorModeForRenderPass();(O._unevaluatedLayout.hasValue("text-variable-anchor")||O._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ge,_e,ve,Se,Oe,Ce,De,Be,Ae){const Ue=_e.transform,ut=_e.style.map.terrain,it=Oe==="map",st=Ce==="map";for(const at of ge){const Rt=Se.getTile(at),Dt=Rt.getBucket(ve);if(!Dt||!Dt.text||!Dt.text.segments.get().length)continue;const Tt=o.ay(Dt.textSizeData,Ue.zoom),Nt=o.aN(Rt,1,_e.transform.zoom),kr=Zt(it,_e.transform,Nt),xn=ve.layout.get("icon-text-fit")!=="none"&&Dt.hasIconData();if(Tt){const Zn=Math.pow(2,Ue.zoom-Rt.tileID.overscaledZ),Pn=ut?(Xn,En)=>ut.getElevation(at,Xn,En):null;ep(Dt,it,st,Ae,Ue,kr,Zn,Tt,xn,o.aO(Ue,Rt,De,Be),at.toUnwrapped(),Pn)}}}(B,M,O,k,O.layout.get("text-rotation-alignment"),O.layout.get("text-pitch-alignment"),O.paint.get("text-translate"),O.paint.get("text-translate-anchor"),q),O.paint.get("icon-opacity").constantOr(1)!==0&&wc(M,k,O,B,!1,O.paint.get("icon-translate"),O.paint.get("icon-translate-anchor"),O.layout.get("icon-rotation-alignment"),O.layout.get("icon-pitch-alignment"),O.layout.get("icon-keep-upright"),te,ce,X),O.paint.get("text-opacity").constantOr(1)!==0&&wc(M,k,O,B,!0,O.paint.get("text-translate"),O.paint.get("text-translate-anchor"),O.layout.get("text-rotation-alignment"),O.layout.get("text-pitch-alignment"),O.layout.get("text-keep-upright"),te,ce,X),k.map.showCollisionBoxes&&(Pl(M,k,O,B,!0),Pl(M,k,O,B,!1))}(n,u,m,v,this.style.placement.variableOffsets,S):o.cn(m)?function(M,k,O,B,q){if(M.renderPass!=="translucent")return;const{isRenderingToTexture:Y}=q,X=O.paint.get("circle-opacity"),te=O.paint.get("circle-stroke-width"),ce=O.paint.get("circle-stroke-opacity"),ge=!O.layout.get("circle-sort-key").isConstant();if(X.constantOr(1)===0&&(te.constantOr(1)===0||ce.constantOr(1)===0))return;const _e=M.context,ve=_e.gl,Se=M.transform,Oe=M.getDepthModeForSublayer(0,Br.ReadOnly),Ce=Yr.disabled,De=M.colorModeForRenderPass(),Be=[],Ae=Se.getCircleRadiusCorrection();for(let Ue=0;Ue<B.length;Ue++){const ut=B[Ue],it=k.getTile(ut),st=it.getBucket(O);if(!st)continue;const at=O.paint.get("circle-translate"),Rt=O.paint.get("circle-translate-anchor"),Dt=o.aO(Se,it,at,Rt),Tt=st.programConfigurations.get(O.id),Nt=M.useProgram("circle",Tt),kr=st.layoutVertexBuffer,xn=st.indexBuffer,Zn=M.style.map.terrain&&M.style.map.terrain.getTerrainData(ut),Pn={programConfiguration:Tt,program:Nt,layoutVertexBuffer:kr,indexBuffer:xn,uniformValues:Hf(M,it,O,Dt,Ae),terrainData:Zn,projectionData:Se.getProjectionData({overscaledTileID:ut,applyGlobeMatrix:!Y,applyTerrainMatrix:!0})};if(ge){const Xn=st.segments.get();for(const En of Xn)Be.push({segments:new o.aX([En]),sortKey:En.sortKey,state:Pn})}else Be.push({segments:st.segments,sortKey:0,state:Pn})}ge&&Be.sort((Ue,ut)=>Ue.sortKey-ut.sortKey);for(const Ue of Be){const{programConfiguration:ut,program:it,layoutVertexBuffer:st,indexBuffer:at,uniformValues:Rt,terrainData:Dt,projectionData:Tt}=Ue.state;it.draw(_e,ve.TRIANGLES,Oe,Ce,De,Zr.backCCW,Rt,Dt,Tt,O.id,st,at,Ue.segments,O.paint,M.transform.zoom,ut)}}(n,u,m,v,S):o.co(m)?function(M,k,O,B,q){if(O.paint.get("heatmap-opacity")===0)return;const Y=M.context,{isRenderingToTexture:X,isRenderingGlobe:te}=q;if(M.style.map.terrain){for(const ce of B){const ge=k.getTile(ce);k.hasRenderableParent(ce)||(M.renderPass==="offscreen"?tp(M,ge,O,ce,te):M.renderPass==="translucent"&&Cm(M,O,ce,X,te))}Y.viewport.set([0,0,M.width,M.height])}else M.renderPass==="offscreen"?function(ce,ge,_e,ve){const Se=ce.context,Oe=Se.gl,Ce=ce.transform,De=Yr.disabled,Be=new sn([Oe.ONE,Oe.ONE],o.bp.transparent,[!0,!0,!0,!0]);(function(Ae,Ue,ut){const it=Ae.gl;Ae.activeTexture.set(it.TEXTURE1),Ae.viewport.set([0,0,Ue.width/4,Ue.height/4]);let st=ut.heatmapFbos.get(o.cd);st?(it.bindTexture(it.TEXTURE_2D,st.colorAttachment.get()),Ae.bindFramebuffer.set(st.framebuffer)):(st=kh(Ae,Ue.width/4,Ue.height/4),ut.heatmapFbos.set(o.cd,st))})(Se,ce,_e),Se.clear({color:o.bp.transparent});for(let Ae=0;Ae<ve.length;Ae++){const Ue=ve[Ae];if(ge.hasRenderableParent(Ue))continue;const ut=ge.getTile(Ue),it=ut.getBucket(_e);if(!it)continue;const st=it.programConfigurations.get(_e.id),at=ce.useProgram("heatmap",st),Rt=Ce.getProjectionData({overscaledTileID:Ue,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Dt=Ce.getCircleRadiusCorrection();at.draw(Se,Oe.TRIANGLES,Br.disabled,De,Be,Zr.backCCW,yu(ut,Ce.zoom,_e.paint.get("heatmap-intensity"),Dt),null,Rt,_e.id,it.layoutVertexBuffer,it.indexBuffer,it.segments,_e.paint,Ce.zoom,st)}Se.viewport.set([0,0,ce.width,ce.height])}(M,k,O,B):M.renderPass==="translucent"&&function(ce,ge){const _e=ce.context,ve=_e.gl;_e.setColorMode(ce.colorModeForRenderPass());const Se=ge.heatmapFbos.get(o.cd);Se&&(_e.activeTexture.set(ve.TEXTURE0),ve.bindTexture(ve.TEXTURE_2D,Se.colorAttachment.get()),_e.activeTexture.set(ve.TEXTURE1),Cu(_e,ge).bind(ve.LINEAR,ve.CLAMP_TO_EDGE),ce.useProgram("heatmapTexture").draw(_e,ve.TRIANGLES,Br.disabled,Yr.disabled,ce.colorModeForRenderPass(),Zr.disabled,Zf(ce,ge,0,1),null,null,ge.id,ce.viewportBuffer,ce.quadTriangleIndexBuffer,ce.viewportSegments,ge.paint,ce.transform.zoom))}(M,O)}(n,u,m,v,S):o.cp(m)?function(M,k,O,B,q){if(M.renderPass!=="translucent")return;const{isRenderingToTexture:Y}=q,X=O.paint.get("line-opacity"),te=O.paint.get("line-width");if(X.constantOr(1)===0||te.constantOr(1)===0)return;const ce=M.getDepthModeForSublayer(0,Br.ReadOnly),ge=M.colorModeForRenderPass(),_e=O.paint.get("line-dasharray"),ve=_e.constantOr(1),Se=O.paint.get("line-pattern"),Oe=Se.constantOr(1),Ce=O.paint.get("line-gradient"),De=O.getCrossfadeParameters();let Be;Be=Oe?"linePattern":ve&&Ce?"lineGradientSDF":ve?"lineSDF":Ce?"lineGradient":"line";const Ae=M.context,Ue=Ae.gl,ut=M.transform;let it=!0;for(const st of B){const at=k.getTile(st);if(Oe&&!at.patternsLoaded())continue;const Rt=at.getBucket(O);if(!Rt)continue;const Dt=Rt.programConfigurations.get(O.id),Tt=M.context.program.get(),Nt=M.useProgram(Be,Dt),kr=it||Nt.program!==Tt,xn=M.style.map.terrain&&M.style.map.terrain.getTerrainData(st),Zn=Se.constantOr(null),Pn=_e&&_e.constantOr(null);if(Zn&&at.imageAtlas){const no=at.imageAtlas,ki=no.patternPositions[Zn.to.toString()],yn=no.patternPositions[Zn.from.toString()];ki&&yn&&Dt.setConstantPatternPositions(ki,yn)}else if(Pn){const no=O.layout.get("line-cap")==="round",ki=M.lineAtlas.getDash(Pn.to,no),yn=M.lineAtlas.getDash(Pn.from,no);Dt.setConstantDashPositions(ki,yn)}const Xn=ut.getProjectionData({overscaledTileID:st,applyGlobeMatrix:!Y,applyTerrainMatrix:!0}),En=ut.getPixelScale();let Kn;Oe?(Kn=_d(M,at,O,En,De),rp(Ae,Ue,at,Dt,De)):ve&&Ce?(Kn=vu(M,at,O,En,De,Rt.lineClipsArray.length),po(M,k,Ae,Ue,O,Rt,st,Dt,De)):ve?(Kn=xd(M,at,O,En,De),On(M,Ae,Ue,Dt,kr,De)):Ce?(Kn=vm(M,at,O,En,Rt.lineClipsArray.length),wo(M,k,Ae,Ue,O,Rt,st)):Kn=Sl(M,at,O,En);const ii=M.stencilModeForClipping(st);Nt.draw(Ae,Ue.TRIANGLES,ce,ii,ge,Zr.disabled,Kn,xn,Xn,O.id,Rt.layoutVertexBuffer,Rt.indexBuffer,Rt.segments,O.paint,M.transform.zoom,Dt,Rt.layoutVertexBuffer2),it=!1}}(n,u,m,v,S):o.cq(m)?function(M,k,O,B,q){const Y=O.paint.get("fill-color"),X=O.paint.get("fill-opacity");if(X.constantOr(1)===0)return;const{isRenderingToTexture:te}=q,ce=M.colorModeForRenderPass(),ge=O.paint.get("fill-pattern"),_e=M.opaquePassEnabledForLayer()&&!ge.constantOr(1)&&Y.constantOr(o.bp.transparent).a===1&&X.constantOr(0)===1?"opaque":"translucent";if(M.renderPass===_e){const ve=M.getDepthModeForSublayer(1,M.renderPass==="opaque"?Br.ReadWrite:Br.ReadOnly);Sc(M,k,O,B,ve,ce,!1,te)}if(M.renderPass==="translucent"&&O.paint.get("fill-antialias")){const ve=M.getDepthModeForSublayer(O.getPaintProperty("fill-outline-color")?2:0,Br.ReadOnly);Sc(M,k,O,B,ve,ce,!0,te)}}(n,u,m,v,S):o.cr(m)?function(M,k,O,B,q){const Y=O.paint.get("fill-extrusion-opacity");if(Y===0)return;const{isRenderingToTexture:X}=q;if(M.renderPass==="translucent"){const te=new Br(M.context.gl.LEQUAL,Br.ReadWrite,M.depthRangeFor3D);if(Y!==1||O.paint.get("fill-extrusion-pattern").constantOr(1))Od(M,k,O,B,te,Yr.disabled,sn.disabled,X),Od(M,k,O,B,te,M.stencilModeFor3D(),M.colorModeForRenderPass(),X);else{const ce=M.colorModeForRenderPass();Od(M,k,O,B,te,Yr.disabled,ce,X)}}}(n,u,m,v,S):o.cs(m)?function(M,k,O,B,q){if(M.renderPass!=="offscreen"&&M.renderPass!=="translucent")return;const{isRenderingToTexture:Y}=q,X=M.context,te=M.style.projection.useSubdivision,ce=M.getDepthModeForSublayer(0,Br.ReadOnly),ge=M.colorModeForRenderPass();if(M.renderPass==="offscreen")(function(_e,ve,Se,Oe,Ce,De,Be){const Ae=_e.context,Ue=Ae.gl;for(const ut of Se){const it=ve.getTile(ut),st=it.dem;if(!st||!st.data||!it.needsHillshadePrepare)continue;const at=st.dim,Rt=st.stride,Dt=st.getPixels();if(Ae.activeTexture.set(Ue.TEXTURE1),Ae.pixelStoreUnpackPremultiplyAlpha.set(!1),it.demTexture=it.demTexture||_e.getTileTexture(Rt),it.demTexture){const Nt=it.demTexture;Nt.update(Dt,{premultiply:!1}),Nt.bind(Ue.NEAREST,Ue.CLAMP_TO_EDGE)}else it.demTexture=new o.T(Ae,Dt,Ue.RGBA,{premultiply:!1}),it.demTexture.bind(Ue.NEAREST,Ue.CLAMP_TO_EDGE);Ae.activeTexture.set(Ue.TEXTURE0);let Tt=it.fbo;if(!Tt){const Nt=new o.T(Ae,{width:at,height:at,data:null},Ue.RGBA);Nt.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE),Tt=it.fbo=Ae.createFramebuffer(at,at,!0,!1),Tt.colorAttachment.set(Nt.texture)}Ae.bindFramebuffer.set(Tt.framebuffer),Ae.viewport.set([0,0,at,at]),_e.useProgram("hillshadePrepare").draw(Ae,Ue.TRIANGLES,Ce,De,Be,Zr.disabled,xh(it.tileID,st),null,null,Oe.id,_e.rasterBoundsBuffer,_e.quadTriangleIndexBuffer,_e.rasterBoundsSegments),it.needsHillshadePrepare=!1}})(M,k,B,O,ce,Yr.disabled,ge),X.viewport.set([0,0,M.width,M.height]);else if(M.renderPass==="translucent")if(te){const[_e,ve,Se]=M.stencilConfigForOverlapTwoPass(B);El(M,k,O,Se,_e,ce,ge,!1,Y),El(M,k,O,Se,ve,ce,ge,!0,Y)}else{const[_e,ve]=M.getStencilConfigForOverlapAndUpdateStencilID(B);El(M,k,O,ve,_e,ce,ge,!1,Y)}}(n,u,m,v,S):o.ct(m)?function(M,k,O,B,q){if(M.renderPass!=="translucent"||!B.length)return;const{isRenderingToTexture:Y}=q,X=M.style.projection.useSubdivision,te=M.getDepthModeForSublayer(0,Br.ReadOnly),ce=M.colorModeForRenderPass();if(X){const[ge,_e,ve]=M.stencilConfigForOverlapTwoPass(B);$s(M,k,O,ve,ge,te,ce,!1,Y),$s(M,k,O,ve,_e,te,ce,!0,Y)}else{const[ge,_e]=M.getStencilConfigForOverlapAndUpdateStencilID(B);$s(M,k,O,_e,ge,te,ce,!1,Y)}}(n,u,m,v,S):o.bU(m)?function(M,k,O,B,q){if(M.renderPass!=="translucent"||O.paint.get("raster-opacity")===0||!B.length)return;const{isRenderingToTexture:Y}=q,X=k.getSource(),te=M.style.projection.useSubdivision;if(X instanceof wn)Ns(M,k,O,B,null,!1,!1,X.tileCoords,X.flippedWindingOrder,Y);else if(te){const[ce,ge,_e]=M.stencilConfigForOverlapTwoPass(B);Ns(M,k,O,_e,ce,!1,!0,js,!1,Y),Ns(M,k,O,_e,ge,!0,!0,js,!1,Y)}else{const[ce,ge]=M.getStencilConfigForOverlapAndUpdateStencilID(B);Ns(M,k,O,ge,ce,!1,!0,js,!1,Y)}}(n,u,m,v,S):o.cu(m)?function(M,k,O,B,q){const Y=O.paint.get("background-color"),X=O.paint.get("background-opacity");if(X===0)return;const{isRenderingToTexture:te}=q,ce=M.context,ge=ce.gl,_e=M.style.projection,ve=M.transform,Se=ve.tileSize,Oe=O.paint.get("background-pattern");if(M.isPatternMissing(Oe))return;const Ce=!Oe&&Y.a===1&&X===1&&M.opaquePassEnabledForLayer()?"opaque":"translucent";if(M.renderPass!==Ce)return;const De=Yr.disabled,Be=M.getDepthModeForSublayer(0,Ce==="opaque"?Br.ReadWrite:Br.ReadOnly),Ae=M.colorModeForRenderPass(),Ue=M.useProgram(Oe?"backgroundPattern":"background"),ut=B||zr(ve,{tileSize:Se,terrain:M.style.map.terrain});Oe&&(ce.activeTexture.set(ge.TEXTURE0),M.imageManager.bind(M.context));const it=O.getCrossfadeParameters();for(const st of ut){const at=ve.getProjectionData({overscaledTileID:st,applyGlobeMatrix:!te,applyTerrainMatrix:!0}),Rt=Oe?Fs(X,M,Oe,{tileID:st,tileSize:Se},it):Yf(X,Y),Dt=M.style.map.terrain&&M.style.map.terrain.getTerrainData(st),Tt=_e.getMeshFromTileID(ce,st.canonical,!1,!0,"raster");Ue.draw(ce,ge.TRIANGLES,Be,De,Ae,Zr.backCCW,Rt,Dt,at,O.id,Tt.vertexBuffer,Tt.indexBuffer,Tt.segments)}}(n,0,m,v,S):o.cv(m)&&function(M,k,O,B){const{isRenderingGlobe:q}=B,Y=M.context,X=O.implementation,te=M.style.projection,ce=M.transform,ge=ce.getProjectionDataForCustomLayer(q),_e={farZ:ce.farZ,nearZ:ce.nearZ,fov:ce.fov*Math.PI/180,modelViewProjectionMatrix:ce.modelViewProjectionMatrix,projectionMatrix:ce.projectionMatrix,shaderData:{variantName:te.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${te.shaderPreludeCode.vertexSource}`,define:te.shaderDefine},defaultProjectionData:ge},ve=X.renderingMode?X.renderingMode:"2d";if(M.renderPass==="offscreen"){const Se=X.prerender;Se&&(M.setCustomLayerDefaults(),Y.setColorMode(M.colorModeForRenderPass()),Se.call(X,Y.gl,_e),Y.setDirty(),M.setBaseState())}else if(M.renderPass==="translucent"){M.setCustomLayerDefaults(),Y.setColorMode(M.colorModeForRenderPass()),Y.setStencilMode(Yr.disabled);const Se=ve==="3d"?M.getDepthModeFor3D():M.getDepthModeForSublayer(0,Br.ReadOnly);Y.setDepthMode(Se),X.render(Y.gl,_e),Y.setDirty(),M.setBaseState(),Y.bindFramebuffer.set(null)}}(n,0,m,S))}saveTileTexture(n){const u=this._tileTextures[n.size[0]];u?u.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const u=this._tileTextures[n];return u&&u.length>0?u.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const u=this.imageManager.getPattern(n.from.toString()),m=this.imageManager.getPattern(n.to.toString());return!u||!m}useProgram(n,u,m=!1,v=[]){this.cache=this.cache||{};const S=!!this.style.map.terrain,M=this.style.projection,k=m?_n.projectionMercator:M.shaderPreludeCode,O=m?Do:M.shaderDefine,B=n+(u?u.cacheKey:"")+`/${m?Go:M.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(S?"/terrain":"")+(v?`/${v.join("/")}`:"");return this.cache[B]||(this.cache[B]=new gd(this.context,_n[n],u,_m[n],this._showOverdrawInspector,S,k,O,v)),this.cache[B]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var n,u;if(this._tileTextures){for(const m in this._tileTextures){const v=this._tileTextures[m];if(v)for(const S of v)S.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&((n=this.tileExtentMesh.vertexBuffer)===null||n===void 0||n.destroy()),this.tileExtentMesh&&((u=this.tileExtentMesh.indexBuffer)===null||u===void 0||u.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const m in this.cache){const v=this.cache[m];v&&v.program&&this.context.gl.deleteProgram(v.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:n,drawingBufferHeight:u}=this.context.gl;return this.width!==n||this.height!==u}}function Fd(w,n){let u,m=!1,v=null,S=null;const M=()=>{v=null,m&&(w.apply(S,u),v=setTimeout(M,n),m=!1)};return(...k)=>(m=!0,S=this,u=k,v||M(),v)}class Bd{constructor(n){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let m;return u.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(m=v)}),(m&&m[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(!this._isValidHash(u))return!1;const m=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:m,pitch:+(u[4]||0)}),!0},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,u)},this._removeHash=()=>{const u=this._getCurrentHash();if(u.length===0)return;const m=u.join("/");let v=m;v.split("&").length>0&&(v=v.split("&")[0]),this._hashName&&(v=`${this._hashName}=${m}`);let S=window.location.hash.replace(v,"");S.startsWith("#&")?S=S.slice(0,1)+S.slice(2):S==="#"&&(S="");let M=window.location.href.replace(/(#.+)?$/,S);M=M.replace("&&","&"),window.history.replaceState(window.history.state,null,M)},this._updateHash=Fd(this._updateHashUnthrottled,300),this._hashName=n&&encodeURIComponent(n)}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(n){const u=this._map.getCenter(),m=Math.round(100*this._map.getZoom())/100,v=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,v),M=Math.round(u.lng*S)/S,k=Math.round(u.lat*S)/S,O=this._map.getBearing(),B=this._map.getPitch();let q="";if(q+=n?`/${M}/${k}/${m}`:`${m}/${k}/${M}`,(O||B)&&(q+="/"+Math.round(10*O)/10),B&&(q+=`/${Math.round(B)}`),this._hashName){const Y=this._hashName;let X=!1;const te=window.location.hash.slice(1).split("&").map(ce=>{const ge=ce.split("=")[0];return ge===Y?(X=!0,`${ge}=${q}`):ce}).filter(ce=>ce);return X||te.push(`${Y}=${q}`),`#${te.join("&")}`}return`#${q}`}_isValidHash(n){if(n.length<3||n.some(isNaN))return!1;try{new o.V(+n[2],+n[1])}catch{return!1}const u=+n[0],m=+(n[3]||0),v=+(n[4]||0);return u>=this._map.getMinZoom()&&u<=this._map.getMaxZoom()&&m>=-180&&m<=180&&v>=this._map.getMinPitch()&&v<=this._map.getMaxPitch()}}const Vs={linearity:.3,easing:o.cw(0,0,.3,1)},np=o.e({deceleration:2500,maxSpeed:1400},Vs),Fi=o.e({deceleration:20,maxSpeed:1400},Vs),Ho=o.e({deceleration:1e3,maxSpeed:360},Vs),$d=o.e({deceleration:1e3,maxSpeed:90},Vs),vs=o.e({deceleration:1e3,maxSpeed:360},Vs);class sy{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:$(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,u=$();for(;n.length>0&&u-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,roll:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)u.zoom+=S.zoomDelta||0,u.bearing+=S.bearingDelta||0,u.pitch+=S.pitchDelta||0,u.roll+=S.rollDelta||0,S.panDelta&&u.pan._add(S.panDelta),S.around&&(u.around=S.around),S.pinchAround&&(u.pinchAround=S.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(u.pan.mag()){const S=oa(u.pan.mag(),m,o.e({},np,n||{})),M=u.pan.mult(S.amount/u.pan.mag()),k=this._map.cameraHelper.handlePanInertia(M,this._map.transform);v.center=k.easingCenter,v.offset=k.easingOffset,_s(v,S)}if(u.zoom){const S=oa(u.zoom,m,Fi);v.zoom=this._map.transform.zoom+S.amount,_s(v,S)}if(u.bearing){const S=oa(u.bearing,m,Ho);v.bearing=this._map.transform.bearing+o.an(S.amount,-179,179),_s(v,S)}if(u.pitch){const S=oa(u.pitch,m,$d);v.pitch=this._map.transform.pitch+S.amount,_s(v,S)}if(u.roll){const S=oa(u.roll,m,vs);v.roll=this._map.transform.roll+o.an(S.amount,-179,179),_s(v,S)}if(v.zoom||v.bearing){const S=u.pinchAround===void 0?u.around:u.pinchAround;v.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),o.e(v,{noMoveStart:!0})}}function _s(w,n){(!w.duration||w.duration<n.duration)&&(w.duration=n.duration,w.easing=n.easing)}function oa(w,n,u){const{maxSpeed:m,linearity:v,deceleration:S}=u,M=o.an(w*v/(n/1e3),-m,m),k=Math.abs(M)/(S*v);return{easing:u.easing,duration:1e3*k,amount:M*(k/2)}}class mi extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,m,v={}){m=m instanceof MouseEvent?m:new MouseEvent(n,m);const S=j.mousePos(u.getCanvas(),m),M=u.unproject(S);super(n,o.e({point:S,lngLat:M,originalEvent:m},v)),this._defaultPrevented=!1,this.target=u}}class Al extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,m){const v=n==="touchend"?m.changedTouches:m.touches,S=j.touchPos(u.getCanvasContainer(),v),M=S.map(O=>u.unproject(O)),k=S.reduce((O,B,q,Y)=>O.add(B.div(Y.length)),new o.P(0,0));super(n,{points:S,point:k,lngLats:M,lngLat:u.unproject(k),originalEvent:m}),this._defaultPrevented=!1}}class Dh extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,m){super(n,{originalEvent:m}),this._defaultPrevented=!1}}class xs{constructor(n,u){this._map=n,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new Dh(n.type,this._map,n))}mousedown(n,u){return this._mousedownPos=u,this._firePreventable(new mi(n.type,this._map,n))}mouseup(n){this._map.fire(new mi(n.type,this._map,n))}click(n,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new mi(n.type,this._map,n))}dblclick(n){return this._firePreventable(new mi(n.type,this._map,n))}mouseover(n){this._map.fire(new mi(n.type,this._map,n))}mouseout(n){this._map.fire(new mi(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Al(n.type,this._map,n))}touchmove(n){this._map.fire(new Al(n.type,this._map,n))}touchend(n){this._map.fire(new Al(n.type,this._map,n))}touchcancel(n){this._map.fire(new Al(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class bs{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new mi(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new mi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new mi(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ws{constructor(n){this._map=n}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(n){return this.transform.screenPointToLocation(o.P.convert(n),this._map.terrain)}}class Wo{constructor(n,u){this._map=n,this._tr=new ws(n),this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,u){this.isEnabled()&&n.shiftKey&&n.button===0&&(j.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(n,u){if(!this._active)return;const m=u;if(this._lastPos.equals(m)||!this._box&&m.dist(this._startPos)<this._clickTolerance)return;const v=this._startPos;this._lastPos=m,this._box||(this._box=j.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",n));const S=Math.min(v.x,m.x),M=Math.max(v.x,m.x),k=Math.min(v.y,m.y),O=Math.max(v.y,m.y);j.setTransform(this._box,`translate(${S}px,${k}px)`),this._box.style.width=M-S+"px",this._box.style.height=O-k+"px"}mouseupWindow(n,u){if(!this._active||n.button!==0)return;const m=this._startPos,v=u;if(this.reset(),j.suppressClick(),m.x!==v.x||m.y!==v.y)return this._map.fire(new o.l("boxzoomend",{originalEvent:n})),{cameraAnimation:S=>S.fitScreenCoordinates(m,v,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(j.remove(this._box),this._box=null),j.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,u){return this._map.fire(new o.l(n,{originalEvent:u}))}}function qi(w,n){if(w.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${w.length}, points ${n.length}`);const u={};for(let m=0;m<w.length;m++)u[w[m].identifier]=n[m];return u}class Ut{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,u,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),m.length===this.numTouches&&(this.centroid=function(v){const S=new o.P(0,0);for(const M of v)S._add(M);return S.div(v.length)}(u),this.touches=qi(m,u)))}touchmove(n,u,m){if(this.aborted||!this.centroid)return;const v=qi(m,u);for(const S in this.touches){const M=v[S];(!M||M.dist(this.touches[S])>30)&&(this.aborted=!0)}}touchend(n,u,m){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class zh{constructor(n){this.singleTap=new Ut(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,u,m){this.singleTap.touchstart(n,u,m)}touchmove(n,u,m){this.singleTap.touchmove(n,u,m)}touchend(n,u,m){const v=this.singleTap.touchend(n,u,m);if(v){const S=n.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(v)<30;if(S&&M||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class Oh{constructor(n){this._tr=new ws(n),this._zoomIn=new zh({numTouches:1,numTaps:2}),this._zoomOut=new zh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,u,m){this._zoomIn.touchstart(n,u,m),this._zoomOut.touchstart(n,u,m)}touchmove(n,u,m){this._zoomIn.touchmove(n,u,m),this._zoomOut.touchmove(n,u,m)}touchend(n,u,m){const v=this._zoomIn.touchend(n,u,m),S=this._zoomOut.touchend(n,u,m),M=this._tr;return v?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:M.zoom+1,around:M.unproject(v)},{originalEvent:n})}):S?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:M.zoom-1,around:M.unproject(S)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Rl{constructor(n){this._enabled=!!n.enable,this._moveStateManager=n.moveStateManager,this._clickTolerance=n.clickTolerance||1,this._moveFunction=n.move,this._activateOnStart=!!n.activateOnStart,n.assignEvents(this),this.reset()}reset(n){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(n)}_move(...n){const u=this._moveFunction(...n);if(u.bearingDelta||u.pitchDelta||u.rollDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(n,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(n)&&(this._moveStateManager.startMove(n),this._lastPoint=Array.isArray(u)?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(n,u){if(!this.isEnabled())return;const m=this._lastPoint;if(!m)return;if(n.preventDefault(),!this._moveStateManager.isValidMoveEvent(n))return void this.reset(n);const v=Array.isArray(u)?u[0]:u;return!this._moved&&v.dist(m)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=v,this._move(m,v))}dragEnd(n){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(n)&&(this._moved&&j.suppressClick(),this.reset(n))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const mo=0,go=2,Wn={[mo]:1,[go]:2};class Lo{constructor(n){this._correctEvent=n.checkCorrectEvent}startMove(n){const u=j.mouseButton(n);this._eventButton=u}endMove(n){delete this._eventButton}isValidStartEvent(n){return this._correctEvent(n)}isValidMoveEvent(n){return!function(u,m){const v=Wn[m];return u.buttons===void 0||(u.buttons&v)!==v}(n,this._eventButton)}isValidEndEvent(n){return j.mouseButton(n)===this._eventButton}}class jd{constructor(){this._firstTouch=void 0}_isOneFingerTouch(n){return n.targetTouches.length===1}_isSameTouchEvent(n){return n.targetTouches[0].identifier===this._firstTouch}startMove(n){this._firstTouch=n.targetTouches[0].identifier}endMove(n){delete this._firstTouch}isValidStartEvent(n){return this._isOneFingerTouch(n)}isValidMoveEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}isValidEndEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}}class ip{constructor(n=new Lo({checkCorrectEvent:()=>!0}),u=new jd){this.mouseMoveStateManager=n,this.oneFingerTouchMoveStateManager=u}_executeRelevantHandler(n,u,m){return n instanceof MouseEvent?u(n):typeof TouchEvent<"u"&&n instanceof TouchEvent?m(n):void 0}startMove(n){this._executeRelevantHandler(n,u=>this.mouseMoveStateManager.startMove(u),u=>this.oneFingerTouchMoveStateManager.startMove(u))}endMove(n){this._executeRelevantHandler(n,u=>this.mouseMoveStateManager.endMove(u),u=>this.oneFingerTouchMoveStateManager.endMove(u))}isValidStartEvent(n){return this._executeRelevantHandler(n,u=>this.mouseMoveStateManager.isValidStartEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidStartEvent(u))}isValidMoveEvent(n){return this._executeRelevantHandler(n,u=>this.mouseMoveStateManager.isValidMoveEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(u))}isValidEndEvent(n){return this._executeRelevantHandler(n,u=>this.mouseMoveStateManager.isValidEndEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidEndEvent(u))}}const Dl=w=>{w.mousedown=w.dragStart,w.mousemoveWindow=w.dragMove,w.mouseup=w.dragEnd,w.contextmenu=n=>{n.preventDefault()}};class op{constructor(n,u){this._clickTolerance=n.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(n){return n<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(n,u,m){return this._calculateTransform(n,u,m)}touchmove(n,u,m){if(this._active){if(!this._shouldBePrevented(m.length))return n.preventDefault(),this._calculateTransform(n,u,m);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",n)}}touchend(n,u,m){this._calculateTransform(n,u,m),this._active&&this._shouldBePrevented(m.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,u,m){m.length>0&&(this._active=!0);const v=qi(m,u),S=new o.P(0,0),M=new o.P(0,0);let k=0;for(const B in v){const q=v[B],Y=this._touches[B];Y&&(S._add(q),M._add(q.sub(Y)),k++,v[B]=q)}if(this._touches=v,this._shouldBePrevented(k)||!M.mag())return;const O=M.div(k);return this._sum._add(O),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(k),panDelta:O}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Lh{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(n,u,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([u[0],u[1]]))}touchmove(n,u,m){if(!this._firstTwoTouches)return;n.preventDefault();const[v,S]=this._firstTwoTouches,M=Tc(m,u,v),k=Tc(m,u,S);if(!M||!k)return;const O=this._aroundCenter?null:M.add(k).div(2);return this._move([M,k],O,n)}touchend(n,u,m){if(!this._firstTwoTouches)return;const[v,S]=this._firstTwoTouches,M=Tc(m,u,v),k=Tc(m,u,S);M&&k||(this._active&&j.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Tc(w,n,u){for(let m=0;m<w.length;m++)if(w[m].identifier===u)return n[m]}function sp(w,n){return Math.log(w/n)/Math.LN2}class zl extends Lh{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,u){const m=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(sp(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:sp(this._distance,m),pinchAround:u}}}function Nd(w,n){return 180*w.angleWith(n)/Math.PI}class ap extends Lh{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,u,m){const v=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Nd(this._vector,v),pinchAround:u}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const u=25/(Math.PI*this._minDiameter)*360,m=Nd(n,this._startVector);return Math.abs(m)<u}}function Mc(w){return Math.abs(w.y)>Math.abs(w.x)}class Fh extends Lh{constructor(n){super(),this._currentTouchCount=0,this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,u,m){super.touchstart(n,u,m),this._currentTouchCount=m.length}_start(n){this._lastPoints=n,Mc(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,u,m){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const v=n[0].sub(this._lastPoints[0]),S=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(v,S,m.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(v.y+S.y)/2*-.5}):void 0}gestureBeginsVertically(n,u,m){if(this._valid!==void 0)return this._valid;const v=n.mag()>=2,S=u.mag()>=2;if(!v&&!S)return;if(!v||!S)return this._firstMove===void 0&&(this._firstMove=m),m-this._firstMove<100&&void 0;const M=n.y>0==u.y>0;return Mc(n)&&Mc(u)&&M}}const $a={panStep:100,bearingStep:15,pitchStep:10};class Sn{constructor(n){this._tr=new ws(n);const u=$a;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let u=0,m=0,v=0,S=0,M=0;switch(n.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:n.shiftKey?m=-1:(n.preventDefault(),S=-1);break;case 39:n.shiftKey?m=1:(n.preventDefault(),S=1);break;case 38:n.shiftKey?v=1:(n.preventDefault(),M=-1);break;case 40:n.shiftKey?v=-1:(n.preventDefault(),M=1);break;default:return}return this._rotationDisabled&&(m=0,v=0),{cameraAnimation:k=>{const O=this._tr;k.easeTo({duration:300,easeId:"keyboardHandler",easing:Tu,zoom:u?Math.round(O.zoom)+u*(n.shiftKey?2:1):O.zoom,bearing:O.bearing+m*this._bearingStep,pitch:O.pitch+v*this._pitchStep,offset:[-S*this._panStep,-M*this._panStep],center:O.center},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Tu(w){return w*(2-w)}const Mu=4.000244140625,Pc=1/450;class Ec{constructor(n,u){this._onTimeout=m=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(m)},this._map=n,this._tr=new ws(n),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Pc}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(n){return!!this._map.cooperativeGestures.isEnabled()&&!(n.ctrlKey||this._map.cooperativeGestures.isBypassed(n))}wheel(n){if(!this.isEnabled())return;if(this._shouldBePrevented(n))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",n);let u=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const m=$(),v=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,u!==0&&u%Mu==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(v*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),n.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=n,this._delta-=u,this._active||this._start(n)),n.preventDefault()}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=j.mousePos(this._map.getCanvas(),n),m=this._tr;this._aroundPoint=this._aroundCenter?m.transform.locationToScreenPoint(o.V.convert(m.center)):u,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const k=n.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=k),typeof this._targetZoom=="number"&&(this._targetZoom+=k)}if(this._delta!==0){const k=this._type==="wheel"&&Math.abs(this._delta)>Mu?this._wheelZoomRate:this._defaultZoomRate;let O=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&O!==0&&(O=1/O);const B=typeof this._targetZoom!="number"?n.scale:o.aq(this._targetZoom);this._targetZoom=n.applyConstrain(n.getCameraLngLat(),o.at(B*O)).zoom,this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom!="number"?n.zoom:this._targetZoom,m=this._startZoom,v=this._easing;let S,M=!1;if(this._type==="wheel"&&m&&v){const k=$()-this._lastWheelEventTime,O=Math.min((k+5)/200,1),B=v(O);S=o.G.number(m,u,B),O<1?this._frameId||(this._frameId=!0):M=!0}else S=u,M=!0;return this._active=!0,M&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=S,{noInertia:!0,needsRenderFrame:!M,zoomDelta:S-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let u=o.cy;if(this._prevEase){const m=this._prevEase,v=($()-m.start)/m.duration,S=m.easing(v+.01)-m.easing(v),M=.27/Math.sqrt(S*S+1e-4)*.01,k=Math.sqrt(.0729-M*M);u=o.cw(M,k,.25,1)}return this._prevEase={start:$(),duration:n,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Ol{constructor(n,u){this._clickZoom=n,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Vd{constructor(n){this._tr=new ws(n),this.reset()}reset(){this._active=!1}dblclick(n,u){return n.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:this._tr.zoom+(n.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ud{constructor(){this._tap=new zh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(n,u,m){if(!this._swipePoint)if(this._tapTime){const v=u[0],S=n.timeStamp-this._tapTime<500,M=this._tapPoint.dist(v)<30;S&&M?m.length>0&&(this._swipePoint=v,this._swipeTouch=m[0].identifier):this.reset()}else this._tap.touchstart(n,u,m)}touchmove(n,u,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const v=u[0],S=v.y-this._swipePoint.y;return this._swipePoint=v,n.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(n,u,m)}touchend(n,u,m){if(this._tapTime)this._swipePoint&&m.length===0&&this.reset();else{const v=this._tap.touchend(n,u,m);v&&(this._tapTime=n.timeStamp,this._tapPoint=v)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gd{constructor(n,u,m){this._el=n,this._mousePan=u,this._touchPan=m}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class as{constructor(n,u,m,v){this._pitchWithRotate=n.pitchWithRotate,this._rollEnabled=n.rollEnabled,this._mouseRotate=u,this._mousePitch=m,this._mouseRoll=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class sa{constructor(n,u,m,v){this._el=n,this._touchZoom=u,this._touchRotate=m,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Xt{constructor(n,u){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=n,this._options=u,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const n=this._map.getCanvasContainer();n.classList.add("maplibregl-cooperative-gestures"),this._container=j.create("div","maplibregl-cooperative-gesture-screen",n);let u=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(u=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const m=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),v=document.createElement("div");v.className="maplibregl-desktop-message",v.textContent=u,this._container.appendChild(v);const S=document.createElement("div");S.className="maplibregl-mobile-message",S.textContent=m,this._container.appendChild(S),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(j.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(n){return n[this._bypassKey]}notifyGestureBlocked(n,u){this._enabled&&(this._map.fire(new o.l("cooperativegestureprevented",{gestureType:n,originalEvent:u})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const cr=w=>w.zoom||w.drag||w.roll||w.pitch||w.rotate;class Ic extends o.l{}function Bh(w){return w.panDelta&&w.panDelta.mag()||w.zoomDelta||w.bearingDelta||w.pitchDelta||w.rollDelta}class Ss{constructor(n,u){this.handleWindowEvent=v=>{this.handleEvent(v,`${v.type}Window`)},this.handleEvent=(v,S)=>{if(v.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const M=v.type==="renderFrame"?void 0:v,k={needsRenderFrame:!1},O={},B={};for(const{handlerName:X,handler:te,allowed:ce}of this._handlers){if(!te.isEnabled())continue;let ge;if(this._blockedByActive(B,ce,X))te.reset();else if(te[S||v.type]){if(o.cz(v,S||v.type)){const _e=j.mousePos(this._map.getCanvas(),v);ge=te[S||v.type](v,_e)}else if(o.cA(v,S||v.type)){const _e=this._getMapTouches(v.touches),ve=j.touchPos(this._map.getCanvas(),_e);ge=te[S||v.type](v,ve,_e)}else o.cB(S||v.type)||(ge=te[S||v.type](v));this.mergeHandlerResult(k,O,ge,X,M),ge&&ge.needsRenderFrame&&this._triggerRenderFrame()}(ge||te.isActive())&&(B[X]=te)}const q={};for(const X in this._previousActiveHandlers)B[X]||(q[X]=M);this._previousActiveHandlers=B,(Object.keys(q).length||Bh(k))&&(this._changes.push([k,O,q]),this._triggerRenderFrame()),(Object.keys(B).length||Bh(k))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Y}=k;Y&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Y(this._map))},this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new sy(n),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,S,M]of this._listeners)j.addEventListener(v,S,v===document?this.handleWindowEvent:this.handleEvent,M)}destroy(){for(const[n,u,m]of this._listeners)j.removeEventListener(n,u,n===document?this.handleWindowEvent:this.handleEvent,m)}_addDefaultHandlers(n){const u=this._map,m=u.getCanvasContainer();this._add("mapEvent",new xs(u,n));const v=u.boxZoom=new Wo(u,n);this._add("boxZoom",v),n.interactive&&n.boxZoom&&v.enable();const S=u.cooperativeGestures=new Xt(u,n.cooperativeGestures);this._add("cooperativeGestures",S),n.cooperativeGestures&&S.enable();const M=new Oh(u),k=new Vd(u);u.doubleClickZoom=new Ol(k,M),this._add("tapZoom",M),this._add("clickZoom",k),n.interactive&&n.doubleClickZoom&&u.doubleClickZoom.enable();const O=new Ud;this._add("tapDragZoom",O);const B=u.touchPitch=new Fh(u);this._add("touchPitch",B),n.interactive&&n.touchPitch&&u.touchPitch.enable(n.touchPitch);const q=()=>u.project(u.getCenter()),Y=function({enable:Ce,clickTolerance:De,aroundCenter:Be=!0,minPixelCenterThreshold:Ae=100,rotateDegreesPerPixelMoved:Ue=.8},ut){const it=new Lo({checkCorrectEvent:st=>j.mouseButton(st)===0&&st.ctrlKey||j.mouseButton(st)===2&&!st.ctrlKey});return new Rl({clickTolerance:De,move:(st,at)=>{const Rt=ut();if(Be&&Math.abs(Rt.y-st.y)>Ae)return{bearingDelta:o.cx(new o.P(st.x,at.y),at,Rt)};let Dt=(at.x-st.x)*Ue;return Be&&at.y<Rt.y&&(Dt=-Dt),{bearingDelta:Dt}},moveStateManager:it,enable:Ce,assignEvents:Dl})}(n,q),X=function({enable:Ce,clickTolerance:De,pitchDegreesPerPixelMoved:Be=-.5}){const Ae=new Lo({checkCorrectEvent:Ue=>j.mouseButton(Ue)===0&&Ue.ctrlKey||j.mouseButton(Ue)===2});return new Rl({clickTolerance:De,move:(Ue,ut)=>({pitchDelta:(ut.y-Ue.y)*Be}),moveStateManager:Ae,enable:Ce,assignEvents:Dl})}(n),te=function({enable:Ce,clickTolerance:De,rollDegreesPerPixelMoved:Be=.3},Ae){const Ue=new Lo({checkCorrectEvent:ut=>j.mouseButton(ut)===2&&ut.ctrlKey});return new Rl({clickTolerance:De,move:(ut,it)=>{const st=Ae();let at=(it.x-ut.x)*Be;return it.y<st.y&&(at=-at),{rollDelta:at}},moveStateManager:Ue,enable:Ce,assignEvents:Dl})}(n,q);u.dragRotate=new as(n,Y,X,te),this._add("mouseRotate",Y,["mousePitch"]),this._add("mousePitch",X,["mouseRotate","mouseRoll"]),this._add("mouseRoll",te,["mousePitch"]),n.interactive&&n.dragRotate&&u.dragRotate.enable();const ce=function({enable:Ce,clickTolerance:De}){const Be=new Lo({checkCorrectEvent:Ae=>j.mouseButton(Ae)===0&&!Ae.ctrlKey});return new Rl({clickTolerance:De,move:(Ae,Ue)=>({around:Ue,panDelta:Ue.sub(Ae)}),activateOnStart:!0,moveStateManager:Be,enable:Ce,assignEvents:Dl})}(n),ge=new op(n,u);u.dragPan=new Gd(m,ce,ge),this._add("mousePan",ce),this._add("touchPan",ge,["touchZoom","touchRotate"]),n.interactive&&n.dragPan&&u.dragPan.enable(n.dragPan);const _e=new ap,ve=new zl;u.touchZoomRotate=new sa(m,ve,_e,O),this._add("touchRotate",_e,["touchPan","touchZoom"]),this._add("touchZoom",ve,["touchPan","touchRotate"]),n.interactive&&n.touchZoomRotate&&u.touchZoomRotate.enable(n.touchZoomRotate),this._add("blockableMapEvent",new bs(u));const Se=u.scrollZoom=new Ec(u,()=>this._triggerRenderFrame());this._add("scrollZoom",Se,["mousePan"]),n.interactive&&n.scrollZoom&&u.scrollZoom.enable(n.scrollZoom);const Oe=u.keyboard=new Sn(u);this._add("keyboard",Oe),n.interactive&&n.keyboard&&u.keyboard.enable()}_add(n,u,m){this._handlers.push({handlerName:n,handler:u,allowed:m}),this._handlersById[n]=u}stop(n){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!cr(this._eventsInProgress)||this.isZooming()}_blockedByActive(n,u,m){for(const v in n)if(v!==m&&(!u||u.indexOf(v)<0))return!0;return!1}_getMapTouches(n){const u=[];for(const m of n)this._el.contains(m.target)&&u.push(m);return u}mergeHandlerResult(n,u,m,v,S){if(!m)return;o.e(n,m);const M={handlerName:v,originalEvent:m.originalEvent||S};m.zoomDelta!==void 0&&(u.zoom=M),m.panDelta!==void 0&&(u.drag=M),m.rollDelta!==void 0&&(u.roll=M),m.pitchDelta!==void 0&&(u.pitch=M),m.bearingDelta!==void 0&&(u.rotate=M)}_applyChanges(){const n={},u={},m={};for(const[v,S,M]of this._changes)v.panDelta&&(n.panDelta=(n.panDelta||new o.P(0,0))._add(v.panDelta)),v.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+v.pitchDelta),v.rollDelta&&(n.rollDelta=(n.rollDelta||0)+v.rollDelta),v.around!==void 0&&(n.around=v.around),v.pinchAround!==void 0&&(n.pinchAround=v.pinchAround),v.noInertia&&(n.noInertia=v.noInertia),o.e(u,S),o.e(m,M);this._updateMapTransform(n,u,m),this._changes=[]}_updateMapTransform(n,u,m){const v=this._map,S=v._getTransformForUpdate(),M=v.terrain;if(!(Bh(n)||M&&this._terrainMovement))return this._fireEvents(u,m,!0);v._stop(!0);let{panDelta:k,zoomDelta:O,bearingDelta:B,pitchDelta:q,rollDelta:Y,around:X,pinchAround:te}=n;te!==void 0&&(X=te),X=X||v.transform.centerPoint,M&&!S.isPointOnMapSurface(X)&&(X=S.centerPoint);const ce={panDelta:k,zoomDelta:O,rollDelta:Y,pitchDelta:q,bearingDelta:B,around:X};this._map.cameraHelper.useGlobeControls&&!S.isPointOnMapSurface(X)&&(X=S.centerPoint);const ge=X.distSqr(S.centerPoint)<.01?S.center:S.screenPointToLocation(k?X.sub(k):X);this._handleMapControls({terrain:M,tr:S,deltasForHelper:ce,preZoomAroundLoc:ge,combinedEventsInProgress:u,panDelta:k}),v._applyUpdatedTransform(S),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(u,m,!0)}_handleMapControls({terrain:n,tr:u,deltasForHelper:m,preZoomAroundLoc:v,combinedEventsInProgress:S,panDelta:M}){const k=this._map.cameraHelper;if(k.handleMapControlsRollPitchBearingZoom(m,u),n)return k.useGlobeControls?(this._terrainMovement||!S.drag&&!S.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void k.handleMapControlsPan(m,u,v)):this._terrainMovement||!S.drag&&!S.zoom?void(S.drag&&this._terrainMovement&&M?u.setCenter(u.screenPointToLocation(u.centerPoint.sub(M))):k.handleMapControlsPan(m,u,v)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void k.handleMapControlsPan(m,u,v));k.handleMapControlsPan(m,u,v)}_fireEvents(n,u,m){const v=cr(this._eventsInProgress),S=cr(n),M={};for(const Y in n){const{originalEvent:X}=n[Y];this._eventsInProgress[Y]||(M[`${Y}start`]=X),this._eventsInProgress[Y]=n[Y]}!v&&S&&this._fireEvent("movestart",S.originalEvent);for(const Y in M)this._fireEvent(Y,M[Y]);S&&this._fireEvent("move",S.originalEvent);for(const Y in n){const{originalEvent:X}=n[Y];this._fireEvent(Y,X)}const k={};let O;for(const Y in this._eventsInProgress){const{handlerName:X,originalEvent:te}=this._eventsInProgress[Y];this._handlersById[X].isActive()||(delete this._eventsInProgress[Y],O=u[X]||te,k[`${Y}end`]=O)}for(const Y in k)this._fireEvent(Y,k[Y]);const B=cr(this._eventsInProgress),q=(v||S)&&!B;if(q&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Y=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&Y.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(Y)}if(m&&q){this._updatingCamera=!0;const Y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=te=>te!==0&&-this._bearingSnap<te&&te<this._bearingSnap;!Y||!Y.essential&&F.prefersReducedMotion?(this._map.fire(new o.l("moveend",{originalEvent:O})),X(this._map.getBearing())&&this._map.resetNorth()):(X(Y.bearing||this._map.getBearing())&&(Y.bearing=0),Y.freezeElevation=!0,this._map.easeTo(Y,{originalEvent:O})),this._updatingCamera=!1}}_fireEvent(n,u){this._map.fire(new o.l(n,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new Ic("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Ti extends o.E{constructor(n,u,m){super(),this._renderFrameCallback=()=>{const v=Math.min(($()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(v)),v<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=m.bearingSnap,this.cameraHelper=u,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(n,u){n.apply(this.transform,!0),this.transform=n,this.cameraHelper=u}getCenter(){return new o.V(this.transform.center.lng,this.transform.center.lat)}setCenter(n,u){return this.jumpTo({center:n},u)}getCenterElevation(){return this.transform.elevation}setCenterElevation(n,u){return this.jumpTo({elevation:n},u),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(n){this._centerClampedToGround=n}panBy(n,u,m){return n=o.P.convert(n).mult(-1),this.panTo(this.transform.center,o.e({offset:n},u),m)}panTo(n,u,m){return this.easeTo(o.e({center:n},u),m)}getZoom(){return this.transform.zoom}setZoom(n,u){return this.jumpTo({zoom:n},u),this}zoomTo(n,u,m){return this.easeTo(o.e({zoom:n},u),m)}zoomIn(n,u){return this.zoomTo(this.getZoom()+1,n,u),this}zoomOut(n,u){return this.zoomTo(this.getZoom()-1,n,u),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(n,u){return n!=this.transform.fov&&(this.transform.setFov(n),this.fire(new o.l("movestart",u)).fire(new o.l("move",u)).fire(new o.l("moveend",u))),this}getBearing(){return this.transform.bearing}setBearing(n,u){return this.jumpTo({bearing:n},u),this}getPadding(){return this.transform.padding}setPadding(n,u){return this.jumpTo({padding:n},u),this}rotateTo(n,u,m){return this.easeTo(o.e({bearing:n},u),m)}resetNorth(n,u){return this.rotateTo(0,o.e({duration:1e3},n),u),this}resetNorthPitch(n,u){return this.easeTo(o.e({bearing:0,pitch:0,roll:0,duration:1e3},n),u),this}snapToNorth(n,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,u):this}getPitch(){return this.transform.pitch}setPitch(n,u){return this.jumpTo({pitch:n},u),this}getRoll(){return this.transform.roll}setRoll(n,u){return this.jumpTo({roll:n},u),this}cameraForBounds(n,u){n=yr.convert(n).adjustAntiMeridian();const m=u&&u.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),m,u)}_cameraForBoxAndBearing(n,u,m,v){const S={top:0,bottom:0,right:0,left:0};if(typeof(v=o.e({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},v)).padding=="number"){const B=v.padding;v.padding={top:B,bottom:B,right:B,left:B}}const M=o.e(S,v.padding);v.padding=M;const k=this.transform,O=new yr(n,u);return this.cameraHelper.cameraForBoxAndBearing(v,M,O,m,k)}fitBounds(n,u,m){return this._fitInternal(this.cameraForBounds(n,u),u,m)}fitScreenCoordinates(n,u,m,v,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(o.P.convert(n)),this.transform.screenPointToLocation(o.P.convert(u)),m,v),v,S)}_fitInternal(n,u,m){return n?(delete(u=o.e(n,u)).padding,u.linear?this.easeTo(u,m):this.flyTo(u,m)):this}jumpTo(n,u){this.stop();const m=this._getTransformForUpdate();let v=!1,S=!1,M=!1;const k=m.zoom;this.cameraHelper.handleJumpToCenterZoom(m,n);const O=m.zoom!==k;return"elevation"in n&&m.elevation!==+n.elevation&&m.setElevation(+n.elevation),"bearing"in n&&m.bearing!==+n.bearing&&(v=!0,m.setBearing(+n.bearing)),"pitch"in n&&m.pitch!==+n.pitch&&(S=!0,m.setPitch(+n.pitch)),"roll"in n&&m.roll!==+n.roll&&(M=!0,m.setRoll(+n.roll)),n.padding==null||m.isPaddingEqual(n.padding)||m.setPadding(n.padding),this._applyUpdatedTransform(m),this.fire(new o.l("movestart",u)).fire(new o.l("move",u)),O&&this.fire(new o.l("zoomstart",u)).fire(new o.l("zoom",u)).fire(new o.l("zoomend",u)),v&&this.fire(new o.l("rotatestart",u)).fire(new o.l("rotate",u)).fire(new o.l("rotateend",u)),S&&this.fire(new o.l("pitchstart",u)).fire(new o.l("pitch",u)).fire(new o.l("pitchend",u)),M&&this.fire(new o.l("rollstart",u)).fire(new o.l("roll",u)).fire(new o.l("rollend",u)),this.fire(new o.l("moveend",u))}calculateCameraOptionsFromTo(n,u,m,v=0){const S=o.a9.fromLngLat(n,u),M=o.a9.fromLngLat(m,v),k=M.x-S.x,O=M.y-S.y,B=M.z-S.z,q=Math.hypot(k,O,B);if(q===0)throw new Error("Can't calculate camera options with same From and To");const Y=Math.hypot(k,O),X=o.at(this.transform.cameraToCenterDistance/q/this.transform.tileSize),te=180*Math.atan2(k,-O)/Math.PI;let ce=180*Math.acos(Y/q)/Math.PI;return ce=B<0?90-ce:90+ce,{center:M.toLngLat(),elevation:v,zoom:X,pitch:ce,bearing:te}}calculateCameraOptionsFromCameraLngLatAltRotation(n,u,m,v,S){const M=this.transform.calculateCenterFromCameraLngLatAlt(n,u,m,v);return{center:M.center,elevation:M.elevation,zoom:M.zoom,bearing:m,pitch:v,roll:S}}easeTo(n,u){this._stop(!1,n.easeId),((n=o.e({offset:[0,0],duration:500,easing:o.cy},n)).animate===!1||!n.essential&&F.prefersReducedMotion)&&(n.duration=0);const m=this._getTransformForUpdate(),v=this.getBearing(),S=m.pitch,M=m.roll,k="bearing"in n?this._normalizeBearing(n.bearing,v):v,O="pitch"in n?+n.pitch:S,B="roll"in n?this._normalizeBearing(n.roll,M):M,q="padding"in n?n.padding:m.padding,Y=o.P.convert(n.offset);let X,te;n.around&&(X=o.V.convert(n.around),te=m.locationToScreenPoint(X));const ce={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ge=this.cameraHelper.handleEaseTo(m,{bearing:k,pitch:O,roll:B,padding:q,around:X,aroundPoint:te,offsetAsPoint:Y,offset:n.offset,zoom:n.zoom,center:n.center});return this._rotating=this._rotating||v!==k,this._pitching=this._pitching||O!==S,this._rolling=this._rolling||B!==M,this._padding=!m.isPaddingEqual(q),this._zooming=this._zooming||ge.isZooming,this._easeId=n.easeId,this._prepareEase(u,n.noMoveStart,ce),this.terrain&&this._prepareElevation(ge.elevationCenter),this._ease(_e=>{ge.easeFunc(_e),this.terrain&&!n.freezeElevation&&this._updateElevation(_e),this._applyUpdatedTransform(m),this._fireMoveEvents(u)},_e=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(u,_e)},n),this}_prepareEase(n,u,m={}){this._moving=!0,u||m.moving||this.fire(new o.l("movestart",n)),this._zooming&&!m.zooming&&this.fire(new o.l("zoomstart",n)),this._rotating&&!m.rotating&&this.fire(new o.l("rotatestart",n)),this._pitching&&!m.pitching&&this.fire(new o.l("pitchstart",n)),this._rolling&&!m.rolling&&this.fire(new o.l("rollstart",n))}_prepareElevation(n){this._elevationCenter=n,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(n){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(n<1&&u!==this._elevationTarget){const m=this._elevationTarget-this._elevationStart;this._elevationStart+=n*(m-(u-(m*n+this._elevationStart))/(1-n)),this._elevationTarget=u}this.transform.setElevation(o.G.number(this._elevationStart,this._elevationTarget,n))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(n){if(!this.terrain&&n.elevation>=0&&n.pitch<=90)return{};const u=n.getCameraLngLat(),m=n.getCameraAltitude(),v=this.terrain?this.terrain.getElevationForLngLatZoom(u,n.zoom):0;if(m<v){const S=this.calculateCameraOptionsFromTo(u,v,n.center,n.elevation);return{pitch:S.pitch,zoom:S.zoom}}return{}}_applyUpdatedTransform(n){const u=[];if(u.push(v=>this._elevateCameraIfInsideTerrain(v)),this.transformCameraUpdate&&u.push(v=>this.transformCameraUpdate(v)),!u.length)return;const m=n.clone();for(const v of u){const S=m.clone(),{center:M,zoom:k,roll:O,pitch:B,bearing:q,elevation:Y}=v(S);M&&S.setCenter(M),Y!==void 0&&S.setElevation(Y),k!==void 0&&S.setZoom(k),O!==void 0&&S.setRoll(O),B!==void 0&&S.setPitch(B),q!==void 0&&S.setBearing(q),m.apply(S,!1)}this.transform.apply(m,!1)}_fireMoveEvents(n){this.fire(new o.l("move",n)),this._zooming&&this.fire(new o.l("zoom",n)),this._rotating&&this.fire(new o.l("rotate",n)),this._pitching&&this.fire(new o.l("pitch",n)),this._rolling&&this.fire(new o.l("roll",n))}_afterEase(n,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const m=this._zooming,v=this._rotating,S=this._pitching,M=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,m&&this.fire(new o.l("zoomend",n)),v&&this.fire(new o.l("rotateend",n)),S&&this.fire(new o.l("pitchend",n)),M&&this.fire(new o.l("rollend",n)),this.fire(new o.l("moveend",n))}flyTo(n,u){if(!n.essential&&F.prefersReducedMotion){const at=o.U(n,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(at,u)}this.stop(),n=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.cy},n);const m=this._getTransformForUpdate(),v=m.bearing,S=m.pitch,M=m.roll,k=m.padding,O="bearing"in n?this._normalizeBearing(n.bearing,v):v,B="pitch"in n?+n.pitch:S,q="roll"in n?this._normalizeBearing(n.roll,M):M,Y="padding"in n?n.padding:m.padding,X=o.P.convert(n.offset);let te=m.centerPoint.add(X);const ce=m.screenPointToLocation(te),ge=this.cameraHelper.handleFlyTo(m,{bearing:O,pitch:B,roll:q,padding:Y,locationAtOffset:ce,offsetAsPoint:X,center:n.center,minZoom:n.minZoom,zoom:n.zoom});let _e=n.curve;const ve=Math.max(m.width,m.height),Se=ve/ge.scaleOfZoom,Oe=ge.pixelPathLength;typeof ge.scaleOfMinZoom=="number"&&(_e=Math.sqrt(ve/ge.scaleOfMinZoom/Oe*2));const Ce=_e*_e;function De(at){const Rt=(Se*Se-ve*ve+(at?-1:1)*Ce*Ce*Oe*Oe)/(2*(at?Se:ve)*Ce*Oe);return Math.log(Math.sqrt(Rt*Rt+1)-Rt)}function Be(at){return(Math.exp(at)-Math.exp(-at))/2}function Ae(at){return(Math.exp(at)+Math.exp(-at))/2}const Ue=De(!1);let ut=function(at){return Ae(Ue)/Ae(Ue+_e*at)},it=function(at){return ve*((Ae(Ue)*(Be(Rt=Ue+_e*at)/Ae(Rt))-Be(Ue))/Ce)/Oe;var Rt},st=(De(!0)-Ue)/_e;if(Math.abs(Oe)<2e-6||!isFinite(st)){if(Math.abs(ve-Se)<1e-6)return this.easeTo(n,u);const at=Se<ve?-1:1;st=Math.abs(Math.log(Se/ve))/_e,it=()=>0,ut=Rt=>Math.exp(at*_e*Rt)}return n.duration="duration"in n?+n.duration:1e3*st/("screenSpeed"in n?+n.screenSpeed/_e:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=v!==O,this._pitching=B!==S,this._rolling=q!==M,this._padding=!m.isPaddingEqual(Y),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(ge.targetCenter),this._ease(at=>{const Rt=at*st,Dt=1/ut(Rt),Tt=it(Rt);this._rotating&&m.setBearing(o.G.number(v,O,at)),this._pitching&&m.setPitch(o.G.number(S,B,at)),this._rolling&&m.setRoll(o.G.number(M,q,at)),this._padding&&(m.interpolatePadding(k,Y,at),te=m.centerPoint.add(X)),ge.easeFunc(at,Dt,Tt,te),this.terrain&&!n.freezeElevation&&this._updateElevation(at),this._applyUpdatedTransform(m),this._fireMoveEvents(u)},()=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(u)},n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,u){var m;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,u)}return n||(m=this.handlers)===null||m===void 0||m.stop(!1),this}_ease(n,u,m){m.animate===!1||m.duration===0?(n(1),u()):(this._easeStart=$(),this._easeOptions=m,this._onEaseFrame=n,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(n,u){n=o.W(n,-180,180);const m=Math.abs(n-u);return Math.abs(n-360-u)<m&&(n-=360),Math.abs(n+360-u)<m&&(n+=360),n}queryTerrainElevation(n){return this.terrain?this.terrain.getElevationForLngLat(o.V.convert(n),this.transform):null}}const Zo={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class qd{constructor(n=Zo){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"&&u.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=n}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options.compact,this._container=j.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=j.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=j.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){j.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,u){const m=this._map._getUIString(`AttributionControl.${u}`);n.title=m,n.setAttribute("aria-label",m)}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(v=>typeof v!="string"?"":v)):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const u=this._map.style.tileManagers;for(const v in u){const S=u[v];if(S.used||S.usedForTerrain){const M=S.getSource();M.attribution&&n.indexOf(M.attribution)<0&&n.push(M.attribution)}}n=n.filter(v=>String(v).trim()),n.sort((v,S)=>v.length-S.length),n=n.filter((v,S)=>{for(let M=S+1;M<n.length;M++)if(n[M].indexOf(v)>=0)return!1;return!0});const m=n.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,n.length?(this._innerContainer.innerHTML=j.sanitize(m),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class aa{constructor(n={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const m=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&m.classList.add("maplibregl-compact"):m.classList.remove("maplibregl-compact")}},this.options=n}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=j.create("div","maplibregl-ctrl");const u=j.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){j.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Ll{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const u=++this._id;return this._queue.push({callback:n,id:u,cancelled:!1}),u}remove(n){const u=this._currentlyRunning,m=u?this._queue.concat(u):this._queue;for(const v of m)if(v.id===n)return void(v.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const m of u)if(!m.cancelled&&(m.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Hd=o.aU([{name:"a_pos3d",type:"Int16",components:3}]);class Pu extends o.E{constructor(n){super(),this._lastTilesetChange=$(),this.tileManager=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=n._source.tileSize*2**this.deltaZoom,n.usedForTerrain=!0,n.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(n,u){this.tileManager.update(n,u),this._renderableTilesKeys=[];const m={};for(const v of zr(n,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u,calculateTileZoom:this.tileManager._source.calculateTileZoom}))m[v.key]=!0,this._renderableTilesKeys.push(v.key),this._tiles[v.key]||(v.terrainRttPosMatrix32f=new Float64Array(16),o.c7(v.terrainRttPosMatrix32f,0,o.a5,o.a5,0,0,1),this._tiles[v.key]=new Ct(v,this.tileSize),this._lastTilesetChange=$());for(const v in this._tiles)m[v]||delete this._tiles[v]}freeRtt(n){for(const u in this._tiles){const m=this._tiles[u];(!n||m.tileID.equals(n)||m.tileID.isChildOf(n)||n.isChildOf(m.tileID))&&(m.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(n=>this.getTileByID(n))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n,u){return u?this._getTerrainCoordsForTileRanges(n,u):this._getTerrainCoordsForRegularTile(n)}_getTerrainCoordsForRegularTile(n){const u={};for(const m of this._renderableTilesKeys){const v=this._tiles[m].tileID,S=n.clone(),M=o.bk();if(v.canonical.equals(n.canonical))o.c7(M,0,o.a5,o.a5,0,0,1);else if(v.canonical.isChildOf(n.canonical)){const k=v.canonical.z-n.canonical.z,O=v.canonical.x-(v.canonical.x>>k<<k),B=v.canonical.y-(v.canonical.y>>k<<k),q=o.a5>>k;o.c7(M,0,q,q,0,0,1),o.O(M,M,[-O*q,-B*q,0])}else{if(!n.canonical.isChildOf(v.canonical))continue;{const k=n.canonical.z-v.canonical.z,O=n.canonical.x-(n.canonical.x>>k<<k),B=n.canonical.y-(n.canonical.y>>k<<k),q=o.a5>>k;o.c7(M,0,o.a5,o.a5,0,0,1),o.O(M,M,[O*q,B*q,0]),o.Q(M,M,[1/2**k,1/2**k,0])}}S.terrainRttPosMatrix32f=new Float32Array(M),u[m]=S}return u}_getTerrainCoordsForTileRanges(n,u){const m={};for(const v of this._renderableTilesKeys){const S=this._tiles[v].tileID;if(!this._isWithinTileRanges(S,u))continue;const M=n.clone(),k=o.bk();if(S.canonical.z===n.canonical.z){const O=n.canonical.x-S.canonical.x+n.wrap*(1<<n.canonical.z),B=n.canonical.y-S.canonical.y;o.c7(k,0,o.a5,o.a5,0,0,1),o.O(k,k,[O*o.a5,B*o.a5,0])}else if(S.canonical.z>n.canonical.z){const O=S.canonical.z-n.canonical.z,B=S.canonical.x-(S.canonical.x>>O<<O)+n.wrap*(1<<S.canonical.z),q=S.canonical.y-(S.canonical.y>>O<<O),Y=n.canonical.x-(S.canonical.x>>O),X=n.canonical.y-(S.canonical.y>>O),te=o.a5>>O;o.c7(k,0,te,te,0,0,1),o.O(k,k,[-B*te+Y*o.a5,-q*te+X*o.a5,0])}else{const O=n.canonical.z-S.canonical.z,B=n.canonical.x-(n.canonical.x>>O<<O)+n.wrap*(1<<n.canonical.z),q=n.canonical.y-(n.canonical.y>>O<<O),Y=(n.canonical.x>>O)-S.canonical.x,X=(n.canonical.y>>O)-S.canonical.y,te=o.a5<<O;o.c7(k,0,te,te,0,0,1),o.O(k,k,[B*o.a5+Y*te,q*o.a5+X*te,0])}M.terrainRttPosMatrix32f=new Float32Array(k),m[v]=M}return m}getSourceTile(n,u){const m=this.tileManager._source;let v=n.overscaledZ-this.deltaZoom;if(v>m.maxzoom&&(v=m.maxzoom),v<m.minzoom)return;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(v).key);let S=this.findTileInCaches(this._sourceTileCache[n.key]);if(!S?.dem&&u)for(;v>=m.minzoom&&!S?.dem;)S=this.findTileInCaches(n.scaledTo(v--).key);return S}findTileInCaches(n){let u=this.tileManager.getTileByID(n);return u||(u=this.tileManager._outOfViewCache.getByKey(n),u)}anyTilesAfterTime(n=Date.now()){return this._lastTilesetChange>=n}_isWithinTileRanges(n,u){const m=u[n.canonical.z];return!!m&&(n.wrap>m.minWrap||n.wrap<m.maxWrap||n.canonical.x>=m.minTileXWrapped&&n.canonical.x<=m.maxTileXWrapped&&n.canonical.y>=m.minTileY&&n.canonical.y<=m.maxTileY)}}class Ln{constructor(n,u,m){this._meshCache={},this.painter=n,this.tileManager=new Pu(u),this.options=m,this.exaggeration=typeof m.exaggeration=="number"?m.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(n,u,m,v=o.a5){var S;if(!(u>=0&&u<v&&m>=0&&m<v))return 0;const M=this.getTerrainData(n),k=(S=M.tile)===null||S===void 0?void 0:S.dem;if(!k)return 0;const O=o.cC([],[u/v*o.a5,m/v*o.a5],M.u_terrain_matrix),B=[O[0]*k.dim,O[1]*k.dim],q=Math.floor(B[0]),Y=Math.floor(B[1]),X=B[0]-q,te=B[1]-Y;return k.get(q,Y)*(1-X)*(1-te)+k.get(q+1,Y)*X*(1-te)+k.get(q,Y+1)*(1-X)*te+k.get(q+1,Y+1)*X*te}getElevationForLngLatZoom(n,u){if(!o.cD(u,n.wrap()))return 0;const{tileID:m,mercatorX:v,mercatorY:S}=this._getOverscaledTileIDFromLngLatZoom(n,u);return this.getElevation(m,v%o.a5,S%o.a5,o.a5)}getElevationForLngLat(n,u){const m=zr(u,{maxzoom:this.tileManager.maxzoom,minzoom:this.tileManager.minzoom,tileSize:512,terrain:this});let v=0;for(const S of m)S.canonical.z>v&&(v=Math.min(S.canonical.z,this.tileManager.maxzoom));return this.getElevationForLngLatZoom(n,v)}getElevation(n,u,m,v=o.a5){return this.getDEMElevation(n,u,m,v)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const v=this.painter.context,S=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new o.T(v,S,v.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new o.T(v,new o.R({width:1,height:1}),v.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.ar([])}const u=this.tileManager.getSourceTile(n,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const v=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new o.T(v,u.dem.getPixels(),v.gl.RGBA,{premultiply:!1}),u.demTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const m=u&&u.toString()+u.tileID.key+n.key;if(m&&!this._demMatrixCache[m]){const v=this.tileManager.getSource().maxzoom;let S=n.canonical.z-u.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=v?S=n.canonical.z-v:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const M=n.canonical.x-(n.canonical.x>>S<<S),k=n.canonical.y-(n.canonical.y>>S<<S),O=o.cE(new Float64Array(16),[1/(o.a5<<S),1/(o.a5<<S),0]);o.O(O,O,[M*o.a5,k*o.a5,0]),this._demMatrixCache[n.key]={matrix:O,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:m?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(n){const u=this.painter,m=u.width/devicePixelRatio,v=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===m&&this._fbo.height===v||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new o.T(u.context,{width:m,height:v,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new o.T(u.context,{width:m,height:v,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(m,v,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,m,v))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let S=0,M=0;S<this._coordsTextureSize;S++)for(let k=0;k<this._coordsTextureSize;k++,M+=4)u[M+0]=255&k,u[M+1]=255&S,u[M+2]=k>>8<<4|S>>8,u[M+3]=0;const m=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),v=new o.T(n,m,n.gl.RGBA,{premultiply:!1});return v.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=v,v}pointCoordinate(n){this.painter.maybeDrawDepthAndCoords(!0);const u=new Uint8Array(4),m=this.painter.context,v=m.gl,S=Math.round(n.x*this.painter.pixelRatio/devicePixelRatio),M=Math.round(n.y*this.painter.pixelRatio/devicePixelRatio),k=Math.round(this.painter.height/devicePixelRatio);m.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),v.readPixels(S,k-M-1,1,1,v.RGBA,v.UNSIGNED_BYTE,u),m.bindFramebuffer.set(null);const O=u[0]+(u[2]>>4<<8),B=u[1]+((15&u[2])<<8),q=this.coordsIndex[255-u[3]],Y=q&&this.tileManager.getTileByID(q);if(!Y)return null;const X=this._coordsTextureSize,te=(1<<Y.tileID.canonical.z)*X;return new o.a9((Y.tileID.canonical.x*X+O)/te+Y.tileID.wrap,(Y.tileID.canonical.y*X+B)/te,this.getElevation(Y.tileID,O,B,X))}depthAtPoint(n){const u=new Uint8Array(4),m=this.painter.context,v=m.gl;return m.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),v.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,v.RGBA,v.UNSIGNED_BYTE,u),m.bindFramebuffer.set(null),(u[0]/16777216+u[1]/65536+u[2]/256+u[3])/256}getTerrainMesh(n){var u;const m=((u=this.painter.style.projection)===null||u===void 0?void 0:u.transitionState)>0,v=m&&n.canonical.y===0,S=m&&n.canonical.y===(1<<n.canonical.z)-1,M=`m_${v?"n":""}_${S?"s":""}`;if(this._meshCache[M])return this._meshCache[M];const k=this.painter.context,O=new o.cF,B=new o.aY,q=this.meshSize,Y=o.a5/q,X=q*q;for(let Ae=0;Ae<=q;Ae++)for(let Ue=0;Ue<=q;Ue++)O.emplaceBack(Ue*Y,Ae*Y,0);for(let Ae=0;Ae<X;Ae+=q+1)for(let Ue=0;Ue<q;Ue++)B.emplaceBack(Ue+Ae,q+Ue+Ae+1,q+Ue+Ae+2),B.emplaceBack(Ue+Ae,q+Ue+Ae+2,Ue+Ae+1);const te=O.length,ce=te+(q+1),ge=(q+1)*q,_e=v?o.br:0,ve=v?0:1,Se=S?o.bs:o.a5,Oe=S?0:1;for(let Ae=0;Ae<=q;Ae++)O.emplaceBack(Ae*Y,_e,ve);for(let Ae=0;Ae<=q;Ae++)O.emplaceBack(Ae*Y,Se,Oe);for(let Ae=0;Ae<q;Ae++)B.emplaceBack(ge+Ae,ce+Ae,ce+Ae+1),B.emplaceBack(ge+Ae,ce+Ae+1,ge+Ae+1),B.emplaceBack(0+Ae,te+Ae+1,te+Ae),B.emplaceBack(0+Ae,0+Ae+1,te+Ae+1);const Ce=O.length,De=Ce+2*(q+1);for(const Ae of[0,1])for(let Ue=0;Ue<=q;Ue++)for(const ut of[0,1])O.emplaceBack(Ae*o.a5,Ue*Y,ut);for(let Ae=0;Ae<2*q;Ae+=2)B.emplaceBack(Ce+Ae,Ce+Ae+1,Ce+Ae+3),B.emplaceBack(Ce+Ae,Ce+Ae+3,Ce+Ae+2),B.emplaceBack(De+Ae,De+Ae+3,De+Ae+1),B.emplaceBack(De+Ae,De+Ae+2,De+Ae+3);const Be=new Mn(k.createVertexBuffer(O,Hd.members),k.createIndexBuffer(B),o.aX.simpleSegment(0,0,O.length,B.length));return this._meshCache[M]=Be,Be}getMeshFrameDelta(n){return 2*Math.PI*o.bE/Math.pow(2,Math.max(n,0))/5}getMinTileElevationForLngLatZoom(n,u){var m;if(!o.cD(u,n.wrap()))return 0;const{tileID:v}=this._getOverscaledTileIDFromLngLatZoom(n,u);return(m=this.getMinMaxElevation(v).minElevation)!==null&&m!==void 0?m:0}getMinMaxElevation(n){const u=this.getTerrainData(n).tile,m={minElevation:null,maxElevation:null};return u&&u.dem&&(m.minElevation=u.dem.min*this.exaggeration,m.maxElevation=u.dem.max*this.exaggeration),m}_getOverscaledTileIDFromLngLatZoom(n,u){const m=o.a9.fromLngLat(n.wrap()),v=(1<<u)*o.a5,S=m.x*v,M=m.y*v,k=Math.floor(S/o.a5),O=Math.floor(M/o.a5);return{tileID:new o.a2(u,0,u,k,O),mercatorX:S,mercatorY:M}}}class gi{constructor(n,u,m){this._context=n,this._size=u,this._tileSize=m,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const n of this._objects)n.texture.destroy(),n.fbo.destroy()}_createObject(n){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),m=new o.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return m.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(m.texture),{id:n,fbo:u,texture:m,stamp:-1,inUse:!1}}getObjectForId(n){return this._objects[n]}useObject(n){n.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(u=>n.id!==u),this._recentlyUsed.push(n.id)}stampObject(n){n.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const n=this._createObject(this._objects.length);return this._objects.push(n),n}freeObject(n){n.inUse=!1}freeAllObjects(){for(const n of this._objects)this.freeObject(n)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(n=>!n.inUse)===!1}}const Us={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Xo{constructor(n,u){this.painter=n,this.terrain=u,this.pool=new gi(n.context,30,u.tileManager.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(n){return this.pool.getObjectForId(n.rtt[this._stacks.length-1].id).texture}prepareForRender(n,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=n._order.filter(m=>!n._layers[m].isHidden(u)),this._coordsAscending={};for(const m in n.tileManagers){this._coordsAscending[m]={};const v=n.tileManagers[m].getVisibleCoordinates(),S=n.tileManagers[m].getSource(),M=S instanceof wn?S.terrainTileRanges:null;for(const k of v){const O=this.terrain.tileManager.getTerrainCoords(k,M);for(const B in O)this._coordsAscending[m][B]||(this._coordsAscending[m][B]=[]),this._coordsAscending[m][B].push(O[B])}}this._coordsAscendingStr={};for(const m of n._order){const v=n._layers[m],S=v.source;if(Us[v.type]&&!this._coordsAscendingStr[S]){this._coordsAscendingStr[S]={};for(const M in this._coordsAscending[S])this._coordsAscendingStr[S][M]=this._coordsAscending[S][M].map(k=>k.key).sort().join()}}for(const m of this._renderableTiles)for(const v in this._coordsAscendingStr){const S=this._coordsAscendingStr[v][m.tileID.key];S&&S!==m.rttCoords[v]&&(m.rtt=[])}}renderLayer(n,u){if(n.isHidden(this.painter.transform.zoom))return!1;const m=Object.assign(Object.assign({},u),{isRenderingToTexture:!0}),v=n.type,S=this.painter,M=this._renderableLayerIds[this._renderableLayerIds.length-1]===n.id;if(Us[v]&&(this._prevType&&Us[this._prevType]||this._stacks.push([]),this._prevType=v,this._stacks[this._stacks.length-1].push(n.id),!M))return!0;if(Us[this._prevType]||Us[v]&&M){this._prevType=v;const k=this._stacks.length-1,O=this._stacks[k]||[];for(const B of this._renderableTiles){if(this.pool.isFull()&&(kl(this.painter,this.terrain,this._rttTiles,m),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(B),B.rtt[k]){const Y=this.pool.getObjectForId(B.rtt[k].id);if(Y.stamp===B.rtt[k].stamp){this.pool.useObject(Y);continue}}const q=this.pool.getOrCreateFreeObject();this.pool.useObject(q),this.pool.stampObject(q),B.rtt[k]={id:q.id,stamp:q.stamp},S.context.bindFramebuffer.set(q.fbo.framebuffer),S.context.clear({color:o.bp.transparent,stencil:0}),S.currentStencilSource=void 0;for(let Y=0;Y<O.length;Y++){const X=S.style._layers[O[Y]],te=X.source?this._coordsAscending[X.source][B.tileID.key]:[B.tileID];S.context.viewport.set([0,0,q.fbo.width,q.fbo.height]),S._renderTileClippingMasks(X,te,!0),S.renderLayer(S,S.style.tileManagers[X.source],X,te,m),X.source&&(B.rttCoords[X.source]=this._coordsAscendingStr[X.source][B.tileID.key])}}return kl(this.painter,this.terrain,this._rttTiles,m),this._rttTiles=[],this.pool.freeAllObjects(),Us[v]}return!1}}const Fl={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},kc=b,la={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Zo,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.c.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},$h={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class ca{constructor(n,u,m=!1){this.mousedown=S=>{this.startMove(S,j.mousePos(this.element,S)),j.addEventListener(window,"mousemove",this.mousemove),j.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=S=>{this.move(S,j.mousePos(this.element,S))},this.mouseup=S=>{this._rotatePitchHandler.dragEnd(S),this.offTemp()},this.touchstart=S=>{S.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=j.touchPos(this.element,S.targetTouches)[0],this.startMove(S,this._startPos),j.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),j.addEventListener(window,"touchend",this.touchend))},this.touchmove=S=>{S.targetTouches.length!==1?this.reset():(this._lastPos=j.touchPos(this.element,S.targetTouches)[0],this.move(S,this._lastPos))},this.touchend=S=>{S.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=u;const v=new ip;this._rotatePitchHandler=new Rl({clickTolerance:3,move:(S,M)=>{const k=u.getBoundingClientRect(),O=new o.P((k.bottom-k.top)/2,(k.right-k.left)/2);return{bearingDelta:o.cx(new o.P(S.x,M.y),M,O),pitchDelta:m?-.5*(M.y-S.y):void 0}},moveStateManager:v,enable:!0,assignEvents:()=>{}}),this.map=n,j.addEventListener(u,"mousedown",this.mousedown),j.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),j.addEventListener(u,"touchcancel",this.reset)}startMove(n,u){this._rotatePitchHandler.dragStart(n,u),j.disableDrag()}move(n,u){const m=this.map,{bearingDelta:v,pitchDelta:S}=this._rotatePitchHandler.dragMove(n,u)||{};v&&m.setBearing(m.getBearing()+v),S&&m.setPitch(m.getPitch()+S)}off(){const n=this.element;j.removeEventListener(n,"mousedown",this.mousedown),j.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),j.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),j.removeEventListener(window,"touchend",this.touchend),j.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){j.enableDrag(),j.removeEventListener(window,"mousemove",this.mousemove),j.removeEventListener(window,"mouseup",this.mouseup),j.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),j.removeEventListener(window,"touchend",this.touchend)}}let ua;function Eu(w,n,u,m=!1){if(m||!u.getCoveringTilesDetailsProvider().allowWorldCopies())return w?.wrap();const v=new o.V(w.lng,w.lat);if(w=new o.V(w.lng,w.lat),n){const S=new o.V(w.lng-360,w.lat),M=new o.V(w.lng+360,w.lat),k=u.locationToScreenPoint(w).distSqr(n);u.locationToScreenPoint(S).distSqr(n)<k?w=S:u.locationToScreenPoint(M).distSqr(n)<k&&(w=M)}for(;Math.abs(w.lng-u.center.lng)>180;){const S=u.locationToScreenPoint(w);if(S.x>=0&&S.y>=0&&S.x<=u.width&&S.y<=u.height)break;w.lng>u.center.lng?w.lng-=360:w.lng+=360}return w.lng!==v.lng&&u.isPointOnMapSurface(u.locationToScreenPoint(w))?w:v}const Fn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ac(w,n,u){const m=w.classList;for(const v in Fn)m.remove(`maplibregl-${u}-anchor-${v}`);m.add(`maplibregl-${u}-anchor-${n}`)}class Rc extends o.E{constructor(n){if(super(),this._onKeyPress=u=>{const m=u.code,v=u.charCode||u.keyCode;m!=="Space"&&m!=="Enter"&&v!==32&&v!==13||this.togglePopup()},this._onMapClick=u=>{const m=u.originalEvent.target,v=this._element;this._popup&&(m===v||v.contains(m))&&this.togglePopup()},this._update=u=>{if(!this._map)return;const m=this._map.loaded()&&!this._map.isMoving();(u?.type==="terrain"||u?.type==="render"&&!m)&&this._map.once("render",this._update),this._lngLat=Eu(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let v="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?v=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(v=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let S="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?S="rotateX(0deg)":this._pitchAlignment==="map"&&(S=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||u&&u.type!=="moveend"||(this._pos=this._pos.round()),j.setTransform(this._element,`${Fn[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${S} ${v}`),F.frameAsync(new AbortController).then(()=>{this._updateOpacity(u&&u.type==="moveend")}).catch(()=>{})},this._onMove=u=>{if(!this._isDragging){const m=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=m}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.l("dragstart"))),this.fire(new o.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.l("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._subpixelPositioning=n&&n.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,this.setOpacity(n?.opacity,n?.opacityWhenCovered),n&&n.element)this._element=n.element,this._offset=o.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=j.create("div");const u=j.createNS("http://www.w3.org/2000/svg","svg"),m=41,v=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${m}px`),u.setAttributeNS(null,"width",`${v}px`),u.setAttributeNS(null,"viewBox",`0 0 ${v} ${m}`);const S=j.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"stroke","none"),S.setAttributeNS(null,"stroke-width","1"),S.setAttributeNS(null,"fill","none"),S.setAttributeNS(null,"fill-rule","evenodd");const M=j.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"fill-rule","nonzero");const k=j.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");const O=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ve of O){const Se=j.createNS("http://www.w3.org/2000/svg","ellipse");Se.setAttributeNS(null,"opacity","0.04"),Se.setAttributeNS(null,"cx","10.5"),Se.setAttributeNS(null,"cy","5.80029008"),Se.setAttributeNS(null,"rx",ve.rx),Se.setAttributeNS(null,"ry",ve.ry),k.appendChild(Se)}const B=j.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill",this._color);const q=j.createNS("http://www.w3.org/2000/svg","path");q.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),B.appendChild(q);const Y=j.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"opacity","0.25"),Y.setAttributeNS(null,"fill","#000000");const X=j.createNS("http://www.w3.org/2000/svg","path");X.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Y.appendChild(X);const te=j.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"transform","translate(6.0, 7.0)"),te.setAttributeNS(null,"fill","#FFFFFF");const ce=j.createNS("http://www.w3.org/2000/svg","g");ce.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ge=j.createNS("http://www.w3.org/2000/svg","circle");ge.setAttributeNS(null,"fill","#000000"),ge.setAttributeNS(null,"opacity","0.25"),ge.setAttributeNS(null,"cx","5.5"),ge.setAttributeNS(null,"cy","5.5"),ge.setAttributeNS(null,"r","5.4999962");const _e=j.createNS("http://www.w3.org/2000/svg","circle");_e.setAttributeNS(null,"fill","#FFFFFF"),_e.setAttributeNS(null,"cx","5.5"),_e.setAttributeNS(null,"cy","5.5"),_e.setAttributeNS(null,"r","5.4999962"),ce.appendChild(ge),ce.appendChild(_e),M.appendChild(k),M.appendChild(B),M.appendChild(Y),M.appendChild(te),M.appendChild(ce),u.appendChild(M),u.setAttributeNS(null,"height",m*this._scale+"px"),u.setAttributeNS(null,"width",v*this._scale+"px"),this._element.appendChild(u),this._offset=o.P.convert(n&&n.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()}),Ac(this._element,this._anchor,"marker"),n&&n.className)for(const u of n.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(n){return this.remove(),this._map=n,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",n._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),n.on("terrain",this._update),n.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),j.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=o.V.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const v=Math.abs(13.5)/Math.SQRT2;n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(n){return this._subpixelPositioning=n,this}getPopup(){return this._popup}togglePopup(){const n=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:n?(n.isOpen()?n.remove():(n.setLngLat(this._lngLat),n.addTo(this._map)),this):this}_updateOpacity(n=!1){var u,m;const v=(u=this._map)===null||u===void 0?void 0:u.terrain,S=this._map.transform.isLocationOccluded(this._lngLat);if(!v||S){const te=S?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==te&&(this._element.style.opacity=te))}if(n)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const M=this._map,k=M.terrain.depthAtPoint(this._pos),O=M.terrain.getElevationForLngLat(this._lngLat,M.transform);if(M.transform.lngLatToCameraDepth(this._lngLat,O)-k<.006)return void(this._element.style.opacity=this._opacity);const B=-this._offset.y/M.transform.pixelsPerMeter,q=Math.sin(M.getPitch()*Math.PI/180)*B,Y=M.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),X=M.transform.lngLatToCameraDepth(this._lngLat,O+q)-Y>.006;!((m=this._popup)===null||m===void 0)&&m.isOpen()&&X&&this._popup.remove(),this._element.style.opacity=X?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(n){return this._offset=o.P.convert(n),this._update(),this}addClassName(n){this._element.classList.add(n)}removeClassName(n){this._element.classList.remove(n)}toggleClassName(n){return this._element.classList.toggle(n)}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(n,u){return(this._opacity===void 0||n===void 0&&u===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),n!==void 0&&(this._opacity=n),u!==void 0&&(this._opacityWhenCovered=u),this._map&&this._updateOpacity(!0),this}}const jh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ja=0,Na=!1;const Va={maxWidth:100,unit:"metric"};function Bn(w,n,u){const m=u&&u.maxWidth||100,v=w._container.clientHeight/2,S=w._container.clientWidth/2,M=w.unproject([S-m/2,v]),k=w.unproject([S+m/2,v]),O=Math.round(w.project(k).x-w.project(M).x),B=Math.min(m,O,w._container.clientWidth),q=M.distanceTo(k);if(u&&u.unit==="imperial"){const Y=3.2808*q;Y>5280?ni(n,B,Y/5280,w._getUIString("ScaleControl.Miles")):ni(n,B,Y,w._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?ni(n,B,q/1852,w._getUIString("ScaleControl.NauticalMiles")):q>=1e3?ni(n,B,q/1e3,w._getUIString("ScaleControl.Kilometers")):ni(n,B,q,w._getUIString("ScaleControl.Meters"))}function ni(w,n,u,m){const v=function(S){const M=Math.pow(10,`${Math.floor(S)}`.length-1);let k=S/M;return k=k>=10?10:k>=5?5:k>=3?3:k>=2?2:k>=1?1:function(O){const B=Math.pow(10,Math.ceil(-Math.log(O)/Math.LN10));return Math.round(O*B)/B}(k),M*k}(u);w.style.width=n*(v/u)+"px",w.innerHTML=`${v}&nbsp;${m}`}const Bi={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0,padding:void 0},Dc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Bl(w){if(w){if(typeof w=="number"){const n=Math.round(Math.abs(w)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,w),"top-left":new o.P(n,n),"top-right":new o.P(-n,n),bottom:new o.P(0,-w),"bottom-left":new o.P(n,-n),"bottom-right":new o.P(-n,-n),left:new o.P(w,0),right:new o.P(-w,0)}}if(w instanceof o.P||Array.isArray(w)){const n=o.P.convert(w);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:o.P.convert(w.center||[0,0]),top:o.P.convert(w.top||[0,0]),"top-left":o.P.convert(w["top-left"]||[0,0]),"top-right":o.P.convert(w["top-right"]||[0,0]),bottom:o.P.convert(w.bottom||[0,0]),"bottom-left":o.P.convert(w["bottom-left"]||[0,0]),"bottom-right":o.P.convert(w["bottom-right"]||[0,0]),left:o.P.convert(w.left||[0,0]),right:o.P.convert(w.right||[0,0])}}return Bl(new o.P(0,0))}const zc=b;f.AJAXError=o.cI,f.Event=o.l,f.Evented=o.E,f.LngLat=o.V,f.MercatorCoordinate=o.a9,f.Point=o.P,f.addProtocol=o.cJ,f.config=o.c,f.removeProtocol=o.cK,f.AttributionControl=qd,f.BoxZoomHandler=Wo,f.CanvasSource=ae,f.CooperativeGesturesHandler=Xt,f.DoubleClickZoomHandler=Ol,f.DragPanHandler=Gd,f.DragRotateHandler=as,f.EdgeInsets=oc,f.FullscreenControl=class extends o.E{constructor(w={}){super(),this._onFullscreenChange=()=>{var n;let u=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((n=u?.shadowRoot)===null||n===void 0)&&n.fullscreenElement;)u=u.shadowRoot.fullscreenElement;u===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,w&&w.container&&(w.container instanceof HTMLElement?this._container=w.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(w){return this._map=w,this._container||(this._container=this._map.getContainer()),this._controlContainer=j.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){j.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const w=this._fullscreenButton=j.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);j.create("span","maplibregl-ctrl-icon",w).setAttribute("aria-hidden","true"),w.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const w=this._getTitle();this._fullscreenButton.setAttribute("aria-label",w),this._fullscreenButton.title=w}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},f.GeoJSONSource=Un,f.GeolocateControl=class extends o.E{constructor(w){super(),this._onSuccess=n=>{if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new o.l("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.l("geolocate",n)),this._finish()}},this._updateCamera=n=>{const u=new o.V(n.coords.longitude,n.coords.latitude),m=n.coords.accuracy,v=this._map.getBearing(),S=o.e({bearing:v},this.options.fitBoundsOptions),M=yr.fromLngLat(u,m);this._map.fitBounds(M,S,{geolocateSource:!0})},this._updateMarker=n=>{if(n){const u=new o.V(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=n.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=n=>{if(this._map){if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&Na)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.l("error",n)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=j.create("button","maplibregl-ctrl-geolocate",this._container),j.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=n=>{if(this._map){if(n===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=j.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Rc({element:this._dotElement}),this._circleElement=j.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Rc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{const m=u?.[0]instanceof ResizeObserverEntry;u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||m||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.l("trackuserlocationend")),this.fire(new o.l("userlocationlostfocus")))})}},this.options=o.e({},jh,w)}onAdd(w){return this._map=w,this._container=j.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return o._(this,arguments,void 0,function*(n=!1){if(ua!==void 0&&!n)return ua;if(window.navigator.permissions===void 0)return ua=!!window.navigator.geolocation,ua;try{ua=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ua=!!window.navigator.geolocation}return ua})}().then(n=>this._finishSetupUI(n)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),j.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,ja=0,Na=!1}_isOutOfMapMaxBounds(w){const n=this._map.getMaxBounds(),u=w.coords;return n&&(u.longitude<n.getWest()||u.longitude>n.getEast()||u.latitude<n.getSouth()||u.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const w=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&w))return;const n=this._map.project(w),u=this._map.unproject([n.x+100,n.y]),m=w.distanceTo(u)/100,v=2*this._accuracy/m;this._circleElement.style.width=`${v.toFixed(2)}px`,this._circleElement.style.height=`${v.toFixed(2)}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ja--,Na=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.l("trackuserlocationstart")),this.fire(new o.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let w;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ja++,ja>1?(w={maximumAge:6e5,timeout:0},Na=!0):(w=this.options.positionOptions,Na=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,w)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},f.GlobeControl=class{constructor(){this._toggleProjection=()=>{var w;const n=(w=this._map.getProjection())===null||w===void 0?void 0:w.type;this._map.setProjection(n!=="mercator"&&n?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var w;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((w=this._map.getProjection())===null||w===void 0?void 0:w.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(w){return this._map=w,this._container=j.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=j.create("button","maplibregl-ctrl-globe",this._container),j.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){j.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},f.Hash=Bd,f.ImageSource=wn,f.KeyboardHandler=Sn,f.LngLatBounds=yr,f.LogoControl=aa,f.Map=class extends Ti{constructor(w){var n,u;o.cG.mark(o.cH.create);const m=Object.assign(Object.assign(Object.assign({},la),w),{canvasContextAttributes:Object.assign(Object.assign({},la.canvasContextAttributes),w.canvasContextAttributes)});if(m.minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const v=new ac,S=new xl;if(m.minZoom!==void 0&&v.setMinZoom(m.minZoom),m.maxZoom!==void 0&&v.setMaxZoom(m.maxZoom),m.minPitch!==void 0&&v.setMinPitch(m.minPitch),m.maxPitch!==void 0&&v.setMaxPitch(m.maxPitch),m.renderWorldCopies!==void 0&&v.setRenderWorldCopies(m.renderWorldCopies),m.transformConstrain!==null&&v.setConstrainOverride(m.transformConstrain),super(v,S,{bearingSnap:m.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Ll,this._controls=[],this._mapId=o.af(),this._lostContextStyle={style:null,images:null},this._contextLost=k=>{k.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy();for(const O of Object.values(this.style._layers))if(O.type==="custom"&&console.warn(`Custom layer with id '${O.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),O._listeners)for(const[B]of Object.entries(O._listeners))console.warn(`Custom layer with id '${O.id}' had event listeners for event '${B}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this._lostContextStyle=this._getStyleAndImages(),this.style.destroy(),this.style=null,this.fire(new o.l("webglcontextlost",{originalEvent:k}))},this._contextRestored=k=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._lostContextStyle={style:null,images:null},this._setupPainter(),this.resize(),this._update(),this._resizeInternal(),this.fire(new o.l("webglcontextrestored",{originalEvent:k}))},this._onMapScroll=k=>{if(k.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=m.interactive,this._maxTileCacheSize=m.maxTileCacheSize,this._maxTileCacheZoomLevels=m.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},m.canvasContextAttributes),this._trackResize=m.trackResize===!0,this._bearingSnap=m.bearingSnap,this._centerClampedToGround=m.centerClampedToGround,this._refreshExpiredTiles=m.refreshExpiredTiles===!0,this._fadeDuration=m.fadeDuration,this._crossSourceCollisions=m.crossSourceCollisions===!0,this._collectResourceTiming=m.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Fl),m.locale),this._clickTolerance=m.clickTolerance,this._overridePixelRatio=m.pixelRatio,this._maxCanvasSize=m.maxCanvasSize,this._zoomLevelsToOverscale=m.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=m.transformCameraUpdate,this.transformConstrain=m.transformConstrain,this.cancelPendingTileRequestsWhileZooming=m.cancelPendingTileRequestsWhileZooming===!0,m.reduceMotion!==void 0&&(F.prefersReducedMotion=m.reduceMotion),this._imageQueueHandle=xe.addThrottleControl(()=>this.isMoving()),this._requestManager=new Me(m.transformRequest),typeof m.container=="string"){if(this._container=document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(m.maxBounds&&this.setMaxBounds(m.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let k=!1;const O=Fd(B=>{this._trackResize&&!this._removed&&(this.resize(B),this.redraw())},50);this._resizeObserver=new ResizeObserver(B=>{k?O(B):k=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ss(this,m),this._hash=m.hash&&new Bd(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,elevation:m.elevation,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch,roll:m.roll}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,o.e({},m.fitBoundsOptions,{duration:0}))));const M=typeof m.style=="string"||((u=(n=m.style)===null||n===void 0?void 0:n.projection)===null||u===void 0?void 0:u.type)!=="globe";this.resize(null,M),this._localIdeographFontFamily=m.localIdeographFontFamily,this._validateStyle=m.validateStyle,m.style&&this.setStyle(m.style,{localIdeographFontFamily:m.localIdeographFontFamily}),m.attributionControl&&this.addControl(new qd(typeof m.attributionControl=="boolean"?void 0:m.attributionControl)),m.maplibreLogo&&this.addControl(new aa,m.logoPosition),this.on("style.load",()=>{if(M||this._resizeTransform(),this.transform.unmodified){const k=o.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(k)}}),this.on("data",k=>{this._update(k.dataType==="style"),this.fire(new o.l(`${k.dataType}data`,k))}),this.on("dataloading",k=>{this.fire(new o.l(`${k.dataType}dataloading`,k))}),this.on("dataabort",k=>{this.fire(new o.l("sourcedataabort",k))})}_getMapId(){return this._mapId}setGlobalStateProperty(w,n){return this.style.setGlobalStateProperty(w,n),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(w,n){if(n===void 0&&(n=w.getDefaultPosition?w.getDefaultPosition():"top-right"),!w||!w.onAdd)return this.fire(new o.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=w.onAdd(this);this._controls.push(w);const m=this._controlPositions[n];return n.indexOf("bottom")!==-1?m.insertBefore(u,m.firstChild):m.appendChild(u),this}removeControl(w){if(!w||!w.onRemove)return this.fire(new o.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(w);return n>-1&&this._controls.splice(n,1),w.onRemove(this),this}hasControl(w){return this._controls.indexOf(w)>-1}coveringTiles(w){return zr(this.transform,w)}calculateCameraOptionsFromTo(w,n,u,m){return m==null&&this.terrain&&(m=this.terrain.getElevationForLngLat(u,this.transform)),super.calculateCameraOptionsFromTo(w,n,u,m)}resize(w,n=!0){if(this._lostContextStyle.style!==null)return this;this._resizeInternal(n);const u=!this._moving;return u&&(this.stop(),this.fire(new o.l("movestart",w)).fire(new o.l("move",w))),this.fire(new o.l("resize",w)),u&&this.fire(new o.l("moveend",w)),this}_resizeInternal(w=!0){const[n,u]=this._containerDimensions(),m=this._getClampedPixelRatio(n,u);if(this._resizeCanvas(n,u,m),this.painter.resize(n,u,m),this.painter.overLimit()){const v=this.painter.context.gl;this._maxCanvasSize=[v.drawingBufferWidth,v.drawingBufferHeight];const S=this._getClampedPixelRatio(n,u);this._resizeCanvas(n,u,S),this.painter.resize(n,u,S)}this._resizeTransform(w)}_resizeTransform(w=!0){var n;const[u,m]=this._containerDimensions();this.transform.resize(u,m,w),(n=this._requestedCameraState)===null||n===void 0||n.resize(u,m,w)}_getClampedPixelRatio(w,n){const{0:u,1:m}=this._maxCanvasSize,v=this.getPixelRatio(),S=w*v,M=n*v;return Math.min(S>u?u/S:1,M>m?m/M:1)*v}getPixelRatio(){var w;return(w=this._overridePixelRatio)!==null&&w!==void 0?w:devicePixelRatio}setPixelRatio(w){this._overridePixelRatio=w,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(w){return this.transform.setMaxBounds(yr.convert(w)),this._update()}setMinZoom(w){if((w=w??-2)>=-2&&w<=this.transform.maxZoom){const n=this._getTransformForUpdate();return n.setMinZoom(w),this._applyUpdatedTransform(n),this._update(),this}throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(w){if((w=w??22)>=this.transform.minZoom){const n=this._getTransformForUpdate();return n.setMaxZoom(w),this._applyUpdatedTransform(n),this._update(),this}throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(w){if((w=w??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(w>=0&&w<=this.transform.maxPitch)return this.transform.setMinPitch(w),this._update(),this.getPitch()<w&&this.setPitch(w),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(w){if((w=w??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(w>=this.transform.minPitch)return this.transform.setMaxPitch(w),this._update(),this.getPitch()>w&&this.setPitch(w),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(w){return this.transform.setRenderWorldCopies(w),this._update()}setTransformConstrain(w){return this.transform.setConstrainOverride(w),this._update()}project(w){return this.transform.locationToScreenPoint(o.V.convert(w),this.style&&this.terrain)}unproject(w){return this.transform.screenPointToLocation(o.P.convert(w),this.terrain)}isMoving(){var w;return this._moving||((w=this.handlers)===null||w===void 0?void 0:w.isMoving())}isZooming(){var w;return this._zooming||((w=this.handlers)===null||w===void 0?void 0:w.isZooming())}isRotating(){var w;return this._rotating||((w=this.handlers)===null||w===void 0?void 0:w.isRotating())}_createDelegatedListener(w,n,u){if(w==="mouseenter"||w==="mouseover"){let m=!1;return{layers:n,listener:u,delegates:{mousemove:S=>{const M=n.filter(O=>this.getLayer(O)),k=M.length!==0?this.queryRenderedFeatures(S.point,{layers:M}):[];k.length?m||(m=!0,u.call(this,new mi(w,this,S.originalEvent,{features:k}))):m=!1},mouseout:()=>{m=!1}}}}if(w==="mouseleave"||w==="mouseout"){let m=!1;return{layers:n,listener:u,delegates:{mousemove:M=>{const k=n.filter(O=>this.getLayer(O));(k.length!==0?this.queryRenderedFeatures(M.point,{layers:k}):[]).length?m=!0:m&&(m=!1,u.call(this,new mi(w,this,M.originalEvent)))},mouseout:M=>{m&&(m=!1,u.call(this,new mi(w,this,M.originalEvent)))}}}}{const m=v=>{const S=n.filter(k=>this.getLayer(k)),M=S.length!==0?this.queryRenderedFeatures(v.point,{layers:S}):[];M.length&&(v.features=M,u.call(this,v),delete v.features)};return{layers:n,listener:u,delegates:{[w]:m}}}}_saveDelegatedListener(w,n){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[w]=this._delegatedListeners[w]||[],this._delegatedListeners[w].push(n)}_removeDelegatedListener(w,n,u){if(!this._delegatedListeners||!this._delegatedListeners[w])return;const m=this._delegatedListeners[w];for(let v=0;v<m.length;v++){const S=m[v];if(S.listener===u&&S.layers.length===n.length&&S.layers.every(M=>n.includes(M))){for(const M in S.delegates)this.off(M,S.delegates[M]);return void m.splice(v,1)}}}on(w,n,u){if(u===void 0)return super.on(w,n);const m=typeof n=="string"?[n]:n,v=this._createDelegatedListener(w,m,u);this._saveDelegatedListener(w,v);for(const S in v.delegates)this.on(S,v.delegates[S]);return{unsubscribe:()=>{this._removeDelegatedListener(w,m,u)}}}once(w,n,u){if(u===void 0)return super.once(w,n);const m=typeof n=="string"?[n]:n,v=this._createDelegatedListener(w,m,u);for(const S in v.delegates){const M=v.delegates[S];v.delegates[S]=(...k)=>{this._removeDelegatedListener(w,m,u),M(...k)}}this._saveDelegatedListener(w,v);for(const S in v.delegates)this.once(S,v.delegates[S]);return this}off(w,n,u){return u===void 0?super.off(w,n):(this._removeDelegatedListener(w,typeof n=="string"?[n]:n,u),this)}queryRenderedFeatures(w,n){if(!this.style)return[];let u;const m=w instanceof o.P||Array.isArray(w),v=m?w:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(m?{}:w)||{},v instanceof o.P||typeof v[0]=="number")u=[o.P.convert(v)];else{const S=o.P.convert(v[0]),M=o.P.convert(v[1]);u=[S,new o.P(M.x,S.y),M,new o.P(S.x,M.y),S]}return this.style.queryRenderedFeatures(u,n,this.transform)}querySourceFeatures(w,n){return this.style.querySourceFeatures(w,n)}setStyle(w,n){return(n=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&w?(this._diffStyle(w,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(w,n))}setTransformRequest(w){return this._requestManager.setTransformRequest(w),this}_getUIString(w){const n=this._locale[w];if(n==null)throw new Error(`Missing UI string '${w}'`);return n}_updateStyle(w,n){var u,m;if(n.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(w,n));const v=this.style&&n.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!w)),w?(this.style=new dc(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof w=="string"?this.style.loadURL(w,n,v):this.style.loadJSON(w,n,v),this):((m=(u=this.style)===null||u===void 0?void 0:u.projection)===null||m===void 0||m.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new dc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(w,n){if(typeof w=="string"){const u=this._requestManager.transformRequest(w,"Style");o.j(u,new AbortController).then(m=>{this._updateDiff(m.data,n)}).catch(m=>{m&&this.fire(new o.k(m))})}else typeof w=="object"&&this._updateDiff(w,n)}_updateDiff(w,n){try{this.style.setState(w,n)&&this._update(!0)}catch(u){o.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(w,n)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(w,n){return this._lazyInitEmptyStyle(),this.style.addSource(w,n),this._update(!0)}isSourceLoaded(w){const n=this.style&&this.style.tileManagers[w];if(n!==void 0)return n.loaded();this.fire(new o.k(new Error(`There is no tile manager with ID '${w}'`)))}setTerrain(w){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),w){const n=this.style.tileManagers[w.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${w.source}`);this.terrain===null&&n.reload();for(const u in this.style._layers){const m=this.style._layers[u];m.type==="hillshade"&&m.source===w.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),m.type==="color-relief"&&m.source===w.source&&o.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ln(this.painter,n,w),this.painter.renderToTexture=new Xo(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=u=>{var m;u.dataType==="style"?this.terrain.tileManager.freeRtt():u.dataType==="source"&&u.tile&&(u.sourceId!==w.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((m=u.source)===null||m===void 0?void 0:m.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new o.l("terrain",{terrain:w})),this}getTerrain(){var w,n;return(n=(w=this.terrain)===null||w===void 0?void 0:w.options)!==null&&n!==void 0?n:null}areTilesLoaded(){const w=this.style&&this.style.tileManagers;for(const n of Object.values(w))if(!n.areTilesLoaded())return!1;return!0}removeSource(w){return this.style.removeSource(w),this._update(!0)}getSource(w){return this.style.getSource(w)}setSourceTileLodParams(w,n,u){if(u){const m=this.getSource(u);if(!m)throw new Error(`There is no source with ID "${u}", cannot set LOD parameters`);m.calculateTileZoom=Dr(Math.max(1,w),Math.max(1,n))}else for(const m in this.style.tileManagers)this.style.tileManagers[m].getSource().calculateTileZoom=Dr(Math.max(1,w),Math.max(1,n));return this._update(!0),this}refreshTiles(w,n){const u=this.style.tileManagers[w];if(!u)throw new Error(`There is no tile manager with ID "${w}", cannot refresh tile`);n===void 0?u.reload(!0):u.refreshTiles(n.map(m=>new o.ac(m.z,m.x,m.y)))}addImage(w,n,u={}){const{pixelRatio:m=1,sdf:v=!1,stretchX:S,stretchY:M,content:k,textFitWidth:O,textFitHeight:B}=u;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||o.b(n))){if(n.width===void 0||n.height===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:q,height:Y,data:X}=n,te=n;return this.style.addImage(w,{data:new o.R({width:q,height:Y},new Uint8Array(X)),pixelRatio:m,stretchX:S,stretchY:M,content:k,textFitWidth:O,textFitHeight:B,sdf:v,version:0,userImage:te}),te.onAdd&&te.onAdd(this,w),this}}{const{width:q,height:Y,data:X}=F.getImageData(n);this.style.addImage(w,{data:new o.R({width:q,height:Y},X),pixelRatio:m,stretchX:S,stretchY:M,content:k,textFitWidth:O,textFitHeight:B,sdf:v,version:0})}}updateImage(w,n){const u=this.style.getImage(w);if(!u)return this.fire(new o.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=n instanceof HTMLImageElement||o.b(n)?F.getImageData(n):n,{width:v,height:S,data:M}=m;if(v===void 0||S===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==u.data.width||S!==u.data.height)return this.fire(new o.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const k=!(n instanceof HTMLImageElement||o.b(n));return u.data.replace(M,k),this.style.updateImage(w,u),this}getImage(w){return this.style.getImage(w)}hasImage(w){return w?!!this.style.getImage(w):(this.fire(new o.k(new Error("Missing required image id"))),!1)}removeImage(w){this.style.removeImage(w)}loadImage(w){return xe.getImage(this._requestManager.transformRequest(w,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(w,n){return this._lazyInitEmptyStyle(),this.style.addLayer(w,n),this._update(!0)}moveLayer(w,n){return this.style.moveLayer(w,n),this._update(!0)}removeLayer(w){return this.style.removeLayer(w),this._update(!0)}getLayer(w){return this.style.getLayer(w)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(w,n,u){return this.style.setLayerZoomRange(w,n,u),this._update(!0)}setFilter(w,n,u={}){return this.style.setFilter(w,n,u),this._update(!0)}getFilter(w){return this.style.getFilter(w)}setPaintProperty(w,n,u,m={}){return this.style.setPaintProperty(w,n,u,m),this._update(!0)}getPaintProperty(w,n){return this.style.getPaintProperty(w,n)}setLayoutProperty(w,n,u,m={}){return this.style.setLayoutProperty(w,n,u,m),this._update(!0)}getLayoutProperty(w,n){return this.style.getLayoutProperty(w,n)}setGlyphs(w,n={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(w,n),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(w,n,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(w,n,u,m=>{m||this._update(!0)}),this}removeSprite(w){return this._lazyInitEmptyStyle(),this.style.removeSprite(w),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(w,n={}){return this._lazyInitEmptyStyle(),this.style.setSprite(w,n,u=>{u||this._update(!0)}),this}setLight(w,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(w,n),this._update(!0)}getLight(){return this.style.getLight()}setSky(w,n={}){return this._lazyInitEmptyStyle(),this.style.setSky(w,n),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(w,n){return this.style.setFeatureState(w,n),this._update()}removeFeatureState(w,n){return this.style.removeFeatureState(w,n),this._update()}getFeatureState(w){return this.style.getFeatureState(w)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let w=0,n=0;return this._container&&(w=this._container.clientWidth||400,n=this._container.clientHeight||300),[w,n]}_setupContainer(){const w=this._container;w.classList.add("maplibregl-map");const n=this._canvasContainer=j.create("div","maplibregl-canvas-container",w);this._interactive&&n.classList.add("maplibregl-interactive"),this._canvas=j.create("canvas","maplibregl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),m=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],m);const v=this._controlContainer=j.create("div","maplibregl-control-container",w),S=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(M=>{S[M]=j.create("div",`maplibregl-ctrl-${M} `,v)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(w,n,u){this._canvas.width=Math.floor(u*w),this._canvas.height=Math.floor(u*n),this._canvas.style.width=`${w}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const w=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let n=null;this._canvas.addEventListener("webglcontextcreationerror",m=>{n={requestedAttributes:w},m&&(n.statusMessage=m.statusMessage,n.type=m.type)},{once:!0});let u=null;if(u=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,w):this._canvas.getContext("webgl2",w)||this._canvas.getContext("webgl",w),!u){const m="Failed to initialize WebGL";throw n?(n.message=m,new Error(JSON.stringify(n))):new Error(m)}this.painter=new Rh(u,this.transform),ie.testSupport(u)}migrateProjection(w,n){super.migrateProjection(w,n),this.painter.transform=w,this.fire(new o.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(w){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||w,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(w){return this._update(),this._renderTaskQueue.add(w)}_cancelRenderFrame(w){this._renderTaskQueue.remove(w)}_render(w){var n,u,m,v,S;const M=this._idleTriggered?this._fadeDuration:0,k=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(w),this._removed)return;let O=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const Y=this.transform.zoom,X=$();this.style.zoomHistory.update(Y,X);const te=new o.H(Y,{now:X,fadeDuration:M,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ce=te.crossFadingFactor();ce===1&&ce===this._crossFadingFactor||(O=!0,this._crossFadingFactor=ce),this.style.update(te)}const B=((u=this.style.projection)===null||u===void 0?void 0:u.transitionState)>0!==k;(m=this.style.projection)===null||m===void 0||m.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((v=this.style.projection)===null||v===void 0?void 0:v.transitionState,(S=this.style.projection)===null||S===void 0?void 0:S.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||B)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,M,this._crossSourceCollisions,B),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:M,showPadding:this.showPadding}),this.fire(new o.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.cG.mark(o.cH.load),this.fire(new o.l("load"))),this.style&&(this.style.hasTransitions()||O)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const q=this._sourcesDirty||this._styleDirty||this._placementDirty;return q||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.l("idle")),!this._loaded||this._fullyLoaded||q||(this._fullyLoaded=!0,o.cG.mark(o.cH.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var w;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),xe.removeThrottleControl(this._imageQueueHandle),(w=this._resizeObserver)===null||w===void 0||w.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n?.loseContext&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),j.remove(this._canvasContainer),j.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),o.cG.clearMetrics(),this._removed=!0,this.fire(new o.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,F.frame(this._frameRequest,w=>{o.cG.frame(w),this._frameRequest=null;try{this._render(w)}catch(n){if(!o.Z(n)&&!function(u){return u.message===Tl}(n))throw n}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(w){this._showTileBoundaries!==w&&(this._showTileBoundaries=w,this._update())}get showPadding(){return!!this._showPadding}set showPadding(w){this._showPadding!==w&&(this._showPadding=w,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(w){this._showCollisionBoxes!==w&&(this._showCollisionBoxes=w,w?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(w){this._showOverdrawInspector!==w&&(this._showOverdrawInspector=w,this._update())}get repaint(){return!!this._repaint}set repaint(w){this._repaint!==w&&(this._repaint=w,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(w){this._vertices=w,this._update()}get version(){return kc}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(w){return this._lazyInitEmptyStyle(),this.style.setProjection(w),this._update(!0)}},f.MapMouseEvent=mi,f.MapTouchEvent=Al,f.MapWheelEvent=Dh,f.Marker=Rc,f.NavigationControl=class{constructor(w){this._updateZoomButtons=()=>{const n=this._map.getZoom(),u=n===this._map.getMaxZoom(),m=n===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(n,u)=>{const m=this._map._getUIString(`NavigationControl.${u}`);n.title=m,n.setAttribute("aria-label",m)},this.options=o.e({},$h,w),this._container=j.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),j.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),j.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=j.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(w){return this._map=w,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ca(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){j.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(w,n){const u=j.create("button",w,this._container);return u.type="button",u.addEventListener("click",n),u}},f.Popup=class extends o.E{constructor(w){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&j.remove(this._content),this._container&&(j.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.l("close"))),this),this._onMouseUp=n=>{this._update(n.point)},this._onMouseMove=n=>{this._update(n.point)},this._onDrag=n=>{this._update(n.point)},this._update=n=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=j.create("div","maplibregl-popup",this._map.getContainer()),this._tip=j.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const M of this.options.className.split(" "))this._container.classList.add(M);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Eu(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!n)return;const u=this._flatPos=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&n?n:this._map.transform.locationToScreenPoint(this._lngLat));let m=this.options.anchor;const v=Bl(this.options.offset);if(!m){const M=this._container.offsetWidth,k=this._container.offsetHeight,O=function(q){var Y,X,te,ce;return q?{top:(Y=q.top)!==null&&Y!==void 0?Y:0,right:(X=q.right)!==null&&X!==void 0?X:0,bottom:(te=q.bottom)!==null&&te!==void 0?te:0,left:(ce=q.left)!==null&&ce!==void 0?ce:0}:{top:0,right:0,bottom:0,left:0}}(this.options.padding);let B;B=u.y+v.bottom.y<k+O.top?["top"]:u.y>this._map.transform.height-k-O.bottom?["bottom"]:[],u.x<M/2+O.left?B.push("left"):u.x>this._map.transform.width-M/2-O.right&&B.push("right"),m=B.length===0?"bottom":B.join("-")}let S=u.add(v[m]);this.options.subpixelPositioning||(S=S.round()),j.setTransform(this._container,`${Fn[m]} translate(${S.x}px,${S.y}px)`),Ac(this._container,m,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(Bi),w)}addTo(w){return this._map&&this.remove(),this._map=w,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(w){return this._lngLat=o.V.convert(w),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(w){return this.setDOMContent(document.createTextNode(w))}setHTML(w){const n=document.createDocumentFragment(),u=document.createElement("body");let m;for(u.innerHTML=w;m=u.firstChild,m;)n.appendChild(m);return this.setDOMContent(n)}getMaxWidth(){var w;return(w=this._container)===null||w===void 0?void 0:w.style.maxWidth}setMaxWidth(w){return this.options.maxWidth=w,this._update(),this}setDOMContent(w){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=j.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(w),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(w){return this._container&&this._container.classList.add(w),this}removeClassName(w){return this._container&&this._container.classList.remove(w),this}setOffset(w){return this.options.offset=w,this._update(),this}toggleClassName(w){if(this._container)return this._container.classList.toggle(w)}setSubpixelPositioning(w){this.options.subpixelPositioning=w}setPadding(w){this.options.padding=w,this._update()}_createCloseButton(){this.options.closeButton&&(this._closeButton=j.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const w=this._container.querySelector(Dc);w&&w.focus()}},f.RasterDEMTileSource=Or,f.RasterTileSource=Rr,f.ScaleControl=class{constructor(w){this._onMove=()=>{Bn(this._map,this._container,this.options)},this.setUnit=n=>{this.options.unit=n,Bn(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Va),w)}getDefaultPosition(){return"bottom-left"}onAdd(w){return this._map=w,this._container=j.create("div","maplibregl-ctrl maplibregl-ctrl-scale",w.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){j.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},f.ScrollZoomHandler=Ec,f.Style=dc,f.TerrainControl=class{constructor(w){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=w}onAdd(w){return this._map=w,this._container=j.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=j.create("button","maplibregl-ctrl-terrain",this._container),j.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){j.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},f.TwoFingersTouchPitchHandler=Fh,f.TwoFingersTouchRotateHandler=ap,f.TwoFingersTouchZoomHandler=zl,f.TwoFingersTouchZoomRotateHandler=sa,f.VectorTileSource=Cr,f.VideoSource=He,f.addSourceType=(w,n)=>o._(void 0,void 0,void 0,function*(){if(ue(w))throw new Error(`A source type called "${w}" already exists.`);((u,m)=>{le[u]=m})(w,n)}),f.clearPrewarmedResources=function(){const w=St;w&&(w.isPreloaded()&&w.numActive()===1?(w.release(wt),St=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},f.createTileMesh=hu,f.getMaxParallelImageRequests=function(){return o.c.MAX_PARALLEL_IMAGE_REQUESTS},f.getRTLTextPluginStatus=function(){return Xe().getRTLTextPluginStatus()},f.getVersion=function(){return zc},f.getWorkerCount=function(){return xt.workerCount},f.getWorkerUrl=function(){return o.c.WORKER_URL},f.importScriptInWorkers=function(w){return mr().broadcast("IS",w)},f.isTimeFrozen=function(){return U.isFrozen()},f.now=$,f.prewarm=function(){At().acquire(wt)},f.restoreNow=function(){U.restoreNow()},f.setMaxParallelImageRequests=function(w){o.c.MAX_PARALLEL_IMAGE_REQUESTS=w},f.setNow=function(w){U.setNow(w)},f.setRTLTextPlugin=function(w,n){return Xe().setRTLTextPlugin(w,n)},f.setWorkerCount=function(w){xt.workerCount=w},f.setWorkerUrl=function(w){o.c.WORKER_URL=w}});var h=i;return h})}(F_)),F_.exports}var sS=T9();const FA=Lv(sS),M9=wE({__proto__:null,default:FA},[sS]);var Tg=Math.pow,ds=(e,t,i)=>new Promise((a,c)=>{var h=b=>{try{o(i.next(b))}catch(P){c(P)}},f=b=>{try{o(i.throw(b))}catch(P){c(P)}},o=b=>b.done?a(b.value):Promise.resolve(b.value).then(h,f);o((i=i.apply(e,t)).next())}),al=Uint8Array,ov=Uint16Array,P9=Int32Array,BA=new al([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),$A=new al([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),E9=new al([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),jA=function(e,t){for(var i=new ov(31),a=0;a<31;++a)i[a]=t+=1<<e[a-1];for(var c=new P9(i[30]),a=1;a<30;++a)for(var h=i[a];h<i[a+1];++h)c[h]=h-i[a]<<5|a;return{b:i,r:c}},NA=jA(BA,2),VA=NA.b,I9=NA.r;VA[28]=258,I9[258]=28;var k9=jA($A,0),A9=k9.b,UA=new ov(32768);for(Vn=0;Vn<32768;++Vn)Qh=(Vn&43690)>>1|(Vn&21845)<<1,Qh=(Qh&52428)>>2|(Qh&13107)<<2,Qh=(Qh&61680)>>4|(Qh&3855)<<4,UA[Vn]=((Qh&65280)>>8|(Qh&255)<<8)>>1;var Qh,Vn,sv=function(e,t,i){for(var a=e.length,c=0,h=new ov(t);c<a;++c)e[c]&&++h[e[c]-1];var f=new ov(t);for(c=1;c<t;++c)f[c]=f[c-1]+h[c-1]<<1;var o;{o=new ov(1<<t);var b=15-t;for(c=0;c<a;++c)if(e[c])for(var P=c<<4|e[c],I=t-e[c],D=f[e[c]-1]++<<I,z=D|(1<<I)-1;D<=z;++D)o[UA[D]>>b]=P}return o},a0=new al(288);for(Vn=0;Vn<144;++Vn)a0[Vn]=8;var Vn;for(Vn=144;Vn<256;++Vn)a0[Vn]=9;var Vn;for(Vn=256;Vn<280;++Vn)a0[Vn]=7;var Vn;for(Vn=280;Vn<288;++Vn)a0[Vn]=8;var Vn,GA=new al(32);for(Vn=0;Vn<32;++Vn)GA[Vn]=5;var Vn,R9=sv(a0,9),D9=sv(GA,5),Fb=function(e){for(var t=e[0],i=1;i<e.length;++i)e[i]>t&&(t=e[i]);return t},Hc=function(e,t,i){var a=t/8|0;return(e[a]|e[a+1]<<8)>>(t&7)&i},Bb=function(e,t){var i=t/8|0;return(e[i]|e[i+1]<<8|e[i+2]<<16)>>(t&7)},z9=function(e){return(e+7)/8|0},O9=function(e,t,i){(i==null||i>e.length)&&(i=e.length);var a=new al(i-t);return a.set(e.subarray(t,i)),a},L9=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],rl=function(e,t,i){var a=new Error(t||L9[e]);if(a.code=e,Error.captureStackTrace&&Error.captureStackTrace(a,rl),!i)throw a;return a},aS=function(e,t,i,a){var c=e.length,h=0;if(!c||t.f&&!t.l)return i||new al(0);var f=!i||t.i!=2,o=t.i;i||(i=new al(c*3));var b=function(It){var mr=i.length;if(It>mr){var ur=new al(Math.max(mr*2,It));ur.set(i),i=ur}},P=t.f||0,I=t.p||0,D=t.b||0,z=t.l,F=t.d,U=t.m,$=t.n,j=c*8;do{if(!z){P=Hc(e,I,1);var ie=Hc(e,I+1,3);if(I+=3,ie)if(ie==1)z=R9,F=D9,U=9,$=5;else if(ie==2){var oe=Hc(e,I,31)+257,be=Hc(e,I+10,15)+4,xe=oe+Hc(e,I+5,31)+1;I+=14;for(var Me=new al(xe),Ee=new al(19),re=0;re<be;++re)Ee[E9[re]]=Hc(e,I+re*3,7);I+=be*3;for(var ke=Fb(Ee),Ge=(1<<ke)-1,Ke=sv(Ee,ke),re=0;re<xe;){var gt=Ke[Hc(e,I,Ge)];I+=gt&15;var se=gt>>4;if(se<16)Me[re++]=se;else{var et=0,qe=0;for(se==16?(qe=3+Hc(e,I,3),I+=2,et=Me[re-1]):se==17?(qe=3+Hc(e,I,7),I+=3):se==18&&(qe=11+Hc(e,I,127),I+=7);qe--;)Me[re++]=et}}var Qe=Me.subarray(0,oe),Ve=Me.subarray(oe);U=Fb(Qe),$=Fb(Ve),z=sv(Qe,U),F=sv(Ve,$)}else rl(1);else{var se=z9(I)+4,Q=e[se-4]|e[se-3]<<8,de=se+Q;if(de>c){o&&rl(0);break}f&&b(D+Q),i.set(e.subarray(se,de),D),t.b=D+=Q,t.p=I=de*8,t.f=P;continue}if(I>j){o&&rl(0);break}}f&&b(D+131072);for(var je=(1<<U)-1,ct=(1<<$)-1,ye=I;;ye=I){var et=z[Bb(e,I)&je],ze=et>>4;if(I+=et&15,I>j){o&&rl(0);break}if(et||rl(2),ze<256)i[D++]=ze;else if(ze==256){ye=I,z=null;break}else{var ft=ze-254;if(ze>264){var re=ze-257,wt=BA[re];ft=Hc(e,I,(1<<wt)-1)+VA[re],I+=wt}var xt=F[Bb(e,I)&ct],_t=xt>>4;xt||rl(3),I+=xt&15;var Ve=A9[_t];if(_t>3){var wt=$A[_t];Ve+=Bb(e,I)&(1<<wt)-1,I+=wt}if(I>j){o&&rl(0);break}f&&b(D+131072);var St=D+ft;if(D<Ve){var tt=h-Ve,At=Math.min(Ve,St);for(tt+D<0&&rl(3);D<At;++D)i[D]=a[tt+D]}for(;D<St;D+=4)i[D]=i[D-Ve],i[D+1]=i[D+1-Ve],i[D+2]=i[D+2-Ve],i[D+3]=i[D+3-Ve];D=St}}t.l=z,t.p=ye,t.b=D,t.f=P,z&&(P=1,t.m=U,t.d=F,t.n=$)}while(!P);return D==i.length?i:O9(i,0,D)},F9=new al(0),B9=function(e){(e[0]!=31||e[1]!=139||e[2]!=8)&&rl(6,"invalid gzip data");var t=e[3],i=10;t&4&&(i+=(e[10]|e[11]<<8)+2);for(var a=(t>>3&1)+(t>>4&1);a>0;a-=!e[i++]);return i+(t&2)},$9=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},j9=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&rl(6,"invalid zlib data"),(e[1]>>5&1)==1&&rl(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function N9(e,t){return aS(e,{i:2},t,t)}function V9(e,t){var i=B9(e);return i+8>e.length&&rl(6,"invalid gzip data"),aS(e.subarray(i,-8),{i:2},new al($9(e)),t)}function U9(e,t){return aS(e.subarray(j9(e),-4),{i:2},t,t)}function Vw(e,t){return e[0]==31&&e[1]==139&&e[2]==8?V9(e,t):(e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31?N9(e,t):U9(e,t)}var G9=typeof TextDecoder<"u"&&new TextDecoder,q9=0;try{G9.decode(F9,{stream:!0}),q9=1}catch{}var qA=(e,t)=>e*Tg(2,t),Ny=(e,t)=>Math.floor(e/Tg(2,t)),dx=(e,t)=>qA(e.getUint16(t+1,!0),8)+e.getUint8(t),HA=(e,t)=>qA(e.getUint32(t+2,!0),16)+e.getUint16(t,!0),H9=(e,t,i,a,c)=>{if(e!==a.getUint8(c))return e-a.getUint8(c);const h=dx(a,c+1);if(t!==h)return t-h;const f=dx(a,c+4);return i!==f?i-f:0},W9=(e,t,i,a)=>{const c=WA(e,t|128,i,a);return c?{z:t,x:i,y:a,offset:c[0],length:c[1],isDir:!0}:null},rP=(e,t,i,a)=>{const c=WA(e,t,i,a);return c?{z:t,x:i,y:a,offset:c[0],length:c[1],isDir:!1}:null},WA=(e,t,i,a)=>{let c=0,h=e.byteLength/17-1;for(;c<=h;){const f=h+c>>1,o=H9(t,i,a,e,f*17);if(o>0)c=f+1;else if(o<0)h=f-1;else return[HA(e,f*17+7),e.getUint32(f*17+13,!0)]}return null},Z9=(e,t)=>e.isDir&&!t.isDir?1:!e.isDir&&t.isDir?-1:e.z!==t.z?e.z-t.z:e.x!==t.x?e.x-t.x:e.y-t.y,ZA=(e,t)=>{const i=e.getUint8(t*17);return{z:i&127,x:dx(e,t*17+1),y:dx(e,t*17+4),offset:HA(e,t*17+7),length:e.getUint32(t*17+13,!0),isDir:i>>7===1}},nP=e=>{const t=[],i=new DataView(e);for(let a=0;a<i.byteLength/17;a++)t.push(ZA(i,a));return X9(t)},X9=e=>{e.sort(Z9);const t=new ArrayBuffer(17*e.length),i=new Uint8Array(t);for(let a=0;a<e.length;a++){const c=e[a];let h=c.z;c.isDir&&(h=h|128),i[a*17]=h,i[a*17+1]=c.x&255,i[a*17+2]=c.x>>8&255,i[a*17+3]=c.x>>16&255,i[a*17+4]=c.y&255,i[a*17+5]=c.y>>8&255,i[a*17+6]=c.y>>16&255,i[a*17+7]=c.offset&255,i[a*17+8]=Ny(c.offset,8)&255,i[a*17+9]=Ny(c.offset,16)&255,i[a*17+10]=Ny(c.offset,24)&255,i[a*17+11]=Ny(c.offset,32)&255,i[a*17+12]=Ny(c.offset,48)&255,i[a*17+13]=c.length&255,i[a*17+14]=c.length>>8&255,i[a*17+15]=c.length>>16&255,i[a*17+16]=c.length>>24&255}return t},K9=(e,t)=>{if(e.byteLength<17)return null;const i=e.byteLength/17,a=ZA(e,i-1);if(a.isDir){const c=a.z,h=t.z-c,f=Math.trunc(t.x/(1<<h)),o=Math.trunc(t.y/(1<<h));return{z:c,x:f,y:o}}return null};function Y9(e){return ds(this,null,function*(){const t=yield e.getBytes(0,512e3),i=new DataView(t.data),a=i.getUint32(4,!0),c=i.getUint16(8,!0),h=new TextDecoder("utf-8"),f=JSON.parse(h.decode(new DataView(t.data,10,a)));let o=0;f.compression==="gzip"&&(o=2);let b=0;"minzoom"in f&&(b=+f.minzoom);let P=0;"maxzoom"in f&&(P=+f.maxzoom);let I=0,D=0,z=0,F=-180,U=-85,$=180,j=85;if(f.bounds){const se=f.bounds.split(",");F=+se[0],U=+se[1],$=+se[2],j=+se[3]}if(f.center){const se=f.center.split(",");I=+se[0],D=+se[1],z=+se[2]}return{specVersion:i.getUint16(2,!0),rootDirectoryOffset:10+a,rootDirectoryLength:c*17,jsonMetadataOffset:10,jsonMetadataLength:a,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:o,tileType:1,minZoom:b,maxZoom:P,minLon:F,minLat:U,maxLon:$,maxLat:j,centerZoom:z,centerLon:I,centerLat:D,etag:t.etag}})}function J9(e,t,i,a,c,h,f){return ds(this,null,function*(){let o=yield i.getArrayBuffer(t,e.rootDirectoryOffset,e.rootDirectoryLength,e);e.specVersion===1&&(o=nP(o));const b=rP(new DataView(o),a,c,h);if(b){let D=(yield t.getBytes(b.offset,b.length,f)).data;const z=new DataView(D);return z.getUint8(0)===31&&z.getUint8(1)===139&&(D=Vw(new Uint8Array(D))),{data:D}}const P=K9(new DataView(o),{z:a,x:c,y:h});if(P){const I=W9(new DataView(o),P.z,P.x,P.y);if(I){let D=yield i.getArrayBuffer(t,I.offset,I.length,e);e.specVersion===1&&(D=nP(D));const z=rP(new DataView(D),a,c,h);if(z){let U=(yield t.getBytes(z.offset,z.length,f)).data;const $=new DataView(U);return $.getUint8(0)===31&&$.getUint8(1)===139&&(U=Vw(new Uint8Array(U))),{data:U}}}}})}var XA={getHeader:Y9,getZxy:J9},Q9=e=>(t,i)=>{if(i instanceof AbortController)return e(t,i);const a=new AbortController;return e(t,a).then(c=>i(void 0,c.data,c.cacheControl||"",c.expires||""),c=>i(c)).catch(c=>i(c)),{cancel:()=>a.abort()}},eU=class{constructor(e){this.tilev4=(t,i)=>ds(this,null,function*(){if(t.type==="json"){const z=t.url.substr(10);let F=this.tiles.get(z);if(F||(F=new iP(z),this.tiles.set(z,F)),this.metadata)return{data:yield F.getTileJson(t.url)};const U=yield F.getHeader();return{data:{tiles:[`${t.url}/{z}/{x}/{y}`],minzoom:U.minZoom,maxzoom:U.maxZoom,bounds:[U.minLon,U.minLat,U.maxLon,U.maxLat]}}}const a=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),c=t.url.match(a);if(!c)throw new Error("Invalid PMTiles protocol URL");const h=c[1];let f=this.tiles.get(h);f||(f=new iP(h),this.tiles.set(h,f));const o=c[2],b=c[3],P=c[4],I=yield f.getHeader(),D=yield f?.getZxy(+o,+b,+P,i.signal);return D?{data:new Uint8Array(D.data),cacheControl:D.cacheControl,expires:D.expires}:I.tileType===1?{data:new Uint8Array}:{data:null}}),this.tile=Q9(this.tilev4),this.tiles=new Map,this.metadata=e?.metadata||!1}add(e){this.tiles.set(e.source.getKey(),e)}get(e){return this.tiles.get(e)}};function lg(e,t){return(t>>>0)*4294967296+(e>>>0)}function tU(e,t){const i=t.buf;let a=i[t.pos++],c=(a&112)>>4;if(a<128||(a=i[t.pos++],c|=(a&127)<<3,a<128)||(a=i[t.pos++],c|=(a&127)<<10,a<128)||(a=i[t.pos++],c|=(a&127)<<17,a<128)||(a=i[t.pos++],c|=(a&127)<<24,a<128)||(a=i[t.pos++],c|=(a&1)<<31,a<128))return lg(e,c);throw new Error("Expected varint not more than 10 bytes")}function Vy(e){const t=e.buf;let i=t[e.pos++],a=i&127;return i<128||(i=t[e.pos++],a|=(i&127)<<7,i<128)||(i=t[e.pos++],a|=(i&127)<<14,i<128)||(i=t[e.pos++],a|=(i&127)<<21,i<128)?a:(i=t[e.pos],a|=(i&15)<<28,tU(a,e))}function rU(e,t,i,a){if(a===0){i===1&&(t[0]=e-1-t[0],t[1]=e-1-t[1]);const c=t[0];t[0]=t[1],t[1]=c}}var nU=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function iU(e,t,i){if(e>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(t>Tg(2,e)-1||i>Tg(2,e)-1)throw Error("tile x/y outside zoom level bounds");const a=nU[e],c=Tg(2,e);let h=0,f=0,o=0;const b=[t,i];let P=c/2;for(;P>0;)h=(b[0]&P)>0?1:0,f=(b[1]&P)>0?1:0,o+=P*P*(3*h^f),rU(P,b,h,f),P=P/2;return a+o}function KA(e,t){return ds(this,null,function*(){if(t===1||t===0)return e;if(t===2){if(typeof globalThis.DecompressionStream>"u")return Vw(new Uint8Array(e));const i=new Response(e).body;if(!i)throw Error("Failed to read response stream");const a=i.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(a).arrayBuffer()}throw Error("Compression method not supported")})}function oU(e){return e===1?".mvt":e===2?".png":e===3?".jpg":e===4?".webp":e===5?".avif":""}var sU=127;function aU(e,t){let i=0,a=e.length-1;for(;i<=a;){const c=a+i>>1,h=t-e[c].tileId;if(h>0)i=c+1;else if(h<0)a=c-1;else return e[c]}return a>=0&&(e[a].runLength===0||t-e[a].tileId<e[a].runLength)?e[a]:null}var lU=class{constructor(e,t=new Headers){this.url=e,this.customHeaders=t,this.mustReload=!1;let i="";"navigator"in globalThis&&(i=globalThis.navigator.userAgent||"");const a=i.indexOf("Windows")>-1,c=/Chrome|Chromium|Edg|OPR|Brave/.test(i);this.chromeWindowsNoCache=!1,a&&c&&(this.chromeWindowsNoCache=!0)}getKey(){return this.url}setHeaders(e){this.customHeaders=e}getBytes(e,t,i,a){return ds(this,null,function*(){let c,h;i?h=i:(c=new AbortController,h=c.signal);const f=new Headers(this.customHeaders);f.set("range",`bytes=${e}-${e+t-1}`);let o;this.mustReload?o="reload":this.chromeWindowsNoCache&&(o="no-store");let b=yield fetch(this.url,{signal:h,cache:o,headers:f});if(e===0&&b.status===416){const z=b.headers.get("Content-Range");if(!z||!z.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const F=+z.substr(8);b=yield fetch(this.url,{signal:h,cache:"reload",headers:{range:`bytes=0-${F-1}`}})}let P=b.headers.get("Etag");if(P?.startsWith("W/")&&(P=null),b.status===416||a&&P&&P!==a)throw this.mustReload=!0,new Uw(`Server returned non-matching ETag ${a} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`);if(b.status>=300)throw Error(`Bad response code: ${b.status}`);const I=b.headers.get("Content-Length");if(b.status===200&&(!I||+I>t))throw c&&c.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield b.arrayBuffer(),etag:P||void 0,cacheControl:b.headers.get("Cache-Control")||void 0,expires:b.headers.get("Expires")||void 0}})}};function Wc(e,t){const i=e.getUint32(t+4,!0),a=e.getUint32(t+0,!0);return i*Tg(2,32)+a}function cU(e,t){const i=new DataView(e),a=i.getUint8(7);if(a>3)throw Error(`Archive is spec version ${a} but this library supports up to spec version 3`);return{specVersion:a,rootDirectoryOffset:Wc(i,8),rootDirectoryLength:Wc(i,16),jsonMetadataOffset:Wc(i,24),jsonMetadataLength:Wc(i,32),leafDirectoryOffset:Wc(i,40),leafDirectoryLength:Wc(i,48),tileDataOffset:Wc(i,56),tileDataLength:Wc(i,64),numAddressedTiles:Wc(i,72),numTileEntries:Wc(i,80),numTileContents:Wc(i,88),clustered:i.getUint8(96)===1,internalCompression:i.getUint8(97),tileCompression:i.getUint8(98),tileType:i.getUint8(99),minZoom:i.getUint8(100),maxZoom:i.getUint8(101),minLon:i.getInt32(102,!0)/1e7,minLat:i.getInt32(106,!0)/1e7,maxLon:i.getInt32(110,!0)/1e7,maxLat:i.getInt32(114,!0)/1e7,centerZoom:i.getUint8(118),centerLon:i.getInt32(119,!0)/1e7,centerLat:i.getInt32(123,!0)/1e7,etag:t}}function YA(e){const t={buf:new Uint8Array(e),pos:0},i=Vy(t),a=[];let c=0;for(let h=0;h<i;h++){const f=Vy(t);a.push({tileId:c+f,offset:0,length:0,runLength:1}),c+=f}for(let h=0;h<i;h++)a[h].runLength=Vy(t);for(let h=0;h<i;h++)a[h].length=Vy(t);for(let h=0;h<i;h++){const f=Vy(t);f===0&&h>0?a[h].offset=a[h-1].offset+a[h-1].length:a[h].offset=f-1}return a}function uU(e){const t=new DataView(e);return t.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):t.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var Uw=class extends Error{};function hU(e,t){return ds(this,null,function*(){const i=yield e.getBytes(0,16384);if(new DataView(i.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(uU(i.data)<3)return[yield XA.getHeader(e)];const c=i.data.slice(0,sU),h=cU(c,i.etag),f=i.data.slice(h.rootDirectoryOffset,h.rootDirectoryOffset+h.rootDirectoryLength),o=`${e.getKey()}|${h.etag||""}|${h.rootDirectoryOffset}|${h.rootDirectoryLength}`,b=YA(yield t(f,h.internalCompression));return[h,[o,b.length,b]]})}function dU(e,t,i,a,c){return ds(this,null,function*(){const h=yield e.getBytes(i,a,void 0,c.etag),f=yield t(h.data,c.internalCompression),o=YA(f);if(o.length===0)throw new Error("Empty directory is invalid");return o})}var fU=class{constructor(e=100,t=!0,i=KA){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=e,this.counter=1,this.decompress=i}getHeader(e){return ds(this,null,function*(){const t=e.getKey(),i=this.cache.get(t);if(i)return i.lastUsed=this.counter++,yield i.data;const a=new Promise((c,h)=>{hU(e,this.decompress).then(f=>{f[1]&&this.cache.set(f[1][0],{lastUsed:this.counter++,data:Promise.resolve(f[1][2])}),c(f[0]),this.prune()}).catch(f=>{h(f)})});return this.cache.set(t,{lastUsed:this.counter++,data:a}),a})}getDirectory(e,t,i,a){return ds(this,null,function*(){const c=`${e.getKey()}|${a.etag||""}|${t}|${i}`,h=this.cache.get(c);if(h)return h.lastUsed=this.counter++,yield h.data;const f=new Promise((o,b)=>{dU(e,this.decompress,t,i,a).then(P=>{o(P),this.prune()}).catch(P=>{b(P)})});return this.cache.set(c,{lastUsed:this.counter++,data:f}),f})}getArrayBuffer(e,t,i,a){return ds(this,null,function*(){const c=`${e.getKey()}|${a.etag||""}|${t}|${i}`,h=this.cache.get(c);if(h)return h.lastUsed=this.counter++,yield h.data;const f=new Promise((o,b)=>{e.getBytes(t,i,void 0,a.etag).then(P=>{o(P.data),this.cache.has(c),this.prune()}).catch(P=>{b(P)})});return this.cache.set(c,{lastUsed:this.counter++,data:f}),f})}prune(){if(this.cache.size>=this.maxCacheEntries){let e=1/0,t;this.cache.forEach((i,a)=>{i.lastUsed<e&&(e=i.lastUsed,t=a)}),t&&this.cache.delete(t)}}invalidate(e){return ds(this,null,function*(){const t=e.getKey();if(this.invalidations.get(t))return yield this.invalidations.get(t);this.cache.delete(e.getKey());const i=new Promise((a,c)=>{this.getHeader(e).then(h=>{a(),this.invalidations.delete(t)}).catch(h=>{c(h)})});this.invalidations.set(t,i)})}},iP=class{constructor(e,t,i){typeof e=="string"?this.source=new lU(e):this.source=e,i?this.decompress=i:this.decompress=KA,t?this.cache=t:this.cache=new fU}getHeader(){return ds(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(e,t,i,a){return ds(this,null,function*(){const c=iU(e,t,i),h=yield this.cache.getHeader(this.source);if(h.specVersion<3)return XA.getZxy(h,this.source,this.cache,e,t,i,a);if(e<h.minZoom||e>h.maxZoom)return;let f=h.rootDirectoryOffset,o=h.rootDirectoryLength;for(let b=0;b<=3;b++){const P=yield this.cache.getDirectory(this.source,f,o,h),I=aU(P,c);if(I){if(I.runLength>0){const D=yield this.source.getBytes(h.tileDataOffset+I.offset,I.length,a,h.etag);return{data:yield this.decompress(D.data,h.tileCompression),cacheControl:D.cacheControl,expires:D.expires}}f=h.leafDirectoryOffset+I.offset,o=I.length}else return}throw Error("Maximum directory depth exceeded")})}getZxy(e,t,i,a){return ds(this,null,function*(){try{return yield this.getZxyAttempt(e,t,i,a)}catch(c){if(c instanceof Uw)return this.cache.invalidate(this.source),yield this.getZxyAttempt(e,t,i,a);throw c}})}getMetadataAttempt(){return ds(this,null,function*(){const e=yield this.cache.getHeader(this.source),t=yield this.source.getBytes(e.jsonMetadataOffset,e.jsonMetadataLength,void 0,e.etag),i=yield this.decompress(t.data,e.internalCompression),a=new TextDecoder("utf-8");return JSON.parse(a.decode(i))})}getMetadata(){return ds(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(e){if(e instanceof Uw)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw e}})}getTileJson(e){return ds(this,null,function*(){const t=yield this.getHeader(),i=yield this.getMetadata(),a=oU(t.tileType);return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${e}/{z}/{x}/{y}${a}`],vector_layers:i.vector_layers,attribution:i.attribution,description:i.description,name:i.name,version:i.version,bounds:[t.minLon,t.minLat,t.maxLon,t.maxLat],center:[t.centerLon,t.centerLat,t.centerZoom],minzoom:t.minZoom,maxzoom:t.maxZoom}})}};let oP=!1;function lS(){if(oP)return;const e=new eU;FA.addProtocol("pmtiles",e.tile),oP=!0}const pU=e=>{lS();const{mode:t="light",children:i,tileRootUrl:a}=e,c=m1[t];return G.jsxs(G.Fragment,{children:[G.jsx(Qr,{id:"background",type:"background",paint:{"background-color":c.land}}),G.jsxs(Xc,{id:"world",type:"vector",url:`pmtiles://${a}/world.pmtiles`,children:[G.jsx(Qr,{"source-layer":"water",type:"fill",paint:{"fill-color":c.water}}),i,G.jsx(Qr,{"source-layer":"states",type:"line",paint:{"line-color":c.stateBorder,"line-width":1,"line-opacity":1,"line-dasharray":[2,2]}}),G.jsx(Qr,{"source-layer":"countries",type:"line",filter:["!=",["get","name"],"Serbia-Kosovo"],paint:{"line-color":c.countryBorder,"line-width":2,"line-opacity":1}}),G.jsx(Qr,{"source-layer":"countries",type:"line",filter:["==",["get","name"],"Serbia-Kosovo"],paint:{"line-color":c.countryBorder,"line-width":2,"line-opacity":1,"line-dasharray":[3,2]}})]})]})},JA=new Set([10,0,11,13,16,15,3,2,17,8,14,12,5,9,1,7,4,6]),QA={0:new Set,1:new Set([10]),2:new Set([0]),3:new Set([11]),4:new Set([13]),5:new Set([16]),6:new Set([16,13]),7:new Set([15]),8:new Set([15,11]),9:new Set([3]),10:new Set([3,13]),11:new Set([3,15]),12:new Set([3,16]),13:new Set([2]),14:new Set([2,11]),15:new Set([2,15]),16:new Set([17]),17:new Set([17,2]),18:new Set([17,3]),19:new Set([17,15]),20:new Set([14]),21:new Set([14,11]),22:new Set([8]),23:new Set([8,3]),24:new Set([8,17]),25:new Set([12]),26:new Set([12,2]),27:new Set([12,11]),28:new Set([12,14]),29:new Set([5]),30:new Set([5,2]),31:new Set([5,12]),32:new Set([9]),33:new Set([9,2]),34:new Set([9,5]),35:new Set([9,17]),36:new Set([1]),37:new Set([1,12]),38:new Set([1,14]),39:new Set([7]),40:new Set([7,1]),41:new Set([7,5]),42:new Set([7,9]),43:new Set([7,12]),44:new Set([4]),45:new Set([4,7]),46:new Set([4,9]),47:new Set([6]),48:new Set([6,1]),49:new Set([6,14])},mU={1:0,2:1,3:2,7:13,13:9,31:3,37:4,43:20,44:7,47:5,17:29,27:22,36:25,50:16,18:32,19:36,26:39,21:44,22:47};for(const e of Object.values(mU))e!==0&&Np(QA[e].size===1);function gU(e){const t=new Set;for(const[i,a]of Object.entries(QA))[...a].every(c=>e.has(c))&&t.add(Number(i));return t}const eR=new Set([0,1,2,3,4,5,6,7,11,12,9,10]),yU={0:new Set,1:new Set([0]),2:new Set([1]),3:new Set([2]),4:new Set([3]),5:new Set([3,2]),6:new Set([4]),7:new Set([4,0]),8:new Set([4,1]),9:new Set([5]),10:new Set([5,0]),11:new Set([6]),12:new Set([6,2]),15:new Set([9]),16:new Set([7]),17:new Set([7,0]),18:new Set([7,4]),19:new Set([10]),20:new Set([11]),21:new Set([11,0]),22:new Set([11,7]),23:new Set([12]),24:new Set([12,4]),25:new Set([12,1])};function vU(e){const t=new Set;for(const[i,a]of Object.entries(yU))[...a].every(c=>e.has(c))&&t.add(Number(i));return t}var tR=(e=>(e[e.Road=0]="Road",e[e.Light=1]="Light",e[e.Dark=2]="Dark",e[e.Green=3]="Green",e[e.NavRed=4]="NavRed",e[e.NavGreen=5]="NavGreen",e[e.NavBlue=6]="NavBlue",e[e.NavYellow=7]="NavYellow",e[e.NavPurple=8]="NavPurple",e))(tR||{});const _U=new Set([10,17]),xU=new Set([7,11]),rR=new Set(Array.from({length:20},(e,t)=>t)),bU=new Set(rR.difference(xU)),wU=new Set(rR.difference(_U)),SU=e=>{const{game:t,tileRootUrl:i,visibleIcons:a=t==="ats"?bU:wU,enableIconAutoHide:c=!0,showSecrets:h=!0,mode:f="light",specialEvent:o}=e,b=o?!0:t==="ats"?fx(t,e.dlcs??JA):fx(t,e.dlcs??eR),P=h?!0:["==",["get","secret"],!1],I=m1[f];lS();const D=ZV();return K.useEffect(()=>{if(!D.current)return;const z=D.current;z.on("styleimagemissing",F=>{if(F.id!=="exit-sign"||z.hasImage("exit-sign"))return;const U=64,$=4,j=new Uint8Array(U*U*$);for(let se=0;se<U;se++)for(let Q=0;Q<U;Q++){const de=(Q*U+se)*$;Q===0||Q===U-1||se===0||se===U-1?(j[de+0]=136,j[de+1]=136,j[de+2]=136,j[de+3]=255):se===1||se===2||se===U-2||se===U-3||Q===1||Q===2||Q===U-2||Q===U-3?(j[de+0]=255,j[de+1]=255,j[de+2]=255,j[de+3]=255):(j[de+0]=82,j[de+1]=177,j[de+2]=129,j[de+3]=255)}const ie=8;z.addImage("exit-sign",{width:U,height:U,data:j},{stretchX:[[ie,U-ie]],stretchY:[[ie,U-ie]],content:[ie,ie,U-ie,U-ie],pixelRatio:2})})},[D.current]),G.jsxs(Xc,{id:t+"-icons",type:"vector",url:`pmtiles://${i}/${o??t}.pmtiles`,children:[G.jsx(Qr,{id:t+"ferry-labels","source-layer":t,minzoom:7.5,type:"symbol",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"ferry"]],layout:{...Zc,"symbol-placement":"line-center","text-field":"{name}","text-size":12},paint:{"text-halo-width":2,"text-halo-color":I.ferryHalo,"text-color":I.ferryLabel}}),G.jsx(Qr,{id:t+"train-labels","source-layer":t,minzoom:7.5,type:"symbol",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],layout:{...Zc,"symbol-placement":"line-center","text-field":"{name}","text-size":12},paint:{"text-halo-width":2,"text-halo-color":I.trainHalo,"text-color":I.trainLabel}}),a.has(15)&&G.jsx(Qr,{id:t+"company-icons","source-layer":t,type:"symbol",minzoom:c?8:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"company"],b,P],layout:ed(c,1,1.25,3.5)}),t==="ets2"&&a.has(16)&&G.jsx(Qr,{id:"euro-road-overlays","source-layer":t,minzoom:c?4.5:0,type:"symbol",filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["!",["in",["get","sprite"],["literal",aP]]],P],layout:ed(c,.4*1.25,.75*1.25,1.25*1.25)}),t==="ats"&&a.has(16)&&G.jsx(Qr,{id:t+"road-interstate-overlays","source-layer":t,type:"symbol",filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["==",["index-of","is",["get","sprite"]],0],b,P],layout:ed(c,.4,.75,1.25)}),t==="ats"&&a.has(16)&&G.jsx(Qr,{id:t+"road-us-route-overlays","source-layer":t,type:"symbol",minzoom:c?5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["==",["index-of","us",["get","sprite"]],0],b,P],layout:ed(c,.4,.75,1.25)}),t==="ats"&&a.has(16)&&G.jsx(Qr,{id:t+"road-state-route-overlays","source-layer":t,type:"symbol",minzoom:c?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],b,P,["!",["any",["==",["index-of","is",["get","sprite"]],0],["==",["index-of","us",["get","sprite"]],0],["in",["get","sprite"],["literal",aP]]]]],layout:ed(c,.4,.75,1.25)}),a.has(17)&&G.jsx(Qr,{id:t+"exit-points","source-layer":t,type:"symbol",paint:{"text-color":"#fff"},minzoom:c?10:0,layout:{...ed(c,.4,.75,1.25),...Zc,"text-field":"{name}","text-size":["interpolate",["linear"],["zoom"],4,4,10,10],"icon-text-fit":"both","icon-text-fit-padding":[0,2,0,2],"icon-image":"exit-sign"},filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"exit"],b]}),a.has(14)&&G.jsx(Qr,{id:t+"city-labels-small","source-layer":t,type:"symbol",minzoom:c?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],[">",["get","scaleRank"],6],b],layout:{...Zc,"text-field":"{name}","text-allow-overlap":!c,"text-variable-anchor":ug,"text-size":12,"icon-image":$b,"icon-allow-overlap":!c,"icon-size":.6},paint:I.primaryTextPaint}),a.has(14)&&G.jsx(Qr,{id:t+"city-labels-medium","source-layer":t,type:"symbol",minzoom:c?5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],["<=",["get","scaleRank"],6],[">",["get","scaleRank"],3],b],layout:{...Zc,"text-field":"{name}","text-allow-overlap":!c,"text-variable-anchor":ug,"text-size":13,"icon-image":$b,"icon-allow-overlap":!c,"icon-size":.6},paint:I.primaryTextPaint}),a.has(14)&&G.jsx(Qr,{id:t+"city-labels-big","source-layer":t,type:"symbol",minzoom:c?4:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],["<=",["get","scaleRank"],3],b],layout:{...Zc,"text-field":"{name}","text-allow-overlap":!c,"text-variable-anchor":ug,"text-size":14,"icon-image":$b,"icon-allow-overlap":!c,"icon-size":.8},paint:I.primaryTextPaint}),t==="ets2"&&a.has(14)&&G.jsx(Qr,{id:t+"country-labels","source-layer":t,type:"symbol",minzoom:4,maxzoom:6.5,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"country"]],layout:{...Zc,"text-font":["Klokantech Noto Sans Bold"],"text-field":"{name}","text-variable-anchor":ug,"text-size":14},paint:I.primaryTextPaint}),t==="ats"&&a.has(14)&&G.jsx(Qr,{id:t+"country-labels","source-layer":t,type:"symbol",minzoom:4,maxzoom:6.5,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"country"]],layout:{...Zc,"text-font":["Open Sans Light"],"text-field":"{name}","text-transform":"uppercase","text-variable-anchor":ug,"text-size":["step",["zoom"],10,5,13]},paint:I.secondaryTextPaint}),Gw(a)&&G.jsx(Qr,{id:t+"poi-icons","source-layer":t,type:"symbol",minzoom:c?7:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],lP(a),b,P],layout:ed(c,.6,1.25,2.5,{vertical:2,horizontal:2})}),Gw(a)&&(a.has(8)||a.has(9)||a.has(5))&&G.jsx(Qr,{id:t+"poi-icon-labels","source-layer":t,type:"symbol",minzoom:c?9.5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["any",["in",["get","poiType"],["literal",["viewpoint","landmark"]]],["all",["==",["get","poiType"],"facility"],["==",["get","sprite"],"dealer_ico"]]],lP(a),b,P],layout:{...ed(c,.6,1.25,2.5,{vertical:2,horizontal:2}),...Zc,"text-field":"{poiName}","text-allow-overlap":!c,"text-variable-anchor":["left","right","top","bottom"],"text-radial-offset":1.5,"text-size":10},paint:I.primaryTextPaint}),(a.has(18)||a.has(19))&&G.jsx(Qr,{id:t+"traffic-icons","source-layer":t,type:"symbol",minzoom:c?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"traffic"],EU(a),b,P],layout:ed(c,.6*.5,1.25*.5,2.5*.5,{vertical:2,horizontal:2})})]})},sP=e=>{const{game:t,tileRootUrl:i,showSecrets:a=!0,mode:c="light",specialEvent:h}=e,f=h?!0:t==="ats"?fx(t,e.dlcs??JA):fx(t,e.dlcs??eR),o=a?!0:["==",["get","secret"],!1],b=m1[c];return lS(),G.jsxs(Xc,{id:t,type:"vector",url:`pmtiles://${i}/${h??t}.pmtiles`,children:[G.jsx(Qr,{id:t+"mapAreas","source-layer":t,type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"mapArea"],f,o],layout:{"fill-sort-key":["get","zIndex"]},paint:{"fill-color":jb(c),"fill-outline-color":["case",["==",["get","color"],tR.Road],b.mapAreaOutline,jb(c)]}}),G.jsx(Qr,{id:t+"prefabs","source-layer":t,type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"prefab"],f,o],layout:{"fill-sort-key":["get","zIndex"]},paint:{"fill-color":jb(c)}}),G.jsx(CU,{game:t,tileRootUrl:i,mode:c,color:b.footprint}),G.jsx(Qr,{id:t+"hidden-roads","source-layer":t,type:"line",minzoom:9,filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","hidden"],!0],f],paint:{"line-color":b.hiddenRoad,"line-width":1,"line-opacity":.7}}),G.jsx(Qr,{id:t+"visible-roads-case","source-layer":t,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["!=",["get","roadType"],"train"],["==",["get","hidden"],!1],f,o],layout:cP,paint:{"line-color":AU(c),"line-gap-width":uP,"line-width":["interpolate",["exponential",1.5],["zoom"],10,1,14,2,16,3]}}),G.jsx(Qr,{id:t+"visible-roads","source-layer":t,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["!=",["get","roadType"],"train"],["==",["get","hidden"],!1],f,o],layout:cP,paint:{"line-color":kU(c),"line-width":uP}}),G.jsx(Qr,{id:t+"ferries","source-layer":t,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"ferry"]],paint:{"line-color":b.ferryLine,"line-width":1,"line-opacity":.8,"line-dasharray":[2,2]}}),G.jsx(Qr,{id:t+"trains-a","source-layer":t,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":b.trainLine,"line-width":2,"line-opacity":.8,"line-offset":["interpolate",["exponential",1.5],["zoom"],9,0,14,-6]}}),G.jsx(Qr,{id:t+"trains-b","source-layer":t,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":b.trainLine,"line-width":2,"line-opacity":.8,"line-offset":["interpolate",["exponential",1.5],["zoom"],9,0,14,6]}}),G.jsx(Qr,{id:t+"train-hatch","source-layer":t,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":b.trainLine,"line-width":10,"line-opacity":.8,"line-dasharray":[.1,1]}})]})},CU=({game:e,tileRootUrl:t,color:i,mode:a,specialEvent:c})=>G.jsxs(Xc,{id:e+"footprints",type:"vector",url:`pmtiles://${t}/${c??e}-footprints.pmtiles`,children:[G.jsx(Qr,{id:e+"footprints","source-layer":"footprints",type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"footprint"]],paint:{"fill-color":i,"fill-opacity":["step",["zoom"],1,9,.8]}}),G.jsx(Qr,{id:e+"extrusions",minzoom:9,"source-layer":"footprints",type:"fill-extrusion",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"footprint"]],paint:{"fill-extrusion-color":i,"fill-extrusion-height":["interpolate",["exponential",1.5],["zoom"],9,["*",10,["get","height"]],13,["*",20,["get","height"]]],"fill-extrusion-opacity":a==="light"?.33:.67}})]});function ed(e,t,i,a,c={vertical:10,horizontal:30}){const h=["literal",[c.vertical,c.horizontal]];return{"icon-image":"{sprite}","icon-allow-overlap":!e,"icon-padding":h,"icon-size":["interpolate",["exponential",1.5],["zoom"],4,t,9,i,13,a]}}const $b=["step",["zoom"],["case",["==",["get","capital"],2],"dotdot","dot"],8,""],TU=[9,8,6,7,2,0,4,5,12,3,13,1,10,11],MU=[18,19],aP=["weigh_ico","toll_ico","agri_check","border_ico"];function Gw(e){return TU.some(t=>e.has(t))}function PU(e){return MU.some(t=>e.has(t))}function EU(e){ba.checkArgument(PU(e));const t=[];return e.has(18)&&t.push("roadwork"),e.has(19)&&t.push("railcrossing"),["any",t.length>0?["in",["get","sprite"],["literal",t]]:!1]}function lP(e){ba.checkArgument(Gw(e));const t=[];e.has(9)&&t.push("landmark"),e.has(8)&&t.push("viewpoint"),e.has(6)&&t.push("ferry"),e.has(7)&&t.push("train");const i=[];e.has(0)&&i.push("gas_ico"),e.has(4)&&i.push("service_ico"),e.has(13)&&i.push("weigh_station_ico"),e.has(5)&&i.push("dealer_ico"),e.has(12)&&i.push("garage_large_ico"),e.has(3)&&i.push("recruitment_ico"),e.has(2)&&i.push("parking_ico");const a=[];e.has(13)&&a.push("weigh_ico"),e.has(1)&&a.push("toll_ico"),e.has(10)&&a.push("agri_check"),e.has(11)&&a.push("border_ico");const c=t.length>0?["in",["get","poiType"],["literal",t]]:!1,h=i.length>0?["all",["==",["get","poiType"],"facility"],["in",["get","sprite"],["literal",i]]]:!1,f=a.length>0?["all",["==",["get","poiType"],"road"],["in",["get","sprite"],["literal",a]]]:!1;return["any",c,h,f]}function fx(e,t){let i;return e==="ats"?i=gU(t):(i=vU(t),i.add(null)),["in",["get","dlcGuard"],["literal",[...i]]]}const ug=["step",["zoom"],["literal",["top","bottom","right","left"]],7,["literal",["center"]]],Zc={"text-radial-offset":.5,"text-justify":"auto","text-font":["Klokantech Noto Sans Regular"]},cP={"line-cap":"round","line-join":"bevel"},uP=["interpolate",["exponential",1.5],["zoom"],3,.8,14,30,16,150],nR={light:{freeway:["#fde293","#f8c248"],divided:["#ffffff","#dddddd"],no_vehicles:["#aaaaaa","#888888"],local:["#f1f3f4","#dddddd"],train:["#ff0000","#f8c248"],tram:["#00ff00","#f8c248"],unknown:["#f0f","#f0f"]},dark:{freeway:["#95813e","#372f21"],divided:["#3c4043","#4c5043"],no_vehicles:["#606166","#888888"],local:["#606166","#333"],train:["#ff0000","#f8c248"],tram:["#00ff00","#f8c248"],unknown:["#f0f","#f0f"]}},IU={light:{0:"hsl(200, 8%, 92%)",1:"hsl(38, 59%, 76%)",2:"hsl(38, 64%, 58%)",3:"hsl(92, 31%, 70%)",4:"hsl(0, 100%, 30%)",5:"hsl(107, 51%, 43%)",6:"hsl(201, 53%, 39%)",7:"hsl(53, 84%, 53%)",8:"hsl(267,46% ,45%)"},dark:{0:"hsl(200, 2%, 36%)",1:"hsl(38, 25%, 35%)",2:"hsl(38, 25%, 25%)",3:"hsl(143, 20%, 25%)",4:"hsl(0, 100%, 25%)",5:"hsl(107, 51%, 25%)",6:"hsl(201, 53%, 25%)",7:"hsl(53, 84%, 25%)",8:"hsl(267, 46%, 25%)"}},kU=e=>["match",["get","roadType"],...Object.entries(nR[e]).flatMap(([t,[i]])=>[t,i]),"#f0f"],AU=e=>["match",["get","roadType"],...Object.entries(nR[e]).flatMap(([t,[,i]])=>[t,i]),"#b0b"],jb=e=>["match",["get","color"],...Object.entries(IU[e]).flatMap(([t,i])=>[Number(t),i]),"#b0b"],RU="/extra-labels.geojson",DU="/ets2-villages.geojson",zU={AR:void 0,AZ:void 0,CA:void 0,CO:void 0,IA:void 0,ID:void 0,KS:void 0,LA:void 0,MO:void 0,MT:void 0,NE:void 0,NM:void 0,NV:void 0,OK:void 0,OR:void 0,TX:void 0,UT:void 0,WA:void 0,WY:void 0},OU=new Set(Object.keys(zU)),hP=e=>{const{game:t,enableAutoHide:i=!0,mode:a="light"}=e,c=t==="ats"?RU:DU,h=t==="ats"?["all",["boolean",["get","show"],!0],["in",["slice",["get","country"],-2],["literal",[...e.enabledStates??OU]]]]:["boolean",!0],f=m1[a];return G.jsx(Xc,{id:`${t}-scenery-towns`,type:"geojson",data:c,children:G.jsx(Qr,{id:`${t}-scenery-towns`,type:"symbol",minzoom:i?7:0,filter:h,layout:{...Zc,"text-field":t==="ats"?"{text}":"{name}","text-allow-overlap":!i,"text-variable-anchor":ug,"text-size":10.5},paint:f.primaryTextPaint})})},cS={version:8,glyphs:"https://fonts.openmaptiles.org/{fontstack}/{range}.pbf",sources:{},layers:[]},uS={get(e,t,i){return t==="sprite"&&typeof e.sprite=="string"&&/^\/\w/.exec(e.sprite.toString())?window.location.origin+e.sprite:Reflect.get(e,t,i)}},LU=new Proxy({...cS,sprite:"/sprites"},uS);new Proxy({...cS,sprite:"/halloween-sprites"},uS);new Proxy({...cS,sprite:"/christmas-sprites"},uS);const v_="https://maps.truckermudgeon.com",FU={ats:[[-124.477162,25.767968].map(e=>Math.floor(e)),[-88.928336,49.122384].map(e=>Math.ceil(e))].flat()},iR=e=>{console.log("render slippy map");const{Destinations:t,TrailerOrWaypointMarkers:i,PlayerMarker:a,center:c=NV(FU.ats),mode:h="light"}=e,f=K.useRef(null),o=K.useRef(null);return G.jsxs(o9,{ref:f,initialViewState:{longitude:c[0],latitude:c[1]},onLoad:()=>{e.onLoad(Ca(f.current),o?.current??void 0)},onDragStart:()=>e.onDragStart(),onZoomStart:b=>{b.originalEvent&&e.onDragStart()},style:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh"},minZoom:4,maxZoom:15,mapStyle:LU,attributionControl:!1,children:[G.jsx(pU,{tileRootUrl:v_,mode:h}),G.jsx(sP,{tileRootUrl:v_,mode:h,game:"ats"}),G.jsx(sP,{tileRootUrl:v_,mode:h,game:"ets2"}),G.jsx(hP,{mode:h,game:"ats"}),G.jsx(hP,{mode:h,game:"ets2"}),Math.random()>2&&G.jsx(Xc,{type:"vector",url:"pmtiles:///usa-prefab-curves.pmtiles",children:G.jsx(Qr,{"source-layer":"usaprefabcurves",type:"line",paint:{"line-color":"#f044","line-width":3,"line-opacity":1},filter:["in","$type","LineString"]})}),Math.random()>2&&G.jsx(Xc,{id:"signs",type:"geojson",data:"signs.geojson",children:G.jsx(Qr,{id:"signs-points",type:"symbol",layout:{...Zc,"text-field":"{poiName} {token}","text-size":12,"text-rotate":["to-number",["get","rotation"]],"text-rotation-alignment":"map","text-overlap":"always"},filter:["in","$type","Point"]})}),G.jsxs(Xc,{id:"activeRoute",type:"geojson",data:{type:"FeatureCollection",features:[]},children:[G.jsx(Qr,{id:"activeRouteLayer-case",type:"line",paint:{"line-color":"hsl(204,100%,40%)","line-gap-width":8,"line-width":4,"line-opacity":1}}),G.jsx(Qr,{id:"activeRouteLayer",type:"line",paint:{"line-color":"hsl(204,100%,50%)","line-width":10,"line-opacity":1}})]}),Array.from({length:GV.size},(b,P)=>G.jsxs(Xc,{id:`previewRoute-${P}`,type:"geojson",data:{type:"FeatureCollection",features:[]},children:[G.jsx(Qr,{id:`previewRouteLayer-${P}-case`,type:"line",paint:{"line-color":"hsl(204,100%,40%)","line-gap-width":8,"line-width":4,"line-opacity":1}}),G.jsx(Qr,{id:`previewRouteLayer-${P}`,type:"line",paint:{"line-color":"hsl(204,100%,50%)","line-width":10,"line-opacity":1}})]},`previewRoute-${P}`)),G.jsxs(Xc,{id:"previewStepArrow",type:"geojson",data:{type:"FeatureCollection",features:[]},children:[G.jsx(Qr,{id:"previewStepArrowCase",type:"line",layout:{"line-cap":"round"},paint:{"line-color":"#444","line-gap-width":11,"line-width":2,"line-opacity":1},filter:["in","$type","LineString"]}),G.jsx(Qr,{id:"previewStepArrowArrow",type:"symbol",layout:{"icon-image":"triangle","icon-allow-overlap":!0,"icon-pitch-alignment":"map","icon-rotation-alignment":"map","icon-rotate":["get","bearing"]},filter:["in","$type","Point"]}),G.jsx(Qr,{id:"previewStepArrowLine",type:"line",layout:{"line-cap":"round"},paint:{"line-color":"#fff","line-width":11,"line-opacity":1},filter:["in","$type","LineString"]})]},"previewStepArrow"),G.jsx(Xc,{id:"activeRouteIcons",type:"geojson",data:{type:"FeatureCollection",features:[]},children:G.jsx(Qr,{id:"activeRouteIconsLayer",type:"symbol",layout:{"icon-image":"{sprite}","icon-allow-overlap":!0},minzoom:10,filter:["in","$type","Point"]})}),G.jsx(SU,{tileRootUrl:v_,mode:h,game:"ats"}),G.jsx(t,{}),G.jsx(i,{}),a&&G.jsx(a,{mode:e.mode,ref:o}),G.jsx("div",{style:{fontSize:"0.9em",opacity:.25,background:"transparent",position:"absolute",right:"1em",bottom:2},children:G.jsx("a",{style:{color:"inherit",textDecoration:"none"},href:"https://github.com/truckermudgeon/maps",children:"TruckSim Maps"})})]})},Nb=4,BU=e=>{const{appClient:t,children:i}=e,[a,c]=K.useState("authorizing"),h=K.useRef(null);console.log("render SessionGate"),K.useEffect(()=>{(async()=>{const b=localStorage.getItem("viewerId");b?(console.log("attempting reconnect"),await t.reconnect.mutate({viewerId:b})?c("loggedIn"):(console.log("reconnect failed; falling back to pairing flow"),c("loggedOut"))):(console.log("no viewer id"),c("loggedOut"))})()},[]);const f=()=>c("loggedIn");return a==="loggedIn"?G.jsx(G.Fragment,{children:i}):G.jsxs(dn,{justifyContent:"center",alignItems:"center",width:"100%",height:"100vh",bgcolor:"black",children:[G.jsx($U,{}),G.jsxs(Hv,{ref:h,size:"lg",sx:{boxShadow:"lg",overflow:"hidden"},children:[G.jsx(jU,{}),G.jsx(Xg,{}),a==="authorizing"?G.jsxs(Wr,{display:"flex",justifyContent:"center",children:[G.jsx(nm,{variant:"solid",size:"sm",color:"neutral",sx:{mr:1}}),"Connecting..."]}):G.jsx(lB,{children:G.jsx(NU,{appClient:t,onLoggedIn:f})})]})]})},$U=K.memo(()=>G.jsx(ei,{sx:{opacity:.33,pointerEvents:"none"},children:G.jsx(iR,{center:[-98,38],onLoad:function(e,t){console.log("SlippyMap loaded")},onDragStart:()=>{},Destinations:()=>G.jsx(G.Fragment,{}),TrailerOrWaypointMarkers:()=>G.jsx(G.Fragment,{})})})),jU=K.memo(()=>G.jsxs(G.Fragment,{children:[" ",G.jsx(Wr,{className:"caveat-alpha-label",level:"h2",textAlign:"end",sx:{position:"absolute",right:"1em",transform:"rotate(-10deg) translate(0.65em, 1em)",color:"#e00"},children:"pre-alpha"}),G.jsx(Wr,{level:"h1",alignSelf:"center",startDecorator:G.jsx(sd,{color:"primary",variant:"solid",style:{pointerEvents:"none"},children:G.jsx(FV,{})}),children:"TruckSimNavigator"})]})),NU=K.memo(e=>{const{appClient:t}=e,[i,a]=K.useState(null),[c,h]=K.useState(""),[f,o]=K.useState(!1);function b(D){D=D.replaceAll(/[^a-z]/gi,""),h(D.toLowerCase())}function P(D){const z=D.clipboardData.getData("text").toLowerCase().trim();z.length===Nb&&(h(z),I(z))}async function I(D){if(console.log("redeem code",D),!f){a(null),o(!0);try{const z=await t.redeemCode.mutate({code:D});localStorage.setItem("viewerId",z.viewerId),localStorage.setItem("telemetryId",z.telemetryId),console.log("code redeemed"),e.onLoggedIn()}catch(z){console.log("error after submitting code"),a(z instanceof Error?z.message:"Login failed"),h("")}finally{o(!1)}}}return G.jsxs(dn,{textAlign:"center",gap:"1em",children:[G.jsxs(Wr,{children:["Enter your"," ",G.jsx(_B,{underline:"always",href:"/whats-a-pairing-code.html",children:"pairing code"})]}),G.jsxs("form",{method:"dialog",onSubmit:()=>void I(c),style:{display:"flex",flexDirection:"column",gap:"1em"},children:[G.jsx($V,{containerStyle:{justifyContent:"center"},value:c,numInputs:Nb,onPaste:P,renderInput:(D,z)=>G.jsx(j6,{slotProps:{input:{...D}},autoFocus:z===0,disabled:f,"data-lpignore":"true","data-1p-ignore":"true",sx:{width:"2em",height:"2em",margin:1,fontSize:"2em",fontFamily:"monospace"}}),onChange:b}),i&&G.jsx(Y4,{color:"danger",startDecorator:G.jsx(BV,{}),children:i}),G.jsxs(rB,{sx:{p:0},children:[G.jsx(Ia,{component:"a",href:"https://truckermudgeon.github.io",variant:"outlined",color:"neutral",disabled:f,sx:{flexBasis:"50%"},children:"Back"}),G.jsx(Ia,{type:"submit",disabled:f||c.length!==Nb,sx:{flexBasis:"50%"},startDecorator:f?G.jsx(nm,{variant:"solid",color:"neutral",sx:{opacity:.5}}):null,children:f?"Checking":"Continue"})]})]})]})});var Vb={exports:{}},dP;function VU(){return dP||(dP=1,function(e){var t={};function i(h){return Math.floor(Math.abs(h)+.5)*(h>=0?1:-1)}function a(h,f,o){h=i(h*o),f=i(f*o);var b=(h-f)*2;b<0&&(b=-b-1);for(var P="";b>=32;)P+=String.fromCharCode((32|b&31)+63),b/=32;return P+=String.fromCharCode((b|0)+63),P}t.decode=function(h,f){for(var o=0,b=0,P=0,I=[],D=0,z=0,F=null,U,$,j=Math.pow(10,Number.isInteger(f)?f:5);o<h.length;){F=null,D=1,z=0;do F=h.charCodeAt(o++)-63,z+=(F&31)*D,D*=32;while(F>=32);U=z&1?(-z-1)/2:z/2,D=1,z=0;do F=h.charCodeAt(o++)-63,z+=(F&31)*D,D*=32;while(F>=32);$=z&1?(-z-1)/2:z/2,b+=U,P+=$,I.push([b/j,P/j])}return I},t.encode=function(h,f){if(!h.length)return"";for(var o=Math.pow(10,Number.isInteger(f)?f:5),b=a(h[0][0],0,o)+a(h[0][1],0,o),P=1;P<h.length;P++){var I=h[P],D=h[P-1];b+=a(I[0],D[0],o),b+=a(I[1],D[1],o)}return b};function c(h){for(var f=[],o=0;o<h.length;o++){var b=h[o].slice();f.push([b[1],b[0]])}return f}t.fromGeoJSON=function(h,f){if(h&&h.type==="Feature"&&(h=h.geometry),!h||h.type!=="LineString")throw new Error("Input must be a GeoJSON LineString");return t.encode(c(h.coordinates),f)},t.toGeoJSON=function(h,f){var o=t.decode(h,f);return{type:"LineString",coordinates:c(o)}},e.exports&&(e.exports=t)}(Vb)),Vb.exports}var UU=VU();const Ug=Lv(UU);function qw(e,t){return qw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},qw(e,t)}function GU(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,qw(e,t)}const fP={disabled:!1},oR=hn.createContext(null);var qU=function(t){return t.scrollTop},Hy="unmounted",zp="exited",Op="entering",hg="entered",Hw="exiting",au=function(e){GU(t,e);function t(a,c){var h;h=e.call(this,a,c)||this;var f=c,o=f&&!f.isMounting?a.enter:a.appear,b;return h.appearStatus=null,a.in?o?(b=zp,h.appearStatus=Op):b=hg:a.unmountOnExit||a.mountOnEnter?b=Hy:b=zp,h.state={status:b},h.nextCallback=null,h}t.getDerivedStateFromProps=function(c,h){var f=c.in;return f&&h.status===Hy?{status:zp}:null};var i=t.prototype;return i.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},i.componentDidUpdate=function(c){var h=null;if(c!==this.props){var f=this.state.status;this.props.in?f!==Op&&f!==hg&&(h=Op):(f===Op||f===hg)&&(h=Hw)}this.updateStatus(!1,h)},i.componentWillUnmount=function(){this.cancelNextCallback()},i.getTimeouts=function(){var c=this.props.timeout,h,f,o;return h=f=o=c,c!=null&&typeof c!="number"&&(h=c.exit,f=c.enter,o=c.appear!==void 0?c.appear:f),{exit:h,enter:f,appear:o}},i.updateStatus=function(c,h){if(c===void 0&&(c=!1),h!==null)if(this.cancelNextCallback(),h===Op){if(this.props.unmountOnExit||this.props.mountOnEnter){var f=this.props.nodeRef?this.props.nodeRef.current:s_.findDOMNode(this);f&&qU(f)}this.performEnter(c)}else this.performExit();else this.props.unmountOnExit&&this.state.status===zp&&this.setState({status:Hy})},i.performEnter=function(c){var h=this,f=this.props.enter,o=this.context?this.context.isMounting:c,b=this.props.nodeRef?[o]:[s_.findDOMNode(this),o],P=b[0],I=b[1],D=this.getTimeouts(),z=o?D.appear:D.enter;if(!c&&!f||fP.disabled){this.safeSetState({status:hg},function(){h.props.onEntered(P)});return}this.props.onEnter(P,I),this.safeSetState({status:Op},function(){h.props.onEntering(P,I),h.onTransitionEnd(z,function(){h.safeSetState({status:hg},function(){h.props.onEntered(P,I)})})})},i.performExit=function(){var c=this,h=this.props.exit,f=this.getTimeouts(),o=this.props.nodeRef?void 0:s_.findDOMNode(this);if(!h||fP.disabled){this.safeSetState({status:zp},function(){c.props.onExited(o)});return}this.props.onExit(o),this.safeSetState({status:Hw},function(){c.props.onExiting(o),c.onTransitionEnd(f.exit,function(){c.safeSetState({status:zp},function(){c.props.onExited(o)})})})},i.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},i.safeSetState=function(c,h){h=this.setNextCallback(h),this.setState(c,h)},i.setNextCallback=function(c){var h=this,f=!0;return this.nextCallback=function(o){f&&(f=!1,h.nextCallback=null,c(o))},this.nextCallback.cancel=function(){f=!1},this.nextCallback},i.onTransitionEnd=function(c,h){this.setNextCallback(h);var f=this.props.nodeRef?this.props.nodeRef.current:s_.findDOMNode(this),o=c==null&&!this.props.addEndListener;if(!f||o){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var b=this.props.nodeRef?[this.nextCallback]:[f,this.nextCallback],P=b[0],I=b[1];this.props.addEndListener(P,I)}c!=null&&setTimeout(this.nextCallback,c)},i.render=function(){var c=this.state.status;if(c===Hy)return null;var h=this.props,f=h.children;h.in,h.mountOnEnter,h.unmountOnExit,h.appear,h.enter,h.exit,h.timeout,h.addEndListener,h.onEnter,h.onEntering,h.onEntered,h.onExit,h.onExiting,h.onExited,h.nodeRef;var o=Pr(h,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return hn.createElement(oR.Provider,{value:null},typeof f=="function"?f(c,o):hn.cloneElement(hn.Children.only(f),o))},t}(hn.Component);au.contextType=oR;au.propTypes={};function cg(){}au.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:cg,onEntering:cg,onEntered:cg,onExit:cg,onExiting:cg,onExited:cg};au.UNMOUNTED=Hy;au.EXITED=zp;au.ENTERING=Op;au.ENTERED=hg;au.EXITING=Hw;const pP={};function HU(e,t){const i=K.useRef(pP);return i.current===pP&&(i.current=e(t)),i}const WU=[];function ZU(e){K.useEffect(e,WU)}class hS{static create(){return new hS}currentId=null;start(t,i){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,i()},t)}clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)};disposeEffect=()=>this.clear}function XU(){const e=HU(hS.create).current;return ZU(e.disposeEffect),e}const sR=e=>e.scrollTop;function Gg(e,t){const{timeout:i,easing:a,style:c={}}=e;return{duration:c.transitionDuration??(typeof i=="number"?i:i[t.mode]||0),easing:c.transitionTimingFunction??(typeof a=="object"?a[t.mode]:a),delay:c.transitionDelay}}function KU(e){return t1("MuiCollapse",e)}ek("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const YU=e=>{const{orientation:t,classes:i}=e,a={root:["root",`${t}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${t}`],wrapperInner:["wrapperInner",`${t}`]};return W2(a,KU,i)},JU=Jv("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,t[i.orientation],i.state==="entered"&&t.entered,i.state==="exited"&&!i.in&&i.collapsedSize==="0px"&&t.hidden]}})(RA(({theme:e})=>({height:0,overflow:"hidden",transition:e.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:e.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:t})=>t.state==="exited"&&!t.in&&t.collapsedSize==="0px",style:{visibility:"hidden"}}]}))),QU=Jv("div",{name:"MuiCollapse",slot:"Wrapper"})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),eG=Jv("div",{name:"MuiCollapse",slot:"WrapperInner"})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),Kp=K.forwardRef(function(t,i){const a=iS({props:t,name:"MuiCollapse"}),{addEndListener:c,children:h,className:f,collapsedSize:o="0px",component:b,easing:P,in:I,onEnter:D,onEntered:z,onEntering:F,onExit:U,onExited:$,onExiting:j,orientation:ie="vertical",style:se,timeout:Q=pk.standard,TransitionComponent:de=au,...oe}=a,be={...a,orientation:ie,collapsedSize:o},xe=YU(be),Me=Yv(),Ee=XU(),re=K.useRef(null),ke=K.useRef(),Ge=typeof o=="number"?`${o}px`:o,Ke=ie==="horizontal",gt=Ke?"width":"height",et=K.useRef(null),qe=oS(i,et),Qe=_t=>St=>{if(_t){const tt=et.current;St===void 0?_t(tt):_t(tt,St)}},Ve=()=>re.current?re.current[Ke?"clientWidth":"clientHeight"]:0,je=Qe((_t,St)=>{re.current&&Ke&&(re.current.style.position="absolute"),_t.style[gt]=Ge,D&&D(_t,St)}),ct=Qe((_t,St)=>{const tt=Ve();re.current&&Ke&&(re.current.style.position="");const{duration:At,easing:It}=Gg({style:se,timeout:Q,easing:P},{mode:"enter"});if(Q==="auto"){const mr=Me.transitions.getAutoHeightDuration(tt);_t.style.transitionDuration=`${mr}ms`,ke.current=mr}else _t.style.transitionDuration=typeof At=="string"?At:`${At}ms`;_t.style[gt]=`${tt}px`,_t.style.transitionTimingFunction=It,F&&F(_t,St)}),ye=Qe((_t,St)=>{_t.style[gt]="auto",z&&z(_t,St)}),ze=Qe(_t=>{_t.style[gt]=`${Ve()}px`,U&&U(_t)}),ft=Qe($),wt=Qe(_t=>{const St=Ve(),{duration:tt,easing:At}=Gg({style:se,timeout:Q,easing:P},{mode:"exit"});if(Q==="auto"){const It=Me.transitions.getAutoHeightDuration(St);_t.style.transitionDuration=`${It}ms`,ke.current=It}else _t.style.transitionDuration=typeof tt=="string"?tt:`${tt}ms`;_t.style[gt]=Ge,_t.style.transitionTimingFunction=At,j&&j(_t)}),xt=_t=>{Q==="auto"&&Ee.start(ke.current||0,_t),c&&c(et.current,_t)};return G.jsx(de,{in:I,onEnter:je,onEntered:ye,onEntering:ct,onExit:ze,onExited:ft,onExiting:wt,addEndListener:xt,nodeRef:et,timeout:Q==="auto"?null:Q,...oe,children:(_t,{ownerState:St,...tt})=>G.jsx(JU,{as:b,className:hi(xe.root,f,{entered:xe.entered,exited:!I&&Ge==="0px"&&xe.hidden}[_t]),style:{[Ke?"minWidth":"minHeight"]:Ge,...se},ref:qe,ownerState:{...be,state:_t},...tt,children:G.jsx(QU,{ownerState:{...be,state:_t},className:xe.wrapper,ref:re,children:G.jsx(eG,{ownerState:{...be,state:_t},className:xe.wrapperInner,children:h})})})})});Kp&&(Kp.muiSupportAuto=!0);function aR(e){return parseInt(K.version,10)>=19?e?.props?.ref||null:e?.ref||null}function tG(e,t,i){const a=t.getBoundingClientRect(),c=i&&i.getBoundingClientRect(),h=DA(t);let f;if(t.fakeTransform)f=t.fakeTransform;else{const P=h.getComputedStyle(t);f=P.getPropertyValue("-webkit-transform")||P.getPropertyValue("transform")}let o=0,b=0;if(f&&f!=="none"&&typeof f=="string"){const P=f.split("(")[1].split(")")[0].split(",");o=parseInt(P[4],10),b=parseInt(P[5],10)}return e==="left"?c?`translateX(${c.right+o-a.left}px)`:`translateX(${h.innerWidth+o-a.left}px)`:e==="right"?c?`translateX(-${a.right-c.left-o}px)`:`translateX(-${a.left+a.width-o}px)`:e==="up"?c?`translateY(${c.bottom+b-a.top}px)`:`translateY(${h.innerHeight+b-a.top}px)`:c?`translateY(-${a.top-c.top+a.height-b}px)`:`translateY(-${a.top+a.height-b}px)`}function rG(e){return typeof e=="function"?e():e}function __(e,t,i){const a=rG(i),c=tG(e,t,a);c&&(t.style.webkitTransform=c,t.style.transform=c)}const dS=K.forwardRef(function(t,i){const a=Yv(),c={enter:a.transitions.easing.easeOut,exit:a.transitions.easing.sharp},h={enter:a.transitions.duration.enteringScreen,exit:a.transitions.duration.leavingScreen},{addEndListener:f,appear:o=!0,children:b,container:P,direction:I="down",easing:D=c,in:z,onEnter:F,onEntered:U,onEntering:$,onExit:j,onExited:ie,onExiting:se,style:Q,timeout:de=h,TransitionComponent:oe=au,...be}=t,xe=K.useRef(null),Me=oS(aR(b),xe,i),Ee=Ve=>je=>{Ve&&(je===void 0?Ve(xe.current):Ve(xe.current,je))},re=Ee((Ve,je)=>{__(I,Ve,P),sR(Ve),F&&F(Ve,je)}),ke=Ee((Ve,je)=>{const ct=Gg({timeout:de,style:Q,easing:D},{mode:"enter"});Ve.style.webkitTransition=a.transitions.create("-webkit-transform",{...ct}),Ve.style.transition=a.transitions.create("transform",{...ct}),Ve.style.webkitTransform="none",Ve.style.transform="none",$&&$(Ve,je)}),Ge=Ee(U),Ke=Ee(se),gt=Ee(Ve=>{const je=Gg({timeout:de,style:Q,easing:D},{mode:"exit"});Ve.style.webkitTransition=a.transitions.create("-webkit-transform",je),Ve.style.transition=a.transitions.create("transform",je),__(I,Ve,P),j&&j(Ve)}),et=Ee(Ve=>{Ve.style.webkitTransition="",Ve.style.transition="",ie&&ie(Ve)}),qe=Ve=>{f&&f(xe.current,Ve)},Qe=K.useCallback(()=>{xe.current&&__(I,xe.current,P)},[I,P]);return K.useEffect(()=>{if(z||I==="down"||I==="right")return;const Ve=OV(()=>{xe.current&&__(I,xe.current,P)}),je=DA(xe.current);return je.addEventListener("resize",Ve),()=>{Ve.clear(),je.removeEventListener("resize",Ve)}},[I,z,P]),K.useEffect(()=>{z||Qe()},[z,Qe]),G.jsx(oe,{nodeRef:xe,onEnter:re,onEntered:Ge,onEntering:ke,onExit:gt,onExited:et,onExiting:Ke,addEndListener:qe,appear:o,in:z,timeout:de,...be,children:(Ve,{ownerState:je,...ct})=>K.cloneElement(b,{ref:Me,style:{visibility:Ve==="exited"&&!z?"hidden":void 0,...Q,...b.props.style},...ct})})}),dg=aN({createStyledComponent:Jv("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.container&&t.container]}}),componentName:"MuiGrid",useThemeProps:e=>iS({props:e,name:"MuiGrid"}),useTheme:Yv}),nG={entering:{transform:"none"},entered:{transform:"none"}},iG=K.forwardRef(function(t,i){const a=Yv(),c={enter:a.transitions.duration.enteringScreen,exit:a.transitions.duration.leavingScreen},{addEndListener:h,appear:f=!0,children:o,easing:b,in:P,onEnter:I,onEntered:D,onEntering:z,onExit:F,onExited:U,onExiting:$,style:j,timeout:ie=c,TransitionComponent:se=au,...Q}=t,de=K.useRef(null),oe=oS(de,aR(o),i),be=gt=>et=>{if(gt){const qe=de.current;et===void 0?gt(qe):gt(qe,et)}},xe=be(z),Me=be((gt,et)=>{sR(gt);const qe=Gg({style:j,timeout:ie,easing:b},{mode:"enter"});gt.style.webkitTransition=a.transitions.create("transform",qe),gt.style.transition=a.transitions.create("transform",qe),I&&I(gt,et)}),Ee=be(D),re=be($),ke=be(gt=>{const et=Gg({style:j,timeout:ie,easing:b},{mode:"exit"});gt.style.webkitTransition=a.transitions.create("transform",et),gt.style.transition=a.transitions.create("transform",et),F&&F(gt)}),Ge=be(U),Ke=gt=>{h&&h(de.current,gt)};return G.jsx(se,{appear:f,in:P,nodeRef:de,onEnter:Me,onEntered:Ee,onEntering:xe,onExit:ke,onExited:Ge,onExiting:re,addEndListener:Ke,timeout:ie,...Q,children:(gt,{ownerState:et,...qe})=>K.cloneElement(o,{style:{transform:"scale(0)",visibility:gt==="exited"&&!P?"hidden":void 0,...nG[gt],...j,...o.props.style},ref:oe,...qe})})}),oG=sk({themeId:Wv});var tl=63710088e-1,sG={centimeters:tl*100,centimetres:tl*100,degrees:360/(2*Math.PI),feet:tl*3.28084,inches:tl*39.37,kilometers:tl/1e3,kilometres:tl/1e3,meters:tl,metres:tl,miles:tl/1609.344,millimeters:tl*1e3,millimetres:tl*1e3,nauticalmiles:tl/1852,radians:1,yards:tl*1.0936};function px(e,t,i={}){const a={type:"Feature"};return(i.id===0||i.id)&&(a.id=i.id),i.bbox&&(a.bbox=i.bbox),a.properties=t||{},a.geometry=e,a}function Wy(e,t,i={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!gP(e[0])||!gP(e[1]))throw new Error("coordinates must contain numbers");return px({type:"Point",coordinates:e},t,i)}function av(e,t,i={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return px({type:"LineString",coordinates:e},t,i)}function mP(e,t={}){const i={type:"FeatureCollection"};return t.id&&(i.id=t.id),t.bbox&&(i.bbox=t.bbox),i.features=e,i}function aG(e,t="kilometers"){const i=sG[t];if(!i)throw new Error(t+" units is invalid");return e*i}function Ww(e){return e%(2*Math.PI)*180/Math.PI}function Ku(e){return e%360*Math.PI/180}function gP(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function fS(e,t,i){if(e!==null)for(var a,c,h,f,o,b,P,I=0,D=0,z,F=e.type,U=F==="FeatureCollection",$=F==="Feature",j=U?e.features.length:1,ie=0;ie<j;ie++){P=U?e.features[ie].geometry:$?e.geometry:e,z=P?P.type==="GeometryCollection":!1,o=z?P.geometries.length:1;for(var se=0;se<o;se++){var Q=0,de=0;if(f=z?P.geometries[se]:P,f!==null){b=f.coordinates;var oe=f.type;switch(I=0,oe){case null:break;case"Point":if(t(b,D,ie,Q,de)===!1)return!1;D++,Q++;break;case"LineString":case"MultiPoint":for(a=0;a<b.length;a++){if(t(b[a],D,ie,Q,de)===!1)return!1;D++,oe==="MultiPoint"&&Q++}oe==="LineString"&&Q++;break;case"Polygon":case"MultiLineString":for(a=0;a<b.length;a++){for(c=0;c<b[a].length-I;c++){if(t(b[a][c],D,ie,Q,de)===!1)return!1;D++}oe==="MultiLineString"&&Q++,oe==="Polygon"&&de++}oe==="Polygon"&&Q++;break;case"MultiPolygon":for(a=0;a<b.length;a++){for(de=0,c=0;c<b[a].length;c++){for(h=0;h<b[a][c].length-I;h++){if(t(b[a][c][h],D,ie,Q,de)===!1)return!1;D++}de++}Q++}break;case"GeometryCollection":for(a=0;a<f.geometries.length;a++)if(fS(f.geometries[a],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function lG(e,t){var i,a,c,h,f,o,b,P,I,D,z=0,F=e.type==="FeatureCollection",U=e.type==="Feature",$=F?e.features.length:1;for(i=0;i<$;i++){for(o=F?e.features[i].geometry:U?e.geometry:e,P=F?e.features[i].properties:U?e.properties:{},I=F?e.features[i].bbox:U?e.bbox:void 0,D=F?e.features[i].id:U?e.id:void 0,b=o?o.type==="GeometryCollection":!1,f=b?o.geometries.length:1,c=0;c<f;c++){if(h=b?o.geometries[c]:o,h===null){if(t(null,z,P,I,D)===!1)return!1;continue}switch(h.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(h,z,P,I,D)===!1)return!1;break}case"GeometryCollection":{for(a=0;a<h.geometries.length;a++)if(t(h.geometries[a],z,P,I,D)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}z++}}function lR(e,t){lG(e,function(i,a,c,h,f){var o=i===null?null:i.type;switch(o){case null:case"Point":case"LineString":case"Polygon":return t(px(i,c,{bbox:h,id:f}),a,0)===!1?!1:void 0}var b;switch(o){case"MultiPoint":b="Point";break;case"MultiLineString":b="LineString";break;case"MultiPolygon":b="Polygon";break}for(var P=0;P<i.coordinates.length;P++){var I=i.coordinates[P],D={type:b,coordinates:I};if(t(px(D,c),a,P)===!1)return!1}})}function cG(e,t){lR(e,function(i,a,c){var h=0;if(i.geometry){var f=i.geometry.type;if(!(f==="Point"||f==="MultiPoint")){var o,b=0,P=0,I=0;if(fS(i,function(D,z,F,U,$){if(o===void 0||a>b||U>P||$>I){o=D,b=a,P=U,I=$,h=0;return}var j=av([o,D],i.properties);if(t(j,a,c,$,h)===!1)return!1;h++,o=D})===!1)return!1}}})}function uG(e,t,i){var a=i,c=!1;return cG(e,function(h,f,o,b,P){c===!1&&i===void 0?a=h:a=t(a,h,f,o,b,P),c=!0}),a}function Ub(e,t={}){if(e.bbox!=null&&t.recompute!==!0)return e.bbox;const i=[1/0,1/0,-1/0,-1/0];return fS(e,a=>{i[0]>a[0]&&(i[0]=a[0]),i[1]>a[1]&&(i[1]=a[1]),i[2]<a[0]&&(i[2]=a[0]),i[3]<a[1]&&(i[3]=a[1])}),i}function xf(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function hG(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function cR(e,t,i={}){if(i.final===!0)return dG(e,t);const a=xf(e),c=xf(t),h=Ku(a[0]),f=Ku(c[0]),o=Ku(a[1]),b=Ku(c[1]),P=Math.sin(f-h)*Math.cos(b),I=Math.cos(o)*Math.sin(b)-Math.sin(o)*Math.cos(b)*Math.cos(f-h);return Ww(Math.atan2(P,I))}function dG(e,t){let i=cR(t,e);return i=(i+180)%360,i}var pS=cR;if(!K.useState)throw new Error("mobx-react-lite requires React with Hooks support");if(!fV)throw new Error("mobx-react-lite@3 requires mobx at least version 6 to be available");function fG(e){e()}function pG(e){e||(e=fG),vA({reactionScheduler:e})}function mG(e){return iV(e)}var gG=1e4,yG=1e4,vG=function(){function e(t){var i=this;Object.defineProperty(this,"finalize",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"registrations",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"sweepTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sweep",{enumerable:!0,configurable:!0,writable:!0,value:function(a){a===void 0&&(a=gG),clearTimeout(i.sweepTimeout),i.sweepTimeout=void 0;var c=Date.now();i.registrations.forEach(function(h,f){c-h.registeredAt>=a&&(i.finalize(h.value),i.registrations.delete(f))}),i.registrations.size>0&&i.scheduleSweep()}}),Object.defineProperty(this,"finalizeAllImmediately",{enumerable:!0,configurable:!0,writable:!0,value:function(){i.sweep(0)}})}return Object.defineProperty(e.prototype,"register",{enumerable:!1,configurable:!0,writable:!0,value:function(t,i,a){this.registrations.set(a,{value:i,registeredAt:Date.now()}),this.scheduleSweep()}}),Object.defineProperty(e.prototype,"unregister",{enumerable:!1,configurable:!0,writable:!0,value:function(t){this.registrations.delete(t)}}),Object.defineProperty(e.prototype,"scheduleSweep",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.sweepTimeout===void 0&&(this.sweepTimeout=setTimeout(this.sweep,yG))}}),e}(),_G=typeof FinalizationRegistry<"u"?FinalizationRegistry:vG,Zw=new _G(function(e){var t;(t=e.reaction)===null||t===void 0||t.dispose(),e.reaction=null}),Gb={exports:{}},qb={};var yP;function xG(){if(yP)return qb;yP=1;var e=Ex();function t(D,z){return D===z&&(D!==0||1/D===1/z)||D!==D&&z!==z}var i=typeof Object.is=="function"?Object.is:t,a=e.useState,c=e.useEffect,h=e.useLayoutEffect,f=e.useDebugValue;function o(D,z){var F=z(),U=a({inst:{value:F,getSnapshot:z}}),$=U[0].inst,j=U[1];return h(function(){$.value=F,$.getSnapshot=z,b($)&&j({inst:$})},[D,F,z]),c(function(){return b($)&&j({inst:$}),D(function(){b($)&&j({inst:$})})},[D]),f(F),F}function b(D){var z=D.getSnapshot;D=D.value;try{var F=z();return!i(D,F)}catch{return!0}}function P(D,z){return z()}var I=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?P:o;return qb.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:I,qb}var vP;function bG(){return vP||(vP=1,Gb.exports=xG()),Gb.exports}var wG=bG();function _P(e){e.reaction=new oh("observer".concat(e.name),function(){var t;e.stateVersion=Symbol(),(t=e.onStoreChange)===null||t===void 0||t.call(e)})}function SG(e,t){t===void 0&&(t="observed");var i=hn.useRef(null);if(!i.current){var a={reaction:null,onStoreChange:null,stateVersion:Symbol(),name:t,subscribe:function(o){return Zw.unregister(a),a.onStoreChange=o,a.reaction||(_P(a),a.stateVersion=Symbol()),function(){var b;a.onStoreChange=null,(b=a.reaction)===null||b===void 0||b.dispose(),a.reaction=null}},getSnapshot:function(){return a.stateVersion}};i.current=a}var c=i.current;c.reaction||(_P(c),Zw.register(i,c,c)),hn.useDebugValue(c.reaction,mG),wG.useSyncExternalStore(c.subscribe,c.getSnapshot,c.getSnapshot);var h,f;if(c.reaction.track(function(){try{h=e()}catch(o){f=o}}),f)throw f;return h}var Hb,Wb,uR=typeof Symbol=="function"&&Symbol.for,CG=(Wb=(Hb=Object.getOwnPropertyDescriptor(function(){},"name"))===null||Hb===void 0?void 0:Hb.configurable)!==null&&Wb!==void 0?Wb:!1,xP=uR?Symbol.for("react.forward_ref"):typeof K.forwardRef=="function"&&K.forwardRef(function(e){return null}).$$typeof,bP=uR?Symbol.for("react.memo"):typeof K.memo=="function"&&K.memo(function(e){return null}).$$typeof;function fo(e,t){var i;if(bP&&e.$$typeof===bP)throw new Error("[mobx-react-lite] You are trying to use `observer` on a function component wrapped in either another `observer` or `React.memo`. The observer already applies 'React.memo' for you.");var a=(i=void 0)!==null&&i!==void 0?i:!1,c=e,h=e.displayName||e.name;if(xP&&e.$$typeof===xP&&(a=!0,c=e.render,typeof c!="function"))throw new Error("[mobx-react-lite] `render` property of ForwardRef was not a function");var f=function(o,b){return SG(function(){return c(o,b)},h)};return f.displayName=e.displayName,CG&&Object.defineProperty(f,"name",{value:e.name,writable:!0,configurable:!0}),e.contextTypes&&(f.contextTypes=e.contextTypes),a&&(f=K.forwardRef(f)),f=K.memo(f),MG(e,f),f}var TG={$$typeof:!0,render:!0,compare:!0,type:!0,displayName:!0};function MG(e,t){Object.keys(e).forEach(function(i){TG[i]||Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))})}var Zb;pG(Zu.unstable_batchedUpdates);Zb=Zw.finalizeAllImmediately;const PG=e=>(console.log("render destination markers",{highlighted:e.selectedDestinationNodeUid,dests:e.destinations}),G.jsx(G.Fragment,{children:e.destinations.map((t,i)=>G.jsx(ux,{longitude:t.lonLat[0],latitude:t.lonLat[1],style:{zIndex:e.selectedDestinationNodeUid===t.nodeUid?e.destinations.length:"auto"},children:G.jsx(Ia,{size:e.selectedDestinationNodeUid===t.nodeUid?"lg":"md",onClick:()=>e.onDestinationClick(t),sx:{width:"1em",height:"1em",border:1,backgroundColor:e.selectedDestinationNodeUid==null||e.selectedDestinationNodeUid===t.nodeUid?"primary":"#aaa",display:e.forceDisplay===!0||e.selectedDestinationNodeUid===t.nodeUid?void 0:"none"},children:i+1})},t.nodeUid))}));var Xb={exports:{}},Kb,wP;function hR(){return wP||(wP=1,Kb={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),Kb}var Yb={exports:{}},Jb,SP;function EG(){return SP||(SP=1,Jb=function(t){return!t||typeof t=="string"?!1:t instanceof Array||Array.isArray(t)||t.length>=0&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&t.constructor.name!=="String")}),Jb}var CP;function IG(){if(CP)return Yb.exports;CP=1;var e=EG(),t=Array.prototype.concat,i=Array.prototype.slice,a=Yb.exports=function(h){for(var f=[],o=0,b=h.length;o<b;o++){var P=h[o];e(P)?f=t.call(f,i.call(P)):f.push(P)}return f};return a.wrap=function(c){return function(){return c(a(arguments))}},Yb.exports}var TP;function kG(){if(TP)return Xb.exports;TP=1;var e=hR(),t=IG(),i=Object.hasOwnProperty,a=Object.create(null);for(var c in e)i.call(e,c)&&(a[e[c]]=c);var h=Xb.exports={to:{},get:{}};h.get=function(b){var P=b.substring(0,3).toLowerCase(),I,D;switch(P){case"hsl":I=h.get.hsl(b),D="hsl";break;case"hwb":I=h.get.hwb(b),D="hwb";break;default:I=h.get.rgb(b),D="rgb";break}return I?{model:D,value:I}:null},h.get.rgb=function(b){if(!b)return null;var P=/^#([a-f0-9]{3,4})$/i,I=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,D=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,z=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,F=/^(\w+)$/,U=[0,0,0,1],$,j,ie;if($=b.match(I)){for(ie=$[2],$=$[1],j=0;j<3;j++){var se=j*2;U[j]=parseInt($.slice(se,se+2),16)}ie&&(U[3]=parseInt(ie,16)/255)}else if($=b.match(P)){for($=$[1],ie=$[3],j=0;j<3;j++)U[j]=parseInt($[j]+$[j],16);ie&&(U[3]=parseInt(ie+ie,16)/255)}else if($=b.match(D)){for(j=0;j<3;j++)U[j]=parseInt($[j+1],0);$[4]&&($[5]?U[3]=parseFloat($[4])*.01:U[3]=parseFloat($[4]))}else if($=b.match(z)){for(j=0;j<3;j++)U[j]=Math.round(parseFloat($[j+1])*2.55);$[4]&&($[5]?U[3]=parseFloat($[4])*.01:U[3]=parseFloat($[4]))}else return($=b.match(F))?$[1]==="transparent"?[0,0,0,0]:i.call(e,$[1])?(U=e[$[1]],U[3]=1,U):null:null;for(j=0;j<3;j++)U[j]=f(U[j],0,255);return U[3]=f(U[3],0,1),U},h.get.hsl=function(b){if(!b)return null;var P=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,I=b.match(P);if(I){var D=parseFloat(I[4]),z=(parseFloat(I[1])%360+360)%360,F=f(parseFloat(I[2]),0,100),U=f(parseFloat(I[3]),0,100),$=f(isNaN(D)?1:D,0,1);return[z,F,U,$]}return null},h.get.hwb=function(b){if(!b)return null;var P=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,I=b.match(P);if(I){var D=parseFloat(I[4]),z=(parseFloat(I[1])%360+360)%360,F=f(parseFloat(I[2]),0,100),U=f(parseFloat(I[3]),0,100),$=f(isNaN(D)?1:D,0,1);return[z,F,U,$]}return null},h.to.hex=function(){var b=t(arguments);return"#"+o(b[0])+o(b[1])+o(b[2])+(b[3]<1?o(Math.round(b[3]*255)):"")},h.to.rgb=function(){var b=t(arguments);return b.length<4||b[3]===1?"rgb("+Math.round(b[0])+", "+Math.round(b[1])+", "+Math.round(b[2])+")":"rgba("+Math.round(b[0])+", "+Math.round(b[1])+", "+Math.round(b[2])+", "+b[3]+")"},h.to.rgb.percent=function(){var b=t(arguments),P=Math.round(b[0]/255*100),I=Math.round(b[1]/255*100),D=Math.round(b[2]/255*100);return b.length<4||b[3]===1?"rgb("+P+"%, "+I+"%, "+D+"%)":"rgba("+P+"%, "+I+"%, "+D+"%, "+b[3]+")"},h.to.hsl=function(){var b=t(arguments);return b.length<4||b[3]===1?"hsl("+b[0]+", "+b[1]+"%, "+b[2]+"%)":"hsla("+b[0]+", "+b[1]+"%, "+b[2]+"%, "+b[3]+")"},h.to.hwb=function(){var b=t(arguments),P="";return b.length>=4&&b[3]!==1&&(P=", "+b[3]),"hwb("+b[0]+", "+b[1]+"%, "+b[2]+"%"+P+")"},h.to.keyword=function(b){return a[b.slice(0,3)]};function f(b,P,I){return Math.min(Math.max(P,b),I)}function o(b){var P=Math.round(b).toString(16).toUpperCase();return P.length<2?"0"+P:P}return Xb.exports}var Qb,MP;function dR(){if(MP)return Qb;MP=1;const e=hR(),t={};for(const c of Object.keys(e))t[e[c]]=c;const i={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};Qb=i;for(const c of Object.keys(i)){if(!("channels"in i[c]))throw new Error("missing channels property: "+c);if(!("labels"in i[c]))throw new Error("missing channel labels property: "+c);if(i[c].labels.length!==i[c].channels)throw new Error("channel and label counts mismatch: "+c);const{channels:h,labels:f}=i[c];delete i[c].channels,delete i[c].labels,Object.defineProperty(i[c],"channels",{value:h}),Object.defineProperty(i[c],"labels",{value:f})}i.rgb.hsl=function(c){const h=c[0]/255,f=c[1]/255,o=c[2]/255,b=Math.min(h,f,o),P=Math.max(h,f,o),I=P-b;let D,z;P===b?D=0:h===P?D=(f-o)/I:f===P?D=2+(o-h)/I:o===P&&(D=4+(h-f)/I),D=Math.min(D*60,360),D<0&&(D+=360);const F=(b+P)/2;return P===b?z=0:F<=.5?z=I/(P+b):z=I/(2-P-b),[D,z*100,F*100]},i.rgb.hsv=function(c){let h,f,o,b,P;const I=c[0]/255,D=c[1]/255,z=c[2]/255,F=Math.max(I,D,z),U=F-Math.min(I,D,z),$=function(j){return(F-j)/6/U+1/2};return U===0?(b=0,P=0):(P=U/F,h=$(I),f=$(D),o=$(z),I===F?b=o-f:D===F?b=1/3+h-o:z===F&&(b=2/3+f-h),b<0?b+=1:b>1&&(b-=1)),[b*360,P*100,F*100]},i.rgb.hwb=function(c){const h=c[0],f=c[1];let o=c[2];const b=i.rgb.hsl(c)[0],P=1/255*Math.min(h,Math.min(f,o));return o=1-1/255*Math.max(h,Math.max(f,o)),[b,P*100,o*100]},i.rgb.cmyk=function(c){const h=c[0]/255,f=c[1]/255,o=c[2]/255,b=Math.min(1-h,1-f,1-o),P=(1-h-b)/(1-b)||0,I=(1-f-b)/(1-b)||0,D=(1-o-b)/(1-b)||0;return[P*100,I*100,D*100,b*100]};function a(c,h){return(c[0]-h[0])**2+(c[1]-h[1])**2+(c[2]-h[2])**2}return i.rgb.keyword=function(c){const h=t[c];if(h)return h;let f=1/0,o;for(const b of Object.keys(e)){const P=e[b],I=a(c,P);I<f&&(f=I,o=b)}return o},i.keyword.rgb=function(c){return e[c]},i.rgb.xyz=function(c){let h=c[0]/255,f=c[1]/255,o=c[2]/255;h=h>.04045?((h+.055)/1.055)**2.4:h/12.92,f=f>.04045?((f+.055)/1.055)**2.4:f/12.92,o=o>.04045?((o+.055)/1.055)**2.4:o/12.92;const b=h*.4124+f*.3576+o*.1805,P=h*.2126+f*.7152+o*.0722,I=h*.0193+f*.1192+o*.9505;return[b*100,P*100,I*100]},i.rgb.lab=function(c){const h=i.rgb.xyz(c);let f=h[0],o=h[1],b=h[2];f/=95.047,o/=100,b/=108.883,f=f>.008856?f**(1/3):7.787*f+16/116,o=o>.008856?o**(1/3):7.787*o+16/116,b=b>.008856?b**(1/3):7.787*b+16/116;const P=116*o-16,I=500*(f-o),D=200*(o-b);return[P,I,D]},i.hsl.rgb=function(c){const h=c[0]/360,f=c[1]/100,o=c[2]/100;let b,P,I;if(f===0)return I=o*255,[I,I,I];o<.5?b=o*(1+f):b=o+f-o*f;const D=2*o-b,z=[0,0,0];for(let F=0;F<3;F++)P=h+1/3*-(F-1),P<0&&P++,P>1&&P--,6*P<1?I=D+(b-D)*6*P:2*P<1?I=b:3*P<2?I=D+(b-D)*(2/3-P)*6:I=D,z[F]=I*255;return z},i.hsl.hsv=function(c){const h=c[0];let f=c[1]/100,o=c[2]/100,b=f;const P=Math.max(o,.01);o*=2,f*=o<=1?o:2-o,b*=P<=1?P:2-P;const I=(o+f)/2,D=o===0?2*b/(P+b):2*f/(o+f);return[h,D*100,I*100]},i.hsv.rgb=function(c){const h=c[0]/60,f=c[1]/100;let o=c[2]/100;const b=Math.floor(h)%6,P=h-Math.floor(h),I=255*o*(1-f),D=255*o*(1-f*P),z=255*o*(1-f*(1-P));switch(o*=255,b){case 0:return[o,z,I];case 1:return[D,o,I];case 2:return[I,o,z];case 3:return[I,D,o];case 4:return[z,I,o];case 5:return[o,I,D]}},i.hsv.hsl=function(c){const h=c[0],f=c[1]/100,o=c[2]/100,b=Math.max(o,.01);let P,I;I=(2-f)*o;const D=(2-f)*b;return P=f*b,P/=D<=1?D:2-D,P=P||0,I/=2,[h,P*100,I*100]},i.hwb.rgb=function(c){const h=c[0]/360;let f=c[1]/100,o=c[2]/100;const b=f+o;let P;b>1&&(f/=b,o/=b);const I=Math.floor(6*h),D=1-o;P=6*h-I,(I&1)!==0&&(P=1-P);const z=f+P*(D-f);let F,U,$;switch(I){default:case 6:case 0:F=D,U=z,$=f;break;case 1:F=z,U=D,$=f;break;case 2:F=f,U=D,$=z;break;case 3:F=f,U=z,$=D;break;case 4:F=z,U=f,$=D;break;case 5:F=D,U=f,$=z;break}return[F*255,U*255,$*255]},i.cmyk.rgb=function(c){const h=c[0]/100,f=c[1]/100,o=c[2]/100,b=c[3]/100,P=1-Math.min(1,h*(1-b)+b),I=1-Math.min(1,f*(1-b)+b),D=1-Math.min(1,o*(1-b)+b);return[P*255,I*255,D*255]},i.xyz.rgb=function(c){const h=c[0]/100,f=c[1]/100,o=c[2]/100;let b,P,I;return b=h*3.2406+f*-1.5372+o*-.4986,P=h*-.9689+f*1.8758+o*.0415,I=h*.0557+f*-.204+o*1.057,b=b>.0031308?1.055*b**(1/2.4)-.055:b*12.92,P=P>.0031308?1.055*P**(1/2.4)-.055:P*12.92,I=I>.0031308?1.055*I**(1/2.4)-.055:I*12.92,b=Math.min(Math.max(0,b),1),P=Math.min(Math.max(0,P),1),I=Math.min(Math.max(0,I),1),[b*255,P*255,I*255]},i.xyz.lab=function(c){let h=c[0],f=c[1],o=c[2];h/=95.047,f/=100,o/=108.883,h=h>.008856?h**(1/3):7.787*h+16/116,f=f>.008856?f**(1/3):7.787*f+16/116,o=o>.008856?o**(1/3):7.787*o+16/116;const b=116*f-16,P=500*(h-f),I=200*(f-o);return[b,P,I]},i.lab.xyz=function(c){const h=c[0],f=c[1],o=c[2];let b,P,I;P=(h+16)/116,b=f/500+P,I=P-o/200;const D=P**3,z=b**3,F=I**3;return P=D>.008856?D:(P-16/116)/7.787,b=z>.008856?z:(b-16/116)/7.787,I=F>.008856?F:(I-16/116)/7.787,b*=95.047,P*=100,I*=108.883,[b,P,I]},i.lab.lch=function(c){const h=c[0],f=c[1],o=c[2];let b;b=Math.atan2(o,f)*360/2/Math.PI,b<0&&(b+=360);const I=Math.sqrt(f*f+o*o);return[h,I,b]},i.lch.lab=function(c){const h=c[0],f=c[1],b=c[2]/360*2*Math.PI,P=f*Math.cos(b),I=f*Math.sin(b);return[h,P,I]},i.rgb.ansi16=function(c,h=null){const[f,o,b]=c;let P=h===null?i.rgb.hsv(c)[2]:h;if(P=Math.round(P/50),P===0)return 30;let I=30+(Math.round(b/255)<<2|Math.round(o/255)<<1|Math.round(f/255));return P===2&&(I+=60),I},i.hsv.ansi16=function(c){return i.rgb.ansi16(i.hsv.rgb(c),c[2])},i.rgb.ansi256=function(c){const h=c[0],f=c[1],o=c[2];return h===f&&f===o?h<8?16:h>248?231:Math.round((h-8)/247*24)+232:16+36*Math.round(h/255*5)+6*Math.round(f/255*5)+Math.round(o/255*5)},i.ansi16.rgb=function(c){let h=c%10;if(h===0||h===7)return c>50&&(h+=3.5),h=h/10.5*255,[h,h,h];const f=(~~(c>50)+1)*.5,o=(h&1)*f*255,b=(h>>1&1)*f*255,P=(h>>2&1)*f*255;return[o,b,P]},i.ansi256.rgb=function(c){if(c>=232){const P=(c-232)*10+8;return[P,P,P]}c-=16;let h;const f=Math.floor(c/36)/5*255,o=Math.floor((h=c%36)/6)/5*255,b=h%6/5*255;return[f,o,b]},i.rgb.hex=function(c){const f=(((Math.round(c[0])&255)<<16)+((Math.round(c[1])&255)<<8)+(Math.round(c[2])&255)).toString(16).toUpperCase();return"000000".substring(f.length)+f},i.hex.rgb=function(c){const h=c.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!h)return[0,0,0];let f=h[0];h[0].length===3&&(f=f.split("").map(D=>D+D).join(""));const o=parseInt(f,16),b=o>>16&255,P=o>>8&255,I=o&255;return[b,P,I]},i.rgb.hcg=function(c){const h=c[0]/255,f=c[1]/255,o=c[2]/255,b=Math.max(Math.max(h,f),o),P=Math.min(Math.min(h,f),o),I=b-P;let D,z;return I<1?D=P/(1-I):D=0,I<=0?z=0:b===h?z=(f-o)/I%6:b===f?z=2+(o-h)/I:z=4+(h-f)/I,z/=6,z%=1,[z*360,I*100,D*100]},i.hsl.hcg=function(c){const h=c[1]/100,f=c[2]/100,o=f<.5?2*h*f:2*h*(1-f);let b=0;return o<1&&(b=(f-.5*o)/(1-o)),[c[0],o*100,b*100]},i.hsv.hcg=function(c){const h=c[1]/100,f=c[2]/100,o=h*f;let b=0;return o<1&&(b=(f-o)/(1-o)),[c[0],o*100,b*100]},i.hcg.rgb=function(c){const h=c[0]/360,f=c[1]/100,o=c[2]/100;if(f===0)return[o*255,o*255,o*255];const b=[0,0,0],P=h%1*6,I=P%1,D=1-I;let z=0;switch(Math.floor(P)){case 0:b[0]=1,b[1]=I,b[2]=0;break;case 1:b[0]=D,b[1]=1,b[2]=0;break;case 2:b[0]=0,b[1]=1,b[2]=I;break;case 3:b[0]=0,b[1]=D,b[2]=1;break;case 4:b[0]=I,b[1]=0,b[2]=1;break;default:b[0]=1,b[1]=0,b[2]=D}return z=(1-f)*o,[(f*b[0]+z)*255,(f*b[1]+z)*255,(f*b[2]+z)*255]},i.hcg.hsv=function(c){const h=c[1]/100,f=c[2]/100,o=h+f*(1-h);let b=0;return o>0&&(b=h/o),[c[0],b*100,o*100]},i.hcg.hsl=function(c){const h=c[1]/100,o=c[2]/100*(1-h)+.5*h;let b=0;return o>0&&o<.5?b=h/(2*o):o>=.5&&o<1&&(b=h/(2*(1-o))),[c[0],b*100,o*100]},i.hcg.hwb=function(c){const h=c[1]/100,f=c[2]/100,o=h+f*(1-h);return[c[0],(o-h)*100,(1-o)*100]},i.hwb.hcg=function(c){const h=c[1]/100,o=1-c[2]/100,b=o-h;let P=0;return b<1&&(P=(o-b)/(1-b)),[c[0],b*100,P*100]},i.apple.rgb=function(c){return[c[0]/65535*255,c[1]/65535*255,c[2]/65535*255]},i.rgb.apple=function(c){return[c[0]/255*65535,c[1]/255*65535,c[2]/255*65535]},i.gray.rgb=function(c){return[c[0]/100*255,c[0]/100*255,c[0]/100*255]},i.gray.hsl=function(c){return[0,0,c[0]]},i.gray.hsv=i.gray.hsl,i.gray.hwb=function(c){return[0,100,c[0]]},i.gray.cmyk=function(c){return[0,0,0,c[0]]},i.gray.lab=function(c){return[c[0],0,0]},i.gray.hex=function(c){const h=Math.round(c[0]/100*255)&255,o=((h<<16)+(h<<8)+h).toString(16).toUpperCase();return"000000".substring(o.length)+o},i.rgb.gray=function(c){return[(c[0]+c[1]+c[2])/3/255*100]},Qb}var ew,PP;function AG(){if(PP)return ew;PP=1;const e=dR();function t(){const h={},f=Object.keys(e);for(let o=f.length,b=0;b<o;b++)h[f[b]]={distance:-1,parent:null};return h}function i(h){const f=t(),o=[h];for(f[h].distance=0;o.length;){const b=o.pop(),P=Object.keys(e[b]);for(let I=P.length,D=0;D<I;D++){const z=P[D],F=f[z];F.distance===-1&&(F.distance=f[b].distance+1,F.parent=b,o.unshift(z))}}return f}function a(h,f){return function(o){return f(h(o))}}function c(h,f){const o=[f[h].parent,h];let b=e[f[h].parent][h],P=f[h].parent;for(;f[P].parent;)o.unshift(f[P].parent),b=a(e[f[P].parent][P],b),P=f[P].parent;return b.conversion=o,b}return ew=function(h){const f=i(h),o={},b=Object.keys(f);for(let P=b.length,I=0;I<P;I++){const D=b[I];f[D].parent!==null&&(o[D]=c(D,f))}return o},ew}var tw,EP;function RG(){if(EP)return tw;EP=1;const e=dR(),t=AG(),i={},a=Object.keys(e);function c(f){const o=function(...b){const P=b[0];return P==null?P:(P.length>1&&(b=P),f(b))};return"conversion"in f&&(o.conversion=f.conversion),o}function h(f){const o=function(...b){const P=b[0];if(P==null)return P;P.length>1&&(b=P);const I=f(b);if(typeof I=="object")for(let D=I.length,z=0;z<D;z++)I[z]=Math.round(I[z]);return I};return"conversion"in f&&(o.conversion=f.conversion),o}return a.forEach(f=>{i[f]={},Object.defineProperty(i[f],"channels",{value:e[f].channels}),Object.defineProperty(i[f],"labels",{value:e[f].labels});const o=t(f);Object.keys(o).forEach(P=>{const I=o[P];i[f][P]=h(I),i[f][P].raw=c(I)})}),tw=i,tw}var rw,IP;function DG(){if(IP)return rw;IP=1;const e=kG(),t=RG(),i=["keyword","gray","hex"],a={};for(const z of Object.keys(t))a[[...t[z].labels].sort().join("")]=z;const c={};function h(z,F){if(!(this instanceof h))return new h(z,F);if(F&&F in i&&(F=null),F&&!(F in t))throw new Error("Unknown model: "+F);let U,$;if(z==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(z instanceof h)this.model=z.model,this.color=[...z.color],this.valpha=z.valpha;else if(typeof z=="string"){const j=e.get(z);if(j===null)throw new Error("Unable to parse color from string: "+z);this.model=j.model,$=t[this.model].channels,this.color=j.value.slice(0,$),this.valpha=typeof j.value[$]=="number"?j.value[$]:1}else if(z.length>0){this.model=F||"rgb",$=t[this.model].channels;const j=Array.prototype.slice.call(z,0,$);this.color=D(j,$),this.valpha=typeof z[$]=="number"?z[$]:1}else if(typeof z=="number")this.model="rgb",this.color=[z>>16&255,z>>8&255,z&255],this.valpha=1;else{this.valpha=1;const j=Object.keys(z);"alpha"in z&&(j.splice(j.indexOf("alpha"),1),this.valpha=typeof z.alpha=="number"?z.alpha:0);const ie=j.sort().join("");if(!(ie in a))throw new Error("Unable to parse color from object: "+JSON.stringify(z));this.model=a[ie];const{labels:se}=t[this.model],Q=[];for(U=0;U<se.length;U++)Q.push(z[se[U]]);this.color=D(Q)}if(c[this.model])for($=t[this.model].channels,U=0;U<$;U++){const j=c[this.model][U];j&&(this.color[U]=j(this.color[U]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}h.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(z){let F=this.model in e.to?this:this.rgb();F=F.round(typeof z=="number"?z:1);const U=F.valpha===1?F.color:[...F.color,this.valpha];return e.to[F.model](U)},percentString(z){const F=this.rgb().round(typeof z=="number"?z:1),U=F.valpha===1?F.color:[...F.color,this.valpha];return e.to.rgb.percent(U)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){const z={},{channels:F}=t[this.model],{labels:U}=t[this.model];for(let $=0;$<F;$++)z[U[$]]=this.color[$];return this.valpha!==1&&(z.alpha=this.valpha),z},unitArray(){const z=this.rgb().color;return z[0]/=255,z[1]/=255,z[2]/=255,this.valpha!==1&&z.push(this.valpha),z},unitObject(){const z=this.rgb().object();return z.r/=255,z.g/=255,z.b/=255,this.valpha!==1&&(z.alpha=this.valpha),z},round(z){return z=Math.max(z||0,0),new h([...this.color.map(o(z)),this.valpha],this.model)},alpha(z){return z!==void 0?new h([...this.color,Math.max(0,Math.min(1,z))],this.model):this.valpha},red:b("rgb",0,P(255)),green:b("rgb",1,P(255)),blue:b("rgb",2,P(255)),hue:b(["hsl","hsv","hsl","hwb","hcg"],0,z=>(z%360+360)%360),saturationl:b("hsl",1,P(100)),lightness:b("hsl",2,P(100)),saturationv:b("hsv",1,P(100)),value:b("hsv",2,P(100)),chroma:b("hcg",1,P(100)),gray:b("hcg",2,P(100)),white:b("hwb",1,P(100)),wblack:b("hwb",2,P(100)),cyan:b("cmyk",0,P(100)),magenta:b("cmyk",1,P(100)),yellow:b("cmyk",2,P(100)),black:b("cmyk",3,P(100)),x:b("xyz",0,P(95.047)),y:b("xyz",1,P(100)),z:b("xyz",2,P(108.833)),l:b("lab",0,P(100)),a:b("lab",1),b:b("lab",2),keyword(z){return z!==void 0?new h(z):t[this.model].keyword(this.color)},hex(z){return z!==void 0?new h(z):e.to.hex(this.rgb().round().color)},hexa(z){if(z!==void 0)return new h(z);const F=this.rgb().round().color;let U=Math.round(this.valpha*255).toString(16).toUpperCase();return U.length===1&&(U="0"+U),e.to.hex(F)+U},rgbNumber(){const z=this.rgb().color;return(z[0]&255)<<16|(z[1]&255)<<8|z[2]&255},luminosity(){const z=this.rgb().color,F=[];for(const[U,$]of z.entries()){const j=$/255;F[U]=j<=.04045?j/12.92:((j+.055)/1.055)**2.4}return .2126*F[0]+.7152*F[1]+.0722*F[2]},contrast(z){const F=this.luminosity(),U=z.luminosity();return F>U?(F+.05)/(U+.05):(U+.05)/(F+.05)},level(z){const F=this.contrast(z);return F>=7?"AAA":F>=4.5?"AA":""},isDark(){const z=this.rgb().color;return(z[0]*2126+z[1]*7152+z[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){const z=this.rgb();for(let F=0;F<3;F++)z.color[F]=255-z.color[F];return z},lighten(z){const F=this.hsl();return F.color[2]+=F.color[2]*z,F},darken(z){const F=this.hsl();return F.color[2]-=F.color[2]*z,F},saturate(z){const F=this.hsl();return F.color[1]+=F.color[1]*z,F},desaturate(z){const F=this.hsl();return F.color[1]-=F.color[1]*z,F},whiten(z){const F=this.hwb();return F.color[1]+=F.color[1]*z,F},blacken(z){const F=this.hwb();return F.color[2]+=F.color[2]*z,F},grayscale(){const z=this.rgb().color,F=z[0]*.3+z[1]*.59+z[2]*.11;return h.rgb(F,F,F)},fade(z){return this.alpha(this.valpha-this.valpha*z)},opaquer(z){return this.alpha(this.valpha+this.valpha*z)},rotate(z){const F=this.hsl();let U=F.color[0];return U=(U+z)%360,U=U<0?360+U:U,F.color[0]=U,F},mix(z,F){if(!z||!z.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof z);const U=z.rgb(),$=this.rgb(),j=F===void 0?.5:F,ie=2*j-1,se=U.alpha()-$.alpha(),Q=((ie*se===-1?ie:(ie+se)/(1+ie*se))+1)/2,de=1-Q;return h.rgb(Q*U.red()+de*$.red(),Q*U.green()+de*$.green(),Q*U.blue()+de*$.blue(),U.alpha()*j+$.alpha()*(1-j))}};for(const z of Object.keys(t)){if(i.includes(z))continue;const{channels:F}=t[z];h.prototype[z]=function(...U){return this.model===z?new h(this):U.length>0?new h(U,z):new h([...I(t[this.model][z].raw(this.color)),this.valpha],z)},h[z]=function(...U){let $=U[0];return typeof $=="number"&&($=D(U,F)),new h($,z)}}function f(z,F){return Number(z.toFixed(F))}function o(z){return function(F){return f(F,z)}}function b(z,F,U){z=Array.isArray(z)?z:[z];for(const $ of z)(c[$]||(c[$]=[]))[F]=U;return z=z[0],function($){let j;return $!==void 0?(U&&($=U($)),j=this[z](),j.color[F]=$,j):(j=this[z]().color[F],U&&(j=U(j)),j)}}function P(z){return function(F){return Math.max(0,Math.min(z,F))}}function I(z){return Array.isArray(z)?z:[z]}function D(z,F){for(let U=0;U<F;U++)typeof z[U]!="number"&&(z[U]=0);return z}return rw=h,rw}var zG=DG();const fR=Lv(zG),pR=ai(G.jsx("path",{d:"m9.78 11.16-1.42 1.42c-.68-.69-1.34-1.58-1.79-2.94l1.94-.49c.32.89.77 1.5 1.27 2.01M11 6 7 2 3 6h3.02c.02.81.08 1.54.19 2.17l1.94-.49C8.08 7.2 8.03 6.63 8.02 6zm10 0-4-4-4 4h2.99c-.1 3.68-1.28 4.75-2.54 5.88-.5.44-1.01.92-1.45 1.55-.34-.49-.73-.88-1.13-1.24L9.46 13.6c.93.85 1.54 1.54 1.54 3.4v5h2v-5c0-2.02.71-2.66 1.79-3.63 1.38-1.24 3.08-2.78 3.2-7.37z"})),OG=ai(G.jsx("path",{d:"M17.77 3.77 16 2 6 12l10 10 1.77-1.77L9.54 12z"})),LG=ai(G.jsx("path",{d:"m22.7 19-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4"})),mR=ai(G.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),FG=ai(G.jsx("path",{d:"m21.41 10.59-7.99-8c-.78-.78-2.05-.78-2.83 0l-8.01 8c-.78.78-.78 2.05 0 2.83l8.01 8c.78.78 2.05.78 2.83 0l7.99-8c.79-.79.79-2.05 0-2.83M13.5 14.5V12H10v3H8v-4c0-.55.45-1 1-1h4.5V7.5L17 11z"})),BG=ai(G.jsx("path",{d:"M20 21c-1.39 0-2.78-.47-4-1.32-2.44 1.71-5.56 1.71-8 0C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 2.52 1.29 5.48 1.29 8 0 1.26.65 2.62.99 4 .99h2v-2zM3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78zM6 6h12v3.97L12 8 6 9.97z"})),$G=ai(G.jsx("path",{d:"M20 9H4v2h16zM4 15h16v-2H4z"})),jG=ai([G.jsx("path",{d:"M13.95 13H9V8.05l5.61-5.61C13.78 2.16 12.9 2 12 2c-4.2 0-8 3.22-8 8.2 0 3.32 2.67 7.25 8 11.8 5.33-4.55 8-8.48 8-11.8 0-1.01-.16-1.94-.45-2.8z"},"0"),G.jsx("path",{d:"M11 11h2.12l6.16-6.16-2.12-2.12L11 8.88zm9.71-9L20 1.29c-.2-.19-.45-.29-.71-.29-.13 0-.48.07-.71.29l-.72.72 2.12 2.12.72-.72c.4-.39.4-1.02.01-1.41"},"1")]),NG=ai(G.jsx("path",{d:"M12 2c-4.2 0-8 3.22-8 8.2 0 3.32 2.67 7.25 8 11.8 5.33-4.55 8-8.48 8-11.8C20 5.22 16.2 2 12 2m0 10c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"})),VG=ai(G.jsx("path",{d:"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5m0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5m0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5M7 19h14v-2H7zm0-6h14v-2H7zm0-8v2h14V5z"})),UG=ai(G.jsx("path",{d:"m12 5.69 5 4.5V18h-2v-6H9v6H7v-7.81zM12 3 2 12h3v8h6v-6h2v6h6v-8h3z"})),GG=ai(G.jsx("path",{d:"M7 13c1.66 0 3-1.34 3-3S8.66 7 7 7s-3 1.34-3 3 1.34 3 3 3m12-6h-8v7H3V5H1v15h2v-3h18v3h2v-9c0-2.21-1.79-4-4-4"})),qG=ai(G.jsx("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"})),HG=ai(G.jsx("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"})),WG=ai([G.jsx("path",{d:"M6 17.59 7.41 19 12 14.42 16.59 19 18 17.59l-6-6z"},"0"),G.jsx("path",{d:"m6 11 1.41 1.41L12 7.83l4.59 4.58L18 11l-6-6z"},"1")]),ZG=ai(G.jsx("path",{d:"m19.77 7.23.01-.01-3.72-3.72L15 4.56l2.11 2.11c-.94.36-1.61 1.26-1.61 2.33 0 1.38 1.12 2.5 2.5 2.5.36 0 .69-.08 1-.21v7.21c0 .55-.45 1-1 1s-1-.45-1-1V14c0-1.1-.9-2-2-2h-1V5c0-1.1-.9-2-2-2H6c-1.1 0-2 .9-2 2v16h10v-7.5h1.5v5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V9c0-.69-.28-1.32-.73-1.77M12 10H6V5h6zm6 0c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"})),gR=ai(G.jsx("path",{d:"M20 8h-3V4H3c-1.1 0-2 .9-2 2v11h2c0 1.66 1.34 3 3 3s3-1.34 3-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3h2v-5zM6 18.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5m13.5-9 1.96 2.5H17V9.5zm-1.5 9c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"})),XG=ai(G.jsx("path",{d:"M15 11V5l-3-3-3 3v2H3v14h18V11zm-8 8H5v-2h2zm0-4H5v-2h2zm0-4H5V9h2zm6 8h-2v-2h2zm0-4h-2v-2h2zm0-4h-2V9h2zm0-4h-2V5h2zm6 12h-2v-2h2zm0-4h-2v-2h2z"})),KG=ai(G.jsx("path",{d:"M12 2 4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"})),YG=ai(G.jsx("path",{d:"m12 7.27 4.28 10.43-3.47-1.53-.81-.36-.81.36-3.47 1.53zM12 2 4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"})),JG=ai(G.jsx("path",{d:"M2 18v4h3v-2h5.5v2h3v-2H19v2h3v-4zM18 2H6c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1m-3 6H9V6h6z"})),QG=ai([G.jsx("circle",{cx:"10",cy:"8",r:"4"},"0"),G.jsx("path",{d:"M10.35 14.01C7.62 13.91 2 15.27 2 18v2h9.54c-2.47-2.76-1.23-5.89-1.19-5.99m9.08 4.01c.36-.59.57-1.28.57-2.02 0-2.21-1.79-4-4-4s-4 1.79-4 4 1.79 4 4 4c.74 0 1.43-.22 2.02-.57L20.59 22 22 20.59zM16 18c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"},"1")]),eq=ai(G.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"})),tq=ai(G.jsx("path",{d:"M12 12c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m6-1.8C18 6.57 15.35 4 12 4s-6 2.57-6 6.2c0 2.34 1.95 5.44 6 9.14 4.05-3.7 6-6.8 6-9.14M12 2c4.2 0 8 3.22 8 8.2 0 3.32-2.67 7.25-8 11.8-5.33-4.55-8-8.48-8-11.8C4 5.22 7.8 2 12 2"})),mS=ai(G.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"})),rq=ai(G.jsx("path",{d:"M15 4c-4.42 0-8 3.58-8 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8m0 14c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6M3 12c0-2.61 1.67-4.83 4-5.65V4.26C3.55 5.15 1 8.27 1 12s2.55 6.85 6 7.74v-2.09c-2.33-.82-4-3.04-4-5.65"})),nq=ai(G.jsx("path",{d:"m20.55 5.22-1.39-1.68C18.88 3.21 18.47 3 18 3H6c-.47 0-.88.21-1.15.55L3.46 5.22C3.17 5.57 3 6.01 3 6.5V19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6.5c0-.49-.17-.93-.45-1.28M12 9.5l5.5 5.5H14v2h-4v-2H6.5zM5.12 5l.82-1h12l.93 1z"}));var Lp=(e=>(e[e.COMPANY=0]="COMPANY",e[e.FUEL=1]="FUEL",e[e.REST=2]="REST",e[e.SERVICE=3]="SERVICE",e[e.DEALER=4]="DEALER",e[e.RECRUITING=5]="RECRUITING",e))(Lp||{}),B_=(e=>(e[e.NEARBY=0]="NEARBY",e[e.ROUTE=1]="ROUTE",e))(B_||{}),fr=(e=>(e[e.THROUGH=0]="THROUGH",e[e.SLIGHT_LEFT=1]="SLIGHT_LEFT",e[e.LEFT=2]="LEFT",e[e.SHARP_LEFT=3]="SHARP_LEFT",e[e.U_TURN_LEFT=4]="U_TURN_LEFT",e[e.SLIGHT_RIGHT=11]="SLIGHT_RIGHT",e[e.RIGHT=12]="RIGHT",e[e.SHARP_RIGHT=13]="SHARP_RIGHT",e[e.U_TURN_RIGHT=14]="U_TURN_RIGHT",e[e.MERGE=-1]="MERGE",e[e.DEPART=-2]="DEPART",e[e.ARRIVE=-3]="ARRIVE",e[e.FERRY=-4]="FERRY",e))(fr||{});const g1=e=>{const{branches:t,activeBranch:i,highlightColor:a="#000",dimColor:c="#ccc"}=e,h=[...t].sort((I,D)=>I===i?1:D===i?-1:0),f=h.some(I=>0<Number(I)&&Number(I)<10),o=h.some(I=>Number(I)>=10),b=h.length===1?"single":f&&!o?"left":o&&!f?"right":"left-and-right",P=h.map((I,D)=>{switch(I){case fr.THROUGH:{let z,F;switch(b){case"single":z=0;break;case"left-and-right":F=-1;break;case"left":z=2,F=-1;break;case"right":z=-2,F=-1;break;default:throw new Uo(b)}return G.jsx(iq,{offsetX:z,offsetY:F,color:I===i?a:c},D)}case fr.SLIGHT_LEFT:case fr.SLIGHT_RIGHT:{let z,F,U;const $=fr.SLIGHT_LEFT&&t.includes(fr.LEFT)||fr.SLIGHT_RIGHT&&t.includes(fr.RIGHT);switch(b){case"single":z=0;break;case"left-and-right":{z=I===fr.SLIGHT_LEFT?-2:2,F=t.includes(fr.THROUGH)?void 0:$?10:9;break}case"left":case"right":F=t.includes(fr.THROUGH)?void 0:9;break;default:throw new Uo(b)}return G.jsx(oq,{offsetX:z,stemLength:F,angleLeg:U,orientation:I===fr.SLIGHT_LEFT?"left":"right",color:I===i?a:c},D)}case fr.LEFT:case fr.RIGHT:{let z,F,U,$;const j=I===fr.LEFT&&t.includes(fr.SLIGHT_LEFT)||I===fr.RIGHT&&t.includes(fr.SLIGHT_RIGHT);switch(b){case"single":z=0;break;case"left-and-right":z=I===fr.LEFT?-4:4,F=j?9:10,U=10,$=t.includes(fr.THROUGH)?4:void 0;break;case"left":case"right":z=b==="left"?-2:2,F=j?9:10,U=10,$=t.includes(fr.THROUGH)?4:void 0;break;default:throw new Uo(b)}return G.jsx(sq,{offsetX:z,stemLength:F,endLength:U,radius:$,orientation:I===fr.LEFT?"left":"right",color:I===i?a:c},D)}case fr.SHARP_LEFT:case fr.SHARP_RIGHT:{let z,F,U;const $=I===fr.SHARP_LEFT&&t.includes(fr.SLIGHT_LEFT)||I===fr.SHARP_RIGHT&&t.includes(fr.SLIGHT_RIGHT);switch(b){case"single":z=0,F=11,U=9,$||F++;break;case"left-and-right":z=I===fr.SHARP_LEFT?-2:2,(I===fr.SHARP_LEFT&&!t.includes(fr.LEFT)||I===fr.SHARP_RIGHT&&!t.includes(fr.RIGHT))&&(F=9,U=8),$||(F=F==null?9:F+1);break;case"left":case"right":t.length===2&&t.includes(fr.THROUGH)&&(F=10,U=9),$||(F=F==null?9:F+1);break;default:throw new Uo(b)}return G.jsx(aq,{offsetX:z,stemLength:F,angleLeg:U,orientation:I===fr.SHARP_LEFT?"left":"right",color:I===i?a:c},D)}case fr.U_TURN_LEFT:case fr.U_TURN_RIGHT:{let z,F,U,$,j;const ie=I===fr.U_TURN_LEFT&&t.includes(fr.LEFT)||I===fr.U_TURN_RIGHT&&t.includes(fr.RIGHT);switch(b){case"single":break;case"left-and-right":z=I===fr.U_TURN_LEFT?-5:5,U=6,j=4,$=3.5,F=-1,ie&&($--,j+=2);break;case"left":case"right":z=I===fr.U_TURN_LEFT?-3:3,F=-1,U=6,j=4,$=3.5,ie&&($--,j+=2);break;default:throw new Uo(b)}return G.jsx(lq,{offsetX:z,offsetY:F,stemLength:U,radius:$,endLength:j,orientation:I===fr.U_TURN_LEFT?"left":"right",color:I===i?a:c},D)}case fr.MERGE:return Np(t.length===1,"MERGE must appear alone"),G.jsx(cq,{color:I===i?a:c},D);case fr.DEPART:return Np(t.length===1,"DEPART must appear alone"),G.jsx(WG,{viewBox:"-5 -5 34 34",style:{fill:c}},D);case fr.ARRIVE:return Np(t.length===1,"ARRIVE must appear alone"),G.jsx(tq,{viewBox:"-5 -5 34 34",style:{fill:c}},D);case fr.FERRY:return Np(t.length===1,"FERRY must appear alone"),G.jsx(BG,{viewBox:"-5 -5 34 34",style:{fill:c}},D);default:throw new Uo(I)}});return G.jsxs("svg",{viewBox:"0 0 24 24",children:[G.jsx("defs",{children:G.jsx("g",{id:"arrow","transform-origin":"0 0",transform:"translate(0,1.414) rotate(135) ",children:G.jsx("path",{fill:"none",strokeWidth:"2",d:"M0,-4 0,0 4,0"})})}),P]})},iq=e=>{const t=[12,21],{color:i="black",orientation:a="left",offsetX:c=0,offsetY:h=0,stemLength:f=18}=e,o=[t[0],t[1]-f];return G.jsxs("g",{stroke:i,"transform-origin":"12 12",transform:`translate(${c}, ${h})scale(${a==="left"?"":"-"}1, 1)`,children:[G.jsx("path",{fill:"none",strokeWidth:"2",d:`M${t.join()} v-${f-1.414}`}),G.jsx("use",{href:"#arrow",x:o[0],y:o[1]})]})},oq=e=>{const t=[14,20],{color:i="black",orientation:a="left",offsetX:c=0,offsetY:h=0,stemLength:f=8,angleLeg:o=8}=e,b=[t[0]-o,t[1]-f-o];return G.jsxs("g",{stroke:i,"transform-origin":"12 12",transform:`translate(${c}, ${h})scale(${a==="left"?"":"-"}1, 1)`,children:[G.jsx("path",{fill:"none",strokeWidth:"2",strokeLinejoin:"round",d:`M${t.join()}v-${f}l-${o-1.414},-${o-1.414}`}),G.jsx("use",{href:"#arrow","transform-origin":b.join(" "),transform:"rotate(-45)",x:b[0],y:b[1]})]})},sq=e=>{const t=[16,20],{color:i="black",orientation:a="left",offsetX:c=0,offsetY:h=0,stemLength:f=10,radius:o=1,endLength:b=12}=e,P=[t[0]-b,t[1]-f];return G.jsxs("g",{stroke:i,"transform-origin":"12 12",transform:`translate(${c}, ${h})scale(${a==="left"?"":"-"}1, 1)`,children:[G.jsx("path",{fill:"none",strokeWidth:"2",d:`M${t.join()}v-${f-o}a${o} ${o} 0 0 0 -${o},-${o}h-${b-o-1.414}`}),G.jsx("use",{href:"#arrow",x:P[0],y:P[1],"transform-origin":P.join(" "),transform:"rotate(-90)"})]})},aq=e=>{const t=[14,20],{color:i="black",orientation:a="left",offsetX:c=0,offsetY:h=0,stemLength:f=8,angleLeg:o=8}=e,b=[t[0]-o,t[1]-f+o];return G.jsxs("g",{stroke:i,"transform-origin":"12 12",transform:`translate(${c}, ${h})scale(${a==="left"?"":"-"}1, 1)`,children:[G.jsx("path",{fill:"none",strokeWidth:"2",strokeLinejoin:"round",d:`M${t.join()}v-${f}l-${o-1.414},${o-1.414}`}),G.jsx("use",{href:"#arrow",x:b[0],y:b[1],"transform-origin":b.join(" "),transform:"rotate(-135)"})]})},lq=e=>{const t=[17,21],{color:i="black",orientation:a="left",offsetX:c=0,offsetY:h=0,stemLength:f=12,radius:o=5,endLength:b=8}=e,P=[t[0]-o*2,t[1]-f+b];return G.jsxs("g",{stroke:i,"transform-origin":"12 12",transform:`translate(${c}, ${h})scale(${a==="left"?"":"-"}1, 1)`,children:[G.jsx("path",{fill:"none",strokeWidth:"2",strokeLinejoin:"round",d:`M${t.join()} v-${f}a${o} ${o} 0 1 0 -${o*2},0v${b-1.414}`}),G.jsx("use",{href:"#arrow",x:P[0],y:P[1],"transform-origin":P.join(" "),transform:"rotate(180)"})]})},cq=e=>{const{color:t="black",offsetX:i=0,offsetY:a=0,stemLength:c=11,baseLeg:h=6}=e,f=[12,3];return G.jsxs("g",{stroke:t,"transform-origin":"12 12",transform:`translate(${i}, ${a})`,children:[G.jsx("path",{fill:"none",strokeWidth:"2",d:`M${f[0]},${f[1]+1.414}V${f[1]+c}l-${h},${h}m${h},-${h}l${h},${h}`}),G.jsx("use",{href:"#arrow",x:f[0],y:f[1]})]})},mx=fR("hsl(151,82%,35%)"),uq=K.memo(e=>{console.log("render Directions");const t=!!e.laneHint||!!e.thenHint,{length:i,unit:a}=e;return G.jsxs(dn,{fontSize:"0.75rem",children:[G.jsx(dn,{direction:"row",alignItems:"center",px:2,py:1,spacing:2,bgcolor:mx.string(),borderRadius:t?"1em 1em 1em 0":"1em",children:G.jsxs(dn,{children:[G.jsxs(dn,{direction:"row",alignItems:"center",gap:1,children:[G.jsx(ei,{width:"6em",children:G.jsx(g1,{branches:[e.direction],dimColor:"#fff"})}),G.jsxs(Wr,{level:"h1",textColor:"#fff",textAlign:"center",display:"block",children:[i," ",a]})]}),e.banner&&G.jsx(Wr,{level:"h2",fontWeight:"normal",textColor:"#fff",children:e.banner.text})]})}),e.laneHint?G.jsx(hq,{roundBottomLeft:!e.thenHint,hint:e.laneHint}):null,e.thenHint&&G.jsx(dq,{hint:e.thenHint})]})}),hq=e=>G.jsx(ei,{children:G.jsx(dn,{display:"inline-flex",direction:"row",height:"5em",px:2,py:1,spacing:.5,divider:G.jsx(Xg,{orientation:"vertical",sx:{"--Divider-lineColor":"#fffc",height:"calc(0.75em)",alignSelf:"end",bottom:"-0.5em"}}),sx:{justifyContent:"center"},bgcolor:mx.darken(.33).string(),borderRadius:`0 0 1em ${e.roundBottomLeft?"1em":0}`,children:e.hint.lanes.map(({branches:t,activeBranch:i},a)=>G.jsx(ei,{width:44,children:G.jsx(g1,{branches:t,activeBranch:i,dimColor:mx.mix(fR("gray"),.5).string(),highlightColor:"#fff"})},a))})}),dq=e=>G.jsx(ei,{children:G.jsxs(dn,{display:"inline-flex",alignItems:"center",direction:"row",height:"5em",px:2,py:1,spacing:1,bgcolor:mx.darken(.33).string(),borderRadius:"0 0 1em 1em",children:[G.jsx(Wr,{textColor:"#fff",level:"body-lg",children:"Then"}),G.jsx(ei,{width:"2.5em",height:"2.5em",children:G.jsx(g1,{branches:[e.hint.direction],activeBranch:e.hint.direction,highlightColor:"#fff"})})]})}),fq={light:{background:"rgba(255,255,255,0.9)",fill:"hsl(204,100%,50%)"},dark:{background:"hsl(204,100%,50%)",fill:"rgba(255,255,255,1)"}},pq=K.forwardRef((e,t)=>{const{mode:i="light"}=e,{background:a,fill:c}=fq[i];return G.jsx(ux,{ref:t,longitude:e.longitude??0,latitude:e.latitude??0,pitchAlignment:"map",rotationAlignment:"map",children:G.jsx(ei,{sx:{width:64,height:64,display:"flex",justifyContent:"center",alignItems:"center",background:a,borderRadius:"50%",boxShadow:"0 1px 1px 1px rgba(128,128,128,.2)"},children:G.jsx(KG,{sx:{transform:"scale(2)",fill:c}})})})});function Yp(e,t={abbreviateUnits:!0,units:"imperial",forceSingular:!1}){const{abbreviateUnits:i,units:a,forceSingular:c}=t;if(a==="metric")throw new Error("metric units currently unsupported");const h=e*.0006213712;let f;if(h<=.1){const o=Math.max(1,e*3.28084),b=Math.round(o/50)*50;f={length:b,unit:i?"ft":c||b===1?"foot":"feet"}}else if(h<=1){const o=Number(h.toPrecision(1));f={length:o,unit:i?"mi":c||o===1?"mile":"miles"}}else h<=10?f={length:Number(h.toPrecision(2)),unit:i?"mi":c?"mile":"miles"}:f={length:Math.round(h),unit:i?"mi":c?"mile":"miles"};return{...f,string:`${f.length.toLocaleString(void 0,{maximumFractionDigits:2})} ${f.unit}`}}function gS(e,t={abbreviateUnits:!0,forceSingular:!1}){const{forceSingular:i}=t,a=t.abbreviateUnits?{plural:"hr",singular:"hr"}:{plural:"hours",singular:"hour"},c=t.abbreviateUnits?{plural:"min",singular:"min"}:{plural:"minutes",singular:"minute"},h=Math.floor(e/3600),f=Math.ceil(e%3600/60),o=[];h&&o.push(h===1?`1 ${a.singular}`:`${h} ${i?a.singular:a.plural}`),o.push(f===1?`1 ${c.singular}`:`${f} ${i?c.singular:c.plural}`);const b=t.abbreviateUnits?o.join(" "):o.join(", ");return{hours:h,minutes:f,string:b}}function mq(e){const t=[];if(e.laneHint?.lanes.length){const c=e.laneHint.lanes,h=c.every(b=>b.activeBranch!=null);let f=0;for(const b of c){if(b.activeBranch!=null){f++;continue}break}let o=0;for(const b of c.toReversed()){if(b.activeBranch!=null){o++;continue}break}if(h)t.push("use any lane to");else if(f>1)e.direction===fr.THROUGH?t.push("keep left to"):t.push(`use the ${f} left lanes to`);else if(o>1)e.direction===fr.THROUGH?t.push("keep right to"):t.push(`use the ${o} right lanes to`);else if(f===1)e.direction===fr.THROUGH?t.push("keep left to"):t.push("use the left lane to");else if(o===1)e.direction===fr.THROUGH?t.push("keep right to"):t.push("use the right lane to");else{const b=[];for(let P=0;P<c.length;P++)c[P].activeBranch!=null&&b.push(P);if(Np(b.length>0),b.length===1){const P=b[0]+1;P<=c.length/2?t.push(`use the ${kP(P)} lane from the left to`):t.push(`use the ${kP(c.length-P+1)} lane from the right to`)}}}let i="none";if(e.banner?.text!=null&&(i=e.banner.text.toLowerCase().startsWith("exit")?"exit":"name"),i==="exit")t.push("take"),t.push(e.banner.text.toLowerCase());else switch(e.direction){case fr.THROUGH:t.push("continue straight");break;case fr.SLIGHT_LEFT:t.push("turn slightly left");break;case fr.LEFT:t.push("turn left");break;case fr.SHARP_LEFT:t.push("turn sharply left");break;case fr.SLIGHT_RIGHT:t.push("turn slightly right");break;case fr.RIGHT:t.push("turn right");break;case fr.SHARP_RIGHT:t.push("turn sharply right");break;case fr.U_TURN_LEFT:case fr.U_TURN_RIGHT:t.push("make a U-turn");break;case fr.MERGE:t.push("merge");break;case fr.DEPART:t.push("follow the route");break;case fr.ARRIVE:t.push(`arrive at ${i!=="none"?e.banner.text:"your destination"}`);break;case fr.FERRY:t.push(`take the ferry to ${Ca(e.banner).text}`);break;default:throw new Uo(e.direction)}i==="name"&&e.direction!==fr.ARRIVE&&e.direction!==fr.FERRY&&(t.push("onto"),t.push(e.banner.text));const a=t.join(" ");return a.charAt(0).toUpperCase()+a.slice(1)}function kP(e){const t=["th","st","nd","rd"],i=e%100;return e+(t[(i-20)%10]||t[i]||t[0])}function gq(e,t){return t.distance<=250||e.startsWith(t.name)||e.endsWith(t.name)?0:t.distance<=1e3?1:2}function Xw(e){switch(e.type){case"city":case"scenery":return`${e.label}, ${e.stateCode}`;case"company":case"landmark":case"viewpoint":case"ferry":case"train":case"dealer":case"facility":{const t=gq(e.label,e.city);switch(t){case 0:return`${e.city.name}, ${e.stateCode}`;case 1:return`near ${e.city.name}, ${e.stateCode}`;case 2:return`${e.stateName}`;default:throw new Uo(t)}}default:throw new Uo(e)}}const yq=e=>{console.log("render route controls");const{summary:{minutes:t,distance:i}}=e,[a,c]=K.useState(!1),h=a?qG:HG,f=K.useCallback(()=>{c(!a),e.onExpandedToggle(!a)},[a]),o=D=>()=>{D(),c(!1),e.onExpandedToggle(!1)},b=gS(t*60),P=new Date(Date.now()+t*6e4),I=new Intl.DateTimeFormat("en-US",{timeStyle:"short"}).format(P);return G.jsxs(Hv,{sx:{boxShadow:"rgba(0, 0, 0, 0.2) 0px 3px 5px -1px, rgba(0, 0, 0, 0.14) 0px 6px 10px 0px, rgba(0, 0, 0, 0.12) 0px 1px 18px 0px",borderRadius:12,pb:a?2:0,height:"100%"},children:[G.jsxs(dn,{direction:"row",spacing:2,sx:{justifyContent:"space-between",alignItems:"center"},children:[G.jsxs(dn,{alignItems:"center",children:[G.jsx(Wr,{level:"h3",fontWeight:"bold",children:I}),G.jsx(Wr,{children:"arrival"})]}),G.jsxs(dn,{alignItems:"center",children:[G.jsxs(Wr,{level:"h3",children:[b.hours,":",b.minutes<10?`0${b.minutes}`:b.minutes]}),G.jsx(Wr,{children:t<60?"minutes":"hours"})]}),G.jsxs(dn,{alignItems:"center",children:[G.jsx(Wr,{level:"h3",children:i.length}),G.jsx(Wr,{children:i.unit})]}),G.jsx(sd,{size:"lg",variant:"soft",onClick:f,children:G.jsx(h,{sx:{transform:"scale(1.25)"}})})]}),G.jsx(ei,{overflow:"scroll",children:G.jsx(vq,{expanded:a,onManageStopsClick:e.onManageStopsClick?o(e.onManageStopsClick):void 0,onSearchAlongRouteClick:o(e.onSearchAlongRouteClick),onRoutePreviewClick:o(e.onRoutePreviewClick),onRouteDirectionsClick:o(e.onRouteDirectionsClick),onRouteEndClick:o(e.onRouteEndClick)})})]})},vq=({expanded:e,onManageStopsClick:t,onSearchAlongRouteClick:i,onRoutePreviewClick:a,onRouteDirectionsClick:c,onRouteEndClick:h})=>{const f=K.useRef();return K.useEffect(()=>{e&&setTimeout(()=>{f.current?.scrollIntoView({behavior:"smooth",block:"end"})},250)},[e]),G.jsx(Kp,{in:e,children:G.jsxs(rm,{size:"lg",children:[t&&G.jsxs(G.Fragment,{children:[G.jsx(yf,{}),G.jsx(ll,{children:G.jsxs($p,{onClick:t,children:[G.jsx(Kc,{children:G.jsx(jG,{sx:{transform:"scale(1.25)"}})}),"Manage Stops"]})})]}),G.jsx(yf,{}),G.jsx(ll,{children:G.jsxs($p,{onClick:i,children:[G.jsx(Kc,{children:G.jsx(mS,{sx:{transform:"scale(1.25)"}})}),"Search along route"]})}),G.jsx(yf,{}),G.jsx(ll,{children:G.jsxs($p,{onClick:a,children:[G.jsx(Kc,{children:G.jsx(pR,{sx:{transform:"scale(1.25)"}})}),"Preview route"]})}),G.jsx(yf,{}),G.jsx(ll,{children:G.jsxs($p,{onClick:c,children:[G.jsx(Kc,{children:G.jsx(VG,{sx:{transform:"scale(1.25)"}})}),"Directions"]})}),G.jsx(yf,{}),G.jsx(Ia,{sx:{mt:2},size:"lg",color:"danger",onClick:h,children:"End Route"}),G.jsx(ei,{ref:f})]})})};function _q(){const[e,t]=K.useState({width:null,height:null}),i=K.useRef(null);return[K.useCallback(c=>{if(i.current&&(i.current.disconnect(),i.current=null),c?.nodeType===Node.ELEMENT_NODE){const h=new ResizeObserver(([f])=>{if(f&&f.borderBoxSize){const{inlineSize:o,blockSize:b}=f.borderBoxSize[0];t({width:o,height:b})}});h.observe(c),i.current=h}},[]),e]}const xq=e=>{const{Guidance:t,RouteControls:i,SegmentCompleteToast:a}=e,[c,{height:h}]=_q(),[f,o]=K.useState(!1),b=(h??0)<520;return G.jsx(ei,{ref:c,height:"100%",children:G.jsxs(dn,{height:"100%",style:{transition:"all 0.5s ease",position:"relative"},justifyContent:"space-between",children:[G.jsx(ei,{sx:{pointerEvents:"auto"},children:G.jsx(dS,{in:!b||!f,appear:!1,children:G.jsx(ei,{children:G.jsx(Kp,{in:!b||!f,appear:!1,children:G.jsx(t,{})})})})}),G.jsx(ei,{sx:{pointerEvents:"auto",maxHeight:`calc(${h}px - 1em)`},children:G.jsx(i,{onExpandedToggle:o})}),G.jsx(a,{})]})})},bq=e=>G.jsxs(qB,{open:e.open,anchorOrigin:{horizontal:"center",vertical:"bottom"},sx:{flexDirection:"column",width:"100%",position:"absolute",bottom:0,pointerEvents:"auto"},children:[G.jsxs(dn,{gap:1,width:"100%",children:[G.jsx(Wr,{level:"h3",children:"You have arrived"}),G.jsxs(Wr,{level:"h4",color:"neutral",children:[e.place," ",G.jsx(Wr,{color:"neutral",children:e.placeInfo})]})]}),G.jsxs(dn,{gap:1,width:"100%",children:[!e.isFinalSegment&&G.jsx(Ia,{size:"lg",onClick:e.onContinueClick,children:"Continue"}),G.jsx(Ia,{size:"lg",variant:e.isFinalSegment?"solid":"outlined",onClick:e.onEndClick,children:"End Trip"})]})]}),wq=e=>{if(console.log("render trailer or waypoints"),e.trailerPoint)return G.jsx(ux,{color:"#0c0",longitude:e.trailerPoint[0],latitude:e.trailerPoint[1]});if(!e.activeRoute)return null;const t=[],i=e.activeRoute.segments.length;for(let a=0;a<i;a++){const c=e.activeRoute.segments[a],h=Ug.decode(c.steps.at(-1).geometry),f=Ca(h.at(-1)),o=a===i-1;t.push(G.jsx(ux,{color:o?"red":"blue",longitude:f[0],latitude:f[1],children:o?null:G.jsx(ei,{sx:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bolder",borderRadius:"50%",width:"1.6em",height:"1.6em",border:"0.15em solid",backgroundColor:"background.surface"},children:a+1})},f.join()+a))}return t},Sq=()=>G.jsx(dn,{justifyContent:"center",alignItems:"center",sx:{position:"absolute",top:0,left:0,width:"100%",height:"100vh",zIndex:9999},bgcolor:"#0005",children:G.jsxs(Hv,{size:"lg",sx:{boxShadow:"lg",overflow:"hidden",maxWidth:"40ch"},children:[G.jsxs(Wr,{fontSize:"lg",display:"flex",justifyContent:"center",alignItems:"center",gap:1,children:[G.jsx(nm,{variant:"solid",size:"sm",color:"neutral",sx:{mr:1}}),"Waiting for game telemetry..."]}),G.jsx(Xg,{}),G.jsxs(Wr,{fontSize:"sm",color:"neutral",children:["Please make sure:",G.jsxs("ul",{style:{paddingLeft:"1.5em",margin:"1ex 0 0 0"},children:[G.jsx("li",{children:"ATS and the Navigator client are running"}),G.jsx("li",{children:"your truck is on the road"})]})]})]})});function Cq(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var t=1;t<=60;++t)e("EPSG:"+(32600+t),"+proj=utm +zone="+t+" +datum=WGS84 +units=m"),e("EPSG:"+(32700+t),"+proj=utm +zone="+t+" +south +datum=WGS84 +units=m");e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]}var Jp=1,Qp=2,Mg=3,Tq=4,Kw=5,AP=6378137,Mq=6356752314e-3,RP=.0066943799901413165,lv=484813681109536e-20,Ft=Math.PI/2,Pq=.16666666666666666,Eq=.04722222222222222,Iq=.022156084656084655,nr=1e-10,us=.017453292519943295,Yu=57.29577951308232,Jn=Math.PI/4,kv=Math.PI*2,vo=3.14159265359,Aa={};Aa.greenwich=0;Aa.lisbon=-9.131906111111;Aa.paris=2.337229166667;Aa.bogota=-74.080916666667;Aa.madrid=-3.687938888889;Aa.rome=12.452333333333;Aa.bern=7.439583333333;Aa.jakarta=106.807719444444;Aa.ferro=-17.666666666667;Aa.brussels=4.367975;Aa.stockholm=18.058277777778;Aa.athens=23.7163375;Aa.oslo=10.722916666667;const kq={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.01},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var DP=/[\s_\-\/\(\)]/g;function If(e,t){if(e[t])return e[t];for(var i=Object.keys(e),a=t.toLowerCase().replace(DP,""),c=-1,h,f;++c<i.length;)if(h=i[c],f=h.toLowerCase().replace(DP,""),f===a)return e[h]}function Yw(e){var t={},i=e.split("+").map(function(o){return o.trim()}).filter(function(o){return o}).reduce(function(o,b){var P=b.split("=");return P.push(!0),o[P[0].toLowerCase()]=P[1],o},{}),a,c,h,f={proj:"projName",datum:"datumCode",rf:function(o){t.rf=parseFloat(o)},lat_0:function(o){t.lat0=o*us},lat_1:function(o){t.lat1=o*us},lat_2:function(o){t.lat2=o*us},lat_ts:function(o){t.lat_ts=o*us},lon_0:function(o){t.long0=o*us},lon_1:function(o){t.long1=o*us},lon_2:function(o){t.long2=o*us},alpha:function(o){t.alpha=parseFloat(o)*us},gamma:function(o){t.rectified_grid_angle=parseFloat(o)},lonc:function(o){t.longc=o*us},x_0:function(o){t.x0=parseFloat(o)},y_0:function(o){t.y0=parseFloat(o)},k_0:function(o){t.k0=parseFloat(o)},k:function(o){t.k0=parseFloat(o)},a:function(o){t.a=parseFloat(o)},b:function(o){t.b=parseFloat(o)},r:function(o){t.a=t.b=parseFloat(o)},r_a:function(){t.R_A=!0},zone:function(o){t.zone=parseInt(o,10)},south:function(){t.utmSouth=!0},towgs84:function(o){t.datum_params=o.split(",").map(function(b){return parseFloat(b)})},to_meter:function(o){t.to_meter=parseFloat(o)},units:function(o){t.units=o;var b=If(kq,o);b&&(t.to_meter=b.to_meter)},from_greenwich:function(o){t.from_greenwich=o*us},pm:function(o){var b=If(Aa,o);t.from_greenwich=(b||parseFloat(o))*us},nadgrids:function(o){o==="@null"?t.datumCode="none":t.nadgrids=o},axis:function(o){var b="ewnsud";o.length===3&&b.indexOf(o.substr(0,1))!==-1&&b.indexOf(o.substr(1,1))!==-1&&b.indexOf(o.substr(2,1))!==-1&&(t.axis=o)},approx:function(){t.approx=!0}};for(a in i)c=i[a],a in f?(h=f[a],typeof h=="function"?h(c):t[h]=c):t[a]=c;return typeof t.datumCode=="string"&&t.datumCode!=="WGS84"&&(t.datumCode=t.datumCode.toLowerCase()),t}var Av=1,yR=2,vR=3,gx=4,_R=5,yS=-1,Aq=/\s/,Rq=/[A-Za-z]/,Dq=/[A-Za-z84_]/,y1=/[,\]]/,xR=/[\d\.E\-\+]/;function ud(e){if(typeof e!="string")throw new Error("not a string");this.text=e.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Av}ud.prototype.readCharicter=function(){var e=this.text[this.place++];if(this.state!==gx)for(;Aq.test(e);){if(this.place>=this.text.length)return;e=this.text[this.place++]}switch(this.state){case Av:return this.neutral(e);case yR:return this.keyword(e);case gx:return this.quoted(e);case _R:return this.afterquote(e);case vR:return this.number(e);case yS:return}};ud.prototype.afterquote=function(e){if(e==='"'){this.word+='"',this.state=gx;return}if(y1.test(e)){this.word=this.word.trim(),this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in afterquote yet, index '+this.place)};ud.prototype.afterItem=function(e){if(e===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=Av;return}if(e==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=Av,this.currentObject=this.stack.pop(),this.currentObject||(this.state=yS);return}};ud.prototype.number=function(e){if(xR.test(e)){this.word+=e;return}if(y1.test(e)){this.word=parseFloat(this.word),this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in number yet, index '+this.place)};ud.prototype.quoted=function(e){if(e==='"'){this.state=_R;return}this.word+=e};ud.prototype.keyword=function(e){if(Dq.test(e)){this.word+=e;return}if(e==="["){var t=[];t.push(this.word),this.level++,this.root===null?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,this.state=Av;return}if(y1.test(e)){this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in keyword yet, index '+this.place)};ud.prototype.neutral=function(e){if(Rq.test(e)){this.word=e,this.state=yR;return}if(e==='"'){this.word="",this.state=gx;return}if(xR.test(e)){this.word=e,this.state=vR;return}if(y1.test(e)){this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in neutral yet, index '+this.place)};ud.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===yS)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function zq(e){var t=new ud(e);return t.output()}function nw(e,t,i){Array.isArray(t)&&(i.unshift(t),t=null);var a=t?{}:e,c=i.reduce(function(h,f){return gg(f,h),h},a);t&&(e[t]=c)}function gg(e,t){if(!Array.isArray(e)){t[e]=!0;return}var i=e.shift();if(i==="PARAMETER"&&(i=e.shift()),e.length===1){if(Array.isArray(e[0])){t[i]={},gg(e[0],t[i]);return}t[i]=e[0];return}if(!e.length){t[i]=!0;return}if(i==="TOWGS84"){t[i]=e;return}if(i==="AXIS"){i in t||(t[i]=[]),t[i].push(e);return}Array.isArray(i)||(t[i]={});var a;switch(i){case"UNIT":case"PRIMEM":case"VERT_DATUM":t[i]={name:e[0].toLowerCase(),convert:e[1]},e.length===3&&gg(e[2],t[i]);return;case"SPHEROID":case"ELLIPSOID":t[i]={name:e[0],a:e[1],rf:e[2]},e.length===4&&gg(e[3],t[i]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":e[0]=["name",e[0]],nw(t,i,e);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":e[0]=["name",e[0]],nw(t,i,e),t[i].type=i;return;default:for(a=-1;++a<e.length;)if(!Array.isArray(e[a]))return gg(e,t[i]);return nw(t,i,e)}}var Oq=.017453292519943295,Lq=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Fq(e,t){var i=t[0],a=t[1];!(i in e)&&a in e&&(e[i]=e[a],t.length===3&&(e[i]=t[2](e[i])))}function Uu(e){return e*Oq}function bR(e){for(var t=Object.keys(e),i=0,a=t.length;i<a;++i){var c=t[i];Lq.indexOf(c)!==-1&&Bq(e[c]),typeof e[c]=="object"&&bR(e[c])}}function Bq(e){if(e.AUTHORITY){var t=Object.keys(e.AUTHORITY)[0];t&&t in e.AUTHORITY&&(e.title=t+":"+e.AUTHORITY[t])}if(e.type==="GEOGCS"?e.projName="longlat":e.type==="LOCAL_CS"?(e.projName="identity",e.local=!0):typeof e.PROJECTION=="object"?e.projName=Object.keys(e.PROJECTION)[0]:e.projName=e.PROJECTION,e.AXIS){for(var i="",a=0,c=e.AXIS.length;a<c;++a){var h=[e.AXIS[a][0].toLowerCase(),e.AXIS[a][1].toLowerCase()];h[0].indexOf("north")!==-1||(h[0]==="y"||h[0]==="lat")&&h[1]==="north"?i+="n":h[0].indexOf("south")!==-1||(h[0]==="y"||h[0]==="lat")&&h[1]==="south"?i+="s":h[0].indexOf("east")!==-1||(h[0]==="x"||h[0]==="lon")&&h[1]==="east"?i+="e":(h[0].indexOf("west")!==-1||(h[0]==="x"||h[0]==="lon")&&h[1]==="west")&&(i+="w")}i.length===2&&(i+="u"),i.length===3&&(e.axis=i)}e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.UNIT.convert&&(e.type==="GEOGCS"?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=e.UNIT.convert*e.DATUM.SPHEROID.a):e.to_meter=e.UNIT.convert));var f=e.GEOGCS;e.type==="GEOGCS"&&(f=e),f&&(f.DATUM?e.datumCode=f.DATUM.name.toLowerCase():e.datumCode=f.name.toLowerCase(),e.datumCode.slice(0,2)==="d_"&&(e.datumCode=e.datumCode.slice(2)),e.datumCode==="new_zealand_1949"&&(e.datumCode="nzgd49"),(e.datumCode==="wgs_1984"||e.datumCode==="world_geodetic_system_1984")&&(e.PROJECTION==="Mercator_Auxiliary_Sphere"&&(e.sphere=!0),e.datumCode="wgs84"),e.datumCode==="belge_1972"&&(e.datumCode="rnb72"),f.DATUM&&f.DATUM.SPHEROID&&(e.ellps=f.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),e.ellps.toLowerCase().slice(0,13)==="international"&&(e.ellps="intl"),e.a=f.DATUM.SPHEROID.a,e.rf=parseFloat(f.DATUM.SPHEROID.rf,10)),f.DATUM&&f.DATUM.TOWGS84&&(e.datum_params=f.DATUM.TOWGS84),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36"),~e.datumCode.indexOf("osni_1952")&&(e.datumCode="osni52"),(~e.datumCode.indexOf("tm65")||~e.datumCode.indexOf("geodetic_datum_of_1965"))&&(e.datumCode="ire65"),e.datumCode==="ch1903+"&&(e.datumCode="ch1903"),~e.datumCode.indexOf("israel")&&(e.datumCode="isr93")),e.b&&!isFinite(e.b)&&(e.b=e.a);function o(I){var D=e.to_meter||1;return I*D}var b=function(I){return Fq(e,I)},P=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Uu],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Uu],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",Uu],["lat0","latitude_of_origin",Uu],["lat0","standard_parallel_1",Uu],["lat1","standard_parallel_1",Uu],["lat2","standard_parallel_2",Uu],["azimuth","Azimuth"],["alpha","azimuth",Uu],["srsCode","name"]];P.forEach(b),!e.long0&&e.longc&&(e.projName==="Albers_Conic_Equal_Area"||e.projName==="Lambert_Azimuthal_Equal_Area")&&(e.long0=e.longc),!e.lat_ts&&e.lat1&&(e.projName==="Stereographic_South_Pole"||e.projName==="Polar Stereographic (variant B)")?(e.lat0=Uu(e.lat1>0?90:-90),e.lat_ts=e.lat1):!e.lat_ts&&e.lat0&&e.projName==="Polar_Stereographic"&&(e.lat_ts=e.lat0,e.lat0=Uu(e.lat0>0?90:-90))}function wR(e){var t=zq(e),i=t[0],a={};return gg(t,a),bR(a),a[i]}function Ks(e){var t=this;if(arguments.length===2){var i=arguments[1];typeof i=="string"?i.charAt(0)==="+"?Ks[e]=Yw(arguments[1]):Ks[e]=wR(arguments[1]):Ks[e]=i}else if(arguments.length===1){if(Array.isArray(e))return e.map(function(a){Array.isArray(a)?Ks.apply(t,a):Ks(a)});if(typeof e=="string"){if(e in Ks)return Ks[e]}else"EPSG"in e?Ks["EPSG:"+e.EPSG]=e:"ESRI"in e?Ks["ESRI:"+e.ESRI]=e:"IAU2000"in e?Ks["IAU2000:"+e.IAU2000]=e:console.log(e);return}}Cq(Ks);function $q(e){return typeof e=="string"}function jq(e){return e in Ks}var Nq=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Vq(e){return Nq.some(function(t){return e.indexOf(t)>-1})}var Uq=["3857","900913","3785","102113"];function Gq(e){var t=If(e,"authority");if(t){var i=If(t,"epsg");return i&&Uq.indexOf(i)>-1}}function qq(e){var t=If(e,"extension");if(t)return If(t,"proj4")}function Hq(e){return e[0]==="+"}function Wq(e){if($q(e)){if(jq(e))return Ks[e];if(Vq(e)){var t=wR(e);if(Gq(t))return Ks["EPSG:3857"];var i=qq(t);return i?Yw(i):t}if(Hq(e))return Yw(e)}else return e}function zP(e,t){e=e||{};var i,a;if(!t)return e;for(a in t)i=t[a],i!==void 0&&(e[a]=i);return e}function sh(e,t,i){var a=e*t;return i/Math.sqrt(1-a*a)}function l0(e){return e<0?-1:1}function or(e){return Math.abs(e)<=vo?e:e-l0(e)*kv}function Qc(e,t,i){var a=e*i,c=.5*e;return a=Math.pow((1-a)/(1+a),c),Math.tan(.5*(Ft-t))/a}function Rv(e,t){for(var i=.5*e,a,c,h=Ft-2*Math.atan(t),f=0;f<=15;f++)if(a=e*Math.sin(h),c=Ft-2*Math.atan(t*Math.pow((1-a)/(1+a),i))-h,h+=c,Math.abs(c)<=1e-10)return h;return-9999}function Zq(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=sh(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function Xq(e){var t=e.x,i=e.y;if(i*Yu>90&&i*Yu<-90&&t*Yu>180&&t*Yu<-180)return null;var a,c;if(Math.abs(Math.abs(i)-Ft)<=nr)return null;if(this.sphere)a=this.x0+this.a*this.k0*or(t-this.long0),c=this.y0+this.a*this.k0*Math.log(Math.tan(Jn+.5*i));else{var h=Math.sin(i),f=Qc(this.e,i,h);a=this.x0+this.a*this.k0*or(t-this.long0),c=this.y0-this.a*this.k0*Math.log(f)}return e.x=a,e.y=c,e}function Kq(e){var t=e.x-this.x0,i=e.y-this.y0,a,c;if(this.sphere)c=Ft-2*Math.atan(Math.exp(-i/(this.a*this.k0)));else{var h=Math.exp(-i/(this.a*this.k0));if(c=Rv(this.e,h),c===-9999)return null}return a=or(this.long0+t/(this.a*this.k0)),e.x=a,e.y=c,e}var Yq=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"];const Jq={init:Zq,forward:Xq,inverse:Kq,names:Yq};function Qq(){}function OP(e){return e}var eH=["longlat","identity"];const tH={init:Qq,forward:OP,inverse:OP,names:eH};var rH=[Jq,tH],$_={},yx=[];function SR(e,t){var i=yx.length;return e.names?(yx[i]=e,e.names.forEach(function(a){$_[a.toLowerCase()]=i}),this):(console.log(t),!0)}function nH(e){if(!e)return!1;var t=e.toLowerCase();if(typeof $_[t]<"u"&&yx[$_[t]])return yx[$_[t]]}function iH(){rH.forEach(SR)}const oH={start:iH,add:SR,get:nH};var Ur={};Ur.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};Ur.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};Ur.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};Ur.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};Ur.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"};Ur.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};Ur.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};Ur.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"};Ur.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};Ur.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};Ur.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};Ur.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"};Ur.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};Ur.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"};Ur.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."};Ur.clrk80ign={a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"};Ur.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"};Ur.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};Ur.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};Ur.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"};Ur.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"};Ur.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"};Ur.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"};Ur.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"};Ur.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};Ur.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};Ur.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};Ur.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};Ur.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};Ur.hough={a:6378270,rf:297,ellipseName:"Hough"};Ur.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};Ur.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};Ur.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};Ur.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};Ur.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"};Ur.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};Ur.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};Ur.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"};Ur.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"};Ur.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};Ur.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};Ur.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var sH=Ur.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Ur.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function aH(e,t,i,a){var c=e*e,h=t*t,f=(c-h)/c,o=0;a?(e*=1-f*(Pq+f*(Eq+f*Iq)),c=e*e,f=0):o=Math.sqrt(f);var b=(c-h)/h;return{es:f,e:o,ep2:b}}function lH(e,t,i,a,c){if(!e){var h=If(Ur,a);h||(h=sH),e=h.a,t=h.b,i=h.rf}return i&&!t&&(t=(1-1/i)*e),(i===0||Math.abs(e-t)<nr)&&(c=!0,t=e),{a:e,b:t,rf:i,sphere:c}}var j_={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};for(var cH in j_){var LP=j_[cH];j_[LP.datumName]=LP}function uH(e,t,i,a,c,h,f){var o={};return e===void 0||e==="none"?o.datum_type=Kw:o.datum_type=Tq,t&&(o.datum_params=t.map(parseFloat),(o.datum_params[0]!==0||o.datum_params[1]!==0||o.datum_params[2]!==0)&&(o.datum_type=Jp),o.datum_params.length>3&&(o.datum_params[3]!==0||o.datum_params[4]!==0||o.datum_params[5]!==0||o.datum_params[6]!==0)&&(o.datum_type=Qp,o.datum_params[3]*=lv,o.datum_params[4]*=lv,o.datum_params[5]*=lv,o.datum_params[6]=o.datum_params[6]/1e6+1)),f&&(o.datum_type=Mg,o.grids=f),o.a=i,o.b=a,o.es=c,o.ep2=h,o}var CR={};function hH(e,t){var i=new DataView(t),a=pH(i),c=mH(i,a),h=gH(i,c,a),f={header:c,subgrids:h};return CR[e]=f,f}function dH(e){if(e===void 0)return null;var t=e.split(",");return t.map(fH)}function fH(e){if(e.length===0)return null;var t=e[0]==="@";return t&&(e=e.slice(1)),e==="null"?{name:"null",mandatory:!t,grid:null,isNull:!0}:{name:e,mandatory:!t,grid:CR[e]||null,isNull:!1}}function yg(e){return e/3600*Math.PI/180}function pH(e){var t=e.getInt32(8,!1);return t===11?!1:(t=e.getInt32(8,!0),t!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function mH(e,t){return{nFields:e.getInt32(8,t),nSubgridFields:e.getInt32(24,t),nSubgrids:e.getInt32(40,t),shiftType:Jw(e,56,64).trim(),fromSemiMajorAxis:e.getFloat64(120,t),fromSemiMinorAxis:e.getFloat64(136,t),toSemiMajorAxis:e.getFloat64(152,t),toSemiMinorAxis:e.getFloat64(168,t)}}function Jw(e,t,i){return String.fromCharCode.apply(null,new Uint8Array(e.buffer.slice(t,i)))}function gH(e,t,i){for(var a=176,c=[],h=0;h<t.nSubgrids;h++){var f=vH(e,a,i),o=_H(e,a,f,i),b=Math.round(1+(f.upperLongitude-f.lowerLongitude)/f.longitudeInterval),P=Math.round(1+(f.upperLatitude-f.lowerLatitude)/f.latitudeInterval);c.push({ll:[yg(f.lowerLongitude),yg(f.lowerLatitude)],del:[yg(f.longitudeInterval),yg(f.latitudeInterval)],lim:[b,P],count:f.gridNodeCount,cvs:yH(o)}),a+=176+f.gridNodeCount*16}return c}function yH(e){return e.map(function(t){return[yg(t.longitudeShift),yg(t.latitudeShift)]})}function vH(e,t,i){return{name:Jw(e,t+8,t+16).trim(),parent:Jw(e,t+24,t+24+8).trim(),lowerLatitude:e.getFloat64(t+72,i),upperLatitude:e.getFloat64(t+88,i),lowerLongitude:e.getFloat64(t+104,i),upperLongitude:e.getFloat64(t+120,i),latitudeInterval:e.getFloat64(t+136,i),longitudeInterval:e.getFloat64(t+152,i),gridNodeCount:e.getInt32(t+168,i)}}function _H(e,t,i,a){for(var c=t+176,h=16,f=[],o=0;o<i.gridNodeCount;o++){var b={latitudeShift:e.getFloat32(c+o*h,a),longitudeShift:e.getFloat32(c+o*h+4,a),latitudeAccuracy:e.getFloat32(c+o*h+8,a),longitudeAccuracy:e.getFloat32(c+o*h+12,a)};f.push(b)}return f}function nh(e,t){if(!(this instanceof nh))return new nh(e);t=t||function(P){if(P)throw P};var i=Wq(e);if(typeof i!="object"){t("Could not parse to valid json: "+e);return}var a=nh.projections.get(i.projName);if(!a){t("Could not get projection name from: "+e);return}if(i.datumCode&&i.datumCode!=="none"){var c=If(j_,i.datumCode);c&&(i.datum_params=i.datum_params||(c.towgs84?c.towgs84.split(","):null),i.ellps=c.ellipse,i.datumName=c.datumName?c.datumName:i.datumCode)}i.k0=i.k0||1,i.axis=i.axis||"enu",i.ellps=i.ellps||"wgs84",i.lat1=i.lat1||i.lat0;var h=lH(i.a,i.b,i.rf,i.ellps,i.sphere),f=aH(h.a,h.b,h.rf,i.R_A),o=dH(i.nadgrids),b=i.datum||uH(i.datumCode,i.datum_params,h.a,h.b,f.es,f.ep2,o);zP(this,i),zP(this,a),this.a=h.a,this.b=h.b,this.rf=h.rf,this.sphere=h.sphere,this.es=f.es,this.e=f.e,this.ep2=f.ep2,this.datum=b,this.init(),t(null,this)}nh.projections=oH;nh.projections.start();function xH(e,t){return e.datum_type!==t.datum_type||e.a!==t.a||Math.abs(e.es-t.es)>5e-11?!1:e.datum_type===Jp?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]:e.datum_type===Qp?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]&&e.datum_params[3]===t.datum_params[3]&&e.datum_params[4]===t.datum_params[4]&&e.datum_params[5]===t.datum_params[5]&&e.datum_params[6]===t.datum_params[6]:!0}function TR(e,t,i){var a=e.x,c=e.y,h=e.z?e.z:0,f,o,b,P;if(c<-Ft&&c>-1.001*Ft)c=-Ft;else if(c>Ft&&c<1.001*Ft)c=Ft;else{if(c<-Ft)return{x:-1/0,y:-1/0,z:e.z};if(c>Ft)return{x:1/0,y:1/0,z:e.z}}return a>Math.PI&&(a-=2*Math.PI),o=Math.sin(c),P=Math.cos(c),b=o*o,f=i/Math.sqrt(1-t*b),{x:(f+h)*P*Math.cos(a),y:(f+h)*P*Math.sin(a),z:(f*(1-t)+h)*o}}function MR(e,t,i,a){var c=1e-12,h=c*c,f=30,o,b,P,I,D,z,F,U,$,j,ie,se,Q,de=e.x,oe=e.y,be=e.z?e.z:0,xe,Me,Ee;if(o=Math.sqrt(de*de+oe*oe),b=Math.sqrt(de*de+oe*oe+be*be),o/i<c){if(xe=0,b/i<c)return Me=Ft,Ee=-a,{x:e.x,y:e.y,z:e.z}}else xe=Math.atan2(oe,de);P=be/b,I=o/b,D=1/Math.sqrt(1-t*(2-t)*I*I),U=I*(1-t)*D,$=P*D,Q=0;do Q++,F=i/Math.sqrt(1-t*$*$),Ee=o*U+be*$-F*(1-t*$*$),z=t*F/(F+Ee),D=1/Math.sqrt(1-z*(2-z)*I*I),j=I*(1-z)*D,ie=P*D,se=ie*U-j*$,U=j,$=ie;while(se*se>h&&Q<f);return Me=Math.atan(ie/Math.abs(j)),{x:xe,y:Me,z:Ee}}function bH(e,t,i){if(t===Jp)return{x:e.x+i[0],y:e.y+i[1],z:e.z+i[2]};if(t===Qp){var a=i[0],c=i[1],h=i[2],f=i[3],o=i[4],b=i[5],P=i[6];return{x:P*(e.x-b*e.y+o*e.z)+a,y:P*(b*e.x+e.y-f*e.z)+c,z:P*(-o*e.x+f*e.y+e.z)+h}}}function wH(e,t,i){if(t===Jp)return{x:e.x-i[0],y:e.y-i[1],z:e.z-i[2]};if(t===Qp){var a=i[0],c=i[1],h=i[2],f=i[3],o=i[4],b=i[5],P=i[6],I=(e.x-a)/P,D=(e.y-c)/P,z=(e.z-h)/P;return{x:I+b*D-o*z,y:-b*I+D+f*z,z:o*I-f*D+z}}}function x_(e){return e===Jp||e===Qp}function SH(e,t,i){if(xH(e,t)||e.datum_type===Kw||t.datum_type===Kw)return i;var a=e.a,c=e.es;if(e.datum_type===Mg){var h=FP(e,!1,i);if(h!==0)return;a=AP,c=RP}var f=t.a,o=t.b,b=t.es;if(t.datum_type===Mg&&(f=AP,o=Mq,b=RP),c===b&&a===f&&!x_(e.datum_type)&&!x_(t.datum_type))return i;if(i=TR(i,c,a),x_(e.datum_type)&&(i=bH(i,e.datum_type,e.datum_params)),x_(t.datum_type)&&(i=wH(i,t.datum_type,t.datum_params)),i=MR(i,b,f,o),t.datum_type===Mg){var P=FP(t,!0,i);if(P!==0)return}return i}function FP(e,t,i){if(e.grids===null||e.grids.length===0)return console.log("Grid shift grids not found"),-1;var a={x:-i.x,y:i.y},c={x:Number.NaN,y:Number.NaN},h=[];e:for(var f=0;f<e.grids.length;f++){var o=e.grids[f];if(h.push(o.name),o.isNull){c=a;break}if(o.mandatory,o.grid===null){if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1;continue}for(var b=o.grid.subgrids,P=0,I=b.length;P<I;P++){var D=b[P],z=(Math.abs(D.del[1])+Math.abs(D.del[0]))/1e4,F=D.ll[0]-z,U=D.ll[1]-z,$=D.ll[0]+(D.lim[0]-1)*D.del[0]+z,j=D.ll[1]+(D.lim[1]-1)*D.del[1]+z;if(!(U>a.y||F>a.x||j<a.y||$<a.x)&&(c=CH(a,t,D),!isNaN(c.x)))break e}}return isNaN(c.x)?(console.log("Failed to find a grid shift table for location '"+-a.x*Yu+" "+a.y*Yu+" tried: '"+h+"'"),-1):(i.x=-c.x,i.y=c.y,0)}function CH(e,t,i){var a={x:Number.NaN,y:Number.NaN};if(isNaN(e.x))return a;var c={x:e.x,y:e.y};c.x-=i.ll[0],c.y-=i.ll[1],c.x=or(c.x-Math.PI)+Math.PI;var h=BP(c,i);if(t){if(isNaN(h.x))return a;h.x=c.x-h.x,h.y=c.y-h.y;var f=9,o=1e-12,b,P;do{if(P=BP(h,i),isNaN(P.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}b={x:c.x-(P.x+h.x),y:c.y-(P.y+h.y)},h.x+=b.x,h.y+=b.y}while(f--&&Math.abs(b.x)>o&&Math.abs(b.y)>o);if(f<0)return console.log("Inverse grid shift iterator failed to converge."),a;a.x=or(h.x+i.ll[0]),a.y=h.y+i.ll[1]}else isNaN(h.x)||(a.x=e.x+h.x,a.y=e.y+h.y);return a}function BP(e,t){var i={x:e.x/t.del[0],y:e.y/t.del[1]},a={x:Math.floor(i.x),y:Math.floor(i.y)},c={x:i.x-1*a.x,y:i.y-1*a.y},h={x:Number.NaN,y:Number.NaN},f;if(a.x<0||a.x>=t.lim[0]||a.y<0||a.y>=t.lim[1])return h;f=a.y*t.lim[0]+a.x;var o={x:t.cvs[f][0],y:t.cvs[f][1]};f++;var b={x:t.cvs[f][0],y:t.cvs[f][1]};f+=t.lim[0];var P={x:t.cvs[f][0],y:t.cvs[f][1]};f--;var I={x:t.cvs[f][0],y:t.cvs[f][1]},D=c.x*c.y,z=c.x*(1-c.y),F=(1-c.x)*(1-c.y),U=(1-c.x)*c.y;return h.x=F*o.x+z*b.x+U*I.x+D*P.x,h.y=F*o.y+z*b.y+U*I.y+D*P.y,h}function $P(e,t,i){var a=i.x,c=i.y,h=i.z||0,f,o,b,P={};for(b=0;b<3;b++)if(!(t&&b===2&&i.z===void 0))switch(b===0?(f=a,"ew".indexOf(e.axis[b])!==-1?o="x":o="y"):b===1?(f=c,"ns".indexOf(e.axis[b])!==-1?o="y":o="x"):(f=h,o="z"),e.axis[b]){case"e":P[o]=f;break;case"w":P[o]=-f;break;case"n":P[o]=f;break;case"s":P[o]=-f;break;case"u":i[o]!==void 0&&(P.z=f);break;case"d":i[o]!==void 0&&(P.z=-f);break;default:return null}return P}function PR(e){var t={x:e[0],y:e[1]};return e.length>2&&(t.z=e[2]),e.length>3&&(t.m=e[3]),t}function TH(e){jP(e.x),jP(e.y)}function jP(e){if(typeof Number.isFinite=="function"){if(Number.isFinite(e))return;throw new TypeError("coordinates must be finite numbers")}if(typeof e!="number"||e!==e||!isFinite(e))throw new TypeError("coordinates must be finite numbers")}function MH(e,t){return(e.datum.datum_type===Jp||e.datum.datum_type===Qp||e.datum.datum_type===Mg)&&t.datumCode!=="WGS84"||(t.datum.datum_type===Jp||t.datum.datum_type===Qp||t.datum.datum_type===Mg)&&e.datumCode!=="WGS84"}function vx(e,t,i,a){var c;Array.isArray(i)?i=PR(i):i={x:i.x,y:i.y,z:i.z,m:i.m};var h=i.z!==void 0;if(TH(i),e.datum&&t.datum&&MH(e,t)&&(c=new nh("WGS84"),i=vx(e,c,i,a),e=c),a&&e.axis!=="enu"&&(i=$P(e,!1,i)),e.projName==="longlat")i={x:i.x*us,y:i.y*us,z:i.z||0};else if(e.to_meter&&(i={x:i.x*e.to_meter,y:i.y*e.to_meter,z:i.z||0}),i=e.inverse(i),!i)return;if(e.from_greenwich&&(i.x+=e.from_greenwich),i=SH(e.datum,t.datum,i),!!i)return t.from_greenwich&&(i={x:i.x-t.from_greenwich,y:i.y,z:i.z||0}),t.projName==="longlat"?i={x:i.x*Yu,y:i.y*Yu,z:i.z||0}:(i=t.forward(i),t.to_meter&&(i={x:i.x/t.to_meter,y:i.y/t.to_meter,z:i.z||0})),a&&t.axis!=="enu"?$P(t,!0,i):(i&&!h&&delete i.z,i)}var NP=nh("WGS84");function iw(e,t,i,a){var c,h,f;return Array.isArray(i)?(c=vx(e,t,i,a)||{x:NaN,y:NaN},i.length>2?typeof e.name<"u"&&e.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"?typeof c.z=="number"?[c.x,c.y,c.z].concat(i.slice(3)):[c.x,c.y,i[2]].concat(i.slice(3)):[c.x,c.y].concat(i.slice(2)):[c.x,c.y]):(h=vx(e,t,i,a),f=Object.keys(i),f.length===2||f.forEach(function(o){if(typeof e.name<"u"&&e.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"){if(o==="x"||o==="y"||o==="z")return}else if(o==="x"||o==="y")return;h[o]=i[o]}),h)}function VP(e){return e instanceof nh?e:e.oProj?e.oProj:nh(e)}function ka(e,t,i){e=VP(e);var a=!1,c;return typeof t>"u"?(t=e,e=NP,a=!0):(typeof t.x<"u"||Array.isArray(t))&&(i=t,t=e,e=NP,a=!0),t=VP(t),i?iw(e,t,i):(c={forward:function(h,f){return iw(e,t,h,f)},inverse:function(h,f){return iw(t,e,h,f)}},a&&(c.oProj=t),c)}var UP=6,ER="AJSAJS",IR="AFAFAF",vg=65,xa=73,Ul=79,Zy=86,Xy=90;const PH={forward:kR,inverse:EH,toPoint:AR};function kR(e,t){return t=t||5,AH(IH({lat:e[1],lon:e[0]}),t)}function EH(e){var t=vS(DR(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat,t.lon,t.lat]:[t.left,t.bottom,t.right,t.top]}function AR(e){var t=vS(DR(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function ow(e){return e*(Math.PI/180)}function GP(e){return 180*(e/Math.PI)}function IH(e){var t=e.lat,i=e.lon,a=6378137,c=.00669438,h=.9996,f,o,b,P,I,D,z,F=ow(t),U=ow(i),$,j;j=Math.floor((i+180)/6)+1,i===180&&(j=60),t>=56&&t<64&&i>=3&&i<12&&(j=32),t>=72&&t<84&&(i>=0&&i<9?j=31:i>=9&&i<21?j=33:i>=21&&i<33?j=35:i>=33&&i<42&&(j=37)),f=(j-1)*6-180+3,$=ow(f),o=c/(1-c),b=a/Math.sqrt(1-c*Math.sin(F)*Math.sin(F)),P=Math.tan(F)*Math.tan(F),I=o*Math.cos(F)*Math.cos(F),D=Math.cos(F)*(U-$),z=a*((1-c/4-3*c*c/64-5*c*c*c/256)*F-(3*c/8+3*c*c/32+45*c*c*c/1024)*Math.sin(2*F)+(15*c*c/256+45*c*c*c/1024)*Math.sin(4*F)-35*c*c*c/3072*Math.sin(6*F));var ie=h*b*(D+(1-P+I)*D*D*D/6+(5-18*P+P*P+72*I-58*o)*D*D*D*D*D/120)+5e5,se=h*(z+b*Math.tan(F)*(D*D/2+(5-P+9*I+4*I*I)*D*D*D*D/24+(61-58*P+P*P+600*I-330*o)*D*D*D*D*D*D/720));return t<0&&(se+=1e7),{northing:Math.round(se),easting:Math.round(ie),zoneNumber:j,zoneLetter:kH(t)}}function vS(e){var t=e.northing,i=e.easting,a=e.zoneLetter,c=e.zoneNumber;if(c<0||c>60)return null;var h=.9996,f=6378137,o=.00669438,b,P=(1-Math.sqrt(1-o))/(1+Math.sqrt(1-o)),I,D,z,F,U,$,j,ie,se,Q=i-5e5,de=t;a<"N"&&(de-=1e7),j=(c-1)*6-180+3,b=o/(1-o),$=de/h,ie=$/(f*(1-o/4-3*o*o/64-5*o*o*o/256)),se=ie+(3*P/2-27*P*P*P/32)*Math.sin(2*ie)+(21*P*P/16-55*P*P*P*P/32)*Math.sin(4*ie)+151*P*P*P/96*Math.sin(6*ie),I=f/Math.sqrt(1-o*Math.sin(se)*Math.sin(se)),D=Math.tan(se)*Math.tan(se),z=b*Math.cos(se)*Math.cos(se),F=f*(1-o)/Math.pow(1-o*Math.sin(se)*Math.sin(se),1.5),U=Q/(I*h);var oe=se-I*Math.tan(se)/F*(U*U/2-(5+3*D+10*z-4*z*z-9*b)*U*U*U*U/24+(61+90*D+298*z+45*D*D-252*b-3*z*z)*U*U*U*U*U*U/720);oe=GP(oe);var be=(U-(1+2*D+z)*U*U*U/6+(5-2*z+28*D-3*z*z+8*b+24*D*D)*U*U*U*U*U/120)/Math.cos(se);be=j+GP(be);var xe;if(e.accuracy){var Me=vS({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});xe={top:Me.lat,right:Me.lon,bottom:oe,left:be}}else xe={lat:oe,lon:be};return xe}function kH(e){var t="Z";return 84>=e&&e>=72?t="X":72>e&&e>=64?t="W":64>e&&e>=56?t="V":56>e&&e>=48?t="U":48>e&&e>=40?t="T":40>e&&e>=32?t="S":32>e&&e>=24?t="R":24>e&&e>=16?t="Q":16>e&&e>=8?t="P":8>e&&e>=0?t="N":0>e&&e>=-8?t="M":-8>e&&e>=-16?t="L":-16>e&&e>=-24?t="K":-24>e&&e>=-32?t="J":-32>e&&e>=-40?t="H":-40>e&&e>=-48?t="G":-48>e&&e>=-56?t="F":-56>e&&e>=-64?t="E":-64>e&&e>=-72?t="D":-72>e&&e>=-80&&(t="C"),t}function AH(e,t){var i="00000"+e.easting,a="00000"+e.northing;return e.zoneNumber+e.zoneLetter+RH(e.easting,e.northing,e.zoneNumber)+i.substr(i.length-5,t)+a.substr(a.length-5,t)}function RH(e,t,i){var a=RR(i),c=Math.floor(e/1e5),h=Math.floor(t/1e5)%20;return DH(c,h,a)}function RR(e){var t=e%UP;return t===0&&(t=UP),t}function DH(e,t,i){var a=i-1,c=ER.charCodeAt(a),h=IR.charCodeAt(a),f=c+e-1,o=h+t,b=!1;f>Xy&&(f=f-Xy+vg-1,b=!0),(f===xa||c<xa&&f>xa||(f>xa||c<xa)&&b)&&f++,(f===Ul||c<Ul&&f>Ul||(f>Ul||c<Ul)&&b)&&(f++,f===xa&&f++),f>Xy&&(f=f-Xy+vg-1),o>Zy?(o=o-Zy+vg-1,b=!0):b=!1,(o===xa||h<xa&&o>xa||(o>xa||h<xa)&&b)&&o++,(o===Ul||h<Ul&&o>Ul||(o>Ul||h<Ul)&&b)&&(o++,o===xa&&o++),o>Zy&&(o=o-Zy+vg-1);var P=String.fromCharCode(f)+String.fromCharCode(o);return P}function DR(e){if(e&&e.length===0)throw"MGRSPoint coverting from nothing";for(var t=e.length,i=null,a="",c,h=0;!/[A-Z]/.test(c=e.charAt(h));){if(h>=2)throw"MGRSPoint bad conversion from: "+e;a+=c,h++}var f=parseInt(a,10);if(h===0||h+3>t)throw"MGRSPoint bad conversion from: "+e;var o=e.charAt(h++);if(o<="A"||o==="B"||o==="Y"||o>="Z"||o==="I"||o==="O")throw"MGRSPoint zone letter "+o+" not handled: "+e;i=e.substring(h,h+=2);for(var b=RR(f),P=zH(i.charAt(0),b),I=OH(i.charAt(1),b);I<LH(o);)I+=2e6;var D=t-h;if(D%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+e;var z=D/2,F=0,U=0,$,j,ie,se,Q;return z>0&&($=1e5/Math.pow(10,z),j=e.substring(h,h+z),F=parseFloat(j)*$,ie=e.substring(h+z),U=parseFloat(ie)*$),se=F+P,Q=U+I,{easting:se,northing:Q,zoneLetter:o,zoneNumber:f,accuracy:$}}function zH(e,t){for(var i=ER.charCodeAt(t-1),a=1e5,c=!1;i!==e.charCodeAt(0);){if(i++,i===xa&&i++,i===Ul&&i++,i>Xy){if(c)throw"Bad character: "+e;i=vg,c=!0}a+=1e5}return a}function OH(e,t){if(e>"V")throw"MGRSPoint given invalid Northing "+e;for(var i=IR.charCodeAt(t-1),a=0,c=!1;i!==e.charCodeAt(0);){if(i++,i===xa&&i++,i===Ul&&i++,i>Zy){if(c)throw"Bad character: "+e;i=vg,c=!0}a+=1e5}return a}function LH(e){var t;switch(e){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+e}function qg(e,t,i){if(!(this instanceof qg))return new qg(e,t,i);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if(typeof e=="object")this.x=e.x,this.y=e.y,this.z=e.z||0;else if(typeof e=="string"&&typeof t>"u"){var a=e.split(",");this.x=parseFloat(a[0],10),this.y=parseFloat(a[1],10),this.z=parseFloat(a[2],10)||0}else this.x=e,this.y=t,this.z=i||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}qg.fromMGRS=function(e){return new qg(AR(e))};qg.prototype.toMGRS=function(e){return kR([this.x,this.y],e)};var FH=1,BH=.25,qP=.046875,HP=.01953125,WP=.01068115234375,$H=.75,jH=.46875,NH=.013020833333333334,VH=.007120768229166667,UH=.3645833333333333,GH=.005696614583333333,qH=.3076171875;function _S(e){var t=[];t[0]=FH-e*(BH+e*(qP+e*(HP+e*WP))),t[1]=e*($H-e*(qP+e*(HP+e*WP)));var i=e*e;return t[2]=i*(jH-e*(NH+e*VH)),i*=e,t[3]=i*(UH-e*GH),t[4]=i*e*qH,t}function Qg(e,t,i,a){return i*=t,t*=t,a[0]*e-i*(a[1]+t*(a[2]+t*(a[3]+t*a[4])))}var HH=20;function xS(e,t,i){for(var a=1/(1-t),c=e,h=HH;h;--h){var f=Math.sin(c),o=1-t*f*f;if(o=(Qg(c,f,Math.cos(c),i)-e)*(o*Math.sqrt(o))*a,c-=o,Math.abs(o)<nr)return c}return c}function WH(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=_S(this.es),this.ml0=Qg(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function ZH(e){var t=e.x,i=e.y,a=or(t-this.long0),c,h,f,o=Math.sin(i),b=Math.cos(i);if(this.es){var I=b*a,D=Math.pow(I,2),z=this.ep2*Math.pow(b,2),F=Math.pow(z,2),U=Math.abs(b)>nr?Math.tan(i):0,$=Math.pow(U,2),j=Math.pow($,2);c=1-this.es*Math.pow(o,2),I=I/Math.sqrt(c);var ie=Qg(i,o,b,this.en);h=this.a*(this.k0*I*(1+D/6*(1-$+z+D/20*(5-18*$+j+14*z-58*$*z+D/42*(61+179*j-j*$-479*$)))))+this.x0,f=this.a*(this.k0*(ie-this.ml0+o*a*I/2*(1+D/12*(5-$+9*z+4*F+D/30*(61+j-58*$+270*z-330*$*z+D/56*(1385+543*j-j*$-3111*$))))))+this.y0}else{var P=b*Math.sin(a);if(Math.abs(Math.abs(P)-1)<nr)return 93;if(h=.5*this.a*this.k0*Math.log((1+P)/(1-P))+this.x0,f=b*Math.cos(a)/Math.sqrt(1-Math.pow(P,2)),P=Math.abs(f),P>=1){if(P-1>nr)return 93;f=0}else f=Math.acos(f);i<0&&(f=-f),f=this.a*this.k0*(f-this.lat0)+this.y0}return e.x=h,e.y=f,e}function XH(e){var t,i,a,c,h=(e.x-this.x0)*(1/this.a),f=(e.y-this.y0)*(1/this.a);if(this.es)if(t=this.ml0+f/this.k0,i=xS(t,this.es,this.en),Math.abs(i)<Ft){var D=Math.sin(i),z=Math.cos(i),F=Math.abs(z)>nr?Math.tan(i):0,U=this.ep2*Math.pow(z,2),$=Math.pow(U,2),j=Math.pow(F,2),ie=Math.pow(j,2);t=1-this.es*Math.pow(D,2);var se=h*Math.sqrt(t)/this.k0,Q=Math.pow(se,2);t=t*F,a=i-t*Q/(1-this.es)*.5*(1-Q/12*(5+3*j-9*U*j+U-4*$-Q/30*(61+90*j-252*U*j+45*ie+46*U-Q/56*(1385+3633*j+4095*ie+1574*ie*j)))),c=or(this.long0+se*(1-Q/6*(1+2*j+U-Q/20*(5+28*j+24*ie+8*U*j+6*U-Q/42*(61+662*j+1320*ie+720*ie*j))))/z)}else a=Ft*l0(f),c=0;else{var o=Math.exp(h/this.k0),b=.5*(o-1/o),P=this.lat0+f/this.k0,I=Math.cos(P);t=Math.sqrt((1-Math.pow(I,2))/(1+Math.pow(b,2))),a=Math.asin(t),f<0&&(a=-a),b===0&&I===0?c=0:c=or(Math.atan2(b,I)+this.long0)}return e.x=c,e.y=a,e}var KH=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const N_={init:WH,forward:ZH,inverse:XH,names:KH};function zR(e){var t=Math.exp(e);return t=(t-1/t)/2,t}function Sa(e,t){e=Math.abs(e),t=Math.abs(t);var i=Math.max(e,t),a=Math.min(e,t)/(i||1);return i*Math.sqrt(1+Math.pow(a,2))}function YH(e){var t=1+e,i=t-1;return i===0?e:e*Math.log(t)/i}function JH(e){var t=Math.abs(e);return t=YH(t*(1+t/(Sa(1,t)+1))),e<0?-t:t}function bS(e,t){for(var i=2*Math.cos(2*t),a=e.length-1,c=e[a],h=0,f;--a>=0;)f=-h+i*c+e[a],h=c,c=f;return t+f*Math.sin(2*t)}function QH(e,t){for(var i=2*Math.cos(t),a=e.length-1,c=e[a],h=0,f;--a>=0;)f=-h+i*c+e[a],h=c,c=f;return Math.sin(t)*f}function eW(e){var t=Math.exp(e);return t=(t+1/t)/2,t}function OR(e,t,i){for(var a=Math.sin(t),c=Math.cos(t),h=zR(i),f=eW(i),o=2*c*f,b=-2*a*h,P=e.length-1,I=e[P],D=0,z=0,F=0,U,$;--P>=0;)U=z,$=D,z=I,D=F,I=-U+o*z-b*D+e[P],F=-$+b*z+o*D;return o=a*f,b=c*h,[o*I-b*F,o*F+b*I]}function tW(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(N_.init.apply(this),this.forward=N_.forward,this.inverse=N_.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var e=this.es/(1+Math.sqrt(1-this.es)),t=e/(2-e),i=t;this.cgb[0]=t*(2+t*(-2/3+t*(-2+t*(116/45+t*(26/45+t*(-2854/675)))))),this.cbg[0]=t*(-2+t*(2/3+t*(4/3+t*(-82/45+t*(32/45+t*(4642/4725)))))),i=i*t,this.cgb[1]=i*(7/3+t*(-8/5+t*(-227/45+t*(2704/315+t*(2323/945))))),this.cbg[1]=i*(5/3+t*(-16/15+t*(-13/9+t*(904/315+t*(-1522/945))))),i=i*t,this.cgb[2]=i*(56/15+t*(-136/35+t*(-1262/105+t*(73814/2835)))),this.cbg[2]=i*(-26/15+t*(34/21+t*(8/5+t*(-12686/2835)))),i=i*t,this.cgb[3]=i*(4279/630+t*(-332/35+t*(-399572/14175))),this.cbg[3]=i*(1237/630+t*(-12/5+t*(-24832/14175))),i=i*t,this.cgb[4]=i*(4174/315+t*(-144838/6237)),this.cbg[4]=i*(-734/315+t*(109598/31185)),i=i*t,this.cgb[5]=i*(601676/22275),this.cbg[5]=i*(444337/155925),i=Math.pow(t,2),this.Qn=this.k0/(1+t)*(1+i*(1/4+i*(1/64+i/256))),this.utg[0]=t*(-.5+t*(2/3+t*(-37/96+t*(1/360+t*(81/512+t*(-96199/604800)))))),this.gtu[0]=t*(.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+t*(7891/37800)))))),this.utg[1]=i*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+t*(1118711/3870720))))),this.gtu[1]=i*(13/48+t*(-3/5+t*(557/1440+t*(281/630+t*(-1983433/1935360))))),i=i*t,this.utg[2]=i*(-17/480+t*(37/840+t*(209/4480+t*(-5569/90720)))),this.gtu[2]=i*(61/240+t*(-103/140+t*(15061/26880+t*(167603/181440)))),i=i*t,this.utg[3]=i*(-4397/161280+t*(11/504+t*(830251/7257600))),this.gtu[3]=i*(49561/161280+t*(-179/168+t*(6601661/7257600))),i=i*t,this.utg[4]=i*(-4583/161280+t*(108847/3991680)),this.gtu[4]=i*(34729/80640+t*(-3418889/1995840)),i=i*t,this.utg[5]=i*(-20648693/638668800),this.gtu[5]=i*(212378941/319334400);var a=bS(this.cbg,this.lat0);this.Zb=-this.Qn*(a+QH(this.gtu,2*a))}function rW(e){var t=or(e.x-this.long0),i=e.y;i=bS(this.cbg,i);var a=Math.sin(i),c=Math.cos(i),h=Math.sin(t),f=Math.cos(t);i=Math.atan2(a,f*c),t=Math.atan2(h*c,Sa(a,c*f)),t=JH(Math.tan(t));var o=OR(this.gtu,2*i,2*t);i=i+o[0],t=t+o[1];var b,P;return Math.abs(t)<=2.623395162778?(b=this.a*(this.Qn*t)+this.x0,P=this.a*(this.Qn*i+this.Zb)+this.y0):(b=1/0,P=1/0),e.x=b,e.y=P,e}function nW(e){var t=(e.x-this.x0)*(1/this.a),i=(e.y-this.y0)*(1/this.a);i=(i-this.Zb)/this.Qn,t=t/this.Qn;var a,c;if(Math.abs(t)<=2.623395162778){var h=OR(this.utg,2*i,2*t);i=i+h[0],t=t+h[1],t=Math.atan(zR(t));var f=Math.sin(i),o=Math.cos(i),b=Math.sin(t),P=Math.cos(t);i=Math.atan2(f*P,Sa(b,P*o)),t=Math.atan2(b,P*o),a=or(t+this.long0),c=bS(this.cgb,i)}else a=1/0,c=1/0;return e.x=a,e.y=c,e}var iW=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const V_={init:tW,forward:rW,inverse:nW,names:iW};function oW(e,t){if(e===void 0){if(e=Math.floor((or(t)+Math.PI)*30/Math.PI)+1,e<0)return 0;if(e>60)return 60}return e}var sW="etmerc";function aW(){var e=oW(this.zone,this.long0);if(e===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(e)-183)*us,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,V_.init.apply(this),this.forward=V_.forward,this.inverse=V_.inverse}var lW=["Universal Transverse Mercator System","utm"];const cW={init:aW,names:lW,dependsOn:sW};function wS(e,t){return Math.pow((1-e)/(1+e),t)}var uW=20;function hW(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Jn)/(Math.pow(Math.tan(.5*this.lat0+Jn),this.C)*wS(this.e*e,this.ratexp))}function dW(e){var t=e.x,i=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+Jn),this.C)*wS(this.e*Math.sin(i),this.ratexp))-Ft,e.x=this.C*t,e}function fW(e){for(var t=1e-14,i=e.x/this.C,a=e.y,c=Math.pow(Math.tan(.5*a+Jn)/this.K,1/this.C),h=uW;h>0&&(a=2*Math.atan(c*wS(this.e*Math.sin(e.y),-.5*this.e))-Ft,!(Math.abs(a-e.y)<t));--h)e.y=a;return h?(e.x=i,e.y=a,e):null}const SS={init:hW,forward:dW,inverse:fW};function pW(){SS.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function mW(e){var t,i,a,c;return e.x=or(e.x-this.long0),SS.forward.apply(this,[e]),t=Math.sin(e.y),i=Math.cos(e.y),a=Math.cos(e.x),c=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*i*a),e.x=c*i*Math.sin(e.x),e.y=c*(this.cosc0*t-this.sinc0*i*a),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function gW(e){var t,i,a,c,h;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,h=Sa(e.x,e.y)){var f=2*Math.atan2(h,this.R2);t=Math.sin(f),i=Math.cos(f),c=Math.asin(i*this.sinc0+e.y*t*this.cosc0/h),a=Math.atan2(e.x*t,h*this.cosc0*i-e.y*this.sinc0*t)}else c=this.phic0,a=0;return e.x=a,e.y=c,SS.inverse.apply(this,[e]),e.x=or(e.x+this.long0),e}var yW=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const vW={init:pW,forward:mW,inverse:gW,names:yW};function _W(e,t,i){return t*=i,Math.tan(.5*(Ft+e))*Math.pow((1-t)/(1+t),.5*i)}function xW(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=nr&&(this.k0=.5*(1+l0(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=nr&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=nr&&Math.abs(Math.cos(this.lat_ts))>nr&&(this.k0=.5*this.cons*sh(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Qc(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=sh(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-Ft,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function bW(e){var t=e.x,i=e.y,a=Math.sin(i),c=Math.cos(i),h,f,o,b,P,I,D=or(t-this.long0);return Math.abs(Math.abs(t-this.long0)-Math.PI)<=nr&&Math.abs(i+this.lat0)<=nr?(e.x=NaN,e.y=NaN,e):this.sphere?(h=2*this.k0/(1+this.sinlat0*a+this.coslat0*c*Math.cos(D)),e.x=this.a*h*c*Math.sin(D)+this.x0,e.y=this.a*h*(this.coslat0*a-this.sinlat0*c*Math.cos(D))+this.y0,e):(f=2*Math.atan(this.ssfn_(i,a,this.e))-Ft,b=Math.cos(f),o=Math.sin(f),Math.abs(this.coslat0)<=nr?(P=Qc(this.e,i*this.con,this.con*a),I=2*this.a*this.k0*P/this.cons,e.x=this.x0+I*Math.sin(t-this.long0),e.y=this.y0-this.con*I*Math.cos(t-this.long0),e):(Math.abs(this.sinlat0)<nr?(h=2*this.a*this.k0/(1+b*Math.cos(D)),e.y=h*o):(h=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*b*Math.cos(D))),e.y=h*(this.cosX0*o-this.sinX0*b*Math.cos(D))+this.y0),e.x=h*b*Math.sin(D)+this.x0,e))}function wW(e){e.x-=this.x0,e.y-=this.y0;var t,i,a,c,h,f=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var o=2*Math.atan(f/(2*this.a*this.k0));return t=this.long0,i=this.lat0,f<=nr?(e.x=t,e.y=i,e):(i=Math.asin(Math.cos(o)*this.sinlat0+e.y*Math.sin(o)*this.coslat0/f),Math.abs(this.coslat0)<nr?this.lat0>0?t=or(this.long0+Math.atan2(e.x,-1*e.y)):t=or(this.long0+Math.atan2(e.x,e.y)):t=or(this.long0+Math.atan2(e.x*Math.sin(o),f*this.coslat0*Math.cos(o)-e.y*this.sinlat0*Math.sin(o))),e.x=t,e.y=i,e)}else if(Math.abs(this.coslat0)<=nr){if(f<=nr)return i=this.lat0,t=this.long0,e.x=t,e.y=i,e;e.x*=this.con,e.y*=this.con,a=f*this.cons/(2*this.a*this.k0),i=this.con*Rv(this.e,a),t=this.con*or(this.con*this.long0+Math.atan2(e.x,-1*e.y))}else c=2*Math.atan(f*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,f<=nr?h=this.X0:(h=Math.asin(Math.cos(c)*this.sinX0+e.y*Math.sin(c)*this.cosX0/f),t=or(this.long0+Math.atan2(e.x*Math.sin(c),f*this.cosX0*Math.cos(c)-e.y*this.sinX0*Math.sin(c)))),i=-1*Rv(this.e,Math.tan(.5*(Ft+h)));return e.x=t,e.y=i,e}var SW=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"];const CW={init:xW,forward:bW,inverse:wW,names:SW,ssfn_:_W};function TW(){var e=this.lat0;this.lambda0=this.long0;var t=Math.sin(e),i=this.a,a=this.rf,c=1/a,h=2*c-Math.pow(c,2),f=this.e=Math.sqrt(h);this.R=this.k0*i*Math.sqrt(1-h)/(1-h*Math.pow(t,2)),this.alpha=Math.sqrt(1+h/(1-h)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(t/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),b=Math.log(Math.tan(Math.PI/4+e/2)),P=Math.log((1+f*t)/(1-f*t));this.K=o-this.alpha*b+this.alpha*f/2*P}function MW(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),a=-this.alpha*(t+i)+this.K,c=2*(Math.atan(Math.exp(a))-Math.PI/4),h=this.alpha*(e.x-this.lambda0),f=Math.atan(Math.sin(h)/(Math.sin(this.b0)*Math.tan(c)+Math.cos(this.b0)*Math.cos(h))),o=Math.asin(Math.cos(this.b0)*Math.sin(c)-Math.sin(this.b0)*Math.cos(c)*Math.cos(h));return e.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,e.x=this.R*f+this.x0,e}function PW(e){for(var t=e.x-this.x0,i=e.y-this.y0,a=t/this.R,c=2*(Math.atan(Math.exp(i/this.R))-Math.PI/4),h=Math.asin(Math.cos(this.b0)*Math.sin(c)+Math.sin(this.b0)*Math.cos(c)*Math.cos(a)),f=Math.atan(Math.sin(a)/(Math.cos(this.b0)*Math.cos(a)-Math.sin(this.b0)*Math.tan(c))),o=this.lambda0+f/this.alpha,b=0,P=h,I=-1e3,D=0;Math.abs(P-I)>1e-7;){if(++D>20)return;b=1/this.alpha*(Math.log(Math.tan(Math.PI/4+h/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(P))/2)),I=P,P=2*Math.atan(Math.exp(b))-Math.PI/2}return e.x=o,e.y=P,e}var EW=["somerc"];const IW={init:TW,forward:MW,inverse:PW,names:EW};var fg=1e-7;function kW(e){var t=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],i=typeof e.PROJECTION=="object"?Object.keys(e.PROJECTION)[0]:e.PROJECTION;return"no_uoff"in e||"no_off"in e||t.indexOf(i)!==-1}function AW(){var e,t,i,a,c,h,f,o,b,P,I=0,D,z=0,F=0,U=0,$=0,j=0,ie=0;this.no_off=kW(this),this.no_rot="no_rot"in this;var se=!1;"alpha"in this&&(se=!0);var Q=!1;if("rectified_grid_angle"in this&&(Q=!0),se&&(ie=this.alpha),Q&&(I=this.rectified_grid_angle*us),se||Q)z=this.longc;else if(F=this.long1,$=this.lat1,U=this.long2,j=this.lat2,Math.abs($-j)<=fg||(e=Math.abs($))<=fg||Math.abs(e-Ft)<=fg||Math.abs(Math.abs(this.lat0)-Ft)<=fg||Math.abs(Math.abs(j)-Ft)<=fg)throw new Error;var de=1-this.es;t=Math.sqrt(de),Math.abs(this.lat0)>nr?(o=Math.sin(this.lat0),i=Math.cos(this.lat0),e=1-this.es*o*o,this.B=i*i,this.B=Math.sqrt(1+this.es*this.B*this.B/de),this.A=this.B*this.k0*t/e,a=this.B*t/(i*Math.sqrt(e)),c=a*a-1,c<=0?c=0:(c=Math.sqrt(c),this.lat0<0&&(c=-c)),this.E=c+=a,this.E*=Math.pow(Qc(this.e,this.lat0,o),this.B)):(this.B=1/t,this.A=this.k0,this.E=a=c=1),se||Q?(se?(D=Math.asin(Math.sin(ie)/a),Q||(I=ie)):(D=I,ie=Math.asin(a*Math.sin(D))),this.lam0=z-Math.asin(.5*(c-1/c)*Math.tan(D))/this.B):(h=Math.pow(Qc(this.e,$,Math.sin($)),this.B),f=Math.pow(Qc(this.e,j,Math.sin(j)),this.B),c=this.E/h,b=(f-h)/(f+h),P=this.E*this.E,P=(P-f*h)/(P+f*h),e=F-U,e<-Math.pi?U-=kv:e>Math.pi&&(U+=kv),this.lam0=or(.5*(F+U)-Math.atan(P*Math.tan(.5*this.B*(F-U))/b)/this.B),D=Math.atan(2*Math.sin(this.B*or(F-this.lam0))/(c-1/c)),I=ie=Math.asin(a*Math.sin(D))),this.singam=Math.sin(D),this.cosgam=Math.cos(D),this.sinrot=Math.sin(I),this.cosrot=Math.cos(I),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(a*a-1)/Math.cos(ie))),this.lat0<0&&(this.u_0=-this.u_0)),c=.5*D,this.v_pole_n=this.ArB*Math.log(Math.tan(Jn-c)),this.v_pole_s=this.ArB*Math.log(Math.tan(Jn+c))}function RW(e){var t={},i,a,c,h,f,o,b,P;if(e.x=e.x-this.lam0,Math.abs(Math.abs(e.y)-Ft)>nr){if(f=this.E/Math.pow(Qc(this.e,e.y,Math.sin(e.y)),this.B),o=1/f,i=.5*(f-o),a=.5*(f+o),h=Math.sin(this.B*e.x),c=(i*this.singam-h*this.cosgam)/a,Math.abs(Math.abs(c)-1)<nr)throw new Error;P=.5*this.ArB*Math.log((1-c)/(1+c)),o=Math.cos(this.B*e.x),Math.abs(o)<fg?b=this.A*e.x:b=this.ArB*Math.atan2(i*this.cosgam+h*this.singam,o)}else P=e.y>0?this.v_pole_n:this.v_pole_s,b=this.ArB*e.y;return this.no_rot?(t.x=b,t.y=P):(b-=this.u_0,t.x=P*this.cosrot+b*this.sinrot,t.y=b*this.cosrot-P*this.sinrot),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function DW(e){var t,i,a,c,h,f,o,b={};if(e.x=(e.x-this.x0)*(1/this.a),e.y=(e.y-this.y0)*(1/this.a),this.no_rot?(i=e.y,t=e.x):(i=e.x*this.cosrot-e.y*this.sinrot,t=e.y*this.cosrot+e.x*this.sinrot+this.u_0),a=Math.exp(-this.BrA*i),c=.5*(a-1/a),h=.5*(a+1/a),f=Math.sin(this.BrA*t),o=(f*this.cosgam+c*this.singam)/h,Math.abs(Math.abs(o)-1)<nr)b.x=0,b.y=o<0?-Ft:Ft;else{if(b.y=this.E/Math.sqrt((1+o)/(1-o)),b.y=Rv(this.e,Math.pow(b.y,1/this.B)),b.y===1/0)throw new Error;b.x=-this.rB*Math.atan2(c*this.cosgam-f*this.singam,Math.cos(this.BrA*t))}return b.x+=this.lam0,b}var zW=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const OW={init:AW,forward:RW,inverse:DW,names:zW};function LW(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<nr)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var t=Math.sin(this.lat1),i=Math.cos(this.lat1),a=sh(this.e,t,i),c=Qc(this.e,this.lat1,t),h=Math.sin(this.lat2),f=Math.cos(this.lat2),o=sh(this.e,h,f),b=Qc(this.e,this.lat2,h),P=Qc(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>nr?this.ns=Math.log(a/o)/Math.log(c/b):this.ns=t,isNaN(this.ns)&&(this.ns=t),this.f0=a/(this.ns*Math.pow(c,this.ns)),this.rh=this.a*this.f0*Math.pow(P,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function FW(e){var t=e.x,i=e.y;Math.abs(2*Math.abs(i)-Math.PI)<=nr&&(i=l0(i)*(Ft-2*nr));var a=Math.abs(Math.abs(i)-Ft),c,h;if(a>nr)c=Qc(this.e,i,Math.sin(i)),h=this.a*this.f0*Math.pow(c,this.ns);else{if(a=i*this.ns,a<=0)return null;h=0}var f=this.ns*or(t-this.long0);return e.x=this.k0*(h*Math.sin(f))+this.x0,e.y=this.k0*(this.rh-h*Math.cos(f))+this.y0,e}function BW(e){var t,i,a,c,h,f=(e.x-this.x0)/this.k0,o=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(f*f+o*o),i=1):(t=-Math.sqrt(f*f+o*o),i=-1);var b=0;if(t!==0&&(b=Math.atan2(i*f,i*o)),t!==0||this.ns>0){if(i=1/this.ns,a=Math.pow(t/(this.a*this.f0),i),c=Rv(this.e,a),c===-9999)return null}else c=-Ft;return h=or(b/this.ns+this.long0),e.x=h,e.y=c,e}var $W=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const jW={init:LW,forward:FW,inverse:BW,names:$W};function NW(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function VW(e){var t,i,a,c,h,f,o,b=e.x,P=e.y,I=or(b-this.long0);return t=Math.pow((1+this.e*Math.sin(P))/(1-this.e*Math.sin(P)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(P/2+this.s45),this.alfa)/t)-this.s45),a=-I*this.alfa,c=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(a)),h=Math.asin(Math.cos(i)*Math.sin(a)/Math.cos(c)),f=this.n*h,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(c/2+this.s45),this.n),e.y=o*Math.cos(f)/1,e.x=o*Math.sin(f)/1,this.czech||(e.y*=-1,e.x*=-1),e}function UW(e){var t,i,a,c,h,f,o,b,P=e.x;e.x=e.y,e.y=P,this.czech||(e.y*=-1,e.x*=-1),f=Math.sqrt(e.x*e.x+e.y*e.y),h=Math.atan2(e.y,e.x),c=h/Math.sin(this.s0),a=2*(Math.atan(Math.pow(this.ro0/f,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(a)-Math.sin(this.ad)*Math.cos(a)*Math.cos(c)),i=Math.asin(Math.cos(a)*Math.sin(c)/Math.cos(t)),e.x=this.long0-i/this.alfa,o=t,b=0;var I=0;do e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-e.y)<1e-10&&(b=1),o=e.y,I+=1;while(b===0&&I<15);return I>=15?null:e}var GW=["Krovak","krovak"];const qW={init:NW,forward:VW,inverse:UW,names:GW};function Ys(e,t,i,a,c){return e*c-t*Math.sin(2*c)+i*Math.sin(4*c)-a*Math.sin(6*c)}function c0(e){return 1-.25*e*(1+e/16*(3+1.25*e))}function u0(e){return .375*e*(1+.25*e*(1+.46875*e))}function h0(e){return .05859375*e*e*(1+.75*e)}function d0(e){return e*e*e*(35/3072)}function Hg(e,t,i){var a=t*i;return e/Math.sqrt(1-a*a)}function Of(e){return Math.abs(e)<Ft?e:e-l0(e)*Math.PI}function _x(e,t,i,a,c){var h,f;h=e/t;for(var o=0;o<15;o++)if(f=(e-(t*h-i*Math.sin(2*h)+a*Math.sin(4*h)-c*Math.sin(6*h)))/(t-2*i*Math.cos(2*h)+4*a*Math.cos(4*h)-6*c*Math.cos(6*h)),h+=f,Math.abs(f)<=1e-10)return h;return NaN}function HW(){this.sphere||(this.e0=c0(this.es),this.e1=u0(this.es),this.e2=h0(this.es),this.e3=d0(this.es),this.ml0=this.a*Ys(this.e0,this.e1,this.e2,this.e3,this.lat0))}function WW(e){var t,i,a=e.x,c=e.y;if(a=or(a-this.long0),this.sphere)t=this.a*Math.asin(Math.cos(c)*Math.sin(a)),i=this.a*(Math.atan2(Math.tan(c),Math.cos(a))-this.lat0);else{var h=Math.sin(c),f=Math.cos(c),o=Hg(this.a,this.e,h),b=Math.tan(c)*Math.tan(c),P=a*Math.cos(c),I=P*P,D=this.es*f*f/(1-this.es),z=this.a*Ys(this.e0,this.e1,this.e2,this.e3,c);t=o*P*(1-I*b*(1/6-(8-b+8*D)*I/120)),i=z-this.ml0+o*h/f*I*(.5+(5-b+6*D)*I/24)}return e.x=t+this.x0,e.y=i+this.y0,e}function ZW(e){e.x-=this.x0,e.y-=this.y0;var t=e.x/this.a,i=e.y/this.a,a,c;if(this.sphere){var h=i+this.lat0;a=Math.asin(Math.sin(h)*Math.cos(t)),c=Math.atan2(Math.tan(t),Math.cos(h))}else{var f=this.ml0/this.a+i,o=_x(f,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-Ft)<=nr)return e.x=this.long0,e.y=Ft,i<0&&(e.y*=-1),e;var b=Hg(this.a,this.e,Math.sin(o)),P=b*b*b/this.a/this.a*(1-this.es),I=Math.pow(Math.tan(o),2),D=t*this.a/b,z=D*D;a=o-b*Math.tan(o)/P*D*D*(.5-(1+3*I)*D*D/24),c=D*(1-z*(I/3+(1+3*I)*I*z/15))/Math.cos(o)}return e.x=or(c+this.long0),e.y=Of(a),e}var XW=["Cassini","Cassini_Soldner","cass"];const KW={init:HW,forward:WW,inverse:ZW,names:XW};function Cf(e,t){var i;return e>1e-7?(i=e*t,(1-e*e)*(t/(1-i*i)-.5/e*Math.log((1-i)/(1+i)))):2*t}var YW=1,JW=2,QW=3,eZ=4;function tZ(){var e=Math.abs(this.lat0);if(Math.abs(e-Ft)<nr?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<nr?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var t;switch(this.qp=Cf(this.e,1),this.mmf=.5/(1-this.es),this.apa=uZ(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Cf(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function rZ(e){var t,i,a,c,h,f,o,b,P,I,D=e.x,z=e.y;if(D=or(D-this.long0),this.sphere){if(h=Math.sin(z),I=Math.cos(z),a=Math.cos(D),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(i=this.mode===this.EQUIT?1+I*a:1+this.sinph0*h+this.cosph0*I*a,i<=nr)return null;i=Math.sqrt(2/i),t=i*I*Math.sin(D),i*=this.mode===this.EQUIT?h:this.cosph0*h-this.sinph0*I*a}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(a=-a),Math.abs(z+this.lat0)<nr)return null;i=Jn-z*.5,i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)),t=i*Math.sin(D),i*=a}}else{switch(o=0,b=0,P=0,a=Math.cos(D),c=Math.sin(D),h=Math.sin(z),f=Cf(this.e,h),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(o=f/this.qp,b=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:P=1+this.sinb1*o+this.cosb1*b*a;break;case this.EQUIT:P=1+b*a;break;case this.N_POLE:P=Ft+z,f=this.qp-f;break;case this.S_POLE:P=z-Ft,f=this.qp+f;break}if(Math.abs(P)<nr)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:P=Math.sqrt(2/P),this.mode===this.OBLIQ?i=this.ymf*P*(this.cosb1*o-this.sinb1*b*a):i=(P=Math.sqrt(2/(1+b*a)))*o*this.ymf,t=this.xmf*P*b*c;break;case this.N_POLE:case this.S_POLE:f>=0?(t=(P=Math.sqrt(f))*c,i=a*(this.mode===this.S_POLE?P:-P)):t=i=0;break}}return e.x=this.a*t+this.x0,e.y=this.a*i+this.y0,e}function nZ(e){e.x-=this.x0,e.y-=this.y0;var t=e.x/this.a,i=e.y/this.a,a,c,h,f,o,b,P;if(this.sphere){var I=0,D,z=0;if(D=Math.sqrt(t*t+i*i),c=D*.5,c>1)return null;switch(c=2*Math.asin(c),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(z=Math.sin(c),I=Math.cos(c)),this.mode){case this.EQUIT:c=Math.abs(D)<=nr?0:Math.asin(i*z/D),t*=z,i=I*D;break;case this.OBLIQ:c=Math.abs(D)<=nr?this.lat0:Math.asin(I*this.sinph0+i*z*this.cosph0/D),t*=z*this.cosph0,i=(I-Math.sin(c)*this.sinph0)*D;break;case this.N_POLE:i=-i,c=Ft-c;break;case this.S_POLE:c-=Ft;break}a=i===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(t,i)}else{if(P=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t/=this.dd,i*=this.dd,b=Math.sqrt(t*t+i*i),b<nr)return e.x=this.long0,e.y=this.lat0,e;f=2*Math.asin(.5*b/this.rq),h=Math.cos(f),t*=f=Math.sin(f),this.mode===this.OBLIQ?(P=h*this.sinb1+i*f*this.cosb1/b,o=this.qp*P,i=b*this.cosb1*h-i*this.sinb1*f):(P=i*f/b,o=this.qp*P,i=b*h)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),o=t*t+i*i,!o)return e.x=this.long0,e.y=this.lat0,e;P=1-o/this.qp,this.mode===this.S_POLE&&(P=-P)}a=Math.atan2(t,i),c=hZ(Math.asin(P),this.apa)}return e.x=or(this.long0+a),e.y=c,e}var iZ=.3333333333333333,oZ=.17222222222222222,sZ=.10257936507936508,aZ=.06388888888888888,lZ=.0664021164021164,cZ=.016415012942191543;function uZ(e){var t,i=[];return i[0]=e*iZ,t=e*e,i[0]+=t*oZ,i[1]=t*aZ,t*=e,i[0]+=t*sZ,i[1]+=t*lZ,i[2]=t*cZ,i}function hZ(e,t){var i=e+e;return e+t[0]*Math.sin(i)+t[1]*Math.sin(i+i)+t[2]*Math.sin(i+i+i)}var dZ=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const fZ={init:tZ,forward:rZ,inverse:nZ,names:dZ,S_POLE:YW,N_POLE:JW,EQUIT:QW,OBLIQ:eZ};function kf(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)}function pZ(){Math.abs(this.lat1+this.lat2)<nr||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=sh(this.e3,this.sin_po,this.cos_po),this.qs1=Cf(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=sh(this.e3,this.sin_po,this.cos_po),this.qs2=Cf(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Cf(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>nr?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function mZ(e){var t=e.x,i=e.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var a=Cf(this.e3,this.sin_phi),c=this.a*Math.sqrt(this.c-this.ns0*a)/this.ns0,h=this.ns0*or(t-this.long0),f=c*Math.sin(h)+this.x0,o=this.rh-c*Math.cos(h)+this.y0;return e.x=f,e.y=o,e}function gZ(e){var t,i,a,c,h,f;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0>=0?(t=Math.sqrt(e.x*e.x+e.y*e.y),a=1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),a=-1),c=0,t!==0&&(c=Math.atan2(a*e.x,a*e.y)),a=t*this.ns0/this.a,this.sphere?f=Math.asin((this.c-a*a)/(2*this.ns0)):(i=(this.c-a*a)/this.ns0,f=this.phi1z(this.e3,i)),h=or(c/this.ns0+this.long0),e.x=h,e.y=f,e}function yZ(e,t){var i,a,c,h,f,o=kf(.5*t);if(e<nr)return o;for(var b=e*e,P=1;P<=25;P++)if(i=Math.sin(o),a=Math.cos(o),c=e*i,h=1-c*c,f=.5*h*h/a*(t/(1-b)-i/h+.5/e*Math.log((1-c)/(1+c))),o=o+f,Math.abs(f)<=1e-7)return o;return null}var vZ=["Albers_Conic_Equal_Area","Albers","aea"];const _Z={init:pZ,forward:mZ,inverse:gZ,names:vZ,phi1z:yZ};function xZ(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function bZ(e){var t,i,a,c,h,f,o,b,P=e.x,I=e.y;return a=or(P-this.long0),t=Math.sin(I),i=Math.cos(I),c=Math.cos(a),f=this.sin_p14*t+this.cos_p14*i*c,h=1,f>0||Math.abs(f)<=nr?(o=this.x0+this.a*h*i*Math.sin(a)/f,b=this.y0+this.a*h*(this.cos_p14*t-this.sin_p14*i*c)/f):(o=this.x0+this.infinity_dist*i*Math.sin(a),b=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*i*c)),e.x=o,e.y=b,e}function wZ(e){var t,i,a,c,h,f;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(t=Math.sqrt(e.x*e.x+e.y*e.y))?(c=Math.atan2(t,this.rc),i=Math.sin(c),a=Math.cos(c),f=kf(a*this.sin_p14+e.y*i*this.cos_p14/t),h=Math.atan2(e.x*i,t*this.cos_p14*a-e.y*this.sin_p14*i),h=or(this.long0+h)):(f=this.phic0,h=0),e.x=h,e.y=f,e}var SZ=["gnom"];const CZ={init:xZ,forward:bZ,inverse:wZ,names:SZ};function TZ(e,t){var i=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(t)-i)<1e-6)return t<0?-1*Ft:Ft;for(var a=Math.asin(.5*t),c,h,f,o,b=0;b<30;b++)if(h=Math.sin(a),f=Math.cos(a),o=e*h,c=Math.pow(1-o*o,2)/(2*f)*(t/(1-e*e)-h/(1-o*o)+.5/e*Math.log((1-o)/(1+o))),a+=c,Math.abs(c)<=1e-10)return a;return NaN}function MZ(){this.sphere||(this.k0=sh(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function PZ(e){var t=e.x,i=e.y,a,c,h=or(t-this.long0);if(this.sphere)a=this.x0+this.a*h*Math.cos(this.lat_ts),c=this.y0+this.a*Math.sin(i)/Math.cos(this.lat_ts);else{var f=Cf(this.e,Math.sin(i));a=this.x0+this.a*this.k0*h,c=this.y0+this.a*f*.5/this.k0}return e.x=a,e.y=c,e}function EZ(e){e.x-=this.x0,e.y-=this.y0;var t,i;return this.sphere?(t=or(this.long0+e.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(i=TZ(this.e,2*e.y*this.k0/this.a),t=or(this.long0+e.x/(this.a*this.k0))),e.x=t,e.y=i,e}var IZ=["cea"];const kZ={init:MZ,forward:PZ,inverse:EZ,names:IZ};function AZ(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function RZ(e){var t=e.x,i=e.y,a=or(t-this.long0),c=Of(i-this.lat0);return e.x=this.x0+this.a*a*this.rc,e.y=this.y0+this.a*c,e}function DZ(e){var t=e.x,i=e.y;return e.x=or(this.long0+(t-this.x0)/(this.a*this.rc)),e.y=Of(this.lat0+(i-this.y0)/this.a),e}var zZ=["Equirectangular","Equidistant_Cylindrical","eqc"];const OZ={init:AZ,forward:RZ,inverse:DZ,names:zZ};var ZP=20;function LZ(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=c0(this.es),this.e1=u0(this.es),this.e2=h0(this.es),this.e3=d0(this.es),this.ml0=this.a*Ys(this.e0,this.e1,this.e2,this.e3,this.lat0)}function FZ(e){var t=e.x,i=e.y,a,c,h,f=or(t-this.long0);if(h=f*Math.sin(i),this.sphere)Math.abs(i)<=nr?(a=this.a*f,c=-1*this.a*this.lat0):(a=this.a*Math.sin(h)/Math.tan(i),c=this.a*(Of(i-this.lat0)+(1-Math.cos(h))/Math.tan(i)));else if(Math.abs(i)<=nr)a=this.a*f,c=-1*this.ml0;else{var o=Hg(this.a,this.e,Math.sin(i))/Math.tan(i);a=o*Math.sin(h),c=this.a*Ys(this.e0,this.e1,this.e2,this.e3,i)-this.ml0+o*(1-Math.cos(h))}return e.x=a+this.x0,e.y=c+this.y0,e}function BZ(e){var t,i,a,c,h,f,o,b,P;if(a=e.x-this.x0,c=e.y-this.y0,this.sphere)if(Math.abs(c+this.a*this.lat0)<=nr)t=or(a/this.a+this.long0),i=0;else{f=this.lat0+c/this.a,o=a*a/this.a/this.a+f*f,b=f;var I;for(h=ZP;h;--h)if(I=Math.tan(b),P=-1*(f*(b*I+1)-b-.5*(b*b+o)*I)/((b-f)/I-1),b+=P,Math.abs(P)<=nr){i=b;break}t=or(this.long0+Math.asin(a*Math.tan(b)/this.a)/Math.sin(i))}else if(Math.abs(c+this.ml0)<=nr)i=0,t=or(this.long0+a/this.a);else{f=(this.ml0+c)/this.a,o=a*a/this.a/this.a+f*f,b=f;var D,z,F,U,$;for(h=ZP;h;--h)if($=this.e*Math.sin(b),D=Math.sqrt(1-$*$)*Math.tan(b),z=this.a*Ys(this.e0,this.e1,this.e2,this.e3,b),F=this.e0-2*this.e1*Math.cos(2*b)+4*this.e2*Math.cos(4*b)-6*this.e3*Math.cos(6*b),U=z/this.a,P=(f*(D*U+1)-U-.5*D*(U*U+o))/(this.es*Math.sin(2*b)*(U*U+o-2*f*U)/(4*D)+(f-U)*(D*F-2/Math.sin(2*b))-F),b-=P,Math.abs(P)<=nr){i=b;break}D=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),t=or(this.long0+Math.asin(a*D/this.a)/Math.sin(i))}return e.x=t,e.y=i,e}var $Z=["Polyconic","poly"];const jZ={init:LZ,forward:FZ,inverse:BZ,names:$Z};function NZ(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function VZ(e){var t,i=e.x,a=e.y,c=a-this.lat0,h=i-this.long0,f=c/lv*1e-5,o=h,b=1,P=0;for(t=1;t<=10;t++)b=b*f,P=P+this.A[t]*b;var I=P,D=o,z=1,F=0,U,$,j=0,ie=0;for(t=1;t<=6;t++)U=z*I-F*D,$=F*I+z*D,z=U,F=$,j=j+this.B_re[t]*z-this.B_im[t]*F,ie=ie+this.B_im[t]*z+this.B_re[t]*F;return e.x=ie*this.a+this.x0,e.y=j*this.a+this.y0,e}function UZ(e){var t,i=e.x,a=e.y,c=i-this.x0,h=a-this.y0,f=h/this.a,o=c/this.a,b=1,P=0,I,D,z=0,F=0;for(t=1;t<=6;t++)I=b*f-P*o,D=P*f+b*o,b=I,P=D,z=z+this.C_re[t]*b-this.C_im[t]*P,F=F+this.C_im[t]*b+this.C_re[t]*P;for(var U=0;U<this.iterations;U++){var $=z,j=F,ie,se,Q=f,de=o;for(t=2;t<=6;t++)ie=$*z-j*F,se=j*z+$*F,$=ie,j=se,Q=Q+(t-1)*(this.B_re[t]*$-this.B_im[t]*j),de=de+(t-1)*(this.B_im[t]*$+this.B_re[t]*j);$=1,j=0;var oe=this.B_re[1],be=this.B_im[1];for(t=2;t<=6;t++)ie=$*z-j*F,se=j*z+$*F,$=ie,j=se,oe=oe+t*(this.B_re[t]*$-this.B_im[t]*j),be=be+t*(this.B_im[t]*$+this.B_re[t]*j);var xe=oe*oe+be*be;z=(Q*oe+de*be)/xe,F=(de*oe-Q*be)/xe}var Me=z,Ee=F,re=1,ke=0;for(t=1;t<=9;t++)re=re*Me,ke=ke+this.D[t]*re;var Ge=this.lat0+ke*lv*1e5,Ke=this.long0+Ee;return e.x=Ke,e.y=Ge,e}var GZ=["New_Zealand_Map_Grid","nzmg"];const qZ={init:NZ,forward:VZ,inverse:UZ,names:GZ};function HZ(){}function WZ(e){var t=e.x,i=e.y,a=or(t-this.long0),c=this.x0+this.a*a,h=this.y0+this.a*Math.log(Math.tan(Math.PI/4+i/2.5))*1.25;return e.x=c,e.y=h,e}function ZZ(e){e.x-=this.x0,e.y-=this.y0;var t=or(this.long0+e.x/this.a),i=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=t,e.y=i,e}var XZ=["Miller_Cylindrical","mill"];const KZ={init:HZ,forward:WZ,inverse:ZZ,names:XZ};var YZ=20;function JZ(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=_S(this.es)}function QZ(e){var t,i,a=e.x,c=e.y;if(a=or(a-this.long0),this.sphere){if(!this.m)c=this.n!==1?Math.asin(this.n*Math.sin(c)):c;else for(var h=this.n*Math.sin(c),f=YZ;f;--f){var o=(this.m*c+Math.sin(c)-h)/(this.m+Math.cos(c));if(c-=o,Math.abs(o)<nr)break}t=this.a*this.C_x*a*(this.m+Math.cos(c)),i=this.a*this.C_y*c}else{var b=Math.sin(c),P=Math.cos(c);i=this.a*Qg(c,b,P,this.en),t=this.a*a*P/Math.sqrt(1-this.es*b*b)}return e.x=t,e.y=i,e}function eX(e){var t,i,a,c;return e.x-=this.x0,a=e.x/this.a,e.y-=this.y0,t=e.y/this.a,this.sphere?(t/=this.C_y,a=a/(this.C_x*(this.m+Math.cos(t))),this.m?t=kf((this.m*t+Math.sin(t))/this.n):this.n!==1&&(t=kf(Math.sin(t)/this.n)),a=or(a+this.long0),t=Of(t)):(t=xS(e.y/this.a,this.es,this.en),c=Math.abs(t),c<Ft?(c=Math.sin(t),i=this.long0+e.x*Math.sqrt(1-this.es*c*c)/(this.a*Math.cos(t)),a=or(i)):c-nr<Ft&&(a=this.long0)),e.x=a,e.y=t,e}var tX=["Sinusoidal","sinu"];const rX={init:JZ,forward:QZ,inverse:eX,names:tX};function nX(){}function iX(e){for(var t=e.x,i=e.y,a=or(t-this.long0),c=i,h=Math.PI*Math.sin(i);;){var f=-(c+Math.sin(c)-h)/(1+Math.cos(c));if(c+=f,Math.abs(f)<nr)break}c/=2,Math.PI/2-Math.abs(i)<nr&&(a=0);var o=.900316316158*this.a*a*Math.cos(c)+this.x0,b=1.4142135623731*this.a*Math.sin(c)+this.y0;return e.x=o,e.y=b,e}function oX(e){var t,i;e.x-=this.x0,e.y-=this.y0,i=e.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),t=Math.asin(i);var a=or(this.long0+e.x/(.900316316158*this.a*Math.cos(t)));a<-Math.PI&&(a=-Math.PI),a>Math.PI&&(a=Math.PI),i=(2*t+Math.sin(2*t))/Math.PI,Math.abs(i)>1&&(i=1);var c=Math.asin(i);return e.x=a,e.y=c,e}var sX=["Mollweide","moll"];const aX={init:nX,forward:iX,inverse:oX,names:sX};function lX(){Math.abs(this.lat1+this.lat2)<nr||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=c0(this.es),this.e1=u0(this.es),this.e2=h0(this.es),this.e3=d0(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=sh(this.e,this.sinphi,this.cosphi),this.ml1=Ys(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<nr?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=sh(this.e,this.sinphi,this.cosphi),this.ml2=Ys(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Ys(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function cX(e){var t=e.x,i=e.y,a;if(this.sphere)a=this.a*(this.g-i);else{var c=Ys(this.e0,this.e1,this.e2,this.e3,i);a=this.a*(this.g-c)}var h=this.ns*or(t-this.long0),f=this.x0+a*Math.sin(h),o=this.y0+this.rh-a*Math.cos(h);return e.x=f,e.y=o,e}function uX(e){e.x-=this.x0,e.y=this.rh-e.y+this.y0;var t,i,a,c;this.ns>=0?(i=Math.sqrt(e.x*e.x+e.y*e.y),t=1):(i=-Math.sqrt(e.x*e.x+e.y*e.y),t=-1);var h=0;if(i!==0&&(h=Math.atan2(t*e.x,t*e.y)),this.sphere)return c=or(this.long0+h/this.ns),a=Of(this.g-i/this.a),e.x=c,e.y=a,e;var f=this.g-i/this.a;return a=_x(f,this.e0,this.e1,this.e2,this.e3),c=or(this.long0+h/this.ns),e.x=c,e.y=a,e}var hX=["Equidistant_Conic","eqdc"];const dX={init:lX,forward:cX,inverse:uX,names:hX};function fX(){this.R=this.a}function pX(e){var t=e.x,i=e.y,a=or(t-this.long0),c,h;Math.abs(i)<=nr&&(c=this.x0+this.R*a,h=this.y0);var f=kf(2*Math.abs(i/Math.PI));(Math.abs(a)<=nr||Math.abs(Math.abs(i)-Ft)<=nr)&&(c=this.x0,i>=0?h=this.y0+Math.PI*this.R*Math.tan(.5*f):h=this.y0+Math.PI*this.R*-Math.tan(.5*f));var o=.5*Math.abs(Math.PI/a-a/Math.PI),b=o*o,P=Math.sin(f),I=Math.cos(f),D=I/(P+I-1),z=D*D,F=D*(2/P-1),U=F*F,$=Math.PI*this.R*(o*(D-U)+Math.sqrt(b*(D-U)*(D-U)-(U+b)*(z-U)))/(U+b);a<0&&($=-$),c=this.x0+$;var j=b+D;return $=Math.PI*this.R*(F*j-o*Math.sqrt((U+b)*(b+1)-j*j))/(U+b),i>=0?h=this.y0+$:h=this.y0-$,e.x=c,e.y=h,e}function mX(e){var t,i,a,c,h,f,o,b,P,I,D,z,F;return e.x-=this.x0,e.y-=this.y0,D=Math.PI*this.R,a=e.x/D,c=e.y/D,h=a*a+c*c,f=-Math.abs(c)*(1+h),o=f-2*c*c+a*a,b=-2*f+1+2*c*c+h*h,F=c*c/b+(2*o*o*o/b/b/b-9*f*o/b/b)/27,P=(f-o*o/3/b)/b,I=2*Math.sqrt(-P/3),D=3*F/P/I,Math.abs(D)>1&&(D>=0?D=1:D=-1),z=Math.acos(D)/3,e.y>=0?i=(-I*Math.cos(z+Math.PI/3)-o/3/b)*Math.PI:i=-(-I*Math.cos(z+Math.PI/3)-o/3/b)*Math.PI,Math.abs(a)<nr?t=this.long0:t=or(this.long0+Math.PI*(h-1+Math.sqrt(1+2*(a*a-c*c)+h*h))/2/a),e.x=t,e.y=i,e}var gX=["Van_der_Grinten_I","VanDerGrinten","vandg"];const yX={init:fX,forward:pX,inverse:mX,names:gX};function vX(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function _X(e){var t=e.x,i=e.y,a=Math.sin(e.y),c=Math.cos(e.y),h=or(t-this.long0),f,o,b,P,I,D,z,F,U,$,j,ie,se,Q,de,oe,be,xe,Me,Ee,re,ke,Ge;return this.sphere?Math.abs(this.sin_p12-1)<=nr?(e.x=this.x0+this.a*(Ft-i)*Math.sin(h),e.y=this.y0-this.a*(Ft-i)*Math.cos(h),e):Math.abs(this.sin_p12+1)<=nr?(e.x=this.x0+this.a*(Ft+i)*Math.sin(h),e.y=this.y0+this.a*(Ft+i)*Math.cos(h),e):(xe=this.sin_p12*a+this.cos_p12*c*Math.cos(h),oe=Math.acos(xe),be=oe?oe/Math.sin(oe):1,e.x=this.x0+this.a*be*c*Math.sin(h),e.y=this.y0+this.a*be*(this.cos_p12*a-this.sin_p12*c*Math.cos(h)),e):(f=c0(this.es),o=u0(this.es),b=h0(this.es),P=d0(this.es),Math.abs(this.sin_p12-1)<=nr?(I=this.a*Ys(f,o,b,P,Ft),D=this.a*Ys(f,o,b,P,i),e.x=this.x0+(I-D)*Math.sin(h),e.y=this.y0-(I-D)*Math.cos(h),e):Math.abs(this.sin_p12+1)<=nr?(I=this.a*Ys(f,o,b,P,Ft),D=this.a*Ys(f,o,b,P,i),e.x=this.x0+(I+D)*Math.sin(h),e.y=this.y0+(I+D)*Math.cos(h),e):(z=a/c,F=Hg(this.a,this.e,this.sin_p12),U=Hg(this.a,this.e,a),$=Math.atan((1-this.es)*z+this.es*F*this.sin_p12/(U*c)),j=Math.atan2(Math.sin(h),this.cos_p12*Math.tan($)-this.sin_p12*Math.cos(h)),j===0?Me=Math.asin(this.cos_p12*Math.sin($)-this.sin_p12*Math.cos($)):Math.abs(Math.abs(j)-Math.PI)<=nr?Me=-Math.asin(this.cos_p12*Math.sin($)-this.sin_p12*Math.cos($)):Me=Math.asin(Math.sin(h)*Math.cos($)/Math.sin(j)),ie=this.e*this.sin_p12/Math.sqrt(1-this.es),se=this.e*this.cos_p12*Math.cos(j)/Math.sqrt(1-this.es),Q=ie*se,de=se*se,Ee=Me*Me,re=Ee*Me,ke=re*Me,Ge=ke*Me,oe=F*Me*(1-Ee*de*(1-de)/6+re/8*Q*(1-2*de)+ke/120*(de*(4-7*de)-3*ie*ie*(1-7*de))-Ge/48*Q),e.x=this.x0+oe*Math.sin(j),e.y=this.y0+oe*Math.cos(j),e))}function xX(e){e.x-=this.x0,e.y-=this.y0;var t,i,a,c,h,f,o,b,P,I,D,z,F,U,$,j,ie,se,Q,de,oe,be,xe,Me;return this.sphere?(t=Math.sqrt(e.x*e.x+e.y*e.y),t>2*Ft*this.a?void 0:(i=t/this.a,a=Math.sin(i),c=Math.cos(i),h=this.long0,Math.abs(t)<=nr?f=this.lat0:(f=kf(c*this.sin_p12+e.y*a*this.cos_p12/t),o=Math.abs(this.lat0)-Ft,Math.abs(o)<=nr?this.lat0>=0?h=or(this.long0+Math.atan2(e.x,-e.y)):h=or(this.long0-Math.atan2(-e.x,e.y)):h=or(this.long0+Math.atan2(e.x*a,t*this.cos_p12*c-e.y*this.sin_p12*a))),e.x=h,e.y=f,e)):(b=c0(this.es),P=u0(this.es),I=h0(this.es),D=d0(this.es),Math.abs(this.sin_p12-1)<=nr?(z=this.a*Ys(b,P,I,D,Ft),t=Math.sqrt(e.x*e.x+e.y*e.y),F=z-t,f=_x(F/this.a,b,P,I,D),h=or(this.long0+Math.atan2(e.x,-1*e.y)),e.x=h,e.y=f,e):Math.abs(this.sin_p12+1)<=nr?(z=this.a*Ys(b,P,I,D,Ft),t=Math.sqrt(e.x*e.x+e.y*e.y),F=t-z,f=_x(F/this.a,b,P,I,D),h=or(this.long0+Math.atan2(e.x,e.y)),e.x=h,e.y=f,e):(t=Math.sqrt(e.x*e.x+e.y*e.y),j=Math.atan2(e.x,e.y),U=Hg(this.a,this.e,this.sin_p12),ie=Math.cos(j),se=this.e*this.cos_p12*ie,Q=-se*se/(1-this.es),de=3*this.es*(1-Q)*this.sin_p12*this.cos_p12*ie/(1-this.es),oe=t/U,be=oe-Q*(1+Q)*Math.pow(oe,3)/6-de*(1+3*Q)*Math.pow(oe,4)/24,xe=1-Q*be*be/2-oe*be*be*be/6,$=Math.asin(this.sin_p12*Math.cos(be)+this.cos_p12*Math.sin(be)*ie),h=or(this.long0+Math.asin(Math.sin(j)*Math.sin(be)/Math.cos($))),Me=Math.sin($),f=Math.atan2((Me-this.es*xe*this.sin_p12)*Math.tan($),Me*(1-this.es)),e.x=h,e.y=f,e))}var bX=["Azimuthal_Equidistant","aeqd"];const wX={init:vX,forward:_X,inverse:xX,names:bX};function SX(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function CX(e){var t,i,a,c,h,f,o,b,P=e.x,I=e.y;return a=or(P-this.long0),t=Math.sin(I),i=Math.cos(I),c=Math.cos(a),f=this.sin_p14*t+this.cos_p14*i*c,h=1,(f>0||Math.abs(f)<=nr)&&(o=this.a*h*i*Math.sin(a),b=this.y0+this.a*h*(this.cos_p14*t-this.sin_p14*i*c)),e.x=o,e.y=b,e}function TX(e){var t,i,a,c,h,f,o;return e.x-=this.x0,e.y-=this.y0,t=Math.sqrt(e.x*e.x+e.y*e.y),i=kf(t/this.a),a=Math.sin(i),c=Math.cos(i),f=this.long0,Math.abs(t)<=nr?(o=this.lat0,e.x=f,e.y=o,e):(o=kf(c*this.sin_p14+e.y*a*this.cos_p14/t),h=Math.abs(this.lat0)-Ft,Math.abs(h)<=nr?(this.lat0>=0?f=or(this.long0+Math.atan2(e.x,-e.y)):f=or(this.long0-Math.atan2(-e.x,e.y)),e.x=f,e.y=o,e):(f=or(this.long0+Math.atan2(e.x*a,t*this.cos_p14*c-e.y*this.sin_p14*a)),e.x=f,e.y=o,e))}var MX=["ortho"];const PX={init:SX,forward:CX,inverse:TX,names:MX};var Xi={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Qn={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function EX(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=Ft-Jn/2?this.face=Xi.TOP:this.lat0<=-(Ft-Jn/2)?this.face=Xi.BOTTOM:Math.abs(this.long0)<=Jn?this.face=Xi.FRONT:Math.abs(this.long0)<=Ft+Jn?this.face=this.long0>0?Xi.RIGHT:Xi.LEFT:this.face=Xi.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function IX(e){var t={x:0,y:0},i,a,c,h,f,o,b={value:0};if(e.x-=this.long0,this.es!==0?i=Math.atan(this.one_minus_f_squared*Math.tan(e.y)):i=e.y,a=e.x,this.face===Xi.TOP)h=Ft-i,a>=Jn&&a<=Ft+Jn?(b.value=Qn.AREA_0,c=a-Ft):a>Ft+Jn||a<=-(Ft+Jn)?(b.value=Qn.AREA_1,c=a>0?a-vo:a+vo):a>-(Ft+Jn)&&a<=-Jn?(b.value=Qn.AREA_2,c=a+Ft):(b.value=Qn.AREA_3,c=a);else if(this.face===Xi.BOTTOM)h=Ft+i,a>=Jn&&a<=Ft+Jn?(b.value=Qn.AREA_0,c=-a+Ft):a<Jn&&a>=-Jn?(b.value=Qn.AREA_1,c=-a):a<-Jn&&a>=-(Ft+Jn)?(b.value=Qn.AREA_2,c=-a-Ft):(b.value=Qn.AREA_3,c=a>0?-a+vo:-a-vo);else{var P,I,D,z,F,U,$;this.face===Xi.RIGHT?a=Pg(a,+Ft):this.face===Xi.BACK?a=Pg(a,+vo):this.face===Xi.LEFT&&(a=Pg(a,-Ft)),z=Math.sin(i),F=Math.cos(i),U=Math.sin(a),$=Math.cos(a),P=F*$,I=F*U,D=z,this.face===Xi.FRONT?(h=Math.acos(P),c=b_(h,D,I,b)):this.face===Xi.RIGHT?(h=Math.acos(I),c=b_(h,D,-P,b)):this.face===Xi.BACK?(h=Math.acos(-P),c=b_(h,D,-I,b)):this.face===Xi.LEFT?(h=Math.acos(-I),c=b_(h,D,P,b)):(h=c=0,b.value=Qn.AREA_0)}return o=Math.atan(12/vo*(c+Math.acos(Math.sin(c)*Math.cos(Jn))-Ft)),f=Math.sqrt((1-Math.cos(h))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(c))))),b.value===Qn.AREA_1?o+=Ft:b.value===Qn.AREA_2?o+=vo:b.value===Qn.AREA_3&&(o+=1.5*vo),t.x=f*Math.cos(o),t.y=f*Math.sin(o),t.x=t.x*this.a+this.x0,t.y=t.y*this.a+this.y0,e.x=t.x,e.y=t.y,e}function kX(e){var t={lam:0,phi:0},i,a,c,h,f,o,b,P,I,D={value:0};if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,a=Math.atan(Math.sqrt(e.x*e.x+e.y*e.y)),i=Math.atan2(e.y,e.x),e.x>=0&&e.x>=Math.abs(e.y)?D.value=Qn.AREA_0:e.y>=0&&e.y>=Math.abs(e.x)?(D.value=Qn.AREA_1,i-=Ft):e.x<0&&-e.x>=Math.abs(e.y)?(D.value=Qn.AREA_2,i=i<0?i+vo:i-vo):(D.value=Qn.AREA_3,i+=Ft),I=vo/12*Math.tan(i),f=Math.sin(I)/(Math.cos(I)-1/Math.sqrt(2)),o=Math.atan(f),c=Math.cos(i),h=Math.tan(a),b=1-c*c*h*h*(1-Math.cos(Math.atan(1/Math.cos(o)))),b<-1?b=-1:b>1&&(b=1),this.face===Xi.TOP)P=Math.acos(b),t.phi=Ft-P,D.value===Qn.AREA_0?t.lam=o+Ft:D.value===Qn.AREA_1?t.lam=o<0?o+vo:o-vo:D.value===Qn.AREA_2?t.lam=o-Ft:t.lam=o;else if(this.face===Xi.BOTTOM)P=Math.acos(b),t.phi=P-Ft,D.value===Qn.AREA_0?t.lam=-o+Ft:D.value===Qn.AREA_1?t.lam=-o:D.value===Qn.AREA_2?t.lam=-o-Ft:t.lam=o<0?-o-vo:-o+vo;else{var z,F,U;z=b,I=z*z,I>=1?U=0:U=Math.sqrt(1-I)*Math.sin(o),I+=U*U,I>=1?F=0:F=Math.sqrt(1-I),D.value===Qn.AREA_1?(I=F,F=-U,U=I):D.value===Qn.AREA_2?(F=-F,U=-U):D.value===Qn.AREA_3&&(I=F,F=U,U=-I),this.face===Xi.RIGHT?(I=z,z=-F,F=I):this.face===Xi.BACK?(z=-z,F=-F):this.face===Xi.LEFT&&(I=z,z=F,F=-I),t.phi=Math.acos(-U)-Ft,t.lam=Math.atan2(F,z),this.face===Xi.RIGHT?t.lam=Pg(t.lam,-Ft):this.face===Xi.BACK?t.lam=Pg(t.lam,-vo):this.face===Xi.LEFT&&(t.lam=Pg(t.lam,+Ft))}if(this.es!==0){var $,j,ie;$=t.phi<0?1:0,j=Math.tan(t.phi),ie=this.b/Math.sqrt(j*j+this.one_minus_f_squared),t.phi=Math.atan(Math.sqrt(this.a*this.a-ie*ie)/(this.one_minus_f*ie)),$&&(t.phi=-t.phi)}return t.lam+=this.long0,e.x=t.lam,e.y=t.phi,e}function b_(e,t,i,a){var c;return e<nr?(a.value=Qn.AREA_0,c=0):(c=Math.atan2(t,i),Math.abs(c)<=Jn?a.value=Qn.AREA_0:c>Jn&&c<=Ft+Jn?(a.value=Qn.AREA_1,c-=Ft):c>Ft+Jn||c<=-(Ft+Jn)?(a.value=Qn.AREA_2,c=c>=0?c-vo:c+vo):(a.value=Qn.AREA_3,c+=Ft)),c}function Pg(e,t){var i=e+t;return i<-vo?i+=kv:i>+vo&&(i-=kv),i}var AX=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const RX={init:EX,forward:IX,inverse:kX,names:AX};var Qw=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Ky=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],LR=.8487,FR=1.3523,BR=Yu/5,DX=1/BR,_g=18,xx=function(e,t){return e[0]+t*(e[1]+t*(e[2]+t*e[3]))},zX=function(e,t){return e[1]+t*(2*e[2]+t*3*e[3])};function OX(e,t,i,a){for(var c=t;a;--a){var h=e(c);if(c-=h,Math.abs(h)<i)break}return c}function LX(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function FX(e){var t=or(e.x-this.long0),i=Math.abs(e.y),a=Math.floor(i*BR);a<0?a=0:a>=_g&&(a=_g-1),i=Yu*(i-DX*a);var c={x:xx(Qw[a],i)*t,y:xx(Ky[a],i)};return e.y<0&&(c.y=-c.y),c.x=c.x*this.a*LR+this.x0,c.y=c.y*this.a*FR+this.y0,c}function BX(e){var t={x:(e.x-this.x0)/(this.a*LR),y:Math.abs(e.y-this.y0)/(this.a*FR)};if(t.y>=1)t.x/=Qw[_g][0],t.y=e.y<0?-Ft:Ft;else{var i=Math.floor(t.y*_g);for(i<0?i=0:i>=_g&&(i=_g-1);;)if(Ky[i][0]>t.y)--i;else if(Ky[i+1][0]<=t.y)++i;else break;var a=Ky[i],c=5*(t.y-a[0])/(Ky[i+1][0]-a[0]);c=OX(function(h){return(xx(a,h)-t.y)/zX(a,h)},c,nr,100),t.x/=xx(Qw[i],c),t.y=(5*i+c)*us,e.y<0&&(t.y=-t.y)}return t.x=or(t.x+this.long0),t}var $X=["Robinson","robin"];const jX={init:LX,forward:FX,inverse:BX,names:$X};function NX(){this.name="geocent"}function VX(e){var t=TR(e,this.es,this.a);return t}function UX(e){var t=MR(e,this.es,this.a,this.b);return t}var GX=["Geocentric","geocentric","geocent","Geocent"];const qX={init:NX,forward:VX,inverse:UX,names:GX};var As={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},Uy={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function HX(){if(Object.keys(Uy).forEach((function(i){if(typeof this[i]>"u")this[i]=Uy[i].def;else{if(Uy[i].num&&isNaN(this[i]))throw new Error("Invalid parameter value, must be numeric "+i+" = "+this[i]);Uy[i].num&&(this[i]=parseFloat(this[i]))}Uy[i].degrees&&(this[i]=this[i]*us)}).bind(this)),Math.abs(Math.abs(this.lat0)-Ft)<nr?this.mode=this.lat0<0?As.S_POLE:As.N_POLE:Math.abs(this.lat0)<nr?this.mode=As.EQUIT:(this.mode=As.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var e=this.tilt,t=this.azi;this.cg=Math.cos(t),this.sg=Math.sin(t),this.cw=Math.cos(e),this.sw=Math.sin(e)}function WX(e){e.x-=this.long0;var t=Math.sin(e.y),i=Math.cos(e.y),a=Math.cos(e.x),c,h;switch(this.mode){case As.OBLIQ:h=this.sinph0*t+this.cosph0*i*a;break;case As.EQUIT:h=i*a;break;case As.S_POLE:h=-t;break;case As.N_POLE:h=t;break}switch(h=this.pn1/(this.p-h),c=h*i*Math.sin(e.x),this.mode){case As.OBLIQ:h*=this.cosph0*t-this.sinph0*i*a;break;case As.EQUIT:h*=t;break;case As.N_POLE:h*=-(i*a);break;case As.S_POLE:h*=i*a;break}var f,o;return f=h*this.cg+c*this.sg,o=1/(f*this.sw*this.h1+this.cw),c=(c*this.cg-h*this.sg)*this.cw*o,h=f*o,e.x=c*this.a,e.y=h*this.a,e}function ZX(e){e.x/=this.a,e.y/=this.a;var t={x:e.x,y:e.y},i,a,c;c=1/(this.pn1-e.y*this.sw),i=this.pn1*e.x*c,a=this.pn1*e.y*this.cw*c,e.x=i*this.cg+a*this.sg,e.y=a*this.cg-i*this.sg;var h=Sa(e.x,e.y);if(Math.abs(h)<nr)t.x=0,t.y=e.y;else{var f,o;switch(o=1-h*h*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/h+h/this.pn1),f=Math.sqrt(1-o*o),this.mode){case As.OBLIQ:t.y=Math.asin(f*this.sinph0+e.y*o*this.cosph0/h),e.y=(f-this.sinph0*Math.sin(t.y))*h,e.x*=o*this.cosph0;break;case As.EQUIT:t.y=Math.asin(e.y*o/h),e.y=f*h,e.x*=o;break;case As.N_POLE:t.y=Math.asin(f),e.y=-e.y;break;case As.S_POLE:t.y=-Math.asin(f);break}t.x=Math.atan2(e.x,e.y)}return e.x=t.x+this.long0,e.y=t.y,e}var XX=["Tilted_Perspective","tpers"];const KX={init:HX,forward:WX,inverse:ZX,names:XX};function YX(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var e=1-this.es,t=1/e;this.radius_p=Math.sqrt(e),this.radius_p2=e,this.radius_p_inv2=t,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function JX(e){var t=e.x,i=e.y,a,c,h,f;if(t=t-this.long0,this.shape==="ellipse"){i=Math.atan(this.radius_p2*Math.tan(i));var o=this.radius_p/Sa(this.radius_p*Math.cos(i),Math.sin(i));if(c=o*Math.cos(t)*Math.cos(i),h=o*Math.sin(t)*Math.cos(i),f=o*Math.sin(i),(this.radius_g-c)*c-h*h-f*f*this.radius_p_inv2<0)return e.x=Number.NaN,e.y=Number.NaN,e;a=this.radius_g-c,this.flip_axis?(e.x=this.radius_g_1*Math.atan(h/Sa(f,a)),e.y=this.radius_g_1*Math.atan(f/a)):(e.x=this.radius_g_1*Math.atan(h/a),e.y=this.radius_g_1*Math.atan(f/Sa(h,a)))}else this.shape==="sphere"&&(a=Math.cos(i),c=Math.cos(t)*a,h=Math.sin(t)*a,f=Math.sin(i),a=this.radius_g-c,this.flip_axis?(e.x=this.radius_g_1*Math.atan(h/Sa(f,a)),e.y=this.radius_g_1*Math.atan(f/a)):(e.x=this.radius_g_1*Math.atan(h/a),e.y=this.radius_g_1*Math.atan(f/Sa(h,a))));return e.x=e.x*this.a,e.y=e.y*this.a,e}function QX(e){var t=-1,i=0,a=0,c,h,f,o;if(e.x=e.x/this.a,e.y=e.y/this.a,this.shape==="ellipse"){this.flip_axis?(a=Math.tan(e.y/this.radius_g_1),i=Math.tan(e.x/this.radius_g_1)*Sa(1,a)):(i=Math.tan(e.x/this.radius_g_1),a=Math.tan(e.y/this.radius_g_1)*Sa(1,i));var b=a/this.radius_p;if(c=i*i+b*b+t*t,h=2*this.radius_g*t,f=h*h-4*c*this.C,f<0)return e.x=Number.NaN,e.y=Number.NaN,e;o=(-h-Math.sqrt(f))/(2*c),t=this.radius_g+o*t,i*=o,a*=o,e.x=Math.atan2(i,t),e.y=Math.atan(a*Math.cos(e.x)/t),e.y=Math.atan(this.radius_p_inv2*Math.tan(e.y))}else if(this.shape==="sphere"){if(this.flip_axis?(a=Math.tan(e.y/this.radius_g_1),i=Math.tan(e.x/this.radius_g_1)*Math.sqrt(1+a*a)):(i=Math.tan(e.x/this.radius_g_1),a=Math.tan(e.y/this.radius_g_1)*Math.sqrt(1+i*i)),c=i*i+a*a+t*t,h=2*this.radius_g*t,f=h*h-4*c*this.C,f<0)return e.x=Number.NaN,e.y=Number.NaN,e;o=(-h-Math.sqrt(f))/(2*c),t=this.radius_g+o*t,i*=o,a*=o,e.x=Math.atan2(i,t),e.y=Math.atan(a*Math.cos(e.x)/t)}return e.x=e.x+this.long0,e}var eK=["Geostationary Satellite View","Geostationary_Satellite","geos"];const tK={init:YX,forward:JX,inverse:QX,names:eK};var cv=1.340264,uv=-.081106,hv=893e-6,dv=.003796,bx=Math.sqrt(3)/2;function rK(){this.es=0,this.long0=this.long0!==void 0?this.long0:0}function nK(e){var t=or(e.x-this.long0),i=e.y,a=Math.asin(bx*Math.sin(i)),c=a*a,h=c*c*c;return e.x=t*Math.cos(a)/(bx*(cv+3*uv*c+h*(7*hv+9*dv*c))),e.y=a*(cv+uv*c+h*(hv+dv*c)),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function iK(e){e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a;var t=1e-9,i=12,a=e.y,c,h,f,o,b,P;for(P=0;P<i&&(c=a*a,h=c*c*c,f=a*(cv+uv*c+h*(hv+dv*c))-e.y,o=cv+3*uv*c+h*(7*hv+9*dv*c),a-=b=f/o,!(Math.abs(b)<t));++P);return c=a*a,h=c*c*c,e.x=bx*e.x*(cv+3*uv*c+h*(7*hv+9*dv*c))/Math.cos(a),e.y=Math.asin(Math.sin(a)/bx),e.x=or(e.x+this.long0),e}var oK=["eqearth","Equal Earth","Equal_Earth"];const sK={init:rK,forward:nK,inverse:iK,names:oK};var Dv=1e-10;function aK(){var e;if(this.phi1=this.lat1,Math.abs(this.phi1)<Dv)throw new Error;this.es?(this.en=_S(this.es),this.m1=Qg(this.phi1,this.am1=Math.sin(this.phi1),e=Math.cos(this.phi1),this.en),this.am1=e/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=cK,this.forward=lK):(Math.abs(this.phi1)+Dv>=Ft?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=hK,this.forward=uK)}function lK(e){var t=or(e.x-(this.long0||0)),i=e.y,a,c,h;return a=this.am1+this.m1-Qg(i,c=Math.sin(i),h=Math.cos(i),this.en),c=h*t/(a*Math.sqrt(1-this.es*c*c)),e.x=a*Math.sin(c),e.y=this.am1-a*Math.cos(c),e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function cK(e){e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a;var t,i,a,c;if(i=Sa(e.x,e.y=this.am1-e.y),c=xS(this.am1+this.m1-i,this.es,this.en),(t=Math.abs(c))<Ft)t=Math.sin(c),a=i*Math.atan2(e.x,e.y)*Math.sqrt(1-this.es*t*t)/Math.cos(c);else if(Math.abs(t-Ft)<=Dv)a=0;else throw new Error;return e.x=or(a+(this.long0||0)),e.y=Of(c),e}function uK(e){var t=or(e.x-(this.long0||0)),i=e.y,a,c;return c=this.cphi1+this.phi1-i,Math.abs(c)>Dv?(e.x=c*Math.sin(a=t*Math.cos(i)/c),e.y=this.cphi1-c*Math.cos(a)):e.x=e.y=0,e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function hK(e){e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a;var t,i,a=Sa(e.x,e.y=this.cphi1-e.y);if(i=this.cphi1+this.phi1-a,Math.abs(i)>Ft)throw new Error;return Math.abs(Math.abs(i)-Ft)<=Dv?t=0:t=a*Math.atan2(e.x,e.y)/Math.cos(i),e.x=or(t+(this.long0||0)),e.y=Of(i),e}var dK=["bonne","Bonne (Werner lat_1=90)"];const fK={init:aK,names:dK};function pK(e){e.Proj.projections.add(N_),e.Proj.projections.add(V_),e.Proj.projections.add(cW),e.Proj.projections.add(vW),e.Proj.projections.add(CW),e.Proj.projections.add(IW),e.Proj.projections.add(OW),e.Proj.projections.add(jW),e.Proj.projections.add(qW),e.Proj.projections.add(KW),e.Proj.projections.add(fZ),e.Proj.projections.add(_Z),e.Proj.projections.add(CZ),e.Proj.projections.add(kZ),e.Proj.projections.add(OZ),e.Proj.projections.add(jZ),e.Proj.projections.add(qZ),e.Proj.projections.add(KZ),e.Proj.projections.add(rX),e.Proj.projections.add(aX),e.Proj.projections.add(dX),e.Proj.projections.add(yX),e.Proj.projections.add(wX),e.Proj.projections.add(PX),e.Proj.projections.add(RX),e.Proj.projections.add(jX),e.Proj.projections.add(qX),e.Proj.projections.add(KX),e.Proj.projections.add(tK),e.Proj.projections.add(sK),e.Proj.projections.add(fK)}ka.defaultDatum="WGS84";ka.Proj=nh;ka.WGS84=new ka.Proj("WGS84");ka.Point=qg;ka.toPoint=PR;ka.defs=Ks;ka.nadgrid=hH;ka.transform=vx;ka.mgrs=PH;ka.version="__VERSION__";pK(ka);const CS=6370997,XP=CS*Math.PI/180,xg={standardParalel1:33,standardParalel2:45,mapOrigin:[39,-96],mapFactor:[-.00017706234,.000176689948]},mK=["+proj=lcc",`+R=${CS}`,`+lat_1=${xg.standardParalel1}`,`+lat_2=${xg.standardParalel2}`,`+lat_0=${xg.mapOrigin[0]}`,`+lon_0=${xg.mapOrigin[1]}`].join(" "),gK=ka(mK),KP=([e,t])=>{const i=[e*xg.mapFactor[1]*XP,t*xg.mapFactor[0]*XP];return gK.inverse(i)},w_={standardParalel1:37,standardParalel2:65,mapOrigin:[50,15]},yK=["+proj=lcc",`+R=${CS}`,`+lat_1=${w_.standardParalel1}`,`+lat_2=${w_.standardParalel2}`,`+lat_0=${w_.mapOrigin[0]}`,`+lon_0=${w_.mapOrigin[1]}`].join(" ");ka(yK);var sw={exports:{}},YP;function vK(){return YP||(YP=1,function(e,t){(function(){var i=Math.PI,a=Math.sin,c=Math.cos,h=Math.tan,f=Math.asin,o=Math.atan2,b=Math.acos,P=i/180,I=1e3*60*60*24,D=2440588,z=2451545;function F(ye){return ye.valueOf()/I-.5+D}function U(ye){return new Date((ye+.5-D)*I)}function $(ye){return F(ye)-z}var j=P*23.4397;function ie(ye,ze){return o(a(ye)*c(j)-h(ze)*a(j),c(ye))}function se(ye,ze){return f(a(ze)*c(j)+c(ze)*a(j)*a(ye))}function Q(ye,ze,ft){return o(a(ye),c(ye)*a(ze)-h(ft)*c(ze))}function de(ye,ze,ft){return f(a(ze)*a(ft)+c(ze)*c(ft)*c(ye))}function oe(ye,ze){return P*(280.16+360.9856235*ye)-ze}function be(ye){return ye<0&&(ye=0),2967e-7/Math.tan(ye+.00312536/(ye+.08901179))}function xe(ye){return P*(357.5291+.98560028*ye)}function Me(ye){var ze=P*(1.9148*a(ye)+.02*a(2*ye)+3e-4*a(3*ye)),ft=P*102.9372;return ye+ze+ft+i}function Ee(ye){var ze=xe(ye),ft=Me(ze);return{dec:se(ft,0),ra:ie(ft,0)}}var re={};re.getPosition=function(ye,ze,ft){var wt=P*-ft,xt=P*ze,_t=$(ye),St=Ee(_t),tt=oe(_t,wt)-St.ra;return{azimuth:Q(tt,xt,St.dec),altitude:de(tt,xt,St.dec)}};var ke=re.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];re.addTime=function(ye,ze,ft){ke.push([ye,ze,ft])};var Ge=9e-4;function Ke(ye,ze){return Math.round(ye-Ge-ze/(2*i))}function gt(ye,ze,ft){return Ge+(ye+ze)/(2*i)+ft}function et(ye,ze,ft){return z+ye+.0053*a(ze)-.0069*a(2*ft)}function qe(ye,ze,ft){return b((a(ye)-a(ze)*a(ft))/(c(ze)*c(ft)))}function Qe(ye){return-2.076*Math.sqrt(ye)/60}function Ve(ye,ze,ft,wt,xt,_t,St){var tt=qe(ye,ft,wt),At=gt(tt,ze,xt);return et(At,_t,St)}re.getTimes=function(ye,ze,ft,wt){wt=wt||0;var xt=P*-ft,_t=P*ze,St=Qe(wt),tt=$(ye),At=Ke(tt,xt),It=gt(0,xt,At),mr=xe(It),ur=Me(mr),Hr=se(ur,0),wr=et(It,mr,ur),sr,Wt,yr,Yt,Cr,Rr,Or={solarNoon:U(wr),nadir:U(wr-.5)};for(sr=0,Wt=ke.length;sr<Wt;sr+=1)yr=ke[sr],Yt=(yr[0]+St)*P,Cr=Ve(Yt,xt,_t,Hr,At,mr,ur),Rr=wr-(Cr-wr),Or[yr[1]]=U(Rr),Or[yr[2]]=U(Cr);return Or};function je(ye){var ze=P*(218.316+13.176396*ye),ft=P*(134.963+13.064993*ye),wt=P*(93.272+13.22935*ye),xt=ze+P*6.289*a(ft),_t=P*5.128*a(wt),St=385001-20905*c(ft);return{ra:ie(xt,_t),dec:se(xt,_t),dist:St}}re.getMoonPosition=function(ye,ze,ft){var wt=P*-ft,xt=P*ze,_t=$(ye),St=je(_t),tt=oe(_t,wt)-St.ra,At=de(tt,xt,St.dec),It=o(a(tt),h(xt)*c(St.dec)-a(St.dec)*c(tt));return At=At+be(At),{azimuth:Q(tt,xt,St.dec),altitude:At,distance:St.dist,parallacticAngle:It}},re.getMoonIllumination=function(ye){var ze=$(ye||new Date),ft=Ee(ze),wt=je(ze),xt=149598e3,_t=b(a(ft.dec)*a(wt.dec)+c(ft.dec)*c(wt.dec)*c(ft.ra-wt.ra)),St=o(xt*a(_t),wt.dist-xt*c(_t)),tt=o(c(ft.dec)*a(ft.ra-wt.ra),a(ft.dec)*c(wt.dec)-c(ft.dec)*a(wt.dec)*c(ft.ra-wt.ra));return{fraction:(1+c(St))/2,phase:.5+.5*St*(tt<0?-1:1)/Math.PI,angle:tt}};function ct(ye,ze){return new Date(ye.valueOf()+ze*I/24)}re.getMoonTimes=function(ye,ze,ft,wt){var xt=new Date(ye);wt?xt.setUTCHours(0,0,0,0):xt.setHours(0,0,0,0);for(var _t=.133*P,St=re.getMoonPosition(xt,ze,ft).altitude-_t,tt,At,It,mr,ur,Hr,wr,sr,Wt,yr,Yt,Cr,Rr,Or=1;Or<=24&&(tt=re.getMoonPosition(ct(xt,Or),ze,ft).altitude-_t,At=re.getMoonPosition(ct(xt,Or+1),ze,ft).altitude-_t,ur=(St+At)/2-tt,Hr=(At-St)/2,wr=-Hr/(2*ur),sr=(ur*wr+Hr)*wr+tt,Wt=Hr*Hr-4*ur*tt,yr=0,Wt>=0&&(Rr=Math.sqrt(Wt)/(Math.abs(ur)*2),Yt=wr-Rr,Cr=wr+Rr,Math.abs(Yt)<=1&&yr++,Math.abs(Cr)<=1&&yr++,Yt<-1&&(Yt=Cr)),yr===1?St<0?It=Or+Yt:mr=Or+Yt:yr===2&&(It=Or+(sr<0?Cr:Yt),mr=Or+(sr<0?Yt:Cr)),!(It&&mr));Or+=2)St=At;var Gr={};return It&&(Gr.rise=ct(xt,It)),mr&&(Gr.set=ct(xt,mr)),!It&&!mr&&(Gr[sr>0?"alwaysUp":"alwaysDown"]=!0),Gr},e.exports=re})()}(sw)),sw.exports}vK();function $R(e){const t=KP([e.position.X,e.position.Z]),i=(.5-e.orientation.heading)*Math.PI*2+Math.PI/2,a=KP([e.position.X+1e3*Math.cos(i),e.position.Z+1e3*Math.sin(i)]);return{position:t,bearing:pS(t,a,{final:!1})}}function vf(e,t,i={}){var a=xf(e),c=xf(t),h=Ku(c[1]-a[1]),f=Ku(c[0]-a[0]),o=Ku(a[1]),b=Ku(c[1]),P=Math.pow(Math.sin(h/2),2)+Math.pow(Math.sin(f/2),2)*Math.cos(o)*Math.cos(b);return aG(2*Math.atan2(Math.sqrt(P),Math.sqrt(1-P)),i.units)}function aw(e,t={}){return uG(e,(i,a)=>{const c=a.geometry.coordinates;return i+vf(c[0],c[1],t)},0)}var _K=Object.defineProperty,xK=Object.defineProperties,bK=Object.getOwnPropertyDescriptors,JP=Object.getOwnPropertySymbols,wK=Object.prototype.hasOwnProperty,SK=Object.prototype.propertyIsEnumerable,QP=(e,t,i)=>t in e?_K(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,eE=(e,t)=>{for(var i in t||(t={}))wK.call(t,i)&&QP(e,i,t[i]);if(JP)for(var i of JP(t))SK.call(t,i)&&QP(e,i,t[i]);return e},tE=(e,t)=>xK(e,bK(t));function CK(e,t,i={}){if(!e||!t)throw new Error("lines and pt are required arguments");const a=xf(t);let c=Wy([1/0,1/0],{dist:1/0,index:-1,multiFeatureIndex:-1,location:-1}),h=0;return lR(e,function(f,o,b){const P=hG(f);for(let I=0;I<P.length-1;I++){const D=Wy(P[I]);D.properties.dist=vf(t,D,i);const z=xf(D),F=Wy(P[I+1]);F.properties.dist=vf(t,F,i);const U=xf(F),$=vf(D,F,i);let j,ie;z[0]===a[0]&&z[1]===a[1]?[j,,ie]=[z,void 0,!1]:U[0]===a[0]&&U[1]===a[1]?[j,,ie]=[U,void 0,!0]:[j,,ie]=PK(D.geometry.coordinates,F.geometry.coordinates,xf(t));let se;j&&(se=Wy(j,{dist:vf(t,j,i),multiFeatureIndex:b,location:h+vf(D,j,i)})),se&&se.properties.dist<c.properties.dist&&(c=tE(eE({},se),{properties:tE(eE({},se.properties),{index:ie?I+1:I})})),h+=$}}),c}function TK(e,t){const[i,a,c]=e,[h,f,o]=t;return i*h+a*f+c*o}function MK(e,t){const[i,a,c]=e,[h,f,o]=t;return[a*o-c*f,c*h-i*o,i*f-a*h]}function rE(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2))}function kp(e,t){const i=TK(e,t)/(rE(e)*rE(t));return Math.acos(Math.min(Math.max(i,-1),1))}function lw(e){const t=Ku(e[1]),i=Ku(e[0]);return[Math.cos(t)*Math.cos(i),Math.cos(t)*Math.sin(i),Math.sin(t)]}function Ap(e){const[t,i,a]=e,c=Ww(Math.asin(a));return[Ww(Math.atan2(i,t)),c]}function PK(e,t,i){const a=lw(e),c=lw(t),h=lw(i),[f,o,b]=h,[P,I,D]=MK(a,c),z=I*b-D*o,F=D*f-P*b,U=P*o-I*f,$=U*I-F*D,j=z*D-U*P,ie=F*P-z*I,se=1/Math.sqrt(Math.pow($,2)+Math.pow(j,2)+Math.pow(ie,2)),Q=[$*se,j*se,ie*se],de=[-1*$*se,-1*j*se,-1*ie*se],oe=kp(a,c),be=kp(a,Q),xe=kp(c,Q),Me=kp(a,de),Ee=kp(c,de);let re;return be<Me&&be<Ee||xe<Me&&xe<Ee?re=Q:re=de,kp(a,re)>oe||kp(c,re)>oe?vf(Ap(re),Ap(a))<=vf(Ap(re),Ap(c))?[Ap(a),!0,!1]:[Ap(c),!1,!0]:[Ap(re),!1,!1]}var cw=CK,Xl=(e=>(e[e.FOLLOW=0]="FOLLOW",e[e.FREE=1]="FREE",e))(Xl||{}),tn=(e=>(e[e.CHOOSE_DESTINATION=0]="CHOOSE_DESTINATION",e[e.SEARCH_ALONG=1]="SEARCH_ALONG",e[e.CHOOSE_ON_MAP=2]="CHOOSE_ON_MAP",e[e.DESTINATIONS=3]="DESTINATIONS",e[e.ROUTES=4]="ROUTES",e[e.DIRECTIONS_FROM_ROUTE_CONTROLS=5]="DIRECTIONS_FROM_ROUTE_CONTROLS",e[e.DIRECTIONS_FROM_ROUTES_LIST=6]="DIRECTIONS_FROM_ROUTES_LIST",e[e.MANAGE_STOPS=7]="MANAGE_STOPS",e))(tn||{});class EK{samples=[];opts;cursorSimT=void 0;lastWallMs=void 0;smoothed;constructor(t={}){this.opts={lookbackMs:t.lookbackMs??200,maxExtrapolationMs:t.maxExtrapolationMs??250,emaAlpha:t.emaAlpha??0}}push(t){const i=this.samples[this.samples.length-1];if(i&&t.t<i.t)throw new Error("Simulation time must be monotonic");this.samples.push(t),this.evictOldSamples(t.t),this.cursorSimT??=t.t-this.opts.lookbackMs}sample(t){if(this.samples.length===0)return null;const i=this.samples[this.samples.length-1];if(this.lastWallMs!=null&&!i.paused){const h=t-this.lastWallMs;this.cursorSimT+=h}this.lastWallMs=t;const a=i.t+this.opts.maxExtrapolationMs;this.cursorSimT=AK(this.cursorSimT,this.samples[0].t,a);const c=this.sampleAtSimTime(this.cursorSimT);return c?this.opts.emaAlpha>0?(this.smoothed=this.smoothed?RK(this.smoothed,c,this.opts.emaAlpha):c,this.smoothed):c:null}evictOldSamples(t){const i=t-(this.opts.lookbackMs+this.opts.maxExtrapolationMs+100);for(;this.samples.length>2&&this.samples[0].t<i;)this.samples.shift()}sampleAtSimTime(t){const i=this.samples.length;if(i===0)return null;if(t<=this.samples[0].t)return this.samples[0];const a=this.samples[i-1];if(t>=a.t)return kK(a,t-a.t);let c=0,h=i-1;for(;c+1<h;){const P=c+h>>1;this.samples[P].t<=t?c=P:h=P}const f=this.samples[c],o=this.samples[h];if(f.paused||o.paused||f.t===o.t)return f;const b=(t-f.t)/(o.t-f.t);return IK(f,o,b)}}function IK(e,t,i){return console.log("interpolate",i),{t:Eg(e.t,t.t,i),paused:!1,position:Yy(e.position,t.position,i),heading:jR(e.heading,t.heading,i),speed:Eg(e.speed,t.speed,i),linearAccel:Yy(e.linearAccel,t.linearAccel,i),angularVelocity:Yy(e.angularVelocity,t.angularVelocity,i),angularAccel:Yy(e.angularAccel,t.angularAccel,i)}}function kK(e,t){if(e.paused)return e;const i=t/1e3;return console.log("extrapolate",t),{t:e.t+t,paused:!1,position:{x:e.position.x+Math.sin(e.heading*2*Math.PI)*e.speed*i,y:e.position.y-Math.cos(e.heading*2*Math.PI)*e.speed*i,z:e.position.z},heading:e.heading+e.angularVelocity.z*i,speed:e.speed,linearAccel:e.linearAccel,angularVelocity:e.angularVelocity,angularAccel:e.angularAccel}}function AK(e,t,i){return Math.max(t,Math.min(i,e))}function Eg(e,t,i){return e+(t-e)*i}function Yy(e,t,i){return{x:Eg(e.x,t.x,i),y:Eg(e.y,t.y,i),z:Eg(e.z,t.z,i)}}function jR(e,t,i){e=(e%1+1)%1,t=(t%1+1)%1;let a=t-e;return a>.5&&(a-=1),a<-.5&&(a+=1),(e+a*i+1)%1}function RK(e,t,i){return{...t,position:Yy(e.position,t.position,i),heading:jR(e.heading,t.heading,i),speed:Eg(e.speed,t.speed,i)}}class DK{themeMode="light";cameraMode=Xl.FOLLOW;activeRoute=void 0;activeRouteIndex=void 0;truckPoint=[0,0];trailerPoint;showNavSheet=!1;currentJob;segmentComplete=void 0;constructor(){eS(this,{activeRoute:bi.ref,activeRouteIndex:bi.struct,truckPoint:bi.ref,trailerPoint:bi.ref,currentJob:bi.ref,segmentComplete:bi.ref})}get isReceivingTelemetry(){return this.truckPoint[0]!==0&&this.truckPoint[1]!==0}get activeStep(){if(!this.activeRoute||this.activeRouteIndex==null)return;const{segmentIndex:t,stepIndex:i}=this.activeRouteIndex;return Ca(this.activeRoute.segments[t].steps[i])}get nextStep(){if(!(!this.activeRoute||!this.activeStep))return FK(this.activeStep,this.activeRoute)}get nextStepArrow(){if(!this.nextStep?.arrowPoints)return;const t=Ug.decode(this.nextStep.geometry).slice(0,this.nextStep.arrowPoints),i=av(t);return{geometry:i,length:aw(i)}}get activeStepLine(){if(!this.activeStep)return;const t=Ug.decode(this.activeStep.geometry),i=av(t);let a;if(this.activeStep.arrowPoints){const c=av(t.slice(0,this.activeStep.arrowPoints));a={geometry:c,length:aw(c)}}return{line:i,length:aw(i),arrow:a}}get activeRouteSummary(){const t=this.activeRouteToFirstWayPointSummary;if(!t||!this.activeRoute||!this.activeRouteIndex)return;const a=this.activeRoute.segments.slice(this.activeRouteIndex.segmentIndex+1).flatMap(c=>c.steps).reduce(nE,{duration:0,distanceMeters:0,activeRouteNodeIndex:this.activeRouteIndex.nodeIndex});return{distanceMeters:t.distanceMeters+a.distanceMeters,minutes:t.minutes+Math.ceil(a.duration/60)}}get activeRouteToFirstWayPointSummary(){if(!this.activeRoute||!this.activeRouteIndex)return;const[t]=this.activeRoute.segments.slice(this.activeRouteIndex.segmentIndex),i=t.steps.slice(this.activeRouteIndex.stepIndex).reduce(nE,{duration:0,distanceMeters:0,activeRouteNodeIndex:this.activeRouteIndex.nodeIndex});return{distanceMeters:i.distanceMeters,minutes:Math.ceil(i.duration/60)}}get activeRouteDirection(){if(!this.activeStepLine)return;const{line:t}=this.activeStepLine,i=t.geometry.coordinates[0];return t.geometry.coordinates.every(c=>c[0]===i[0]&&c[1]===i[1])?void 0:cw(t,this.truckPoint).properties.location<(this.activeStepLine.arrow?.length??0)/2?this.activeStep?.maneuver:this.nextStep?.maneuver}get distanceToNextManeuver(){if(!this.activeStepLine)return 0;const{line:t,length:i}=this.activeStepLine,a=t.geometry.coordinates[0];if(t.geometry.coordinates.every(f=>f[0]===a[0]&&f[1]===a[1]))return 0;const c=cw(t,this.truckPoint).properties.location,h=(this.activeStepLine.arrow?.length??0)/2;return c<h?(h-c)*1e3/19.668:(i-c+(this.nextStepArrow?.length??0)/2)*1e3/19.668}get activeArrowStep(){if(!this.activeStepLine)return;const{line:t}=this.activeStepLine,i=t.geometry.coordinates[0];return t.geometry.coordinates.every(c=>c[0]===i[0]&&c[1]===i[1])?void 0:cw(t,this.truckPoint).properties.location<(this.activeStepLine.arrow?.length??0)/2?this.activeStep:this.nextStep}}class zK{map;playerMarker;chooseOnMapUi;addMapDragEndListener(t){const a=ba.checkExists(this.map).on("dragend",c=>t(c.target.getCenter().toArray()));return()=>a.unsubscribe()}clearPitchAndBearing(t){console.log("clear pitch and bearing"),ba.checkState(this.map!=null),this.map.panTo(this.map.getCenter(),{duration:500,pitch:0,zoom:11.5,bearing:0,padding:{left:t.showNavSheet?400:0,top:0}})}fitPoints(t,i){if(!this.map||!this.playerMarker){console.warn("tried to view points but map/marker hasn't loaded");return}const a=VV([...i]),c=[a[0],a[1]],h=[a[2],a[3]];console.log("fitting to",c,h),this.map.fitBounds([c,h],{duration:500,linear:!0,pitch:0,bearing:0,offset:[0,-100]})}flyTo(t,i,a=0){if(!this.map){console.warn("tried to fly butmap hasn't loaded");return}this.map.panTo(i,{duration:500,pitch:0,zoom:13,bearing:a,padding:50})}onMapLoad(t,i){ba.checkState(this.map==null),ba.checkState(this.playerMarker==null),this.map=t,this.playerMarker=i}setFree(t){t.cameraMode=Xl.FREE}setFollow(t){t.cameraMode=Xl.FOLLOW}hideNavSheet(t){console.log("hide nav sheet"),t.showNavSheet=!1}setDestinationNodeUid(t,i,a){a.previewRoutes.query({toNodeUid:i}).then(Ir(([c])=>{c||console.warn("could not find route to",i),this.setActiveRoute(t,c,a)}))}setActiveRoute(t,i,a){t.activeRoute=i,t.activeRouteIndex={segmentIndex:0,stepIndex:0,nodeIndex:0},this.renderActiveRoute(i),a.setActiveRoute.mutate(i?.segments.map(c=>c.key))}setActiveRouteFromNodeUids(t,i,a){a.generateRouteFromNodeUids.query(i.map(c=>c.toString(16))).then(Ir(c=>{this.setActiveRoute(t,c,a)}))}startListening(t,i){let a=[0,0],c=[0,0];const h=[0,0];let f=0,o=0,b=0;console.log("subscribing");const P=new EK({lookbackMs:250,maxExtrapolationMs:500,emaAlpha:.5});i.subscribeToDevice.subscribe(void 0,{onData:z=>{switch(z.type){case"positionUpdate":P.push(z.data);break;case"routeUpdate":jy(()=>{t.activeRoute=z.data,t.activeRouteIndex=void 0,this.renderActiveRoute(z.data)});break;case"routeProgress":jy(()=>t.activeRouteIndex=z.data);break;case"segmentComplete":jy(()=>t.segmentComplete=z.data);break;case"themeModeUpdate":jy(()=>{t.themeMode=z.data;const F=document.documentElement;F.setAttribute("data-joy-color-scheme",z.data),F.setAttribute("data-mui-color-scheme",z.data)});break;case"trailerUpdate":jy(()=>t.trailerPoint=z.data?.position);break;case"jobUpdate":break;default:throw new Uo(z)}}});const I=500;setInterval(Ir(()=>{const z=P.sample(Date.now());if(z==null)return;const{speed:F,position:U,heading:$}=z,{position:j,bearing:ie}=$R({position:{X:U.x,Y:U.z,Z:U.y},orientation:{heading:$}}),se=Math.round(F*2.236936);t.truckPoint=j;const{map:Q,playerMarker:de}=this;if(!Q||!de){console.log("early return onPositionUpdate");return}switch(a.every(oe=>!oe)&&(console.log("reset center",j),Q.setCenter(j),de.setLngLat(j),de.setRotation(ie)),a=c,c=j,f=o,o=ie,t.cameraMode){case Xl.FOLLOW:Q.easeTo({...LK(j,ie,se),duration:I,padding:{left:t.showNavSheet||t.activeRoute?440:0,top:550},easing:oe=>(h[0]=a[0]+oe*(c[0]-a[0]),h[1]=a[1]+oe*(c[1]-a[1]),b=f+oe*OK(f,o),de.setLngLat(h),de.setRotation(b),oe)});break;case Xl.FREE:de.setLngLat(j),de.setRotation(ie);break;default:throw new Uo(t.cameraMode)}}),I)}synthesizeSearchResult(t,i){return ba.checkState(this.chooseOnMapUi!=null),i.synthesizeSearchResult.query(this.chooseOnMapUi.marker.getLngLat().toArray())}toggleChooseOnMapUi(t,i){if(i){ba.checkState(this.chooseOnMapUi==null);const a=ba.checkExists(this.map),c=new sS.Marker().setLngLat(a.getCenter()).setDraggable(!1).addTo(a.getMap()),h=a.on("move",()=>c.setLngLat(a.getCenter()));this.chooseOnMapUi={marker:c,unsubscribeOnMove:()=>h.unsubscribe()}}else{if(!this.chooseOnMapUi)return;this.chooseOnMapUi.marker.remove(),this.chooseOnMapUi.unsubscribeOnMove(),this.chooseOnMapUi=void 0}}renderActiveRoute(t){const{map:i}=this;if(!i)return;const a=Ca(i.getSource("activeRoute")),c=Ca(i.getSource("activeRouteIcons"));if(!t){a.setData(uw),c.setData(uw);return}console.log("setting route data",t),a.setData(Ig(t)),c.setData(Ig(t)),i.getMap().setLayoutProperty("activeRouteLayer","visibility","visible").setLayoutProperty("activeRouteLayer-case","visibility","visible").setLayoutProperty("activeRouteIconsLayer","visibility","visible")}renderRoutePreview(t,i){const{map:a}=this;if(!a)return;console.log("rendering route preview");const c=Ca(a.getSource(`previewRoute-${i.index}`));if(!t){c.setData(uw);return}c.setData(Ig(t)),a.getMap().setPaintProperty(`previewRouteLayer-${i.index}`,"line-opacity",i.highlight?1:.25).setPaintProperty(`previewRouteLayer-${i.index}-case`,"line-opacity",i.highlight?1:.25).setLayoutProperty("activeRouteLayer","visibility","none").setLayoutProperty("activeRouteLayer-case","visibility","none")}drawStepArrow(t){const{map:i}=this;if(!i)return;const a=Ca(i.getSource("previewStepArrow"));if(!t?.arrowPoints||t.arrowPoints<2){a.setData(mP([]));return}const c=Ug.decode(t.geometry).slice(0,t.arrowPoints),h=av(c),f=pS(c.at(-2),c.at(-1)),o=Wy(c.at(-1),{bearing:f});a.setData(mP([h,o]))}unpauseRouteEvents(t,i){t.segmentComplete=void 0,i.unpauseRouteEvents.mutate()}}const uw={type:"FeatureCollection",features:[]};function Ig(e){const t=e.segments.flatMap(i=>i.steps.flatMap(a=>a.trafficIcons.flatMap(c=>({type:"Feature",geometry:{type:"Point",coordinates:c.lonLat},properties:{sprite:c.type==="stop"?"stopsign":"trafficlight"}}))));return{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"LineString",coordinates:e.segments.flatMap(i=>i.steps.flatMap(a=>Ug.decode(a.geometry)))},properties:null},...t]}}function OK(e,t){const i=e%360;let c=(t>0?t:t+360)-i;return c>180&&(c-=360),c}function LK(e,t,i){let a,c;return i>60?(a=11,c=30):i>30?(a=12,c=45):(a=13,c=50),{center:e,bearing:t,zoom:a,pitch:c}}function FK(e,t){const i=t.segments.flatMap(c=>c.steps),a=i.indexOf(e);if(a!==-1)return i[a+1]}const nE=(e,t,i)=>{const a=i===0?(t.nodesTraveled-e.activeRouteNodeIndex)/t.nodesTraveled:1;let c=t.duration*a;(isNaN(c)||!isFinite(c))&&(c=0);let h=t.distanceMeters*a;return(isNaN(h)||!isFinite(h))&&(h=0),e.duration+=c,e.distanceMeters+=h,e},BK={p:2,borderRadius:"50%"},hw=e=>{const t=K.useRef(null);return G.jsx(Kp,{in:e.show,collapsedSize:0,onExiting:()=>{t.current&&(t.current.style.boxShadow="none",t.current.style.transitionDuration="100ms",t.current.style.transitionDelay="0ms")},onEntering:()=>{t.current&&(t.current.style.boxShadow="rgba(0, 0, 0, 0.2) 0 3px 5px -1px, rgba(0, 0, 0, 0.14) 0 6px 10px 0, rgba(0, 0, 0, 0.12) 0 1px 18px 0",t.current.style.transitionDuration="500ms",t.current.style.transitionDelay="300ms")},appear:!0,children:G.jsx(iG,{in:e.show,appear:!0,children:G.jsx("div",{style:{padding:"0.5em"},children:G.jsx(sd,{ref:t,size:"lg",color:"primary",variant:e.variant??"solid",sx:{...BK,backgroundColor:e.backgroundColor??"primary.500"},style:{transition:"box-shadow",transitionDuration:"500ms",transitionDelay:"500ms"},onClick:e.onClick,children:G.jsx(e.Icon,{})})})})})},$K=e=>(console.log("render controls"),G.jsxs(dn,{direction:"column",justifyContent:"space-between",children:[G.jsxs(dn,{gap:1,alignSelf:"end",alignItems:"end",sx:{pointerEvents:"auto"},children:[G.jsx(e.Direction,{}),G.jsx(e.SpeedLimit,{})]}),G.jsxs(dn,{alignSelf:"end",alignItems:"center",sx:{pointerEvents:"auto"},children:[G.jsx(e.RecenterFab,{}),G.jsx(e.RouteFab,{}),G.jsx(e.SearchFab,{})]})]})),jK=K.forwardRef((e,t)=>{const i=e.limitMph!=null?G.jsx(NK,{limitMph:e.limitMph,ref:t}):e.limitKph!=null?G.jsx(VK,{limitKph:e.limitKph,ref:t}):null,a=(e.limitMph??0)<5?1/0:e.limitMph??0,c=e.speedMph/a,h=c<=1?"white":c<=1.1?"orange":"red";return G.jsxs(dn,{display:"grid",gridTemplateColumns:"1fr 1fr",gap:.25,sx:{backgroundColor:"#000",p:.25},borderRadius:4,children:[i,G.jsxs(dn,{justifyContent:"center",children:[G.jsx(Wr,{textAlign:"center",level:"title-lg",fontSize:"xl2",fontWeight:"bold",sx:{color:h,WebkitTextStroke:1.25},children:Math.round(e.speedMph)||"--"}),G.jsx(Wr,{textAlign:"center",lineHeight:1,level:"body-md",sx:{color:h},children:"mph"})]})]})}),NK=K.forwardRef((e,t)=>G.jsx(ei,{boxShadow:"0 0 2px 0 #0008",padding:.25,borderRadius:4,sx:{backgroundColor:"white"},ref:t,children:G.jsxs(ei,{border:2,borderColor:"common.black",padding:.5,paddingBottom:0,borderRadius:4,children:[G.jsxs(Wr,{textAlign:"center",lineHeight:1.2,level:"body-xs",sx:{color:"common.black"},children:["SPEED",G.jsx("br",{}),"LIMIT"]}),G.jsx(Wr,{textAlign:"center",level:"title-lg",fontSize:"xl2",fontWeight:"bold",sx:{color:"common.black",WebkitTextStroke:1.25},children:e.limitMph<5?"--":e.limitMph})]})})),VK=K.forwardRef((e,t)=>G.jsx(ei,{boxShadow:"0 0 2px 0 #0004",padding:.2,borderRadius:"50%",border:1,borderColor:"#f22",sx:{backgroundColor:"white"},ref:t,children:G.jsx(ei,{display:"flex",alignItems:"center",border:6,borderColor:"#f22",padding:1,borderRadius:"50%",sx:{aspectRatio:1},children:G.jsx(Wr,{textAlign:"center",level:"title-lg",fontSize:"xl2",fontWeight:"bold",sx:{color:"common.black",WebkitTextStroke:1.25},children:e.limitKph})})})),UK=e=>G.jsx(WI,{variant:"solid",sx:{p:.5,px:2,borderRadius:8,fontWeight:"bold"},children:e.direction});function NR(e){const t=e>=0?e:360+e;return 337.5<=t||t<22.5?"N":22.5<=t&&t<67.5?"NE":67.5<=t&&t<112.5?"E":112.5<=t&&t<157.5?"SE":157.5<=t&&t<202.5?"S":202.5<=t&&t<247.5?"SW":247.5<=t&&t<292.5?"W":(Np(292.5<=t&&t<337.5),"NW")}class GK{constructor(t){this.appStore=t,eS(this)}direction="N";limitMph=0;speedMph=0;get showRecenterFab(){return this.appStore.cameraMode===Xl.FREE}get showRouteFab(){return!this.appStore.activeRoute&&!this.appStore.showNavSheet}get showSearchFab(){return!!this.appStore.activeRoute&&!this.appStore.showNavSheet}}class qK{startListening(t,i){i.onPositionUpdate.subscribe(void 0,{onData:Ir(a=>{const{speed:c,position:h,heading:f}=a,{bearing:o}=$R({position:{X:h.x,Y:h.z,Z:h.y},orientation:{heading:f}}),b=Math.abs(Math.round(c*2.236936));t.direction=NR(o),t.limitMph=a.speedLimit,t.speedMph=b})})}}function HK(e){const{appStore:t}=e,i=new GK(t),a=new qK,c=fo(()=>G.jsx(UK,{direction:i.direction})),h=fo(()=>G.jsx(jK,{limitMph:i.limitMph,speedMph:i.speedMph})),f=fo(P=>G.jsx(hw,{show:i.showRecenterFab,variant:"plain",backgroundColor:"background.body",Icon:()=>G.jsx(YG,{sx:{transform:"scale(1.25) rotate(30deg)"}}),onClick:P.onClick})),o=fo(P=>G.jsx(hw,{show:i.showRouteFab,Icon:()=>G.jsx(FG,{sx:{transform:"scale(1.25)"}}),onClick:P.onClick})),b=fo(P=>G.jsx(hw,{show:i.showSearchFab,Icon:()=>G.jsx(mS,{sx:{transform:"scale(1.25)"}}),onClick:P.onClick}));return{Controls:P=>G.jsx($K,{Direction:c,SpeedLimit:h,RecenterFab:()=>G.jsx(f,{onClick:P.onRecenterFabClick}),RouteFab:()=>G.jsx(o,{onClick:P.onRouteFabClick}),SearchFab:()=>G.jsx(b,{onClick:P.onSearchFabClick})}),store:i,controller:a}}function WK(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return K.useMemo(()=>a=>{t.forEach(c=>c(a))},t)}const v1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function ey(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function TS(e){return"nodeType"in e}function Js(e){var t,i;return e?ey(e)?e:TS(e)&&(t=(i=e.ownerDocument)==null?void 0:i.defaultView)!=null?t:window:window}function MS(e){const{Document:t}=Js(e);return e instanceof t}function f0(e){return ey(e)?!1:e instanceof Js(e).HTMLElement}function VR(e){return e instanceof Js(e).SVGElement}function ty(e){return e?ey(e)?e.document:TS(e)?MS(e)?e:f0(e)||VR(e)?e.ownerDocument:document:document:document}const nu=v1?K.useLayoutEffect:K.useEffect;function _1(e){const t=K.useRef(e);return nu(()=>{t.current=e}),K.useCallback(function(){for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return t.current==null?void 0:t.current(...a)},[])}function ZK(){const e=K.useRef(null),t=K.useCallback((a,c)=>{e.current=setInterval(a,c)},[]),i=K.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,i]}function zv(e,t){t===void 0&&(t=[e]);const i=K.useRef(e);return nu(()=>{i.current!==e&&(i.current=e)},t),i}function p0(e,t){const i=K.useRef();return K.useMemo(()=>{const a=e(i.current);return i.current=a,a},[...t])}function wx(e){const t=_1(e),i=K.useRef(null),a=K.useCallback(c=>{c!==i.current&&t?.(c,i.current),i.current=c},[]);return[i,a]}function Sx(e){const t=K.useRef();return K.useEffect(()=>{t.current=e},[e]),t.current}let dw={};function m0(e,t){return K.useMemo(()=>{if(t)return t;const i=dw[e]==null?0:dw[e]+1;return dw[e]=i,e+"-"+i},[e,t])}function UR(e){return function(t){for(var i=arguments.length,a=new Array(i>1?i-1:0),c=1;c<i;c++)a[c-1]=arguments[c];return a.reduce((h,f)=>{const o=Object.entries(f);for(const[b,P]of o){const I=h[b];I!=null&&(h[b]=I+e*P)}return h},{...t})}}const kg=UR(1),Cx=UR(-1);function XK(e){return"clientX"in e&&"clientY"in e}function x1(e){if(!e)return!1;const{KeyboardEvent:t}=Js(e.target);return t&&e instanceof t}function KK(e){if(!e)return!1;const{TouchEvent:t}=Js(e.target);return t&&e instanceof t}function Tx(e){if(KK(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:i}=e.touches[0];return{x:t,y:i}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:i}=e.changedTouches[0];return{x:t,y:i}}}return XK(e)?{x:e.clientX,y:e.clientY}:null}const Af=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:i}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(i?Math.round(i):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:i}=e;return"scaleX("+t+") scaleY("+i+")"}},Transform:{toString(e){if(e)return[Af.Translate.toString(e),Af.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:i,easing:a}=e;return t+" "+i+"ms "+a}}}),iE="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function YK(e){return e.matches(iE)?e:e.querySelector(iE)}const JK={display:"none"};function QK(e){let{id:t,value:i}=e;return hn.createElement("div",{id:t,style:JK},i)}function eY(e){let{id:t,announcement:i,ariaLiveType:a="assertive"}=e;const c={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return hn.createElement("div",{id:t,style:c,role:"status","aria-live":a,"aria-atomic":!0},i)}function tY(){const[e,t]=K.useState("");return{announce:K.useCallback(a=>{a!=null&&t(a)},[]),announcement:e}}const GR=K.createContext(null);function rY(e){const t=K.useContext(GR);K.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function nY(){const[e]=K.useState(()=>new Set),t=K.useCallback(a=>(e.add(a),()=>e.delete(a)),[e]);return[K.useCallback(a=>{let{type:c,event:h}=a;e.forEach(f=>{var o;return(o=f[c])==null?void 0:o.call(f,h)})},[e]),t]}const iY={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},oY={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:i}=e;return i?"Draggable item "+t.id+" was moved over droppable area "+i.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:i}=e;return i?"Draggable item "+t.id+" was dropped over droppable area "+i.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function sY(e){let{announcements:t=oY,container:i,hiddenTextDescribedById:a,screenReaderInstructions:c=iY}=e;const{announce:h,announcement:f}=tY(),o=m0("DndLiveRegion"),[b,P]=K.useState(!1);if(K.useEffect(()=>{P(!0)},[]),rY(K.useMemo(()=>({onDragStart(D){let{active:z}=D;h(t.onDragStart({active:z}))},onDragMove(D){let{active:z,over:F}=D;t.onDragMove&&h(t.onDragMove({active:z,over:F}))},onDragOver(D){let{active:z,over:F}=D;h(t.onDragOver({active:z,over:F}))},onDragEnd(D){let{active:z,over:F}=D;h(t.onDragEnd({active:z,over:F}))},onDragCancel(D){let{active:z,over:F}=D;h(t.onDragCancel({active:z,over:F}))}}),[h,t])),!b)return null;const I=hn.createElement(hn.Fragment,null,hn.createElement(QK,{id:a,value:c.draggable}),hn.createElement(eY,{id:o,announcement:f}));return i?Zu.createPortal(I,i):I}var Vo;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Vo||(Vo={}));function Mx(){}function aY(e,t){return K.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function lY(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return K.useMemo(()=>[...t].filter(a=>a!=null),[...t])}const iu=Object.freeze({x:0,y:0});function cY(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function uY(e,t){const i=Tx(e);if(!i)return"0 0";const a={x:(i.x-t.left)/t.width*100,y:(i.y-t.top)/t.height*100};return a.x+"% "+a.y+"%"}function hY(e,t){let{data:{value:i}}=e,{data:{value:a}}=t;return i-a}function dY(e,t){let{data:{value:i}}=e,{data:{value:a}}=t;return a-i}function fY(e,t){if(!e||e.length===0)return null;const[i]=e;return i[t]}function oE(e,t,i){return t===void 0&&(t=e.left),i===void 0&&(i=e.top),{x:t+e.width*.5,y:i+e.height*.5}}const pY=e=>{let{collisionRect:t,droppableRects:i,droppableContainers:a}=e;const c=oE(t,t.left,t.top),h=[];for(const f of a){const{id:o}=f,b=i.get(o);if(b){const P=cY(oE(b),c);h.push({id:o,data:{droppableContainer:f,value:P}})}}return h.sort(hY)};function mY(e,t){const i=Math.max(t.top,e.top),a=Math.max(t.left,e.left),c=Math.min(t.left+t.width,e.left+e.width),h=Math.min(t.top+t.height,e.top+e.height),f=c-a,o=h-i;if(a<c&&i<h){const b=t.width*t.height,P=e.width*e.height,I=f*o,D=I/(b+P-I);return Number(D.toFixed(4))}return 0}const gY=e=>{let{collisionRect:t,droppableRects:i,droppableContainers:a}=e;const c=[];for(const h of a){const{id:f}=h,o=i.get(f);if(o){const b=mY(o,t);b>0&&c.push({id:f,data:{droppableContainer:h,value:b}})}}return c.sort(dY)};function yY(e,t,i){return{...e,scaleX:t&&i?t.width/i.width:1,scaleY:t&&i?t.height/i.height:1}}function qR(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:iu}function vY(e){return function(i){for(var a=arguments.length,c=new Array(a>1?a-1:0),h=1;h<a;h++)c[h-1]=arguments[h];return c.reduce((f,o)=>({...f,top:f.top+e*o.y,bottom:f.bottom+e*o.y,left:f.left+e*o.x,right:f.right+e*o.x}),{...i})}}const _Y=vY(1);function HR(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function xY(e,t,i){const a=HR(t);if(!a)return e;const{scaleX:c,scaleY:h,x:f,y:o}=a,b=e.left-f-(1-c)*parseFloat(i),P=e.top-o-(1-h)*parseFloat(i.slice(i.indexOf(" ")+1)),I=c?e.width/c:e.width,D=h?e.height/h:e.height;return{width:I,height:D,top:P,right:b+I,bottom:P+D,left:b}}const bY={ignoreTransform:!1};function ry(e,t){t===void 0&&(t=bY);let i=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:P,transformOrigin:I}=Js(e).getComputedStyle(e);P&&(i=xY(i,P,I))}const{top:a,left:c,width:h,height:f,bottom:o,right:b}=i;return{top:a,left:c,width:h,height:f,bottom:o,right:b}}function sE(e){return ry(e,{ignoreTransform:!0})}function wY(e){const t=e.innerWidth,i=e.innerHeight;return{top:0,left:0,right:t,bottom:i,width:t,height:i}}function SY(e,t){return t===void 0&&(t=Js(e).getComputedStyle(e)),t.position==="fixed"}function CY(e,t){t===void 0&&(t=Js(e).getComputedStyle(e));const i=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(c=>{const h=t[c];return typeof h=="string"?i.test(h):!1})}function PS(e,t){const i=[];function a(c){if(t!=null&&i.length>=t||!c)return i;if(MS(c)&&c.scrollingElement!=null&&!i.includes(c.scrollingElement))return i.push(c.scrollingElement),i;if(!f0(c)||VR(c)||i.includes(c))return i;const h=Js(e).getComputedStyle(c);return c!==e&&CY(c,h)&&i.push(c),SY(c,h)?i:a(c.parentNode)}return e?a(e):i}function WR(e){const[t]=PS(e,1);return t??null}function fw(e){return!v1||!e?null:ey(e)?e:TS(e)?MS(e)||e===ty(e).scrollingElement?window:f0(e)?e:null:null}function ZR(e){return ey(e)?e.scrollX:e.scrollLeft}function XR(e){return ey(e)?e.scrollY:e.scrollTop}function e2(e){return{x:ZR(e),y:XR(e)}}var is;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(is||(is={}));function KR(e){return!v1||!e?!1:e===document.scrollingElement}function YR(e){const t={x:0,y:0},i=KR(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},a={x:e.scrollWidth-i.width,y:e.scrollHeight-i.height},c=e.scrollTop<=t.y,h=e.scrollLeft<=t.x,f=e.scrollTop>=a.y,o=e.scrollLeft>=a.x;return{isTop:c,isLeft:h,isBottom:f,isRight:o,maxScroll:a,minScroll:t}}const TY={x:.2,y:.2};function MY(e,t,i,a,c){let{top:h,left:f,right:o,bottom:b}=i;a===void 0&&(a=10),c===void 0&&(c=TY);const{isTop:P,isBottom:I,isLeft:D,isRight:z}=YR(e),F={x:0,y:0},U={x:0,y:0},$={height:t.height*c.y,width:t.width*c.x};return!P&&h<=t.top+$.height?(F.y=is.Backward,U.y=a*Math.abs((t.top+$.height-h)/$.height)):!I&&b>=t.bottom-$.height&&(F.y=is.Forward,U.y=a*Math.abs((t.bottom-$.height-b)/$.height)),!z&&o>=t.right-$.width?(F.x=is.Forward,U.x=a*Math.abs((t.right-$.width-o)/$.width)):!D&&f<=t.left+$.width&&(F.x=is.Backward,U.x=a*Math.abs((t.left+$.width-f)/$.width)),{direction:F,speed:U}}function PY(e){if(e===document.scrollingElement){const{innerWidth:h,innerHeight:f}=window;return{top:0,left:0,right:h,bottom:f,width:h,height:f}}const{top:t,left:i,right:a,bottom:c}=e.getBoundingClientRect();return{top:t,left:i,right:a,bottom:c,width:e.clientWidth,height:e.clientHeight}}function JR(e){return e.reduce((t,i)=>kg(t,e2(i)),iu)}function EY(e){return e.reduce((t,i)=>t+ZR(i),0)}function IY(e){return e.reduce((t,i)=>t+XR(i),0)}function QR(e,t){if(t===void 0&&(t=ry),!e)return;const{top:i,left:a,bottom:c,right:h}=t(e);WR(e)&&(c<=0||h<=0||i>=window.innerHeight||a>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const kY=[["x",["left","right"],EY],["y",["top","bottom"],IY]];class ES{constructor(t,i){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const a=PS(i),c=JR(a);this.rect={...t},this.width=t.width,this.height=t.height;for(const[h,f,o]of kY)for(const b of f)Object.defineProperty(this,b,{get:()=>{const P=o(a),I=c[h]-P;return this.rect[b]+I},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class fv{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(i=>{var a;return(a=this.target)==null?void 0:a.removeEventListener(...i)})},this.target=t}add(t,i,a){var c;(c=this.target)==null||c.addEventListener(t,i,a),this.listeners.push([t,i,a])}}function AY(e){const{EventTarget:t}=Js(e);return e instanceof t?e:ty(e)}function pw(e,t){const i=Math.abs(e.x),a=Math.abs(e.y);return typeof t=="number"?Math.sqrt(i**2+a**2)>t:"x"in t&&"y"in t?i>t.x&&a>t.y:"x"in t?i>t.x:"y"in t?a>t.y:!1}var Gl;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Gl||(Gl={}));function aE(e){e.preventDefault()}function RY(e){e.stopPropagation()}var Nn;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Nn||(Nn={}));const e5={start:[Nn.Space,Nn.Enter],cancel:[Nn.Esc],end:[Nn.Space,Nn.Enter,Nn.Tab]},DY=(e,t)=>{let{currentCoordinates:i}=t;switch(e.code){case Nn.Right:return{...i,x:i.x+25};case Nn.Left:return{...i,x:i.x-25};case Nn.Down:return{...i,y:i.y+25};case Nn.Up:return{...i,y:i.y-25}}};class t5{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:i}}=t;this.props=t,this.listeners=new fv(ty(i)),this.windowListeners=new fv(Js(i)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Gl.Resize,this.handleCancel),this.windowListeners.add(Gl.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Gl.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:i}=this.props,a=t.node.current;a&&QR(a),i(iu)}handleKeyDown(t){if(x1(t)){const{active:i,context:a,options:c}=this.props,{keyboardCodes:h=e5,coordinateGetter:f=DY,scrollBehavior:o="smooth"}=c,{code:b}=t;if(h.end.includes(b)){this.handleEnd(t);return}if(h.cancel.includes(b)){this.handleCancel(t);return}const{collisionRect:P}=a.current,I=P?{x:P.left,y:P.top}:iu;this.referenceCoordinates||(this.referenceCoordinates=I);const D=f(t,{active:i,context:a.current,currentCoordinates:I});if(D){const z=Cx(D,I),F={x:0,y:0},{scrollableAncestors:U}=a.current;for(const $ of U){const j=t.code,{isTop:ie,isRight:se,isLeft:Q,isBottom:de,maxScroll:oe,minScroll:be}=YR($),xe=PY($),Me={x:Math.min(j===Nn.Right?xe.right-xe.width/2:xe.right,Math.max(j===Nn.Right?xe.left:xe.left+xe.width/2,D.x)),y:Math.min(j===Nn.Down?xe.bottom-xe.height/2:xe.bottom,Math.max(j===Nn.Down?xe.top:xe.top+xe.height/2,D.y))},Ee=j===Nn.Right&&!se||j===Nn.Left&&!Q,re=j===Nn.Down&&!de||j===Nn.Up&&!ie;if(Ee&&Me.x!==D.x){const ke=$.scrollLeft+z.x,Ge=j===Nn.Right&&ke<=oe.x||j===Nn.Left&&ke>=be.x;if(Ge&&!z.y){$.scrollTo({left:ke,behavior:o});return}Ge?F.x=$.scrollLeft-ke:F.x=j===Nn.Right?$.scrollLeft-oe.x:$.scrollLeft-be.x,F.x&&$.scrollBy({left:-F.x,behavior:o});break}else if(re&&Me.y!==D.y){const ke=$.scrollTop+z.y,Ge=j===Nn.Down&&ke<=oe.y||j===Nn.Up&&ke>=be.y;if(Ge&&!z.x){$.scrollTo({top:ke,behavior:o});return}Ge?F.y=$.scrollTop-ke:F.y=j===Nn.Down?$.scrollTop-oe.y:$.scrollTop-be.y,F.y&&$.scrollBy({top:-F.y,behavior:o});break}}this.handleMove(t,kg(Cx(D,this.referenceCoordinates),F))}}}handleMove(t,i){const{onMove:a}=this.props;t.preventDefault(),a(i)}handleEnd(t){const{onEnd:i}=this.props;t.preventDefault(),this.detach(),i()}handleCancel(t){const{onCancel:i}=this.props;t.preventDefault(),this.detach(),i()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}t5.activators=[{eventName:"onKeyDown",handler:(e,t,i)=>{let{keyboardCodes:a=e5,onActivation:c}=t,{active:h}=i;const{code:f}=e.nativeEvent;if(a.start.includes(f)){const o=h.activatorNode.current;return o&&e.target!==o?!1:(e.preventDefault(),c?.({event:e.nativeEvent}),!0)}return!1}}];function lE(e){return!!(e&&"distance"in e)}function cE(e){return!!(e&&"delay"in e)}class IS{constructor(t,i,a){var c;a===void 0&&(a=AY(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=i;const{event:h}=t,{target:f}=h;this.props=t,this.events=i,this.document=ty(f),this.documentListeners=new fv(this.document),this.listeners=new fv(a),this.windowListeners=new fv(Js(f)),this.initialCoordinates=(c=Tx(h))!=null?c:iu,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:i,bypassActivationConstraint:a}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Gl.Resize,this.handleCancel),this.windowListeners.add(Gl.DragStart,aE),this.windowListeners.add(Gl.VisibilityChange,this.handleCancel),this.windowListeners.add(Gl.ContextMenu,aE),this.documentListeners.add(Gl.Keydown,this.handleKeydown),i){if(a!=null&&a({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(cE(i)){this.timeoutId=setTimeout(this.handleStart,i.delay),this.handlePending(i);return}if(lE(i)){this.handlePending(i);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,i){const{active:a,onPending:c}=this.props;c(a,t,this.initialCoordinates,i)}handleStart(){const{initialCoordinates:t}=this,{onStart:i}=this.props;t&&(this.activated=!0,this.documentListeners.add(Gl.Click,RY,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Gl.SelectionChange,this.removeTextSelection),i(t))}handleMove(t){var i;const{activated:a,initialCoordinates:c,props:h}=this,{onMove:f,options:{activationConstraint:o}}=h;if(!c)return;const b=(i=Tx(t))!=null?i:iu,P=Cx(c,b);if(!a&&o){if(lE(o)){if(o.tolerance!=null&&pw(P,o.tolerance))return this.handleCancel();if(pw(P,o.distance))return this.handleStart()}if(cE(o)&&pw(P,o.tolerance))return this.handleCancel();this.handlePending(o,P);return}t.cancelable&&t.preventDefault(),f(b)}handleEnd(){const{onAbort:t,onEnd:i}=this.props;this.detach(),this.activated||t(this.props.active),i()}handleCancel(){const{onAbort:t,onCancel:i}=this.props;this.detach(),this.activated||t(this.props.active),i()}handleKeydown(t){t.code===Nn.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const zY={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class kS extends IS{constructor(t){const{event:i}=t,a=ty(i.target);super(t,zY,a)}}kS.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:i}=e,{onActivation:a}=t;return!i.isPrimary||i.button!==0?!1:(a?.({event:i}),!0)}}];const OY={move:{name:"mousemove"},end:{name:"mouseup"}};var t2;(function(e){e[e.RightClick=2]="RightClick"})(t2||(t2={}));class LY extends IS{constructor(t){super(t,OY,ty(t.event.target))}}LY.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:i}=e,{onActivation:a}=t;return i.button===t2.RightClick?!1:(a?.({event:i}),!0)}}];const mw={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class FY extends IS{constructor(t){super(t,mw)}static setup(){return window.addEventListener(mw.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(mw.move.name,t)};function t(){}}}FY.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:i}=e,{onActivation:a}=t;const{touches:c}=i;return c.length>1?!1:(a?.({event:i}),!0)}}];var pv;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(pv||(pv={}));var Px;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Px||(Px={}));function BY(e){let{acceleration:t,activator:i=pv.Pointer,canScroll:a,draggingRect:c,enabled:h,interval:f=5,order:o=Px.TreeOrder,pointerCoordinates:b,scrollableAncestors:P,scrollableAncestorRects:I,delta:D,threshold:z}=e;const F=jY({delta:D,disabled:!h}),[U,$]=ZK(),j=K.useRef({x:0,y:0}),ie=K.useRef({x:0,y:0}),se=K.useMemo(()=>{switch(i){case pv.Pointer:return b?{top:b.y,bottom:b.y,left:b.x,right:b.x}:null;case pv.DraggableRect:return c}},[i,c,b]),Q=K.useRef(null),de=K.useCallback(()=>{const be=Q.current;if(!be)return;const xe=j.current.x*ie.current.x,Me=j.current.y*ie.current.y;be.scrollBy(xe,Me)},[]),oe=K.useMemo(()=>o===Px.TreeOrder?[...P].reverse():P,[o,P]);K.useEffect(()=>{if(!h||!P.length||!se){$();return}for(const be of oe){if(a?.(be)===!1)continue;const xe=P.indexOf(be),Me=I[xe];if(!Me)continue;const{direction:Ee,speed:re}=MY(be,Me,se,t,z);for(const ke of["x","y"])F[ke][Ee[ke]]||(re[ke]=0,Ee[ke]=0);if(re.x>0||re.y>0){$(),Q.current=be,U(de,f),j.current=re,ie.current=Ee;return}}j.current={x:0,y:0},ie.current={x:0,y:0},$()},[t,de,a,$,h,f,JSON.stringify(se),JSON.stringify(F),U,P,oe,I,JSON.stringify(z)])}const $Y={x:{[is.Backward]:!1,[is.Forward]:!1},y:{[is.Backward]:!1,[is.Forward]:!1}};function jY(e){let{delta:t,disabled:i}=e;const a=Sx(t);return p0(c=>{if(i||!a||!c)return $Y;const h={x:Math.sign(t.x-a.x),y:Math.sign(t.y-a.y)};return{x:{[is.Backward]:c.x[is.Backward]||h.x===-1,[is.Forward]:c.x[is.Forward]||h.x===1},y:{[is.Backward]:c.y[is.Backward]||h.y===-1,[is.Forward]:c.y[is.Forward]||h.y===1}}},[i,t,a])}function NY(e,t){const i=t!=null?e.get(t):void 0,a=i?i.node.current:null;return p0(c=>{var h;return t==null?null:(h=a??c)!=null?h:null},[a,t])}function VY(e,t){return K.useMemo(()=>e.reduce((i,a)=>{const{sensor:c}=a,h=c.activators.map(f=>({eventName:f.eventName,handler:t(f.handler,a)}));return[...i,...h]},[]),[e,t])}var Ov;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Ov||(Ov={}));var r2;(function(e){e.Optimized="optimized"})(r2||(r2={}));const uE=new Map;function UY(e,t){let{dragging:i,dependencies:a,config:c}=t;const[h,f]=K.useState(null),{frequency:o,measure:b,strategy:P}=c,I=K.useRef(e),D=j(),z=zv(D),F=K.useCallback(function(ie){ie===void 0&&(ie=[]),!z.current&&f(se=>se===null?ie:se.concat(ie.filter(Q=>!se.includes(Q))))},[z]),U=K.useRef(null),$=p0(ie=>{if(D&&!i)return uE;if(!ie||ie===uE||I.current!==e||h!=null){const se=new Map;for(let Q of e){if(!Q)continue;if(h&&h.length>0&&!h.includes(Q.id)&&Q.rect.current){se.set(Q.id,Q.rect.current);continue}const de=Q.node.current,oe=de?new ES(b(de),de):null;Q.rect.current=oe,oe&&se.set(Q.id,oe)}return se}return ie},[e,h,i,D,b]);return K.useEffect(()=>{I.current=e},[e]),K.useEffect(()=>{D||F()},[i,D]),K.useEffect(()=>{h&&h.length>0&&f(null)},[JSON.stringify(h)]),K.useEffect(()=>{D||typeof o!="number"||U.current!==null||(U.current=setTimeout(()=>{F(),U.current=null},o))},[o,D,F,...a]),{droppableRects:$,measureDroppableContainers:F,measuringScheduled:h!=null};function j(){switch(P){case Ov.Always:return!1;case Ov.BeforeDragging:return i;default:return!i}}}function AS(e,t){return p0(i=>e?i||(typeof t=="function"?t(e):e):null,[t,e])}function GY(e,t){return AS(e,t)}function qY(e){let{callback:t,disabled:i}=e;const a=_1(t),c=K.useMemo(()=>{if(i||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:h}=window;return new h(a)},[a,i]);return K.useEffect(()=>()=>c?.disconnect(),[c]),c}function b1(e){let{callback:t,disabled:i}=e;const a=_1(t),c=K.useMemo(()=>{if(i||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:h}=window;return new h(a)},[i]);return K.useEffect(()=>()=>c?.disconnect(),[c]),c}function HY(e){return new ES(ry(e),e)}function hE(e,t,i){t===void 0&&(t=HY);const[a,c]=K.useState(null);function h(){c(b=>{if(!e)return null;if(e.isConnected===!1){var P;return(P=b??i)!=null?P:null}const I=t(e);return JSON.stringify(b)===JSON.stringify(I)?b:I})}const f=qY({callback(b){if(e)for(const P of b){const{type:I,target:D}=P;if(I==="childList"&&D instanceof HTMLElement&&D.contains(e)){h();break}}}}),o=b1({callback:h});return nu(()=>{h(),e?(o?.observe(e),f?.observe(document.body,{childList:!0,subtree:!0})):(o?.disconnect(),f?.disconnect())},[e]),a}function WY(e){const t=AS(e);return qR(e,t)}const dE=[];function ZY(e){const t=K.useRef(e),i=p0(a=>e?a&&a!==dE&&e&&t.current&&e.parentNode===t.current.parentNode?a:PS(e):dE,[e]);return K.useEffect(()=>{t.current=e},[e]),i}function XY(e){const[t,i]=K.useState(null),a=K.useRef(e),c=K.useCallback(h=>{const f=fw(h.target);f&&i(o=>o?(o.set(f,e2(f)),new Map(o)):null)},[]);return K.useEffect(()=>{const h=a.current;if(e!==h){f(h);const o=e.map(b=>{const P=fw(b);return P?(P.addEventListener("scroll",c,{passive:!0}),[P,e2(P)]):null}).filter(b=>b!=null);i(o.length?new Map(o):null),a.current=e}return()=>{f(e),f(h)};function f(o){o.forEach(b=>{const P=fw(b);P?.removeEventListener("scroll",c)})}},[c,e]),K.useMemo(()=>e.length?t?Array.from(t.values()).reduce((h,f)=>kg(h,f),iu):JR(e):iu,[e,t])}function fE(e,t){t===void 0&&(t=[]);const i=K.useRef(null);return K.useEffect(()=>{i.current=null},t),K.useEffect(()=>{const a=e!==iu;a&&!i.current&&(i.current=e),!a&&i.current&&(i.current=null)},[e]),i.current?Cx(e,i.current):iu}function KY(e){K.useEffect(()=>{if(!v1)return;const t=e.map(i=>{let{sensor:a}=i;return a.setup==null?void 0:a.setup()});return()=>{for(const i of t)i?.()}},e.map(t=>{let{sensor:i}=t;return i}))}function YY(e,t){return K.useMemo(()=>e.reduce((i,a)=>{let{eventName:c,handler:h}=a;return i[c]=f=>{h(f,t)},i},{}),[e,t])}function r5(e){return K.useMemo(()=>e?wY(e):null,[e])}const pE=[];function JY(e,t){t===void 0&&(t=ry);const[i]=e,a=r5(i?Js(i):null),[c,h]=K.useState(pE);function f(){h(()=>e.length?e.map(b=>KR(b)?a:new ES(t(b),b)):pE)}const o=b1({callback:f});return nu(()=>{o?.disconnect(),f(),e.forEach(b=>o?.observe(b))},[e]),c}function n5(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return f0(t)?t:e}function QY(e){let{measure:t}=e;const[i,a]=K.useState(null),c=K.useCallback(P=>{for(const{target:I}of P)if(f0(I)){a(D=>{const z=t(I);return D?{...D,width:z.width,height:z.height}:z});break}},[t]),h=b1({callback:c}),f=K.useCallback(P=>{const I=n5(P);h?.disconnect(),I&&h?.observe(I),a(I?t(I):null)},[t,h]),[o,b]=wx(f);return K.useMemo(()=>({nodeRef:o,rect:i,setRef:b}),[i,o,b])}const eJ=[{sensor:kS,options:{}},{sensor:t5,options:{}}],tJ={current:{}},U_={draggable:{measure:sE},droppable:{measure:sE,strategy:Ov.WhileDragging,frequency:r2.Optimized},dragOverlay:{measure:ry}};class mv extends Map{get(t){var i;return t!=null&&(i=super.get(t))!=null?i:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:i}=t;return!i})}getNodeFor(t){var i,a;return(i=(a=this.get(t))==null?void 0:a.node.current)!=null?i:void 0}}const rJ={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new mv,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Mx},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:U_,measureDroppableContainers:Mx,windowRect:null,measuringScheduled:!1},i5={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Mx,draggableNodes:new Map,over:null,measureDroppableContainers:Mx},g0=K.createContext(i5),o5=K.createContext(rJ);function nJ(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new mv}}}function iJ(e,t){switch(t.type){case Vo.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Vo.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Vo.DragEnd:case Vo.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Vo.RegisterDroppable:{const{element:i}=t,{id:a}=i,c=new mv(e.droppable.containers);return c.set(a,i),{...e,droppable:{...e.droppable,containers:c}}}case Vo.SetDroppableDisabled:{const{id:i,key:a,disabled:c}=t,h=e.droppable.containers.get(i);if(!h||a!==h.key)return e;const f=new mv(e.droppable.containers);return f.set(i,{...h,disabled:c}),{...e,droppable:{...e.droppable,containers:f}}}case Vo.UnregisterDroppable:{const{id:i,key:a}=t,c=e.droppable.containers.get(i);if(!c||a!==c.key)return e;const h=new mv(e.droppable.containers);return h.delete(i),{...e,droppable:{...e.droppable,containers:h}}}default:return e}}function oJ(e){let{disabled:t}=e;const{active:i,activatorEvent:a,draggableNodes:c}=K.useContext(g0),h=Sx(a),f=Sx(i?.id);return K.useEffect(()=>{if(!t&&!a&&h&&f!=null){if(!x1(h)||document.activeElement===h.target)return;const o=c.get(f);if(!o)return;const{activatorNode:b,node:P}=o;if(!b.current&&!P.current)return;requestAnimationFrame(()=>{for(const I of[b.current,P.current]){if(!I)continue;const D=YK(I);if(D){D.focus();break}}})}},[a,t,c,f,h]),null}function s5(e,t){let{transform:i,...a}=t;return e!=null&&e.length?e.reduce((c,h)=>h({transform:c,...a}),i):i}function sJ(e){return K.useMemo(()=>({draggable:{...U_.draggable,...e?.draggable},droppable:{...U_.droppable,...e?.droppable},dragOverlay:{...U_.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function aJ(e){let{activeNode:t,measure:i,initialRect:a,config:c=!0}=e;const h=K.useRef(!1),{x:f,y:o}=typeof c=="boolean"?{x:c,y:c}:c;nu(()=>{if(!f&&!o||!t){h.current=!1;return}if(h.current||!a)return;const P=t?.node.current;if(!P||P.isConnected===!1)return;const I=i(P),D=qR(I,a);if(f||(D.x=0),o||(D.y=0),h.current=!0,Math.abs(D.x)>0||Math.abs(D.y)>0){const z=WR(P);z&&z.scrollBy({top:D.y,left:D.x})}},[t,f,o,a,i])}const w1=K.createContext({...iu,scaleX:1,scaleY:1});var pf;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(pf||(pf={}));const lJ=K.memo(function(t){var i,a,c,h;let{id:f,accessibility:o,autoScroll:b=!0,children:P,sensors:I=eJ,collisionDetection:D=gY,measuring:z,modifiers:F,...U}=t;const $=K.useReducer(iJ,void 0,nJ),[j,ie]=$,[se,Q]=nY(),[de,oe]=K.useState(pf.Uninitialized),be=de===pf.Initialized,{draggable:{active:xe,nodes:Me,translate:Ee},droppable:{containers:re}}=j,ke=xe!=null?Me.get(xe):null,Ge=K.useRef({initial:null,translated:null}),Ke=K.useMemo(()=>{var tr;return xe!=null?{id:xe,data:(tr=ke?.data)!=null?tr:tJ,rect:Ge}:null},[xe,ke]),gt=K.useRef(null),[et,qe]=K.useState(null),[Qe,Ve]=K.useState(null),je=zv(U,Object.values(U)),ct=m0("DndDescribedBy",f),ye=K.useMemo(()=>re.getEnabled(),[re]),ze=sJ(z),{droppableRects:ft,measureDroppableContainers:wt,measuringScheduled:xt}=UY(ye,{dragging:be,dependencies:[Ee.x,Ee.y],config:ze.droppable}),_t=NY(Me,xe),St=K.useMemo(()=>Qe?Tx(Qe):null,[Qe]),tt=br(),At=GY(_t,ze.draggable.measure);aJ({activeNode:xe!=null?Me.get(xe):null,config:tt.layoutShiftCompensation,initialRect:At,measure:ze.draggable.measure});const It=hE(_t,ze.draggable.measure,At),mr=hE(_t?_t.parentElement:null),ur=K.useRef({activatorEvent:null,active:null,activeNode:_t,collisionRect:null,collisions:null,droppableRects:ft,draggableNodes:Me,draggingNode:null,draggingNodeRect:null,droppableContainers:re,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Hr=re.getNodeFor((i=ur.current.over)==null?void 0:i.id),wr=QY({measure:ze.dragOverlay.measure}),sr=(a=wr.nodeRef.current)!=null?a:_t,Wt=be?(c=wr.rect)!=null?c:It:null,yr=!!(wr.nodeRef.current&&wr.rect),Yt=WY(yr?null:It),Cr=r5(sr?Js(sr):null),Rr=ZY(be?Hr??_t:null),Or=JY(Rr),Gr=s5(F,{transform:{x:Ee.x-Yt.x,y:Ee.y-Yt.y,scaleX:1,scaleY:1},activatorEvent:Qe,active:Ke,activeNodeRect:It,containerNodeRect:mr,draggingNodeRect:Wt,over:ur.current.over,overlayNodeRect:wr.rect,scrollableAncestors:Rr,scrollableAncestorRects:Or,windowRect:Cr}),rn=St?kg(St,Ee):null,Un=XY(Rr),wn=fE(Un),He=fE(Un,[It]),ae=kg(Gr,wn),le=Wt?_Y(Wt,Gr):null,ue=Ke&&le?D({active:Ke,collisionRect:le,droppableRects:ft,droppableContainers:ye,pointerCoordinates:rn}):null,Pe=fY(ue,"id"),[Re,Ye]=K.useState(null),Xe=yr?Gr:kg(Gr,He),$e=yY(Xe,(h=Re?.rect)!=null?h:null,It),Je=K.useRef(null),Ct=K.useCallback((tr,Ze)=>{let{sensor:Lr,options:mn}=Ze;if(gt.current==null)return;const ar=Me.get(gt.current);if(!ar)return;const Dr=tr.nativeEvent,ln=new Lr({active:gt.current,activeNode:ar,event:Dr,options:mn,context:ur,onAbort(zr){if(!Me.get(zr))return;const{onDragAbort:Kr}=je.current,Vi={id:zr};Kr?.(Vi),se({type:"onDragAbort",event:Vi})},onPending(zr,Vr,Kr,Vi){if(!Me.get(zr))return;const{onDragPending:Et}=je.current,vn={id:zr,constraint:Vr,initialCoordinates:Kr,offset:Vi};Et?.(vn),se({type:"onDragPending",event:vn})},onStart(zr){const Vr=gt.current;if(Vr==null)return;const Kr=Me.get(Vr);if(!Kr)return;const{onDragStart:Vi}=je.current,Ui={activatorEvent:Dr,active:{id:Vr,data:Kr.data,rect:Ge}};Zu.unstable_batchedUpdates(()=>{Vi?.(Ui),oe(pf.Initializing),ie({type:Vo.DragStart,initialCoordinates:zr,active:Vr}),se({type:"onDragStart",event:Ui}),qe(Je.current),Ve(Dr)})},onMove(zr){ie({type:Vo.DragMove,coordinates:zr})},onEnd:Xr(Vo.DragEnd),onCancel:Xr(Vo.DragCancel)});Je.current=ln;function Xr(zr){return async function(){const{active:Kr,collisions:Vi,over:Ui,scrollAdjustedTranslate:Et}=ur.current;let vn=null;if(Kr&&Et){const{cancelDrop:zn}=je.current;vn={activatorEvent:Dr,active:Kr,collisions:Vi,delta:Et,over:Ui},zr===Vo.DragEnd&&typeof zn=="function"&&await Promise.resolve(zn(vn))&&(zr=Vo.DragCancel)}gt.current=null,Zu.unstable_batchedUpdates(()=>{ie({type:zr}),oe(pf.Uninitialized),Ye(null),qe(null),Ve(null),Je.current=null;const zn=zr===Vo.DragEnd?"onDragEnd":"onDragCancel";if(vn){const fs=je.current[zn];fs?.(vn),se({type:zn,event:vn})}})}}},[Me]),yt=K.useCallback((tr,Ze)=>(Lr,mn)=>{const ar=Lr.nativeEvent,Dr=Me.get(mn);if(gt.current!==null||!Dr||ar.dndKit||ar.defaultPrevented)return;const ln={active:Dr};tr(Lr,Ze.options,ln)===!0&&(ar.dndKit={capturedBy:Ze.sensor},gt.current=mn,Ct(Lr,Ze))},[Me,Ct]),$t=VY(I,yt);KY(I),nu(()=>{It&&de===pf.Initializing&&oe(pf.Initialized)},[It,de]),K.useEffect(()=>{const{onDragMove:tr}=je.current,{active:Ze,activatorEvent:Lr,collisions:mn,over:ar}=ur.current;if(!Ze||!Lr)return;const Dr={active:Ze,activatorEvent:Lr,collisions:mn,delta:{x:ae.x,y:ae.y},over:ar};Zu.unstable_batchedUpdates(()=>{tr?.(Dr),se({type:"onDragMove",event:Dr})})},[ae.x,ae.y]),K.useEffect(()=>{const{active:tr,activatorEvent:Ze,collisions:Lr,droppableContainers:mn,scrollAdjustedTranslate:ar}=ur.current;if(!tr||gt.current==null||!Ze||!ar)return;const{onDragOver:Dr}=je.current,ln=mn.get(Pe),Xr=ln&&ln.rect.current?{id:ln.id,rect:ln.rect.current,data:ln.data,disabled:ln.disabled}:null,zr={active:tr,activatorEvent:Ze,collisions:Lr,delta:{x:ar.x,y:ar.y},over:Xr};Zu.unstable_batchedUpdates(()=>{Ye(Xr),Dr?.(zr),se({type:"onDragOver",event:zr})})},[Pe]),nu(()=>{ur.current={activatorEvent:Qe,active:Ke,activeNode:_t,collisionRect:le,collisions:ue,droppableRects:ft,draggableNodes:Me,draggingNode:sr,draggingNodeRect:Wt,droppableContainers:re,over:Re,scrollableAncestors:Rr,scrollAdjustedTranslate:ae},Ge.current={initial:Wt,translated:le}},[Ke,_t,ue,le,Me,sr,Wt,ft,re,Re,Rr,ae]),BY({...tt,delta:Ee,draggingRect:le,pointerCoordinates:rn,scrollableAncestors:Rr,scrollableAncestorRects:Or});const qt=K.useMemo(()=>({active:Ke,activeNode:_t,activeNodeRect:It,activatorEvent:Qe,collisions:ue,containerNodeRect:mr,dragOverlay:wr,draggableNodes:Me,droppableContainers:re,droppableRects:ft,over:Re,measureDroppableContainers:wt,scrollableAncestors:Rr,scrollableAncestorRects:Or,measuringConfiguration:ze,measuringScheduled:xt,windowRect:Cr}),[Ke,_t,It,Qe,ue,mr,wr,Me,re,ft,Re,wt,Rr,Or,ze,xt,Cr]),Qt=K.useMemo(()=>({activatorEvent:Qe,activators:$t,active:Ke,activeNodeRect:It,ariaDescribedById:{draggable:ct},dispatch:ie,draggableNodes:Me,over:Re,measureDroppableContainers:wt}),[Qe,$t,Ke,It,ie,ct,Me,Re,wt]);return hn.createElement(GR.Provider,{value:Q},hn.createElement(g0.Provider,{value:Qt},hn.createElement(o5.Provider,{value:qt},hn.createElement(w1.Provider,{value:$e},P)),hn.createElement(oJ,{disabled:o?.restoreFocus===!1})),hn.createElement(sY,{...o,hiddenTextDescribedById:ct}));function br(){const tr=et?.autoScrollEnabled===!1,Ze=typeof b=="object"?b.enabled===!1:b===!1,Lr=be&&!tr&&!Ze;return typeof b=="object"?{...b,enabled:Lr}:{enabled:Lr}}}),cJ=K.createContext(null),mE="button",uJ="Draggable";function hJ(e){let{id:t,data:i,disabled:a=!1,attributes:c}=e;const h=m0(uJ),{activators:f,activatorEvent:o,active:b,activeNodeRect:P,ariaDescribedById:I,draggableNodes:D,over:z}=K.useContext(g0),{role:F=mE,roleDescription:U="draggable",tabIndex:$=0}=c??{},j=b?.id===t,ie=K.useContext(j?w1:cJ),[se,Q]=wx(),[de,oe]=wx(),be=YY(f,t),xe=zv(i);nu(()=>(D.set(t,{id:t,key:h,node:se,activatorNode:de,data:xe}),()=>{const Ee=D.get(t);Ee&&Ee.key===h&&D.delete(t)}),[D,t]);const Me=K.useMemo(()=>({role:F,tabIndex:$,"aria-disabled":a,"aria-pressed":j&&F===mE?!0:void 0,"aria-roledescription":U,"aria-describedby":I.draggable}),[a,F,$,j,U,I.draggable]);return{active:b,activatorEvent:o,activeNodeRect:P,attributes:Me,isDragging:j,listeners:a?void 0:be,node:se,over:z,setNodeRef:Q,setActivatorNodeRef:oe,transform:ie}}function a5(){return K.useContext(o5)}const dJ="Droppable",fJ={timeout:25};function pJ(e){let{data:t,disabled:i=!1,id:a,resizeObserverConfig:c}=e;const h=m0(dJ),{active:f,dispatch:o,over:b,measureDroppableContainers:P}=K.useContext(g0),I=K.useRef({disabled:i}),D=K.useRef(!1),z=K.useRef(null),F=K.useRef(null),{disabled:U,updateMeasurementsFor:$,timeout:j}={...fJ,...c},ie=zv($??a),se=K.useCallback(()=>{if(!D.current){D.current=!0;return}F.current!=null&&clearTimeout(F.current),F.current=setTimeout(()=>{P(Array.isArray(ie.current)?ie.current:[ie.current]),F.current=null},j)},[j]),Q=b1({callback:se,disabled:U||!f}),de=K.useCallback((Me,Ee)=>{Q&&(Ee&&(Q.unobserve(Ee),D.current=!1),Me&&Q.observe(Me))},[Q]),[oe,be]=wx(de),xe=zv(t);return K.useEffect(()=>{!Q||!oe.current||(Q.disconnect(),D.current=!1,Q.observe(oe.current))},[oe,Q]),K.useEffect(()=>(o({type:Vo.RegisterDroppable,element:{id:a,key:h,disabled:i,node:oe,rect:z,data:xe}}),()=>o({type:Vo.UnregisterDroppable,key:h,id:a})),[a]),K.useEffect(()=>{i!==I.current.disabled&&(o({type:Vo.SetDroppableDisabled,id:a,key:h,disabled:i}),I.current.disabled=i)},[a,h,i,o]),{active:f,rect:z,isOver:b?.id===a,node:oe,over:b,setNodeRef:be}}function mJ(e){let{animation:t,children:i}=e;const[a,c]=K.useState(null),[h,f]=K.useState(null),o=Sx(i);return!i&&!a&&o&&c(o),nu(()=>{if(!h)return;const b=a?.key,P=a?.props.id;if(b==null||P==null){c(null);return}Promise.resolve(t(P,h)).then(()=>{c(null)})},[t,a,h]),hn.createElement(hn.Fragment,null,i,a?K.cloneElement(a,{ref:f}):null)}const gJ={x:0,y:0,scaleX:1,scaleY:1};function yJ(e){let{children:t}=e;return hn.createElement(g0.Provider,{value:i5},hn.createElement(w1.Provider,{value:gJ},t))}const vJ={position:"fixed",touchAction:"none"},_J=e=>x1(e)?"transform 250ms ease":void 0,xJ=K.forwardRef((e,t)=>{let{as:i,activatorEvent:a,adjustScale:c,children:h,className:f,rect:o,style:b,transform:P,transition:I=_J}=e;if(!o)return null;const D=c?P:{...P,scaleX:1,scaleY:1},z={...vJ,width:o.width,height:o.height,top:o.top,left:o.left,transform:Af.Transform.toString(D),transformOrigin:c&&a?uY(a,o):void 0,transition:typeof I=="function"?I(a):I,...b};return hn.createElement(i,{className:f,style:z,ref:t},h)}),bJ=e=>t=>{let{active:i,dragOverlay:a}=t;const c={},{styles:h,className:f}=e;if(h!=null&&h.active)for(const[o,b]of Object.entries(h.active))b!==void 0&&(c[o]=i.node.style.getPropertyValue(o),i.node.style.setProperty(o,b));if(h!=null&&h.dragOverlay)for(const[o,b]of Object.entries(h.dragOverlay))b!==void 0&&a.node.style.setProperty(o,b);return f!=null&&f.active&&i.node.classList.add(f.active),f!=null&&f.dragOverlay&&a.node.classList.add(f.dragOverlay),function(){for(const[b,P]of Object.entries(c))i.node.style.setProperty(b,P);f!=null&&f.active&&i.node.classList.remove(f.active)}},wJ=e=>{let{transform:{initial:t,final:i}}=e;return[{transform:Af.Transform.toString(t)},{transform:Af.Transform.toString(i)}]},SJ={duration:250,easing:"ease",keyframes:wJ,sideEffects:bJ({styles:{active:{opacity:"0"}}})};function CJ(e){let{config:t,draggableNodes:i,droppableContainers:a,measuringConfiguration:c}=e;return _1((h,f)=>{if(t===null)return;const o=i.get(h);if(!o)return;const b=o.node.current;if(!b)return;const P=n5(f);if(!P)return;const{transform:I}=Js(f).getComputedStyle(f),D=HR(I);if(!D)return;const z=typeof t=="function"?t:TJ(t);return QR(b,c.draggable.measure),z({active:{id:h,data:o.data,node:b,rect:c.draggable.measure(b)},draggableNodes:i,dragOverlay:{node:f,rect:c.dragOverlay.measure(P)},droppableContainers:a,measuringConfiguration:c,transform:D})})}function TJ(e){const{duration:t,easing:i,sideEffects:a,keyframes:c}={...SJ,...e};return h=>{let{active:f,dragOverlay:o,transform:b,...P}=h;if(!t)return;const I={x:o.rect.left-f.rect.left,y:o.rect.top-f.rect.top},D={scaleX:b.scaleX!==1?f.rect.width*b.scaleX/o.rect.width:1,scaleY:b.scaleY!==1?f.rect.height*b.scaleY/o.rect.height:1},z={x:b.x-I.x,y:b.y-I.y,...D},F=c({...P,active:f,dragOverlay:o,transform:{initial:b,final:z}}),[U]=F,$=F[F.length-1];if(JSON.stringify(U)===JSON.stringify($))return;const j=a?.({active:f,dragOverlay:o,...P}),ie=o.node.animate(F,{duration:t,easing:i,fill:"forwards"});return new Promise(se=>{ie.onfinish=()=>{j?.(),se()}})}}let gE=0;function MJ(e){return K.useMemo(()=>{if(e!=null)return gE++,gE},[e])}const PJ=hn.memo(e=>{let{adjustScale:t=!1,children:i,dropAnimation:a,style:c,transition:h,modifiers:f,wrapperElement:o="div",className:b,zIndex:P=999}=e;const{activatorEvent:I,active:D,activeNodeRect:z,containerNodeRect:F,draggableNodes:U,droppableContainers:$,dragOverlay:j,over:ie,measuringConfiguration:se,scrollableAncestors:Q,scrollableAncestorRects:de,windowRect:oe}=a5(),be=K.useContext(w1),xe=MJ(D?.id),Me=s5(f,{activatorEvent:I,active:D,activeNodeRect:z,containerNodeRect:F,draggingNodeRect:j.rect,over:ie,overlayNodeRect:j.rect,scrollableAncestors:Q,scrollableAncestorRects:de,transform:be,windowRect:oe}),Ee=AS(z),re=CJ({config:a,draggableNodes:U,droppableContainers:$,measuringConfiguration:se}),ke=Ee?j.setRef:void 0;return hn.createElement(yJ,null,hn.createElement(mJ,{animation:re},D&&xe?hn.createElement(xJ,{key:xe,id:D.id,ref:ke,as:o,activatorEvent:I,adjustScale:t,className:b,transition:h,rect:Ee,style:{zIndex:P,...c},transform:Me},i):null))});function RS(e,t,i){const a=e.slice();return a.splice(i<0?a.length+i:i,0,a.splice(t,1)[0]),a}function EJ(e,t){return e.reduce((i,a,c)=>{const h=t.get(a);return h&&(i[c]=h),i},Array(e.length))}function S_(e){return e!==null&&e>=0}function IJ(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}function kJ(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const l5=e=>{let{rects:t,activeIndex:i,overIndex:a,index:c}=e;const h=RS(t,a,i),f=t[c],o=h[c];return!o||!f?null:{x:o.left-f.left,y:o.top-f.top,scaleX:o.width/f.width,scaleY:o.height/f.height}},C_={scaleX:1,scaleY:1},AJ=e=>{var t;let{activeIndex:i,activeNodeRect:a,index:c,rects:h,overIndex:f}=e;const o=(t=h[i])!=null?t:a;if(!o)return null;if(c===i){const P=h[f];return P?{x:0,y:i<f?P.top+P.height-(o.top+o.height):P.top-o.top,...C_}:null}const b=RJ(h,c,i);return c>i&&c<=f?{x:0,y:-o.height-b,...C_}:c<i&&c>=f?{x:0,y:o.height+b,...C_}:{x:0,y:0,...C_}};function RJ(e,t,i){const a=e[t],c=e[t-1],h=e[t+1];return a?i<t?c?a.top-(c.top+c.height):h?h.top-(a.top+a.height):0:h?h.top-(a.top+a.height):c?a.top-(c.top+c.height):0:0}const c5="Sortable",u5=hn.createContext({activeIndex:-1,containerId:c5,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:l5,disabled:{draggable:!1,droppable:!1}});function DJ(e){let{children:t,id:i,items:a,strategy:c=l5,disabled:h=!1}=e;const{active:f,dragOverlay:o,droppableRects:b,over:P,measureDroppableContainers:I}=a5(),D=m0(c5,i),z=o.rect!==null,F=K.useMemo(()=>a.map(be=>typeof be=="object"&&"id"in be?be.id:be),[a]),U=f!=null,$=f?F.indexOf(f.id):-1,j=P?F.indexOf(P.id):-1,ie=K.useRef(F),se=!IJ(F,ie.current),Q=j!==-1&&$===-1||se,de=kJ(h);nu(()=>{se&&U&&I(F)},[se,F,U,I]),K.useEffect(()=>{ie.current=F},[F]);const oe=K.useMemo(()=>({activeIndex:$,containerId:D,disabled:de,disableTransforms:Q,items:F,overIndex:j,useDragOverlay:z,sortedRects:EJ(F,b),strategy:c}),[$,D,de.draggable,de.droppable,Q,F,j,b,z,c]);return hn.createElement(u5.Provider,{value:oe},t)}const zJ=e=>{let{id:t,items:i,activeIndex:a,overIndex:c}=e;return RS(i,a,c).indexOf(t)},OJ=e=>{let{containerId:t,isSorting:i,wasDragging:a,index:c,items:h,newIndex:f,previousItems:o,previousContainerId:b,transition:P}=e;return!P||!a||o!==h&&c===f?!1:i?!0:f!==c&&t===b},LJ={duration:200,easing:"ease"},h5="transform",FJ=Af.Transition.toString({property:h5,duration:0,easing:"linear"}),BJ={roleDescription:"sortable"};function $J(e){let{disabled:t,index:i,node:a,rect:c}=e;const[h,f]=K.useState(null),o=K.useRef(i);return nu(()=>{if(!t&&i!==o.current&&a.current){const b=c.current;if(b){const P=ry(a.current,{ignoreTransform:!0}),I={x:b.left-P.left,y:b.top-P.top,scaleX:b.width/P.width,scaleY:b.height/P.height};(I.x||I.y)&&f(I)}}i!==o.current&&(o.current=i)},[t,i,a,c]),K.useEffect(()=>{h&&f(null)},[h]),h}function jJ(e){let{animateLayoutChanges:t=OJ,attributes:i,disabled:a,data:c,getNewIndex:h=zJ,id:f,strategy:o,resizeObserverConfig:b,transition:P=LJ}=e;const{items:I,containerId:D,activeIndex:z,disabled:F,disableTransforms:U,sortedRects:$,overIndex:j,useDragOverlay:ie,strategy:se}=K.useContext(u5),Q=NJ(a,F),de=I.indexOf(f),oe=K.useMemo(()=>({sortable:{containerId:D,index:de,items:I},...c}),[D,c,de,I]),be=K.useMemo(()=>I.slice(I.indexOf(f)),[I,f]),{rect:xe,node:Me,isOver:Ee,setNodeRef:re}=pJ({id:f,data:oe,disabled:Q.droppable,resizeObserverConfig:{updateMeasurementsFor:be,...b}}),{active:ke,activatorEvent:Ge,activeNodeRect:Ke,attributes:gt,setNodeRef:et,listeners:qe,isDragging:Qe,over:Ve,setActivatorNodeRef:je,transform:ct}=hJ({id:f,data:oe,attributes:{...BJ,...i},disabled:Q.draggable}),ye=WK(re,et),ze=!!ke,ft=ze&&!U&&S_(z)&&S_(j),wt=!ie&&Qe,xt=wt&&ft?ct:null,St=ft?xt??(o??se)({rects:$,activeNodeRect:Ke,activeIndex:z,overIndex:j,index:de}):null,tt=S_(z)&&S_(j)?h({id:f,items:I,activeIndex:z,overIndex:j}):de,At=ke?.id,It=K.useRef({activeId:At,items:I,newIndex:tt,containerId:D}),mr=I!==It.current.items,ur=t({active:ke,containerId:D,isDragging:Qe,isSorting:ze,id:f,index:de,items:I,newIndex:It.current.newIndex,previousItems:It.current.items,previousContainerId:It.current.containerId,transition:P,wasDragging:It.current.activeId!=null}),Hr=$J({disabled:!ur,index:de,node:Me,rect:xe});return K.useEffect(()=>{ze&&It.current.newIndex!==tt&&(It.current.newIndex=tt),D!==It.current.containerId&&(It.current.containerId=D),I!==It.current.items&&(It.current.items=I)},[ze,tt,D,I]),K.useEffect(()=>{if(At===It.current.activeId)return;if(At!=null&&It.current.activeId==null){It.current.activeId=At;return}const sr=setTimeout(()=>{It.current.activeId=At},50);return()=>clearTimeout(sr)},[At]),{active:ke,activeIndex:z,attributes:gt,data:oe,rect:xe,index:de,newIndex:tt,items:I,isOver:Ee,isSorting:ze,isDragging:Qe,listeners:qe,node:Me,overIndex:j,over:Ve,setNodeRef:ye,setActivatorNodeRef:je,setDroppableNodeRef:re,setDraggableNodeRef:et,transform:Hr??St,transition:wr()};function wr(){if(Hr||mr&&It.current.newIndex===de)return FJ;if(!(wt&&!x1(Ge)||!P)&&(ze||ur))return Af.Transition.toString({...P,property:h5})}}function NJ(e,t){var i,a;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(i=e?.draggable)!=null?i:t.draggable,droppable:(a=e?.droppable)!=null?a:t.droppable}}Nn.Down,Nn.Right,Nn.Up,Nn.Left;const yE=(e,t)=>{let i;return(...a)=>{clearTimeout(i),i=setTimeout(()=>{e(...a)},t)}},n2={[Lp.COMPANY]:{Icon:nq,label:"Companies",color:"orange"},[Lp.FUEL]:{Icon:ZG,label:"Fuel Stations",color:"#008234"},[Lp.REST]:{Icon:GG,label:"Rest Stops",color:"#1f6eb7"},[Lp.SERVICE]:{Icon:LG,label:"Service Centers",color:"#8e0d0d"},[Lp.DEALER]:{Icon:gR,label:"Dealerships",color:"#7c2391"},[Lp.RECRUITING]:{Icon:QG,label:"Recruitment Agencies",color:"#918d00"}},VJ=e=>G.jsx(ei,{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:2,children:Object.entries(n2).map(([t,{Icon:i,label:a,color:c}])=>G.jsx(UJ,{Icon:i,color:c,label:a,onClick:()=>e.onClick(Number(t),a)},t))}),UJ=({Icon:e,color:t,label:i,onClick:a})=>G.jsx(G.Fragment,{children:G.jsxs(ei,{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:1,children:[G.jsx(sd,{size:"lg",variant:"solid",sx:{borderRadius:"50%",p:2.5,backgroundColor:t},onClick:a,children:G.jsx(e,{sx:{transform:"scale(1.25)"}})}),G.jsx(Wr,{children:i})]})}),GJ={chooseDestination:{categoriesTitle:"Show nearby"},searchAlong:{categoriesTitle:"Search along the way"}},vE=e=>G.jsxs(dn,{direction:"column",gap:2,flexGrow:1,children:[G.jsxs(Hv,{size:"lg",variant:"soft",children:[G.jsx(qJ,{loading:e.showSearchLoading,onSelect:e.onSelect,onInputChange:e.onInputChange,placeholderText:"Search companies, facilities, points of interest...",options:e.options}),G.jsx(Ia,{size:"lg",sx:{justifyContent:"start",px:2},startDecorator:G.jsx(eq,{}),variant:"plain",color:"neutral",onClick:()=>e.onChooseOnMapClick(),children:"Choose on map"})]}),G.jsx(Xg,{}),G.jsx(Wr,{level:"title-lg",children:GJ[e.mode].categoriesTitle}),G.jsx(VJ,{onClick:e.onDestinationTypeClick})]}),qJ=e=>G.jsx(xF,{size:"lg",placeholder:e.placeholderText,options:e.options,onChange:(t,i,a)=>i!=null&&(a=="selectOption"||a==="createOption")&&e.onSelect(i),onInputChange:(t,i,a)=>e.onInputChange(i,a),filterOptions:t=>t,getOptionLabel:XJ,blurOnSelect:!0,handleHomeEndKeys:!0,freeSolo:!0,startDecorator:G.jsx(mS,{}),endDecorator:e.loading?G.jsx(nm,{size:"sm",sx:{bgcolor:"background.surface"}}):null,renderOption:(t,i)=>K.createElement(Y6,{...t,key:i.nodeUid+i.type},G.jsx(HJ,{option:i}))}),HJ=K.memo(({option:e})=>G.jsxs(G.Fragment,{children:[G.jsx(Kc,{sx:{display:"flex",justifyContent:"center",mx:0},children:G.jsx(_E,{option:e})}),G.jsx(ZJ,{option:e}),G.jsx(Kc,{children:G.jsx(_E,{option:e,position:"end"})})]})),_E=({option:e,position:t})=>{if(t==="end")return e.type==="company"?G.jsx(gw,{spriteName:e.sprite,includeMargin:!0}):e.type==="facility"&&KJ(e.sprite)?G.jsxs(dn,{direction:"row",alignItems:"center",children:[e.facilityUrls.map(a=>G.jsx("img",{src:a,style:{transformOrigin:"0 0",transform:"scale(0.8)"}},a)),G.jsx(gw,{spriteName:e.sprite,includeMargin:!0})]}):null;let i;switch(e.type){case"city":return G.jsx(XG,{});case"scenery":return G.jsx(UG,{});case"company":return G.jsx(JG,{});case"landmark":case"viewpoint":case"dealer":case"ferry":case"train":i=e.sprite;break;case"facility":{switch(e.label){case"Gallon Oil":case"Phoenix":case"Aron":case"Vortex":case"WP":case"GreenPetrol":case"Fusion":case"Driverse":case"Haulett":i="gas_ico";break;case"Western Star":case"Kenworth":case"Peterbilt":case"Volvo":case"Freightliner":case"International":case"Mack":i="dealer_ico";break;case"Garage":i="garage_large_ico";break;case"Gas Station":i="gas_ico";break;case"Rest Area":i="parking_ico";break;default:i="facility";break}break}default:throw new Uo(e)}return G.jsx(gw,{spriteName:i})},gw=({spriteName:e,includeMargin:t})=>G.jsx("div",{children:G.jsx("img",{src:`/icons/${e}.png`,alt:e,style:{padding:0,margin:0,transform:"scale(0.8)",marginRight:t?"1em":void 0}})});function WJ(e,t){return t.distance<=250||e.startsWith(t.name)||e.endsWith(t.name)?0:t.distance<=1e3?1:2}const ZJ=({option:e})=>{switch(e.type){case"city":case"scenery":return G.jsxs(J_,{children:[e.label,", ",e.stateCode]});case"company":case"landmark":case"viewpoint":case"dealer":case"ferry":case"train":case"facility":{let t;const i=WJ(e.label,e.city);switch(i){case 0:t=`${e.city.name}, ${e.stateCode}`;break;case 1:t=`near ${e.city.name}, ${e.stateCode}`;break;case 2:t=`${e.stateName}`;break;default:throw new Uo(i)}return G.jsxs(J_,{children:[G.jsx(Wr,{children:e.label}),G.jsx(Wr,{level:"body-sm",children:t})]})}default:throw new Uo(e)}};function XJ(e){if(typeof e=="string")return e;const t=Xw(e);return e.type==="city"||e.type==="scenery"?t:[e.label,Xw(e)].join(" ")}function KJ(e){return e.endsWith("_oil_gst")||e.endsWith("_dlr")}const YJ=e=>G.jsx(dn,{direction:"column",gap:2,flexGrow:1,children:G.jsxs(Hv,{size:"lg",variant:"soft",children:[G.jsx(Wr,{level:"body-md",fontSize:"lg",children:"Pan and zoom to adjust"}),G.jsx(Ia,{size:"lg",onClick:e.onUseThisPointClick,children:"Done"})]})}),JJ=e=>(console.log("render collapsible button bar"),G.jsx(Kp,{in:e.visible,children:G.jsxs(VF,{variant:"outlined",size:"lg",buttonFlex:"1 0 50%",sx:{mt:2,mb:1},children:[G.jsx(Ia,{startDecorator:G.jsx(pR,{}),onClick:t=>{e.onDestinationRoutesClick(),t.stopPropagation()},children:"Routes"}),G.jsx(Ia,{variant:"solid",color:"success",onClick:t=>{e.onDestinationGoClick(),t.stopPropagation()},children:"Go!"})]})})),QJ=e=>G.jsxs(G.Fragment,{children:[G.jsx(ll,{children:G.jsxs($p,{onClick:e.onDestinationHighlight,sx:{display:"flex",flexDirection:"column",gap:0,alignItems:"normal"},children:[G.jsxs(dn,{direction:"row",gap:1,children:[e.index!=null&&G.jsx(ei,{width:"1em",mr:1,children:G.jsxs(Wr,{fontSize:"lg",textAlign:"right",children:[e.index+1,"."]})}),G.jsx(ei,{marginTop:.5,children:G.jsx("img",{src:eQ(e.destination),style:{width:"4rem"}})}),G.jsxs(dn,{flexDirection:"column",flexGrow:1,children:[G.jsxs(dn,{flexDirection:"row",gap:1,justifyContent:"space-between",children:[G.jsx(Wr,{fontSize:"lg",children:e.destination.label}),G.jsx(dn,{direction:"row",alignItems:"center",gap:.5,children:e.destination.facilityUrls.map(t=>G.jsx("img",{src:t,style:{width:"1.5rem"}},t))})]}),G.jsxs(dn,{flexDirection:"row",gap:1,alignItems:"baseline",children:[G.jsx(Wr,{noWrap:!0,color:"neutral",fontSize:"sm",flexGrow:1,width:100,children:Xw(e.destination)}),G.jsxs(Wr,{color:"neutral",fontSize:"md",flexGrow:0,children:[Yp(e.destination.distance).length,G.jsx(Wr,{fontSize:"xs",children:Yp(e.destination.distance).unit})]}),G.jsx(Wr,{color:"neutral",fontSize:"md",fontWeight:"bold",flex:"0 1 2em",textAlign:"center",children:NR(e.destination.bearing)})]})]})]}),G.jsx(e.CollapsibleButtonBar,{})]})}),G.jsx(yf,{})]});function eQ(e){switch(e.type){case"city":case"scenery":return"/icons/city_names_ico.png";case"company":case"landmark":case"viewpoint":case"ferry":case"train":case"dealer":case"facility":return`/icons/${e.sprite}.png`;default:throw new Uo(e)}}const tQ=e=>(console.log("render dest list"),G.jsx(rm,{size:"lg",children:e.destinations.map((t,i)=>G.jsx(QJ,{destination:t,index:i,onDestinationHighlight:()=>e.onDestinationHighlight(t),CollapsibleButtonBar:()=>G.jsx(e.CollapsibleButtonBar,{destination:t})},t.nodeUid))}));function rQ(e,t,i){const a={...e};return t.top+e.y<=i.top?a.y=i.top-t.top:t.bottom+e.y>=i.top+i.height&&(a.y=i.top+i.height-t.bottom),t.left+e.x<=i.left?a.x=i.left-t.left:t.right+e.x>=i.left+i.width&&(a.x=i.left+i.width-t.right),a}const nQ=e=>{let{containerNodeRect:t,draggingNodeRect:i,transform:a}=e;return!i||!t?a:rQ(a,i,t)},iQ=e=>{let{transform:t}=e;return{...t,x:0}},xE={backgroundColor:"background.body",border:"1px solid",borderColor:"neutral.outlinedBorder",borderRadius:"var(--joy-radius-sm)",padding:1},oQ=e=>{const[t,i]=K.useState(null),a=lY(aY(kS,{activationConstraint:{delay:50,tolerance:5}})),c=gS(e.summary.minutes*60);function h(b){const{active:P}=b;i(P.id)}function f(b){const{active:P,over:I}=b;P.id!==I?.id&&e.onWaypointReorder({oldIndex:e.waypoints.findIndex(D=>D.id===P.id),newIndex:e.waypoints.findIndex(D=>D.id===I?.id)}),i(null)}const o=e.waypoints.find(b=>b.id===t);return G.jsxs(dn,{direction:"column",gap:2,flexGrow:1,children:[G.jsxs(rm,{size:"lg",children:[G.jsxs(ll,{children:[G.jsx(f5,{hide:t!=null,index:-1,totalItems:e.waypoints.length}),G.jsx(J_,{sx:{border:"1px solid transparent",padding:1},children:G.jsx(Wr,{children:"Your location"})})]}),G.jsxs(lJ,{collisionDetection:pY,modifiers:[iQ,nQ],onDragStart:h,onDragEnd:f,sensors:a,children:[G.jsx(DJ,{items:e.waypoints,strategy:AJ,children:e.waypoints.map((b,P)=>G.jsx(sQ,{onDeleteClick:()=>e.onWaypointDelete(P),invisible:b.id===t,isDragOpActive:t!=null,index:P,totalItems:e.waypoints.length,waypoint:b},b.id))}),G.jsx(PJ,{children:o?G.jsx(d5,{index:e.waypoints.indexOf(o),waypoint:o,totalItems:e.waypoints.length,shadow:!0,hideDecorators:!0}):null})]})]}),G.jsxs(dn,{direction:"row",gap:2,px:2,justifyContent:"space-between",alignItems:"center",children:[G.jsxs(Wr,{level:"title-lg",children:["Total trip: ",c.string]}),G.jsx(Ia,{size:"lg",onClick:e.onDoneClick,children:"Done"})]})]})},sQ=e=>{const{invisible:t,isDragOpActive:i,index:a,totalItems:c,waypoint:h,onDeleteClick:f}=e,{setNodeRef:o,setActivatorNodeRef:b,attributes:P,listeners:I,transform:D,transition:z}=jJ({id:h.id}),F={transform:Af.Transform.toString(D),transition:z,opacity:t?0:void 0};return G.jsx(d5,{ref:o,hideDecorators:i,style:F,attributes:P,listeners:I,index:a,totalItems:c,waypoint:h,onDeleteClick:f,setActivatorNodeRef:b})},d5=K.forwardRef((e,t)=>{const{index:i,totalItems:a,waypoint:c,hideDecorators:h=!1,style:f,attributes:o,listeners:b}=e,P=a>1?xE.border:void 0;return G.jsxs(ll,{ref:t,style:f,...o,children:[G.jsx(f5,{hide:h,index:i,totalItems:a}),G.jsx(J_,{sx:{...xE,border:P,boxShadow:e.shadow?"0px 0px 10px 3px rgba(0.5,0.5,0.5,0.15)":void 0},children:G.jsxs(dn,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[G.jsx(Wr,{children:c.description}),a>1&&G.jsx(ei,{ref:e.setActivatorNodeRef,...b,sx:{display:"flex",cursor:"grab",justifyContent:"center",alignItems:"center",width:"2em",height:"2em"},children:G.jsx($G,{})})]})}),a>1&&G.jsx(Kc,{children:G.jsx(sd,{onClick:e.onDeleteClick,sx:{opacity:1,transition:"opacity 200ms"},style:{opacity:h?0:void 0},children:G.jsx(mR,{})})})]})}),f5=e=>{const{index:t,totalItems:i,hide:a}=e;return t===-1?G.jsx(Kc,{children:G.jsx(ei,{sx:{border:"0.15em solid",borderColor:"white",boxShadow:"0px 0px 1px 1px rgba(0,0,0,0.25)",borderRadius:"50%",width:"1em",height:"1em",backgroundColor:"hsl(204,100%,50%)",opacity:1,transition:"opacity 200ms"},style:{opacity:a?0:void 0}})}):t===i-1?G.jsx(Kc,{children:G.jsx(NG,{sx:{marginLeft:"-0.1em",stroke:"rgba(0.5,0.5,0.5,.25)",fill:"red",opacity:1,transition:"opacity 200ms"},style:{opacity:a?0:void 0}})}):G.jsx(Kc,{children:G.jsx(ei,{sx:{fontSize:"0.625em",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bolder",borderRadius:"50%",width:"1.6em",height:"1.6em",border:"0.15em solid",backgroundColor:"background.surface",opacity:1,transition:"opacity 200ms"},style:{opacity:a?0:void 0},children:t+1})})},aQ=e=>G.jsx(WI,{variant:"outlined",sx:{p:2,borderRadius:12,height:"100%"},children:G.jsxs(dn,{gap:2,height:"100%",overflow:"hidden",children:[G.jsx(e.TitleControls,{}),G.jsx(Xg,{}),G.jsx(ei,{overflow:"auto",display:"flex",justifyContent:"center",children:G.jsx(e.CurrentPage,{})})]})}),lQ=e=>{const t=e.route.detour?.distanceMeters??e.route.distanceMeters,i=e.route.detour?.duration??e.route.duration;let a=Yp(t,{abbreviateUnits:!1,units:"imperial",forceSingular:e.route.detour!=null}).string,c=gS(i,{abbreviateUnits:!1,forceSingular:e.route.detour!=null}).string;return e.route.detour&&(a=t<=0?"Along the way":`+${a} detour`,c=i<=0?"Quick detour":`+${c} detour`),G.jsxs(G.Fragment,{children:[G.jsx(ll,{children:G.jsxs($p,{onClick:e.onRouteHighlight,sx:{gap:1,alignItems:"start"},children:[G.jsxs(dn,{direction:"column",flexGrow:1,gap:1,children:[G.jsxs(ei,{children:[G.jsx(Wr,{fontSize:"x-large",children:c}),G.jsxs(Wr,{color:"neutral",fontSize:"md",children:[a," "," ",dQ(e.route.segments[0].strategy)]})]}),G.jsx(cQ,{summary:e.route.summary})]}),G.jsx(Ia,{size:"lg",variant:"outlined",color:"neutral",onClick:h=>{e.onRouteDetailsClick(),h.stopPropagation()},children:"Details"}),G.jsx(Ia,{size:"lg",variant:"solid",color:"success",onClick:h=>{e.onRouteGoClick(),h.stopPropagation()},children:"Go!"})]})}),G.jsx(yf,{})]})},cQ=({summary:e})=>{const t=[];for(const i of e.grades)t.push(G.jsx(uQ,{grade:i}));for(const i of e.roads)t.push(G.jsxs(dn,{direction:"row",gap:1,children:[G.jsx("img",{style:{width:"24px",maxHeight:"24px",display:"block",filter:hQ(i)?["drop-shadow(1px 0 0 black)","drop-shadow(-1px 0 0 black)","drop-shadow(0 1px 0 black)","drop-shadow(0-1px 0 black)"].join(" "):void 0},src:`/icons/${i}.png`,alt:i}),G.jsx(Wr,{children:fQ(i)})]}));return e.hasTolls&&t.push(G.jsxs(dn,{direction:"row",gap:1,children:[G.jsx(rq,{}),G.jsx(Wr,{children:"This route has tolls"})]})),G.jsx(G.Fragment,{children:t})},uQ=({grade:e})=>{const{string:t}=Yp(e.distance,{abbreviateUnits:!1,units:"imperial",forceSingular:!1});return G.jsxs(dn,{direction:"row",alignItems:"center",gap:1,children:[G.jsxs(ei,{sx:{display:"flex",justifyContent:"center",alignItems:"center",position:"relative"},children:[G.jsx(gR,{sx:{transform:`translateX(${e.percentage>0?"":"-"}0.1em) scale(0.8) scaleX(-1) translateY(-0.125em) rotate(${e.percentage>0?"-":""}20deg)`}}),G.jsx("svg",{viewBox:"0 0 24 24",style:{position:"absolute",transform:e.percentage>0?void 0:"scaleX(-1)"},children:G.jsx("polygon",{points:"24,24 0,24, 0,11.5, 24,20.5 24,24"})})]}),G.jsxs(Wr,{children:[Math.abs(e.percentage),"%"," ",e.percentage>0?"Uphill":"Descent"," ",G.jsxs(Wr,{fontSize:"sm",color:"neutral",children:["for ",t]})]})]})};function hQ(e){return/^(us|tx)/.test(e)}function dQ(e){switch(e){case"fastest":return"Fastest";case"shortest":return"Shortest";case"smallRoads":return"Prefer small roads";default:throw new Uo(e)}}function fQ(e){let[t,i,a]=e.split(/(\d+)/).map(c=>c.toUpperCase());return t==="IS"?t="I":t==="CA_R"?t="CA":t==="TXL"&&(t="TX LOOP"),ba.checkArgument(/^[a-z ]+$/i.test(t),t),ba.checkArgument(/^\d+$/.test(i),i),`${t}-${i}${a?" "+a:""}`}const pQ=e=>{console.log("render route list");const{onRouteHighlight:t,onRouteDetailsClick:i,onRouteGoClick:a}=e,c=h=>G.jsx(lQ,{route:h.route,onRouteHighlight:()=>t(h.route),onRouteDetailsClick:()=>i(h.route),onRouteGoClick:()=>a(h.route)});return G.jsx(rm,{size:"lg",children:e.routes.map(h=>G.jsx(c,{route:h},h.id))})},bE=e=>{console.log("render route steps list");const{mode:t,systemMode:i}=RO(),a=(t==="system"?i:t)??"light",c=({direction:f})=>G.jsx(yQ,{direction:f,mode:a}),h=({step:f})=>G.jsx(gQ,{step:f,onStepClick:e.onStepClick,StepIcon:c});return G.jsx(rm,{size:"md",children:e.route.segments.map(f=>G.jsx(mQ,{segment:f,RouteStep:h},f.key))})},mQ=e=>G.jsx(rm,{children:e.segment.steps.map((t,i)=>G.jsx(e.RouteStep,{step:t},i))}),gQ=e=>{const{step:t,step:{maneuver:i},onStepClick:a,StepIcon:c}=e,h=Yp(t.distanceMeters,{abbreviateUnits:!1,units:"imperial",forceSingular:!1}).string,f=({children:o})=>a?G.jsx($p,{sx:{py:.125},onClick:()=>a(t),children:o}):G.jsx(G.Fragment,{children:o});return G.jsxs(G.Fragment,{children:[G.jsx(ll,{children:G.jsxs(f,{children:[G.jsx(Kc,{sx:{m:0,justifyContent:"center"},children:G.jsx(sd,{size:"md",children:G.jsx(c,{direction:i.direction})})}),mq(i)]})}),t.distanceMeters>0&&G.jsx(yf,{inset:"startContent",sx:{"--Divider-childPosition":"0%",marginInlineStart:8},children:h})]})},yQ=e=>G.jsx(g1,{branches:[e.direction],dimColor:e.mode==="light"?"#333":"#ddd"}),vQ=e=>G.jsxs(dn,{gap:1,direction:"row",alignItems:"center",children:[G.jsx(Kp,{in:e.showBackButton,orientation:"horizontal",children:G.jsx(sd,{onClick:e.onBackClick,children:G.jsx(OG,{})})}),G.jsx(Wr,{flexGrow:1,level:"title-lg",fontSize:"xl",children:e.title}),G.jsx(sd,{onClick:e.onCloseClick,children:G.jsx(mR,{})})]});function yw(e){return function(t){return t.isLoading?G.jsx(nm,{size:"lg"}):G.jsx(e,{...t})}}class _Q{pageStack=[tn.CHOOSE_DESTINATION];isLoading=!1;disableFitToBounds=!1;searchQuery="";destinations=[];selectedDestination=void 0;routes=[];selectedRoute=void 0;constructor(){eS(this,{destinations:bi.ref,selectedDestination:bi.ref,routes:bi.ref,selectedRoute:bi.ref})}get currentPageKey(){return Ca(this.pageStack.at(-1))}get title(){switch(this.currentPageKey){case tn.CHOOSE_DESTINATION:return"Choose destination";case tn.SEARCH_ALONG:return"Search along route";case tn.CHOOSE_ON_MAP:return"Choose destination";case tn.DESTINATIONS:return this.searchQuery||"Search results";case tn.ROUTES:return`Routes to ${Ca(this.selectedDestination).label}`;case tn.DIRECTIONS_FROM_ROUTE_CONTROLS:return"Directions";case tn.DIRECTIONS_FROM_ROUTES_LIST:return"Details";case tn.MANAGE_STOPS:return"Manage stops";default:throw new Uo(this.currentPageKey)}}get showBackButton(){return this.pageStack.length>1}}class xQ{constructor(t){this.appClient=t}startChooseDestinationFlow(t){this.reset(t),t.pageStack[0]=tn.CHOOSE_DESTINATION}startSearchAlongFlow(t){this.reset(t),t.pageStack[0]=tn.SEARCH_ALONG}startShowActiveRouteDirectionsFlow(t){this.reset(t),t.pageStack[0]=tn.DIRECTIONS_FROM_ROUTE_CONTROLS}startManageStopsFlow(t){this.reset(t),t.pageStack[0]=tn.MANAGE_STOPS}search(t,i){return this.appClient.getAutocompleteOptions.query(i)}onSearchSelect(t,i){typeof i=="string"?(t.pageStack.push(tn.DESTINATIONS),t.isLoading=!0,this.search(t,i).then(Ir(a=>{t.searchQuery=i,t.destinations=a,t.selectedDestination=void 0})).finally(Ir(()=>t.isLoading=!1))):this.onDestinationRoutesClick(t,i)}onBackClick(t){switch(ba.checkState(t.pageStack.length>0),t.currentPageKey){case tn.CHOOSE_DESTINATION:case tn.SEARCH_ALONG:case tn.DIRECTIONS_FROM_ROUTE_CONTROLS:case tn.DIRECTIONS_FROM_ROUTES_LIST:case tn.CHOOSE_ON_MAP:case tn.MANAGE_STOPS:t.pageStack.pop();break;case tn.DESTINATIONS:this.reset(t);break;case tn.ROUTES:t.selectedDestination=void 0,t.routes=[],t.selectedRoute=void 0,t.pageStack.pop();break;default:throw new Uo(t.currentPageKey)}}onChooseOnMapClick(t){t.pageStack.push(tn.CHOOSE_ON_MAP)}onDestinationTypeClick(t,i,a,c){const h=t.currentPageKey;console.log("currentPage",h);const f=h===tn.CHOOSE_DESTINATION?B_.NEARBY:B_.ROUTE;if(t.pageStack.push(tn.DESTINATIONS),t.isLoading=!0,this.appClient.search.query({type:i,scope:f}).then(Ir(o=>{t.searchQuery=n2[i].label,t.destinations=o,t.selectedDestination=void 0})).finally(Ir(()=>t.isLoading=!1)),f===B_.NEARBY){const o=c.addMapDragEndListener(b=>{this.appClient.search.query({type:i,scope:f,center:b}).then(Ir(P=>{t.searchQuery=n2[i].label,t.destinations=P,t.selectedDestination=void 0,t.disableFitToBounds=!0}))});cV(()=>t.currentPageKey!==tn.DESTINATIONS,()=>{console.log("clearing map drag listener!"),o(),t.disableFitToBounds=!1})}}onDestinationHighlight(t,i){t.selectedDestination=i===t.selectedDestination?void 0:i}onDestinationGoClick(t,i){console.log("go",i),t.selectedDestination=i}onDestinationRoutesClick(t,i){console.log("routes",i),t.selectedDestination=i,t.pageStack.push(tn.ROUTES),t.isLoading=!0,this.appClient.previewRoutes.query({toNodeUid:i.nodeUid}).then(Ir(a=>{t.isLoading=!1,t.routes=a,t.selectedRoute=t.routes[0]}))}onRouteHighlight(t,i){console.log("highlight route",i),t.selectedRoute=i}onRouteDetailsClick(t,i){console.log("route details",i),t.selectedRoute=i,t.pageStack.push(tn.DIRECTIONS_FROM_ROUTES_LIST)}onRouteGoClick(t,i){console.log("go route",i),t.selectedRoute=i}reset(t){console.log("nav sheet reset"),t.pageStack.length=1,t.isLoading=!1,t.destinations=[],t.selectedDestination=void 0,t.routes=[],t.selectedRoute=void 0}}function bQ({appClient:e,appStore:t,appController:i}){const a=new _Q,c=new xQ(e),{CurrentNavPage:h}=wQ({store:a,controller:c,appStore:t,appController:i}),f=fo(b=>G.jsx(vQ,{showBackButton:a.showBackButton,title:a.title,onBackClick:Ir(()=>c.onBackClick(a)),onCloseClick:b.onCloseClick}));return{NavSheet:b=>G.jsx(aQ,{TitleControls:()=>G.jsx(f,{onCloseClick:b.onCloseClick}),CurrentPage:()=>G.jsx(h,{onDestinationGoClick:b.onDestinationGoClick,onRouteGoClick:b.onRouteGoClick,onRouteStepClick:b.onRouteStepClick,onRouteToPointClick:b.onRouteToPointClick,onManageStopsDoneClick:b.onCloseClick,onWaypointsChange:b.onWaypointsChange})}),store:a,controller:c}}function wQ(e){const{store:t,controller:i,appStore:a,appController:c}=e,h=()=>{const[U,$]=K.useState([]),[j,ie]=K.useState(!1),se=K.useCallback(de=>{if(de.trim().length===0){$([]);return}j||(ie(!0),i.search(t,de).then(oe=>$(oe),oe=>console.log("search failed:",oe)).finally(()=>ie(!1)))},[j]),Q=yE(se,250);return G.jsx(vE,{showSearchLoading:j,mode:"chooseDestination",onSelect:Ir(de=>i.onSearchSelect(t,de)),onInputChange:Q,onDestinationTypeClick:Ir((de,oe)=>i.onDestinationTypeClick(t,de,oe,c)),onChooseOnMapClick:Ir(()=>i.onChooseOnMapClick(t)),options:U})},f=()=>{const[U,$]=K.useState([]),[j,ie]=K.useState(!1),se=K.useCallback(de=>{if(de.trim().length===0){$([]);return}j||(ie(!0),i.search(t,de).then(oe=>$(oe),oe=>console.log("search failed:",oe)).finally(()=>ie(!1)))},[j]),Q=yE(se,250);return G.jsx(vE,{mode:"searchAlong",showSearchLoading:j,onSelect:Ir(de=>i.onSearchSelect(t,de)),onInputChange:Q,onDestinationTypeClick:Ir((de,oe)=>i.onDestinationTypeClick(t,de,oe,c)),onChooseOnMapClick:Ir(()=>i.onChooseOnMapClick(t)),options:U})},o=yw(YJ),b=fo(U=>G.jsx(o,{isLoading:t.isLoading,onUseThisPointClick:U.onUseThisPointClick})),P=yw(tQ),I=fo(U=>{const $=fo(({destination:j})=>{const ie=Sf(()=>t.selectedDestination===j);return G.jsx(JJ,{visible:ie.get(),onDestinationRoutesClick:Ir(()=>i.onDestinationRoutesClick(t,j)),onDestinationGoClick:Ir(()=>{i.onDestinationGoClick(t,j),U.onDestinationGoClick()})})});return G.jsx(P,{isLoading:t.isLoading,destinations:t.destinations,CollapsibleButtonBar:$,onDestinationHighlight:Ir(j=>i.onDestinationHighlight(t,j))})}),D=yw(pQ),z=fo(U=>G.jsx(D,{isLoading:t.isLoading,routes:t.routes,onRouteHighlight:Ir($=>i.onRouteHighlight(t,$)),onRouteDetailsClick:Ir($=>i.onRouteDetailsClick(t,$)),onRouteGoClick:Ir($=>{i.onRouteGoClick(t,$),U.onRouteGoClick()})})),F=fo(U=>{const{activeRoute:$,activeRouteIndex:j,activeRouteSummary:ie}=a,[se,Q]=K.useState($!=null?$.segments.slice(j?.segmentIndex).map((be,xe)=>{const Me=BigInt("0x"+be.key.split("-")[1]);return{id:Me.toString(16)+"-"+xe,description:be.steps.at(-1).maneuver.banner?.text??"Waypoint",nodeUid:Me}}):[]);if(!$)return null;const de=be=>{const xe=RS(se,be.oldIndex,be.newIndex);Q(xe),U.onWaypointsChange(xe.map(Me=>Me.nodeUid))},oe=be=>{se.splice(be,1);const xe=se.slice(0);Q(xe),U.onWaypointsChange(xe.map(Me=>Me.nodeUid))};return G.jsx(oQ,{summary:ie??{distanceMeters:0,minutes:0},waypoints:se,onDoneClick:Ir(U.onDoneClick),onWaypointReorder:Ir(de),onWaypointDelete:Ir(oe)})});return{CurrentNavPage:fo(U=>{switch(console.log("render current nav pag",t.currentPageKey),t.currentPageKey){case tn.CHOOSE_DESTINATION:return G.jsx(h,{});case tn.SEARCH_ALONG:return G.jsx(f,{});case tn.CHOOSE_ON_MAP:return G.jsx(b,{onUseThisPointClick:U.onRouteToPointClick});case tn.DESTINATIONS:return G.jsx(I,{onDestinationGoClick:U.onDestinationGoClick});case tn.ROUTES:return G.jsx(z,{onRouteGoClick:U.onRouteGoClick});case tn.DIRECTIONS_FROM_ROUTES_LIST:return G.jsx(bE,{route:Ca(t.selectedRoute),onStepClick:U.onRouteStepClick});case tn.DIRECTIONS_FROM_ROUTE_CONTROLS:return G.jsx(bE,{route:Ca(a.activeRoute)});case tn.MANAGE_STOPS:return G.jsx(F,{onDoneClick:U.onManageStopsDoneClick,onWaypointsChange:U.onWaypointsChange});default:throw new Uo(t.currentPageKey)}})}}function SQ({appClient:e,transitionDurationMs:t}){const i=new DK,a=new zK,{NavSheet:c,controller:h,store:f}=bQ({appClient:e,appStore:i,appController:a}),o=Ir(()=>{a.hideNavSheet(i),a.setFollow(i),EQ(t).then(Ir(()=>h.reset(f))),f.destinations=[]}),b=()=>G.jsx(c,{onCloseClick:o,onDestinationGoClick:()=>{a.setDestinationNodeUid(i,Ca(f.selectedDestination).nodeUid,e),o()},onRouteGoClick:Ir(()=>{a.setActiveRoute(i,f.selectedRoute,e),o()}),onRouteToPointClick:Ir(()=>{f.isLoading=!0,a.synthesizeSearchResult(i,e).then(Ir(Ee=>{h.onDestinationRoutesClick(f,Ee)}),Ee=>console.log("error trying to synthesize result",Ee))}),onRouteStepClick:Ir(Ee=>{a.flyTo(i,Ee.maneuver.lonLat,IQ(Ee)),a.drawStepArrow(Ee)}),onWaypointsChange:Ir(Ee=>{a.setActiveRouteFromNodeUids(i,Ee,e)})});sg(()=>i.showNavSheet&&f.currentPageKey===tn.CHOOSE_ON_MAP,Ir(Ee=>{a.toggleChooseOnMapUi(i,Ee),Ee&&(a.clearPitchAndBearing(i),i.cameraMode=Xl.FREE)})),sg(()=>{if(!(f.destinations.length===0||f.currentPageKey!==tn.DESTINATIONS))return f.destinations.map(Ee=>Ee.lonLat)},Ir(Ee=>{Ee&&(a.setFree(i),f.disableFitToBounds||a.fitPoints(i,Ee))})),sg(()=>{if(i.showNavSheet&&f.currentPageKey===tn.ROUTES&&!f.isLoading)return f.routes},Ee=>{if(Ee)if(Ee.every(re=>re.detour)){const re=[i.truckPoint,Ee[0].detour.lngLat];console.log("tlbrs",re),i.cameraMode=Xl.FREE,a.fitPoints(i,re)}else{const ke=Ee.map(Ge=>Ub(Ig(Ge))).flatMap(([Ge,Ke,gt,et])=>[[Ge,Ke],[gt,et]]);console.log("tlbrs",ke),i.cameraMode=Xl.FREE,a.fitPoints(i,ke)}}),sg(()=>({routes:f.routes,selected:f.selectedRoute}),({routes:Ee,selected:re})=>{[0,1,2].forEach(ke=>a.renderRoutePreview(Ee[ke],{index:ke,highlight:re?.id===Ee[ke]?.id})),Ee.length===0&&!re&&a.renderActiveRoute(i.activeRoute)}),sg(()=>i.showNavSheet&&f.currentPageKey===tn.MANAGE_STOPS?i.activeRoute:void 0,Ee=>{if(!Ee)return;const[re,ke,Ge,Ke]=Ub(Ig(Ee)),gt=[[re,ke],[Ge,Ke]];i.cameraMode=Xl.FREE,a.fitPoints(i,gt)}),sg(()=>i.showNavSheet?void 0:i.activeArrowStep,Ee=>a.drawStepArrow(Ee));const{Controls:P,controller:I,store:D}=HK({appStore:i}),z=()=>G.jsx(P,{onRecenterFabClick:Ir(()=>a.setFollow(i)),onRouteFabClick:Ir(()=>{h.startChooseDestinationFlow(f),i.showNavSheet=!0}),onSearchFabClick:Ir(()=>{h.startSearchAlongFlow(f),i.showNavSheet=!0})}),F=Ir((Ee,re)=>{a.onMapLoad(Ee,re),a.startListening(i,e),I.startListening(D,e)}),U=fo(()=>G.jsx(PG,{destinations:f.destinations,selectedDestinationNodeUid:f.selectedDestination?.nodeUid,forceDisplay:f.currentPageKey===tn.DESTINATIONS,onDestinationClick:Ir(Ee=>h.onDestinationRoutesClick(f,Ee))})),$=Sf(()=>i.trailerPoint?.map(Ee=>Number(Ee.toFixed(6))),{equals:Pf.structural}),j=fo(()=>G.jsx(wq,{trailerPoint:$.get(),activeRoute:i.activeRoute})),ie=fo(()=>G.jsx(iR,{mode:i.themeMode,onLoad:F,onDragStart:Ir(()=>a.setFree(i)),Destinations:U,TrailerOrWaypointMarkers:j,PlayerMarker:pq})),se=Sf(()=>Yp(i.distanceToNextManeuver)),Q=fo(()=>i.activeRouteDirection?G.jsx(uq,{direction:i.activeRouteDirection.direction,length:se.get().length,unit:se.get().unit,laneHint:i.distanceToNextManeuver<=5e3?i.activeRouteDirection.laneHint:void 0,thenHint:!i.activeRouteDirection.laneHint||i.distanceToNextManeuver>5e3?i.activeRouteDirection.thenHint:void 0,banner:i.activeRouteDirection.banner}):G.jsx(G.Fragment,{})),de=fo(()=>i.segmentComplete!=null?G.jsx(bq,{open:!0,place:i.segmentComplete.place,placeInfo:i.segmentComplete.placeInfo,isFinalSegment:i.segmentComplete.isFinal,onContinueClick:Ir(()=>a.unpauseRouteEvents(i,e)),onEndClick:Ir(()=>{a.unpauseRouteEvents(i,e),a.setActiveRoute(i,void 0,e)})}):G.jsx(G.Fragment,{})),oe=Sf(()=>({minutes:i.activeRouteToFirstWayPointSummary?.minutes??0,distance:Yp(i.activeRouteToFirstWayPointSummary?.distanceMeters??0)}),{equals:Pf.structural}),be=fo(Ee=>G.jsx(yq,{summary:oe.get(),onExpandedToggle:Ee.onExpandedToggle,onManageStopsClick:i.activeRoute!=null&&i.activeRoute.segments.length>1?Ir(()=>{h.startManageStopsFlow(f),i.showNavSheet=!0}):void 0,onSearchAlongRouteClick:Ir(()=>{h.startSearchAlongFlow(f),i.showNavSheet=!0}),onRoutePreviewClick:Ir(()=>{if(!i.activeRoute){console.warn("no active route to preview");return}const[re,ke,Ge,Ke]=Ub(Ig(i.activeRoute));i.cameraMode=Xl.FREE,a.fitPoints(i,[[re,ke],[Ge,Ke]])}),onRouteDirectionsClick:Ir(()=>{h.startShowActiveRouteDirectionsFlow(f),i.showNavSheet=!0}),onRouteEndClick:Ir(()=>a.setActiveRoute(i,void 0,e))})),xe=()=>G.jsx(xq,{Guidance:Q,RouteControls:be,SegmentCompleteToast:de}),Me=fo(()=>i.isReceivingTelemetry?G.jsx(G.Fragment,{}):G.jsx(Sq,{}));return{App:()=>G.jsx(CQ,{store:i,transitionDurationMs:t,SlippyMap:ie,NavSheet:b,RouteStack:xe,Controls:z,WaitingForTelemetry:Me})}}const CQ=e=>{console.log("render app");const{SlippyMap:t,NavSheet:i,RouteStack:a,Controls:c,WaitingForTelemetry:h}=e,f=Yv(),o=oG(f.breakpoints.up("sm")+" and (orientation: portrait)");return G.jsxs(G.Fragment,{children:[G.jsx(t,{}),G.jsx(dg,{columns:3,container:!0,sx:{flexGrow:1,position:"absolute",top:0,right:0,pointerEvents:"none"},padding:2,paddingBlockEnd:3,height:"100vh",children:G.jsx(TQ,{store:e.store,isLargePortrait:o,transitionDurationMs:e.transitionDurationMs,children:G.jsx(c,{})})}),G.jsx(dg,{container:!0,sx:{flexGrow:1,pointerEvents:"none"},padding:2,paddingBlockEnd:3,height:"100vh",justifyContent:"space-between",children:G.jsx(dg,{size:{xs:12,sm:o?12:5},maxWidth:o?void 0:600,sx:{zIndex:999},children:G.jsx(MQ,{store:e.store,children:G.jsx(a,{})})})}),G.jsx(dg,{container:!0,sx:{flexGrow:1,position:"absolute",top:0,left:0,right:0,pointerEvents:"none"},padding:2,paddingBlockEnd:3,height:"100vh",children:G.jsx(dg,{size:{xs:12,sm:o?12:5},maxWidth:o?void 0:600,sx:{maxHeight:"100%"},children:G.jsx(PQ,{store:e.store,children:G.jsx(i,{})})})}),G.jsx(h,{})]})},TQ=fo(e=>{const t=!e.store.showNavSheet&&e.store.activeRoute!=null;return G.jsx(dg,{container:!0,alignItems:"stretch",sx:{pt:{xs:t?14:0,sm:e.isLargePortrait&&t?14:0},pb:{xs:t?13:0,sm:e.isLargePortrait&&t?13:0},zIndex:999,transition:`${e.transitionDurationMs}ms padding ease`},children:e.children})}),MQ=fo(e=>G.jsx(dS,{in:!e.store.showNavSheet&&e.store.activeRoute!=null,direction:"right",children:G.jsx(ei,{height:"100%",children:e.children})})),PQ=fo(e=>G.jsx(dS,{in:e.store.showNavSheet,direction:"right",children:G.jsx(ei,{height:"100%",sx:{position:"relative",top:0,left:0,zIndex:999,pointerEvents:"auto"},children:e.children})})),EQ=e=>new Promise(t=>setTimeout(t,e));function IQ(e){if(!e.arrowPoints||e.arrowPoints<2)return 0;const t=Ug.decode(e.geometry).slice(0,e.arrowPoints);return pS(t[0],t[1])}vA({enforceActions:"always",computedRequiresReaction:!0,reactionRequiresObservable:!0,observableRequiresReaction:!0,disableErrorBoundaries:!0});const p5=vk(),kQ=document.getElementById("root"),AQ=AV.createRoot(kQ),m5=D8({links:[P8({client:M8({url:"wss://api.truckermudgeon.com/navigator",connectionParams:()=>{const e=localStorage.getItem("viewerId");return e?{viewerId:e}:null},onOpen:()=>{console.log("opening...")},onError:e=>console.error("ws client error",e),onClose:e=>console.error("socket closed",e),retryDelayMs:e=>Math.min(Math.pow(2,e+1)*1e3,15e3),keepAlive:{enabled:!0,intervalMs:3e4,pongTimeoutMs:5e3}})})]}).app,{App:RQ}=SQ({appClient:m5,transitionDurationMs:p5.transitions.duration.standard});AQ.render(G.jsx(K.StrictMode,{children:G.jsx(jN,{theme:{[Wv]:p5},children:G.jsxs(AO,{children:[G.jsx(cB,{}),G.jsx(BU,{appClient:m5,children:G.jsx(RQ,{})})]})})}))});export default DQ();
